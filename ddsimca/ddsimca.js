var Qh=Object.defineProperty;var wc=at=>{throw TypeError(at)};var Zh=(at,Qe,yt)=>Qe in at?Qh(at,Qe,{enumerable:!0,configurable:!0,writable:!0,value:yt}):at[Qe]=yt;var yr=(at,Qe,yt)=>Zh(at,typeof Qe!="symbol"?Qe+"":Qe,yt),ja=(at,Qe,yt)=>Qe.has(at)||wc("Cannot "+yt);var Oe=(at,Qe,yt)=>(ja(at,Qe,"read from private field"),yt?yt.call(at):Qe.get(at)),zt=(at,Qe,yt)=>Qe.has(at)?wc("Cannot add the same private member more than once"):Qe instanceof WeakSet?Qe.add(at):Qe.set(at,yt),Kt=(at,Qe,yt,rn)=>(ja(at,Qe,"write to private field"),rn?rn.call(at,yt):Qe.set(at,yt),yt),tn=(at,Qe,yt)=>(ja(at,Qe,"access private method"),yt);(function(){"use strict";var Bn,Vn,Zr,dl,vl,yn,Yn,xn,$r,Wn,ml,hl,br,yc,fs,qa,en,Un,gl,is,xc,gc;var at=document.createElement("style");at.textContent=`button.svelte-ymtj5z{display:inline-block;font-size:.9em;padding:0 .5em;line-height:1.5em;border-radius:.25em;box-shadow:none;margin:0;text-align:center;border:1px solid}.button.svelte-ymtj5z:focus-visible{outline:solid 2px;outline-offset:2px}button.svelte-bx9fh5{display:inline-block;font-size:1em;width:1.3em;height:1.3em;border:none;border-radius:50%;box-shadow:none;margin:0 .25em;text-align:center;padding:0;background-size:45% 45%;background-position:50%;background-repeat:no-repeat}button.svelte-bx9fh5:last-of-type{margin-right:0}.button.svelte-bx9fh5:focus-visible{outline:solid 2px;outline-offset:2px}.control-element.svelte-1986c5z{font-size:.85em;background:var(--container-bg-color, #fff);color:var(--text-color-dark, #606570);padding:.5em .5em .5em 1em;border-radius:0;display:flex;justify-items:flex-start;justify-content:flex-start;align-items:center;margin-bottom:.5px}.control-element.svelte-1986c5z:hover{background:var(--container-bg-color, #fafdff)}.control-element.svelte-1986c5z:first-child{margin-top:.25rem;border-top-left-radius:.25rem;border-top-right-radius:.25rem}.control-element.svelte-1986c5z:last-child{margin-bottom:.25rem;border-bottom-left-radius:.25rem;border-bottom-right-radius:.25rem}.hidden.svelte-1986c5z{display:none}.control-element.error.svelte-1986c5z{background:var(--warning-color, crimson);color:var(--warning-text-color, #fefefe)}.label.svelte-1986c5z{padding-right:.75em;flex-grow:0;flex-shrink:1;color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z>.wrapper{flex:1 1 auto;position:relative;box-sizing:border-box;display:inline-block;margin:0;padding:0;width:auto;align-items:flex-start;justify-content:center;justify-items:flex-start}.control-element.svelte-1986c5z>h2{text-align:left;flex-grow:1;padding:0 .25em 0 0;margin:0;font-size:1.1em}.control-element.svelte-1986c5z>p{text-align:left;flex-grow:1;padding:0 .25em 0 0;margin:0;font-size:max(12px,.9em)}.control-element.error p{color:var(--warning-text-color, #fefafa)}.control-element.error a{color:var(--warning-link-color, #ffeeaa)}.control-element.error a:hover{color:var(--warning-link-hover-color, #ffee80)}.control-element.svelte-1986c5z>.title{font-size:1.05em;font-weight:700;color:var(--text-color-dark, #606570);flex-grow:1;padding:.3em 0;margin:0}.control-element.svelte-1986c5z>.range-slider-container{outline-color:var(--outline-color, #ccc);background:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z>.range-slider-container:focus-visible{outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .range-slider{color:var(--text-color-light, #fafafa);background-color:var(--main-color1, #6eb8ff);border-right-color:var(--main-color2, #528abe)}.control-element.svelte-1986c5z .range-value{color:var(--text-color-light, #fafafa)}.control-element.svelte-1986c5z .range-value_left,.control-element.svelte-1986c5z .range-value_right{color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z .button{border-color:transparent;background-color:var(--bg-color-dark, #606570);color:var(--text-color-light, #fafafa);outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .button:hover{border-color:var(--main-color1, #6eb8ff);background-color:var(--main-color1-light, #6eb8ff20);color:var(--main-color2, #5086b9)}.control-element.svelte-1986c5z .button-cancel{background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" version="2.0" viewBox="0 0 100 100" style="stroke:%23fafafa;stroke-width:1em;" ><line x1="0" y1="0" x2="100" y2="100"/><line x1="0" y1="100" x2="100" y2="0"/></svg>')}.control-element.svelte-1986c5z .button-cancel:hover{background-color:var(--warning-color, #dc143c)}.control-element.svelte-1986c5z .button-undo{background-image:url('data:image/svg+xml;utf8,<svg width="99px" height="99px" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g stroke-linecap="round" stroke-linejoin="round" ><path d="M6 7L7 6L4.70711 3.70711L5.19868 3.21553C5.97697 2.43724 7.03256 2 8.13323 2C11.361 2 14 4.68015 14 7.93274C14 11.2589 11.3013 14 8 14C6.46292 14 4.92913 13.4144 3.75736 12.2426L2.34315 13.6569C3.90505 15.2188 5.95417 16 8 16C12.4307 16 16 12.3385 16 7.93274C16 3.60052 12.4903 0 8.13323 0C6.50213 0 4.93783 0.647954 3.78447 1.80132L3.29289 2.29289L1 0L0 1V7H6Z" fill="%23fafafa"></path> </g></svg>')}.control-element.svelte-1986c5z .button-undo:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-up{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="55" y1="110" x2="55" y2="10"/><line x1="20" y1="50" x2="55" y2="10"/><line x1="90" y1="50" x2="55" y2="10"/></svg>')}.control-element.svelte-1986c5z .button-up:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-down{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="55" y1="0" x2="55" y2="100"/><line x1="20" y1="60" x2="55" y2="100"/><line x1="90" y1="60" x2="55" y2="100"/></svg>')}.control-element.svelte-1986c5z .button-down:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-download{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="50" y1="0" x2="50" y2="100"/><line x1="10" y1="60" x2="50" y2="100"/><line x1="90" y1="60" x2="50" y2="100"/></svg>')}.control-element.svelte-1986c5z .button-download:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-add{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="55" y1="0" x2="55" y2="110"/><line x1="0" y1="55" x2="110" y2="55"/></svg>')}.control-element.svelte-1986c5z .button-add:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-settings{background-size:75%;background-image:url('data:image/svg+xml;utf8,<svg width="16" height="16" viewBox="0 0 16 16"  style="stroke:none;stroke-width:1px;" fill="%23fafafa" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><path d="M12.2418 6.58543L6.27026 12.5584C5.94986 12.8788 5.54841 13.1061 5.10883 13.216L2.81783 13.7887C2.45164 13.8803 2.11994 13.5486 2.21149 13.1824L2.78424 10.8914C2.89413 10.4518 3.12143 10.0504 3.44183 9.72996L9.41337 3.75701L12.2418 6.58543ZM13.6567 2.3435C14.4378 3.12455 14.4378 4.39088 13.6567 5.17193L12.9489 5.87833L10.1205 3.0499L10.8283 2.3435C11.6093 1.56245 12.8757 1.56245 13.6567 2.3435Z"/></svg>')}.control-element.svelte-1986c5z .button-settings:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .selector:focus-visible{outline:2px solid;outline-offset:2px;outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .selector>.option{color:var(--text-color-dark, #606570);background-color:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z .plot-selector>.option>svg{stroke:var(--main-color1, #606570)}.control-element.svelte-1986c5z .plot-selector>.option.selected>svg{stroke:var(--text-color-light, #fefefe)}.control-element.svelte-1986c5z .selector>.option.selected{background-color:var(--main-color1, #6eb8ff);color:var(--text-color-light, #fefefe)}.control-element.svelte-1986c5z .selector>.option:not(.selected):hover{border:1px solid var(--main-color1, #6eb8ff);background-color:var(--main-color1-light, #6eb8ff20);color:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .selector>.option:not(.selected):hover>svg{stroke:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .file-selector:before{color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z .file-selector.selected:before{color:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .file-selector:focus-visible{outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .file-selector:focus-visible:before{outline-color:var(--outline-color, #ccc);color:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .file-selector:hover:before{color:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .textinput>input{background-color:var(--main-color1, #6eb8ff);color:var(--text-color-light, #fefefe)}.control-element.svelte-1986c5z .textinput>input:placeholder-shown{color:var(--text-color-dark, #a0a0a0);background-color:var(--bg-color-light, #f0f0f0);border-color:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z .textinput>input::placeholder{color:#a0a0a0}.control-element.svelte-1986c5z .textinput>input:active::placeholder,.control-element.svelte-1986c5z .textinput>input:focus::placeholder{color:transparent}.control-element.svelte-1986c5z .textinput>input:focus,.control-element.svelte-1986c5z .textinput>input:active{border-color:var(--main-color1, #6eb8ff);background-color:var(--main-color1-light, #6eb8ff20);color:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .textinput.error>input,.control-element.svelte-1986c5z .textinput.error>input:focus,.control-element.svelte-1986c5z .textinput.error>input:active{color:var(--warning-color, crimson);background-color:var(--warning-color-light, #ffd5ce);border-color:var(--warning-color, crimson)}.control-element.svelte-1986c5z .textinput.error>.error-message{color:var(--warning-color, crimson);background-color:var(--warning-color-light, #ffd5ce)}.control-element.svelte-1986c5z .spinner:after{border-color:var(--main-color1, #6eb8ff) transparent var(--main-color1, #6eb8ff) transparent}.control-element.svelte-1986c5z .number-container{background-color:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z .number-container>.value{color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z .number-container>.button-small>svg>polygon{fill:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .number-container>.button-small:hover>svg>polygon{fill:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .number-container:focus-visible{outline-color:var(--outline-color, #ccc)}.range-slider-container.svelte-vhx0r0{position:relative;box-sizing:border-box;flex:1 1 auto;height:1.5em;margin:0;padding:0;width:auto;border-radius:2px;cursor:default;display:flex;align-items:center;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider-container.svelte-vhx0r0:focus-visible{outline:solid 2px #ccc;outline-offset:2px}.range-slider.svelte-vhx0r0{position:relative;display:flex;justify-content:right;align-items:center;box-sizing:border-box;border-radius:2px;border-right:solid 5px;text-align:right;margin:0;padding:0;height:100%;cursor:default;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider_right.svelte-vhx0r0{justify-content:left}.range-value.svelte-vhx0r0{display:inline-block;margin:0;padding:0;cursor:default;font-size:.85em;position:relative;user-select:none;-webkit-user-select:none;-moz-user-select:none;right:.25em}.range-value_right.svelte-vhx0r0{left:calc(100% + 5px + .25em)}.range-slider-container.svelte-xdlm7u{position:relative;box-sizing:border-box;display:inline-block;flex:1 1 auto;height:1.5em;margin:0;padding:0;width:auto;border-radius:2px;cursor:default;display:flex;align-items:center;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider-container.svelte-xdlm7u:focus-visible{outline:solid 2px;outline-offset:2px}.range-slider.svelte-xdlm7u{position:relative;display:flex;justify-content:center;align-items:center;box-sizing:border-box;border-radius:2px;text-align:center;margin:0;padding:0;height:100%;cursor:default;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider_left.svelte-xdlm7u{justify-content:left}.range-slider_right.svelte-xdlm7u{justify-content:right}.range-value.svelte-xdlm7u{display:inline-block;margin:0;padding:0;cursor:default;font-size:.85em;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-value_left.svelte-xdlm7u{position:relative;left:calc(100% + .25em)}.range-value_right.svelte-xdlm7u{position:relative;right:calc(100% + .25em)}input.svelte-1i17tox{display:none}.selector.svelte-1i17tox{position:relative;box-sizing:border-box;flex:1 1 auto;font-size:1em;line-height:1.5em;margin:0;padding:0;width:auto;border-radius:2px;user-select:none;-webkit-user-select:none;-moz-user-select:none;display:flex}.selector.svelte-1i17tox:focus-visible{outline:solid 2px;outline-offset:2px}.option.svelte-1i17tox{cursor:default;padding:.25em .5em;margin:0 .3em 0 0;border:1px solid transparent;border-radius:.3em;font-size:.85em}.option.svelte-1i17tox:not(.selected):hover{border:1px solid}.file-selector.svelte-1k0x7uv>input:where(.svelte-1k0x7uv){display:none}.file-selector.svelte-1k0x7uv{display:flex;align-items:baseline;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;flex:1 1;min-width:0;border-radius:2px;cursor:default}.file-selector.svelte-1k0x7uv:focus-visible{outline:solid 2px;outline-offset:2px}.file-selector.svelte-1k0x7uv:before{display:inline-block;content:"⇪";font-size:1.1em;margin:0 .5em 0 0;padding:0}.file-selector.selected.svelte-1k0x7uv:before{content:"☷";font-size:1.3em;letter-spacing:-.2em;font-weight:700}.textinput.svelte-1qtiwcs{box-sizing:border-box;flex:1 1 auto;font-size:1em;line-height:1.5em;margin:0;padding:.15em 0;width:auto;border-radius:2px;user-select:none;-webkit-user-select:none;-moz-user-select:none;display:flex;position:relative}.textinput.svelte-1qtiwcs>input:where(.svelte-1qtiwcs){flex:1 1 auto;font-size:.9em;width:100%;cursor:default;padding:.25em .5em;border:1px solid;border-radius:.3em;outline:none}.textinput.svelte-1qtiwcs>input:where(.svelte-1qtiwcs):focus,.textinput.svelte-1qtiwcs>input:where(.svelte-1qtiwcs):active{border:1px solid}.error-message.svelte-1qtiwcs{position:absolute;left:0;bottom:calc(100% + 2px);border-radius:.3em;line-height:1em;font-size:.75em;padding:.5em}.spinner.svelte-n48urb{display:inline-block;height:1.5em;line-height:1.5em;width:1.5em;margin:0 .5em}.spinner.svelte-n48urb:after{content:" ";display:block;width:.8em;height:.8em;margin:.1em;border-radius:50%;border:.2em solid;animation:svelte-n48urb-spinner 1.2s linear infinite}@keyframes svelte-n48urb-spinner{0%{transform:rotate(0)}to{transform:rotate(360deg)}}input.svelte-yf64an{display:none}.selector.svelte-yf64an{position:relative;box-sizing:border-box;flex:1 1 auto;font-size:1em;margin:0;padding:0;width:auto;border-radius:2px;user-select:none;-webkit-user-select:none;-moz-user-select:none;display:flex}.option.svelte-yf64an{cursor:default;padding:0;padding-inline:0;padding-block:0;margin:0 .2em 0 0;border:1px solid transparent;border-radius:.3em;font-size:.85em;height:auto;display:flex;justify-content:center}.option.svelte-yf64an:not(.selected):hover{border:1px solid}.outliers.svelte-1ggez3e{line-height:1.5em;text-align:left;padding:.5em 0;flex:0 0 80%}.outliers.svelte-1ggez3e>.item:where(.svelte-1ggez3e){color:#dc143c;background:#dc143c20;display:inline-block;white-space:nowrap;vertical-align:middle;max-width:10ch;overflow:hidden;text-overflow:ellipsis;padding:.1em .5em;margin:.2em .1em;border-radius:.2em}.show-download-links-none.svelte-1jtdxd0>.download-links:where(.svelte-1jtdxd0){display:none}.show-download-links-hover.svelte-1jtdxd0:hover>.download-links:where(.svelte-1jtdxd0){bottom:0}.show-download-links-fixed.svelte-1jtdxd0>.download-links:where(.svelte-1jtdxd0){bottom:0}.download-links.svelte-1jtdxd0{position:absolute;font-size:.8em;bottom:-50%;right:0;z-index:10;padding:.5em 1em;background:#fefefe;border-radius:.5em;transition:bottom .35s ease;box-shadow:0 0 .75em #00000060;margin:.6em;box-sizing:border-box;display:flex;align-items:center;justify-content:center}.download-links.svelte-1jtdxd0>button:where(.svelte-1jtdxd0){box-sizing:border-box;color:#606060;border:none;box-shadow:none;background:#fafafa;border-radius:.35em;padding:.25em .5em}.download-links.svelte-1jtdxd0>button:where(.svelte-1jtdxd0):hover{background:#433;color:#fafafa}.download-links.svelte-1jtdxd0>button.error{background:#e43}.download-links.svelte-1jtdxd0>button.copied{background:#48e}.plot-container.svelte-1jtdxd0{font-family:Arial,Helvetica,sans-serif;box-sizing:border-box;position:relative;min-width:100px;min-height:50px;width:100%;height:100%;padding:0;margin:0;overflow:hidden;background:#fff}.plot-error.svelte-1jtdxd0{display:flex;justify-content:center;align-items:center}.message-error.svelte-1jtdxd0{font-size:1.2em;color:#dc143c;padding:1em;box-sizing:border-box;text-align:center}.plot.svelte-1jtdxd0{display:block;box-sizing:border-box;position:absolute;padding:0;margin:0;left:0;top:0;bottom:0;right:0;width:100%;height:100%}.axes-content.svelte-1jtdxd0{padding:0;margin:0;height:100%;width:100%;max-height:100%;max-width:100%;min-height:100%;min-width:100%}.drop.svelte-q7wo60{position:fixed;z-index:9999;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:#000000a0}.modal.svelte-q7wo60{border-radius:.5rem;background-color:#fff;display:grid;grid-template-areas:"header" "body";grid-template-rows:30px 1fr;width:auto;height:auto;border-radius:.25rem}.body.svelte-q7wo60{grid-area:body;box-sizing:border-box;padding:0 1em .5em;width:100%;height:100%}.header.svelte-q7wo60{grid-area:header}.close-button.svelte-q7wo60{cursor:pointer;border:none;box-shadow:none;background:transparent;font-size:inherit;font-weight:700;color:#f8ebc5;border-radius:50%;width:20px;height:20px;background-color:#9ea0a2;float:right;text-align:center;padding:0;line-height:20px;font-size:12px;margin:5px}.close-button.svelte-q7wo60:hover{background-color:#4e5052}.isdark.svelte-q7wo60,.isdark.svelte-q7wo60 .header:where(.svelte-q7wo60),.isdark.svelte-q7wo60 .body:where(.svelte-q7wo60){background-color:#606060}.isdark.svelte-q7wo60 .close-button:where(.svelte-q7wo60){color:#433201;background-color:#c2be9b}.isdark.svelte-q7wo60 .close-button:where(.svelte-q7wo60):hover{background-color:#f0f674}.wrapper.svelte-ha02r1{width:95vw;height:90vh;display:grid;grid-template-areas:"plot" "message" "controls";grid-template-rows:1fr 15px min-content}.plot-container.svelte-ha02r1{grid-area:plot}.plot-controls.svelte-ha02r1{grid-area:controls;display:flex;width:100%;justify-content:center;border-radius:.5rem}.plot-controls.svelte-ha02r1>.control-element{background:transparent}.msg-select.svelte-ha02r1{grid-area:message;height:15px;font-size:12px;color:#aaa;text-align:center}.info-details.svelte-1l1cvmx{position:relative;border-bottom:dashed 1px #606060;cursor:help}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx){position:absolute;z-index:1;background:#505050;visibility:hidden;width:300px;top:100%;left:50%;margin-left:-100px;color:beige;box-shadow:0 0 5px #00000060;padding:.5em 1em;border-radius:.25em}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx) ul{padding:0;margin:0;list-style:none}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx) ul>li{padding:.25em 0}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx) ul>li>span{margin-left:1em;padding:.15em .5em;background-color:#707070;border-radius:3px}.info-details.svelte-1l1cvmx:hover>span:where(.svelte-1l1cvmx){visibility:visible}.info{position:relative}.info-text.svelte-1dxrrpt{line-height:1.5em}.info-text.svelte-1dxrrpt>span{vertical-align:top;color:#a0a0a0}.info-text.svelte-1dxrrpt>.file-name:where(.svelte-1dxrrpt){display:inline-block;padding:0;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:25ch;color:#222}.prep-info{position:relative}span.svelte-2gffce{cursor:default;display:inline-block;border-radius:3px;border:solid 1px #a0a0a0;color:gray;background-color:#fafafa;padding:.2em .5em;margin:0 .5em}span.svelte-2gffce:hover{border:solid 1px #6eb8ff;color:#5086b9;background-color:#6eb8ff20}button.button-down{box-sizing:border-box;margin:0 .3em 0 0}botton.button-up{box-sizing:border-box;margin:0}.method-open.svelte-2gffce{position:absolute;height:100vh;top:0;left:inherit;width:340px;padding:200px 1em 1em;margin-left:-18px;background:#000000a0;z-index:999;box-sizing:border-box}.selected-methods-list.svelte-15cx0gr{background:#fefafaa0;border-radius:5px}.selected-methods-list.svelte-15cx0gr>.control-element:last-child .button-down,.selected-methods-list.svelte-15cx0gr>.control-element:nth-child(2) .button-up{cursor:text;background-color:transparent;color:transparent}.selected-methods-list.svelte-15cx0gr:not(.editable)>.control-element .button-settings{display:block}.methods-list.svelte-15cx0gr{margin-top:1em;font-size:.9em}.methods-list.svelte-15cx0gr>div{background:#ebf0f0}.final.svelte-15cx0gr .button-up,.final.svelte-15cx0gr .button-down,.final.svelte-15cx0gr .button-cancel{visibility:hidden}.plot-panel.svelte-x8qn01{width:100%;height:100%;box-sizing:border-box;padding:0;display:grid;grid-template-rows:1fr;grid-template-columns:1fr minmax(270px,30%)}.plot-area.svelte-x8qn01{padding:1em;margin-top:.25rem;border-radius:.25em;background:#fefefe}.plot-controls-area.svelte-x8qn01{padding:0 .25em 0 .5em}.plot.svelte-x8qn01{width:100%;height:calc(100% - 15px)}@media (min-width:1100px){.plot-panel.svelte-x8qn01{grid-template-columns:1fr minmax(285px,30%)}}@media (min-width:1300px){.plot-panel.svelte-x8qn01{grid-template-columns:1fr max(300px,30%)}}@media (min-width:1600px){.plot-panel.svelte-x8qn01{grid-template-columns:1fr 400px}}.widget-container.svelte-1soqt9v{font-family:Helvetica,Arial,sans-serif;font-size:1rem;color:#404040;box-sizing:border-box;margin:0 auto;padding:.35em .25em;width:100%;height:100%;display:grid;grid-template-areas:"controls content";grid-template-rows:100%;grid-template-columns:min(310px,30%) 1fr;background-color:#606060;width:98vw;height:95vh}.app-controls.svelte-1soqt9v{box-sizing:border-box;padding:.25em .5em}.app-content.svelte-1soqt9v{box-sizing:border-box;padding:.25em;height:100%}.app-controls.svelte-1soqt9v>div:where(.svelte-1soqt9v){border-radius:.25rem}@media (min-width:1300px){.widget-container.svelte-1soqt9v{grid-template-columns:min(340px,30%) 1fr}}@media (min-width:1100px){.widget-container.svelte-1soqt9v{grid-template-columns:min(320px,30%) 1fr}}.prep-container>button{margin-left:.25em}.dataset-info.svelte-gdjwex{line-height:1.5em}.dataset-info.svelte-gdjwex>span{vertical-align:middle;color:#a0a0a0}.dataset-info.svelte-gdjwex>.file-name:where(.svelte-gdjwex),.dataset-info.svelte-gdjwex>.file-size:where(.svelte-gdjwex){display:inline-block;padding:0;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:25ch;color:#222}.selected-buttons.svelte-8mh2yv>.control-element{background:#fff0c8}.selected-buttons.svelte-8mh2yv>.control-element button:last-of-type{color:#fff;border-color:#dc143c;background:#dc143c;margin-left:5px}.selected-buttons.svelte-8mh2yv>.control-element button:last-of-type:hover{background:#dc143c20;border-color:#dc143c80;color:#dc143c}.plot-panel.svelte-8mh2yv{width:100%;height:100%;box-sizing:border-box;padding:0;display:grid;grid-template-rows:1fr;grid-template-columns:1fr minmax(270px,30%)}.plot-area.svelte-8mh2yv{padding:1em;margin-top:.25rem;border-radius:.25em;background:#fefefe}.plot-controls-area.svelte-8mh2yv{padding:0 .25em 0 .5em}.plot-selector.svelte-8mh2yv{cursor:pointer;color:#606060;background:#fffef480;box-sizing:border-box;padding:.5em 1em;margin:.25em 0;border-radius:.25rem;box-shadow:none;border:none;width:100%;text-align:left;font-size:1rem}.plot-selector.svelte-8mh2yv:hover{background:#e0e0e0;color:#403020}div.plot-container.off-screen{position:absolute;top:0;left:50%;width:650px;height:600px;background:#fff;z-index:999}.plot.svelte-8mh2yv{width:100%;height:calc(100% - 15px)}.plot-select-msg.svelte-8mh2yv{height:15px;font-size:12px;color:#aaa;text-align:center}@media (min-width:1100px){.plot-panel.svelte-8mh2yv{grid-template-columns:1fr minmax(285px,30%)}}@media (min-width:1300px){.plot-panel.svelte-8mh2yv{grid-template-columns:1fr max(300px,30%)}}@media (min-width:1600px){.plot-panel.svelte-8mh2yv{grid-template-columns:1fr 400px}}.app-container.svelte-1v0yar6{font-family:Helvetica,Arial,sans-serif;font-size:1rem;color:#404040;box-sizing:border-box;margin:0 auto;padding:.35em .25em;width:100%;height:100%;display:grid;grid-template-areas:"controls content";grid-template-rows:100%;grid-template-columns:min(310px,30%) 1fr}.app-controls.svelte-1v0yar6{box-sizing:border-box;padding:.25em .5em}.app-content.svelte-1v0yar6{box-sizing:border-box;padding:.25em;height:100%}.app-controls.svelte-1v0yar6>div:where(.svelte-1v0yar6){border-radius:.25rem}.app-controls.svelte-1v0yar6>.model-stats:where(.svelte-1v0yar6),.app-controls.svelte-1v0yar6>.result-stats:where(.svelte-1v0yar6){background:#e8e8e8}.app-controls.svelte-1v0yar6>.model-stats:where(.svelte-1v0yar6),.app-controls.svelte-1v0yar6>.result-stats:where(.svelte-1v0yar6){padding:.5rem 1rem;margin-top:.25rem;font-size:.85em}.help-text.svelte-1v0yar6{margin-top:.25rem}.help-text.svelte-1v0yar6>p:where(.svelte-1v0yar6),.help-text.svelte-1v0yar6>div:where(.svelte-1v0yar6){background:#fafafa;padding:0 1.5em .5em;color:#606060;line-height:1.5em;margin:0 1em 0 0}.help-text.svelte-1v0yar6 table:where(.svelte-1v0yar6){border-collapse:collapse}.help-text.svelte-1v0yar6 table:where(.svelte-1v0yar6) td:where(.svelte-1v0yar6){padding:.25em .5em;background:#e0f0fa;text-align:right;border:1px solid white}.help-text.svelte-1v0yar6 table:where(.svelte-1v0yar6) thead:where(.svelte-1v0yar6) tr:where(.svelte-1v0yar6) td:where(.svelte-1v0yar6){font-weight:700;background:#f8f4e0}.help-text.svelte-1v0yar6 table:where(.svelte-1v0yar6) td:where(.svelte-1v0yar6):first-child{font-weight:700;background:#f8f4e0;padding-right:1em}.help-text.svelte-1v0yar6 table:where(.svelte-1v0yar6) tbody:where(.svelte-1v0yar6) td:where(.svelte-1v0yar6):nth-child(2){background:#e0e8f0;padding-right:1em}.help-text.svelte-1v0yar6>p:where(.svelte-1v0yar6):first-child{border-top-left-radius:.25rem;border-top-right-radius:.25rem;padding-top:1.5em}.help-text.svelte-1v0yar6>p:where(.svelte-1v0yar6):last-child{border-bottom-left-radius:.25rem;border-bottom-right-radius:.25rem;padding-bottom:1.5em}@media (min-width:1300px){.app-container.svelte-1v0yar6{grid-template-columns:min(340px,30%) 1fr}}@media (min-width:1100px){.app-container.svelte-1v0yar6{grid-template-columns:min(325px,30%) 1fr}}.model-info.svelte-14tszjv{line-height:1.5em}.model-info.svelte-14tszjv>span{vertical-align:top;color:#a0a0a0}.model-info.svelte-14tszjv>.file-name:where(.svelte-14tszjv){display:inline-block;padding:0;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:25ch;color:#222}table.svelte-1i1bo7x{width:100%;border-collapse:collapse}tr.svelte-1i1bo7x{width:100%}th.svelte-1i1bo7x{border-bottom:1px solid #a0a0a0}tr.section.svelte-1i1bo7x>td:where(.svelte-1i1bo7x){border-top:1px solid #a0a0a0}th.svelte-1i1bo7x,td.svelte-1i1bo7x{text-align:right;padding:.2em .5em .2em .1em;color:#404040;margin:0}.label.svelte-1i1bo7x{text-align:left;padding:.1em .5em}table.svelte-kg0b31{width:100%;border-collapse:collapse}tr.svelte-kg0b31{width:100%}th.svelte-kg0b31{border-bottom:1px solid #a0a0a0}th.svelte-kg0b31,td.svelte-kg0b31{text-align:right;padding:.2em .5em .2em .1em;color:#404040;margin:0}.label.svelte-kg0b31{text-align:left;padding:.1em .5em}.app-container.svelte-1qdsey6{font-family:Helvetica,Arial,sans-serif;font-size:1rem;color:#404040;box-sizing:border-box;margin:0 auto;padding:.35em .25em;width:100%;height:100%;display:grid;grid-template-areas:"controls content";grid-template-rows:100%;grid-template-columns:min(310px,30%) 1fr}.app-controls.svelte-1qdsey6{box-sizing:border-box;padding:.25em .5em}.app-content.svelte-1qdsey6{box-sizing:border-box;padding:.25em;height:100%}.app-controls.svelte-1qdsey6>div:where(.svelte-1qdsey6){border-radius:.25rem}.app-controls.svelte-1qdsey6>.model-stats:where(.svelte-1qdsey6),.app-controls.svelte-1qdsey6>.result-stats:where(.svelte-1qdsey6){background:#e8e8e8}.app-controls.svelte-1qdsey6>.model-stats:where(.svelte-1qdsey6),.app-controls.svelte-1qdsey6>.result-stats:where(.svelte-1qdsey6){padding:.5rem 1rem;margin-top:.25rem;font-size:.85em}.help-text.svelte-1qdsey6{margin-top:.25rem}.help-text.svelte-1qdsey6>p:where(.svelte-1qdsey6){background:#fafafa;padding:0 1.5em .5em;color:#606060;line-height:1.5em;margin:0 1em 0 0}.help-text.svelte-1qdsey6>p:where(.svelte-1qdsey6):first-child{border-top-left-radius:.25rem;border-top-right-radius:.25rem;padding-top:1.5em}.help-text.svelte-1qdsey6>p:where(.svelte-1qdsey6):last-child{border-bottom-left-radius:.25rem;border-bottom-right-radius:.25rem;padding-bottom:1.5em}@media (min-width:1300px){.app-container.svelte-1qdsey6{grid-template-columns:min(340px,30%) 1fr}}@media (min-width:1100px){.app-container.svelte-1qdsey6{grid-template-columns:min(325px,30%) 1fr}}.page.svelte-1cyr8za{width:100%;height:100%;margin:0 auto;padding:0;min-width:1020px;min-height:590px;max-width:1900px;display:flex;flex-direction:column}header.svelte-1cyr8za{display:flex;justify-content:flex-start;flex-direction:row;background:#f8f6f4}.header-group.svelte-1cyr8za{width:min-content;min-width:400px;margin:0 0 0 .25rem;display:grid;align-items:center;grid-template-columns:min-content 1fr;grid-template-rows:min-content min-content min-content min-content;grid-template-areas:"logo ." "logo title" "logo subtitle" "logo ."}.logo.svelte-1cyr8za{width:3.5rem;margin:.25rem;padding:.5rem;grid-area:logo}.header-group.svelte-1cyr8za>h1:where(.svelte-1cyr8za){margin:0;padding:0;text-align:left;font-size:1.6rem;color:#4e5052;white-space:nowrap;grid-area:title}.header-group.svelte-1cyr8za>p:where(.svelte-1cyr8za){margin:0;padding:0;text-align:left;font-size:1.1rem;color:#7e8082;grid-area:subtitle}main.svelte-1cyr8za{flex-basis:auto;flex-grow:1;flex-shrink:1;box-sizing:border-box;padding:.2rem 0}main.svelte-1cyr8za>div:where(.svelte-1cyr8za){height:100%}footer.svelte-1cyr8za{display:grid;grid-template-columns:20% 60% 20%;grid-template-areas:"session info .";align-items:center;justify-content:center;font-size:.9rem;flex-basis:min-content;flex-grow:0;flex-shrink:0;background:#4e5052;color:silver;padding:.5em}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za){grid-area:session;padding-left:.5em;display:flex;align-items:center}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) input:where(.svelte-1cyr8za){display:none}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .session-message:where(.svelte-1cyr8za){color:silver;padding-right:.5em}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .session-message:where(.svelte-1cyr8za){color:#fafafa}footer.svelte-1cyr8za .session.no-buttons:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session.no-buttons:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session.no-buttons:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za){display:none}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za){font-size:.9rem;background:#5e6062;color:silver;box-shadow:none;padding:0;margin:0 0 0 .2em;border-radius:3px;border:none;height:20px;box-sizing:border-box;display:inline-block}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za){stroke-width:.75em;stroke-linecap:round;stroke-linejoin:round;stroke:silver}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .clear-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .upload-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .download-button:where(.svelte-1cyr8za){background:#35332d}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .clear-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .upload-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .download-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za){stroke:#fafafa}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za){margin-left:.5em}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za):hover,footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za):hover{background-color:#6eb8ff}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za):hover{background-color:#dc143c}footer.svelte-1cyr8za .info:where(.svelte-1cyr8za){grid-area:info;display:flex;justify-content:center;align-items:center}footer.svelte-1cyr8za .info:where(.svelte-1cyr8za) .button-info:where(.svelte-1cyr8za){cursor:default;border:none;box-shadow:none;background:transparent;font-weight:700;color:#4e5052;border-radius:.2em;padding:.25em .5em;text-align:center;line-height:1em;margin-left:.25em;margin-right:.5em;background-color:#f8ebc5}footer.svelte-1cyr8za .info:where(.svelte-1cyr8za) .button-info:where(.svelte-1cyr8za):hover{background-color:#f7db89}footer.svelte-1cyr8za p{margin:0 .5em;text-align:center;padding:.15em}footer.svelte-1cyr8za span,footer.svelte-1cyr8za a{color:#f8ebc5}.hidden.svelte-1cyr8za{display:none}.nav.svelte-1cyr8za,.nav.svelte-1cyr8za :where(.svelte-1cyr8za){-webkit-user-select:none;user-select:none;-moz-user-select:none}.nav.svelte-1cyr8za{display:flex;flex-direction:row;justify-content:flex-end;list-style:none;margin:0 100px 0 auto;padding:0;align-self:flex-end}.nav-item.svelte-1cyr8za{list-style:none;margin:0;border-bottom:5px solid transparent}.nav-item.svelte-1cyr8za>button:where(.svelte-1cyr8za){cursor:pointer;padding:.5em 1em;border:none;box-shadow:none;background:transparent;font-size:inherit}.nav-item.svelte-1cyr8za>button:where(.svelte-1cyr8za)>span{color:#888}.nav-item.svelte-1cyr8za:hover{border-bottom:5px solid #80888f50}.nav-item.svelte-1cyr8za:hover>button:where(.svelte-1cyr8za){border-top-left-radius:5px;border-top-right-radius:5px;background:#00000010}.nav-item.selected.svelte-1cyr8za{border-bottom:5px solid #80888f}.nav-item.selected.svelte-1cyr8za>button:where(.svelte-1cyr8za){font-weight:700;cursor:default}.nav-item.selected.svelte-1cyr8za:hover{border-bottom:5px solid #80888f}@media (min-width: 1600px){.page.svelte-1cyr8za>header:where(.svelte-1cyr8za){border-bottom-right-radius:.25rem;border-bottom-left-radius:.25rem}.page.svelte-1cyr8za>footer:where(.svelte-1cyr8za){border-top-right-radius:.25rem;border-top-left-radius:.25rem}}.info-container.svelte-1cyr8za{width:900px}.info-container.svelte-1cyr8za>p{font-size:1.15em;line-height:1.35em;padding:0 1em .5em;margin:0}.info-container.svelte-1cyr8za>.release-info{font-size:1em;color:gray;line-height:1.25em;padding:0 1.2em .5em;margin:0}.info-container.svelte-1cyr8za>h2{font-size:1.5em;line-height:1.25em;padding:0em 1rem .5em;margin:0}.info-container.svelte-1cyr8za>h3{font-size:1.15em;line-height:1.25em;padding:1rem 1em .25em;margin:0}.info-container.svelte-1cyr8za>ul{margin:0}.info-container.svelte-1cyr8za>ul>li{font-size:1.15em;line-height:1.25em;padding:0 .5em .5em 0;margin:0}.info-container.svelte-1cyr8za>ul>li>span{font-size:.9em;color:gray;line-height:1.25em;padding:0 .25em;margin:0}.info-container.svelte-1cyr8za a{color:#ae8032}.info-container.svelte-1cyr8za a:hover{color:#eb9707}.info-container.svelte-1cyr8za:last-child{padding-bottom:1rem}
/*$vite$:1*/`,document.head.appendChild(at);var Qe=typeof document<"u"?document.currentScript:null;const yt=!1;var rn=Array.isArray,kc=Array.prototype.indexOf,ds=Array.from,vs=Object.defineProperty,qr=Object.getOwnPropertyDescriptor,Fa=Object.getOwnPropertyDescriptors,Oa=Object.prototype,Ec=Array.prototype,yl=Object.getPrototypeOf,Da=Object.isExtensible;function Cn(l){return typeof l=="function"}const xt=()=>{};function Sc(l){return typeof(l==null?void 0:l.then)=="function"}function Cc(l){return l()}function xl(l){for(var e=0;e<l.length;e++)l[e]()}function Ac(){var l,e,t=new Promise((s,a)=>{l=s,e=a});return{promise:t,resolve:l,reject:e}}function ms(l,e){if(Array.isArray(l))return l;if(e===void 0||!(Symbol.iterator in l))return Array.from(l);const t=[];for(const s of l)if(t.push(s),t.length===e)break;return t}const Jt=2,hs=4,kl=8,An=16,Lr=32,nn=64,Ba=128,lr=256,El=512,Ft=1024,sr=2048,Fr=4096,dr=8192,ln=16384,Sl=32768,Nn=65536,Va=1<<17,Nc=1<<18,gs=1<<19,ps=1<<20,bs=1<<21,_s=1<<22,sn=1<<23,Or=Symbol("$state"),Ya=Symbol("legacy props"),Mc=Symbol(""),ws=new class extends Error{constructor(){super(...arguments);yr(this,"name","StaleReactionError");yr(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Tc(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function Wa(l){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Pc(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function zc(l){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Lc(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Rc(l){throw new Error("https://svelte.dev/e/effect_orphan")}function Ic(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function jc(l){throw new Error("https://svelte.dev/e/props_invalid_value")}function qc(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Fc(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Oc(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const Cl=1,Al=2,Ua=4,Dc=8,Bc=16,Vc=1,Yc=2,Wc=4,Uc=8,Hc=16,Gc=1,Xc=2,Kc=4,Ha=1,Jc=2,kt=Symbol(),Qc="http://www.w3.org/1999/xhtml";let Zc=!1;function Ga(l){return l===this.v}function Xa(l,e){return l!=l?e==e:l!==e||l!==null&&typeof l=="object"||typeof l=="function"}function $c(l,e){return l!==e}function Ka(l){return!Xa(l,this.v)}let Mn=!1,eu=!1;function tu(){Mn=!0}const ru=[];function nu(l,e=!1){return Nl(l,new Map,"",ru)}function Nl(l,e,t,s,a=null){if(typeof l=="object"&&l!==null){var o=e.get(l);if(o!==void 0)return o;if(l instanceof Map)return new Map(l);if(l instanceof Set)return new Set(l);if(rn(l)){var c=Array(l.length);e.set(l,c),a!==null&&e.set(a,c);for(var d=0;d<l.length;d+=1){var u=l[d];d in l&&(c[d]=Nl(u,e,t,s))}return c}if(yl(l)===Oa){c={},e.set(l,c),a!==null&&e.set(a,c);for(var f in l)c[f]=Nl(l[f],e,t,s);return c}if(l instanceof Date)return structuredClone(l);if(typeof l.toJSON=="function")return Nl(l.toJSON(),e,t,s,l)}if(l instanceof EventTarget)return l;try{return structuredClone(l)}catch{return l}}let ot=null;function Tn(l){ot=l}function Yt(l){return Ja().get(l)}function lu(l,e){return Ja().set(l,e),e}function ge(l,e=!1,t){ot={p:ot,c:null,e:null,s:l,x:null,l:Mn&&!e?{s:null,u:null,$:[]}:null}}function pe(l){var e=ot,t=e.e;if(t!==null){e.e=null;for(var s of t)fo(s)}return ot=e.p,{}}function Dr(){return!Mn||ot!==null&&ot.l===null}function Ja(l){return ot===null&&Wa(),ot.c??(ot.c=new Map(su(ot)||void 0))}function su(l){let e=l.p;for(;e!==null;){const t=e.c;if(t!==null)return t;e=e.p}return null}const au=new WeakMap;function ou(l){var e=Be;if(e===null)return Ve.f|=sn,l;if((e.f&Sl)===0){if((e.f&Ba)===0)throw!e.parent&&l instanceof Error&&Qa(l),l;e.b.error(l)}else ys(l,e)}function ys(l,e){for(;e!==null;){if((e.f&Ba)!==0)try{e.b.error(l);return}catch(t){l=t}e=e.parent}throw l instanceof Error&&Qa(l),l}function Qa(l){const e=au.get(l);e&&(vs(l,"message",{value:e.message}),vs(l,"stack",{value:e.stack}))}let Hn=[],xs=[];function Za(){var l=Hn;Hn=[],xl(l)}function iu(){var l=xs;xs=[],xl(l)}function Gn(l){Hn.length===0&&queueMicrotask(Za),Hn.push(l)}function cu(){Hn.length>0&&Za(),xs.length>0&&iu()}function uu(){for(var l=Be.b;l!==null&&!l.has_pending_snippet();)l=l.parent;return l===null&&Tc(),l}function Xn(l){var e=Jt|sr,t=Ve!==null&&(Ve.f&Jt)!==0?Ve:null;return Be===null||t!==null&&(t.f&lr)!==0?e|=lr:Be.f|=gs,{ctx:ot,deps:null,effects:null,equals:Ga,f:e,fn:l,reactions:null,rv:0,v:kt,wv:0,parent:t??Be,ac:null}}function fu(l,e){let t=Be;t===null&&Pc();var s=t.b,a=void 0,o=un(kt),c=null,d=!Ve;return xu(()=>{try{var u=l()}catch(h){u=Promise.reject(h)}var f=()=>u;a=(c==null?void 0:c.then(f,f))??Promise.resolve(u),c=a;var v=$e,m=s.pending;d&&(s.update_pending_count(1),m||v.increment());const g=(h,p=void 0)=>{c=null,m||v.activate(),p?p!==ws&&(o.f|=sn,Vr(o,p)):((o.f&sn)!==0&&(o.f^=sn),Vr(o,h)),d&&(s.update_pending_count(-1),m||v.decrement()),to()};if(a.then(g,h=>g(null,h||"unknown")),v)return()=>{queueMicrotask(()=>v.neuter())}}),new Promise(u=>{function f(v){function m(){v===a?u(o):f(a)}v.then(m,m)}f(a)})}function w(l){const e=Xn(l);return xo(e),e}function ks(l){const e=Xn(l);return e.equals=Ka,e}function $a(l){var e=l.effects;if(e!==null){l.effects=null;for(var t=0;t<e.length;t+=1)Er(e[t])}}function du(l){for(var e=l.parent;e!==null;){if((e.f&Jt)===0)return e;e=e.parent}return null}function Es(l){var e,t=Be;Cr(du(l));try{$a(l),e=Ao(l)}finally{Cr(t)}return e}function eo(l){var e=Es(l);if(l.equals(e)||(l.v=e,l.wv=So()),!fn)if(Br!==null)Br.set(l,l.v);else{var t=(Ur||(l.f&lr)!==0)&&l.deps!==null?Fr:Ft;Ut(l,t)}}function vu(l,e,t){const s=Dr()?Xn:ks;if(e.length===0){t(l.map(s));return}var a=$e,o=Be,c=mu(),d=uu();Promise.all(e.map(u=>fu(u))).then(u=>{a==null||a.activate(),c();try{t([...l.map(s),...u])}catch(f){(o.f&ln)===0&&ys(f,o)}a==null||a.deactivate(),to()}).catch(u=>{d.error(u)})}function mu(){var l=Be,e=Ve,t=ot;return function(){Cr(l),ar(e),Tn(t)}}function to(){Cr(null),ar(null),Tn(null)}const Kn=new Set;let $e=null,Ml=null,Br=null,ro=new Set,Tl=[];function no(){const l=Tl.shift();Tl.length>0&&queueMicrotask(no),l()}let an=[],Pl=null,Ss=!1,zl=!1;const os=class os{constructor(){zt(this,br);yr(this,"current",new Map);zt(this,Bn,new Map);zt(this,Vn,new Set);zt(this,Zr,0);zt(this,dl,null);zt(this,vl,!1);zt(this,yn,[]);zt(this,Yn,[]);zt(this,xn,[]);zt(this,$r,[]);zt(this,Wn,[]);zt(this,ml,[]);zt(this,hl,[]);yr(this,"skipped_effects",new Set)}process(e){var o;an=[],Ml=null;var t=null;if(Kn.size>1){t=new Map,Br=new Map;for(const[c,d]of this.current)t.set(c,{v:c.v,wv:c.wv}),c.v=d;for(const c of Kn)if(c!==this)for(const[d,u]of Oe(c,Bn))t.has(d)||(t.set(d,{v:d.v,wv:d.wv}),d.v=u)}for(const c of e)tn(this,br,yc).call(this,c);if(Oe(this,yn).length===0&&Oe(this,Zr)===0){tn(this,br,qa).call(this);var s=Oe(this,xn),a=Oe(this,$r);Kt(this,xn,[]),Kt(this,$r,[]),Kt(this,Wn,[]),Ml=$e,$e=null,so(s),so(a),$e===null?$e=this:Kn.delete(this),(o=Oe(this,dl))==null||o.resolve()}else tn(this,br,fs).call(this,Oe(this,xn)),tn(this,br,fs).call(this,Oe(this,$r)),tn(this,br,fs).call(this,Oe(this,Wn));if(t){for(const[c,{v:d,wv:u}]of t)c.wv<=u&&(c.v=d);Br=null}for(const c of Oe(this,yn))$n(c);for(const c of Oe(this,Yn))$n(c);Kt(this,yn,[]),Kt(this,Yn,[])}capture(e,t){Oe(this,Bn).has(e)||Oe(this,Bn).set(e,t),this.current.set(e,e.v)}activate(){$e=this}deactivate(){$e=null,Ml=null;for(const e of ro)if(ro.delete(e),e(),$e!==null)break}neuter(){Kt(this,vl,!0)}flush(){an.length>0?lo():tn(this,br,qa).call(this),$e===this&&(Oe(this,Zr)===0&&Kn.delete(this),this.deactivate())}increment(){Kt(this,Zr,Oe(this,Zr)+1)}decrement(){if(Kt(this,Zr,Oe(this,Zr)-1),Oe(this,Zr)===0){for(const e of Oe(this,ml))Ut(e,sr),on(e);for(const e of Oe(this,hl))Ut(e,Fr),on(e);Kt(this,xn,[]),Kt(this,$r,[]),this.flush()}else this.deactivate()}add_callback(e){Oe(this,Vn).add(e)}settled(){return(Oe(this,dl)??Kt(this,dl,Ac())).promise}static ensure(){if($e===null){const e=$e=new os;Kn.add($e),zl||os.enqueue(()=>{$e===e&&e.flush()})}return $e}static enqueue(e){Tl.length===0&&queueMicrotask(no),Tl.unshift(e)}};Bn=new WeakMap,Vn=new WeakMap,Zr=new WeakMap,dl=new WeakMap,vl=new WeakMap,yn=new WeakMap,Yn=new WeakMap,xn=new WeakMap,$r=new WeakMap,Wn=new WeakMap,ml=new WeakMap,hl=new WeakMap,br=new WeakSet,yc=function(e){var v;e.f^=Ft;for(var t=e.first;t!==null;){var s=t.f,a=(s&(Lr|nn))!==0,o=a&&(s&Ft)!==0,c=o||(s&dr)!==0||this.skipped_effects.has(t);if(!c&&t.fn!==null){if(a)t.f^=Ft;else if((s&Ft)===0)if((s&hs)!==0)Oe(this,$r).push(t);else if((s&_s)!==0){var d=(v=t.b)!=null&&v.pending?Oe(this,Yn):Oe(this,yn);d.push(t)}else jl(t)&&((t.f&An)!==0&&Oe(this,Wn).push(t),$n(t));var u=t.first;if(u!==null){t=u;continue}}var f=t.parent;for(t=t.next;t===null&&f!==null;)t=f.next,f=f.parent}},fs=function(e){for(const t of e)((t.f&sr)!==0?Oe(this,ml):Oe(this,hl)).push(t),Ut(t,Ft);e.length=0},qa=function(){if(!Oe(this,vl))for(const e of Oe(this,Vn))e();Oe(this,Vn).clear()};let Jn=os;function hu(l){var e=zl;zl=!0;try{for(var t;;){if(cu(),an.length===0&&($e==null||$e.flush(),an.length===0))return Pl=null,t;lo()}}finally{zl=e}}function lo(){var l=zn;Ss=!0;try{var e=0;for(wo(!0);an.length>0;){var t=Jn.ensure();if(e++>1e3){var s,a;gu()}t.process(an),cn.clear()}}finally{Ss=!1,wo(l),Pl=null}}function gu(){try{Ic()}catch(l){ys(l,Pl)}}function so(l){var e=l.length;if(e!==0){for(var t=0;t<e;){var s=l[t++];if((s.f&(ln|dr))===0&&jl(s)){var a=$e?$e.current.size:0;if($n(s),s.deps===null&&s.first===null&&s.nodes_start===null&&(s.teardown===null&&s.ac===null?po(s):s.fn=null),$e!==null&&$e.current.size>a&&(s.f&ps)!==0)break}}for(;t<e;)on(l[t++])}}function on(l){for(var e=Pl=l;e.parent!==null;){e=e.parent;var t=e.f;if(Ss&&e===Be&&(t&An)!==0)return;if((t&(nn|Lr))!==0){if((t&Ft)===0)return;e.f^=Ft}}an.push(e)}const cn=new Map;function un(l,e){var t={f:0,v:l,reactions:null,equals:Ga,rv:0,wv:0};return t}function ne(l,e){const t=un(l);return xo(t),t}function Cs(l,e=!1,t=!0){var a;const s=un(l);return e||(s.equals=Ka),Mn&&t&&ot!==null&&ot.l!==null&&((a=ot.l).s??(a.s=[])).push(s),s}function V(l,e,t=!1){Ve!==null&&(!Sr||(Ve.f&Va)!==0)&&Dr()&&(Ve.f&(Jt|An|_s|Va))!==0&&!(Ot!=null&&Ot.includes(l))&&Oc();let s=t?Re(e):e;return Vr(l,s)}function Vr(l,e){if(!l.equals(e)){var t=l.v;fn?cn.set(l,e):cn.set(l,t),l.v=e;var s=Jn.ensure();s.capture(l,t),(l.f&Jt)!==0&&((l.f&sr)!==0&&Es(l),Ut(l,(l.f&lr)===0?Ft:Fr)),l.wv=So(),ao(l,sr),Dr()&&Be!==null&&(Be.f&Ft)!==0&&(Be.f&(Lr|nn))===0&&(or===null?Eu([l]):or.push(l))}return e}function As(l){V(l,l.v+1)}function ao(l,e){var t=l.reactions;if(t!==null)for(var s=Dr(),a=t.length,o=0;o<a;o++){var c=t[o],d=c.f;if(!(!s&&c===Be)){var u=(d&sr)===0;u&&Ut(c,e),(d&Jt)!==0?ao(c,Fr):u&&on(c)}}}function Re(l){if(typeof l!="object"||l===null||Or in l)return l;const e=yl(l);if(e!==Oa&&e!==Ec)return l;var t=new Map,s=rn(l),a=ne(0),o=dn,c=d=>{if(dn===o)return d();var u=Ve,f=dn;ar(null),Eo(o);var v=d();return ar(u),Eo(f),v};return s&&t.set("length",ne(l.length)),new Proxy(l,{defineProperty(d,u,f){(!("value"in f)||f.configurable===!1||f.enumerable===!1||f.writable===!1)&&qc();var v=t.get(u);return v===void 0?v=c(()=>{var m=ne(f.value);return t.set(u,m),m}):V(v,f.value,!0),!0},deleteProperty(d,u){var f=t.get(u);if(f===void 0){if(u in d){const v=c(()=>ne(kt));t.set(u,v),As(a)}}else V(f,kt),As(a);return!0},get(d,u,f){var h;if(u===Or)return l;var v=t.get(u),m=u in d;if(v===void 0&&(!m||(h=qr(d,u))!=null&&h.writable)&&(v=c(()=>{var p=Re(m?d[u]:kt),_=ne(p);return _}),t.set(u,v)),v!==void 0){var g=r(v);return g===kt?void 0:g}return Reflect.get(d,u,f)},getOwnPropertyDescriptor(d,u){var f=Reflect.getOwnPropertyDescriptor(d,u);if(f&&"value"in f){var v=t.get(u);v&&(f.value=r(v))}else if(f===void 0){var m=t.get(u),g=m==null?void 0:m.v;if(m!==void 0&&g!==kt)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return f},has(d,u){var g;if(u===Or)return!0;var f=t.get(u),v=f!==void 0&&f.v!==kt||Reflect.has(d,u);if(f!==void 0||Be!==null&&(!v||(g=qr(d,u))!=null&&g.writable)){f===void 0&&(f=c(()=>{var h=v?Re(d[u]):kt,p=ne(h);return p}),t.set(u,f));var m=r(f);if(m===kt)return!1}return v},set(d,u,f,v){var E;var m=t.get(u),g=u in d;if(s&&u==="length")for(var h=f;h<m.v;h+=1){var p=t.get(h+"");p!==void 0?V(p,kt):h in d&&(p=c(()=>ne(kt)),t.set(h+"",p))}if(m===void 0)(!g||(E=qr(d,u))!=null&&E.writable)&&(m=c(()=>ne(void 0)),V(m,Re(f)),t.set(u,m));else{g=m.v!==kt;var _=c(()=>Re(f));V(m,_)}var b=Reflect.getOwnPropertyDescriptor(d,u);if(b!=null&&b.set&&b.set.call(v,f),!g){if(s&&typeof u=="string"){var y=t.get("length"),C=Number(u);Number.isInteger(C)&&C>=y.v&&V(y,C+1)}As(a)}return!0},ownKeys(d){r(a);var u=Reflect.ownKeys(d).filter(m=>{var g=t.get(m);return g===void 0||g.v!==kt});for(var[f,v]of t)v.v!==kt&&!(f in d)&&u.push(f);return u},setPrototypeOf(){Fc()}})}var Ns,oo,io,co;function pu(){if(Ns===void 0){Ns=window,oo=/Firefox/.test(navigator.userAgent);var l=Element.prototype,e=Node.prototype,t=Text.prototype;io=qr(e,"firstChild").get,co=qr(e,"nextSibling").get,Da(l)&&(l.__click=void 0,l.__className=void 0,l.__attributes=null,l.__style=void 0,l.__e=void 0),Da(t)&&(t.__t=void 0)}}function Yr(l=""){return document.createTextNode(l)}function Qt(l){return io.call(l)}function Ll(l){return co.call(l)}function j(l,e){return Qt(l)}function J(l,e){{var t=Qt(l);return t instanceof Comment&&t.data===""?Ll(t):t}}function z(l,e=1,t=!1){let s=l;for(;e--;)s=Ll(s);return s}function bu(l){l.textContent=""}function Rl(){return!1}function uo(l){Be===null&&Ve===null&&Rc(),Ve!==null&&(Ve.f&lr)!==0&&Be===null&&Lc(),fn&&zc()}function _u(l,e){var t=e.last;t===null?e.last=e.first=l:(t.next=l,l.prev=t,e.last=l)}function xr(l,e,t,s=!0){var a=Be;a!==null&&(a.f&dr)!==0&&(l|=dr);var o={ctx:ot,deps:null,nodes_start:null,nodes_end:null,f:l|sr,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{$n(o),o.f|=Sl}catch(u){throw Er(o),u}else e!==null&&on(o);var c=t&&o.deps===null&&o.first===null&&o.nodes_start===null&&o.teardown===null&&(o.f&gs)===0;if(!c&&s&&(a!==null&&_u(o,a),Ve!==null&&(Ve.f&Jt)!==0&&(l&nn)===0)){var d=Ve;(d.effects??(d.effects=[])).push(o)}return o}function wu(l){const e=xr(kl,null,!1);return Ut(e,Ft),e.teardown=l,e}function ce(l){uo();var e=Be.f,t=!Ve&&(e&Lr)!==0&&(e&Sl)===0;if(t){var s=ot;(s.e??(s.e=[])).push(l)}else return fo(l)}function fo(l){return xr(hs|ps,l,!1)}function Il(l){return uo(),xr(kl|ps,l,!0)}function yu(l){Jn.ensure();const e=xr(nn,l,!0);return(t={})=>new Promise(s=>{t.outro?Wr(e,()=>{Er(e),s(void 0)}):(Er(e),s(void 0))})}function Ms(l){return xr(hs,l,!1)}function xu(l){return xr(_s|gs,l,!0)}function vo(l,e=0){return xr(kl|e,l,!0)}function ae(l,e=[],t=[]){vu(e,t,s=>{xr(kl,()=>l(...s.map(r)),!0)})}function Pn(l,e=0){var t=xr(An|e,l,!0);return t}function kr(l,e=!0){return xr(Lr,l,!0,e)}function mo(l){var e=l.teardown;if(e!==null){const t=fn,s=Ve;yo(!0),ar(null);try{e.call(null)}finally{yo(t),ar(s)}}}function ho(l,e=!1){var a;var t=l.first;for(l.first=l.last=null;t!==null;){(a=t.ac)==null||a.abort(ws);var s=t.next;(t.f&nn)!==0?t.parent=null:Er(t,e),t=s}}function ku(l){for(var e=l.first;e!==null;){var t=e.next;(e.f&Lr)===0&&Er(e),e=t}}function Er(l,e=!0){var t=!1;(e||(l.f&Nc)!==0)&&l.nodes_start!==null&&l.nodes_end!==null&&(go(l.nodes_start,l.nodes_end),t=!0),ho(l,e&&!t),ql(l,0),Ut(l,ln);var s=l.transitions;if(s!==null)for(const o of s)o.stop();mo(l);var a=l.parent;a!==null&&a.first!==null&&po(l),l.next=l.prev=l.teardown=l.ctx=l.deps=l.fn=l.nodes_start=l.nodes_end=l.ac=null}function go(l,e){for(;l!==null;){var t=l===e?null:Ll(l);l.remove(),l=t}}function po(l){var e=l.parent,t=l.prev,s=l.next;t!==null&&(t.next=s),s!==null&&(s.prev=t),e!==null&&(e.first===l&&(e.first=s),e.last===l&&(e.last=t))}function Wr(l,e){var t=[];Ts(l,t,!0),bo(t,()=>{Er(l),e&&e()})}function bo(l,e){var t=l.length;if(t>0){var s=()=>--t||e();for(var a of l)a.out(s)}else e()}function Ts(l,e,t){if((l.f&dr)===0){if(l.f^=dr,l.transitions!==null)for(const c of l.transitions)(c.is_global||t)&&e.push(c);for(var s=l.first;s!==null;){var a=s.next,o=(s.f&Nn)!==0||(s.f&Lr)!==0;Ts(s,e,o?t:!1),s=a}}}function Qn(l){_o(l,!0)}function _o(l,e){if((l.f&dr)!==0){l.f^=dr,(l.f&Ft)===0&&(Ut(l,sr),on(l));for(var t=l.first;t!==null;){var s=t.next,a=(t.f&Nn)!==0||(t.f&Lr)!==0;_o(t,a?e:!1),t=s}if(l.transitions!==null)for(const o of l.transitions)(o.is_global||e)&&o.in()}}let zn=!1;function wo(l){zn=l}let fn=!1;function yo(l){fn=l}let Ve=null,Sr=!1;function ar(l){Ve=l}let Be=null;function Cr(l){Be=l}let Ot=null;function xo(l){Ve!==null&&(Ot===null?Ot=[l]:Ot.push(l))}let Dt=null,Zt=0,or=null;function Eu(l){or=l}let ko=1,Zn=0,dn=Zn;function Eo(l){dn=l}let Ur=!1;function So(){return++ko}function jl(l){var m;var e=l.f;if((e&sr)!==0)return!0;if((e&Fr)!==0){var t=l.deps,s=(e&lr)!==0;if(t!==null){var a,o,c=(e&El)!==0,d=s&&Be!==null&&!Ur,u=t.length;if((c||d)&&(Be===null||(Be.f&ln)===0)){var f=l,v=f.parent;for(a=0;a<u;a++)o=t[a],(c||!((m=o==null?void 0:o.reactions)!=null&&m.includes(f)))&&(o.reactions??(o.reactions=[])).push(f);c&&(f.f^=El),d&&v!==null&&(v.f&lr)===0&&(f.f^=lr)}for(a=0;a<u;a++)if(o=t[a],jl(o)&&eo(o),o.wv>l.wv)return!0}(!s||Be!==null&&!Ur)&&Ut(l,Ft)}return!1}function Co(l,e,t=!0){var s=l.reactions;if(s!==null&&!(Ot!=null&&Ot.includes(l)))for(var a=0;a<s.length;a++){var o=s[a];(o.f&Jt)!==0?Co(o,e,!1):e===o&&(t?Ut(o,sr):(o.f&Ft)!==0&&Ut(o,Fr),on(o))}}function Ao(l){var p;var e=Dt,t=Zt,s=or,a=Ve,o=Ur,c=Ot,d=ot,u=Sr,f=dn,v=l.f;Dt=null,Zt=0,or=null,Ur=(v&lr)!==0&&(Sr||!zn||Ve===null),Ve=(v&(Lr|nn))===0?l:null,Ot=null,Tn(l.ctx),Sr=!1,dn=++Zn,l.ac!==null&&(l.ac.abort(ws),l.ac=null);try{l.f|=bs;var m=(0,l.fn)(),g=l.deps;if(Dt!==null){var h;if(ql(l,Zt),g!==null&&Zt>0)for(g.length=Zt+Dt.length,h=0;h<Dt.length;h++)g[Zt+h]=Dt[h];else l.deps=g=Dt;if(!Ur||(v&Jt)!==0&&l.reactions!==null)for(h=Zt;h<g.length;h++)((p=g[h]).reactions??(p.reactions=[])).push(l)}else g!==null&&Zt<g.length&&(ql(l,Zt),g.length=Zt);if(Dr()&&or!==null&&!Sr&&g!==null&&(l.f&(Jt|Fr|sr))===0)for(h=0;h<or.length;h++)Co(or[h],l);return a!==null&&a!==l&&(Zn++,or!==null&&(s===null?s=or:s.push(...or))),(l.f&sn)!==0&&(l.f^=sn),m}catch(_){return ou(_)}finally{l.f^=bs,Dt=e,Zt=t,or=s,Ve=a,Ur=o,Ot=c,Tn(d),Sr=u,dn=f}}function Su(l,e){let t=e.reactions;if(t!==null){var s=kc.call(t,l);if(s!==-1){var a=t.length-1;a===0?t=e.reactions=null:(t[s]=t[a],t.pop())}}t===null&&(e.f&Jt)!==0&&(Dt===null||!Dt.includes(e))&&(Ut(e,Fr),(e.f&(lr|El))===0&&(e.f^=El),$a(e),ql(e,0))}function ql(l,e){var t=l.deps;if(t!==null)for(var s=e;s<t.length;s++)Su(l,t[s])}function $n(l){var e=l.f;if((e&ln)===0){Ut(l,Ft);var t=Be,s=zn;Be=l,zn=!0;try{(e&An)!==0?ku(l):ho(l),mo(l);var a=Ao(l);l.teardown=typeof a=="function"?a:null,l.wv=ko;var o;yt&&eu&&(l.f&sr)!==0&&l.deps}finally{zn=s,Be=t}}}function r(l){var e=l.f,t=(e&Jt)!==0;if(Ve!==null&&!Sr){var s=Be!==null&&(Be.f&ln)!==0;if(!s&&!(Ot!=null&&Ot.includes(l))){var a=Ve.deps;if((Ve.f&bs)!==0)l.rv<Zn&&(l.rv=Zn,Dt===null&&a!==null&&a[Zt]===l?Zt++:Dt===null?Dt=[l]:(!Ur||!Dt.includes(l))&&Dt.push(l));else{(Ve.deps??(Ve.deps=[])).push(l);var o=l.reactions;o===null?l.reactions=[Ve]:o.includes(Ve)||o.push(Ve)}}}else if(t&&l.deps===null&&l.effects===null){var c=l,d=c.parent;d!==null&&(d.f&lr)===0&&(c.f^=lr)}if(fn){if(cn.has(l))return cn.get(l);if(t){c=l;var u=c.v;return((c.f&Ft)===0&&c.reactions!==null||No(c))&&(u=Es(c)),cn.set(c,u),u}}else if(t){if(c=l,Br!=null&&Br.has(c))return Br.get(c);jl(c)&&eo(c)}if((l.f&sn)!==0)throw l.v;return l.v}function No(l){if(l.v===kt)return!0;if(l.deps===null)return!1;for(const e of l.deps)if(cn.has(e)||(e.f&Jt)!==0&&No(e))return!0;return!1}function Wt(l){var e=Sr;try{return Sr=!0,l()}finally{Sr=e}}const Cu=-7169;function Ut(l,e){l.f=l.f&Cu|e}function Au(l){if(!(typeof l!="object"||!l||l instanceof EventTarget)){if(Or in l)Ps(l);else if(!Array.isArray(l))for(let e in l){const t=l[e];typeof t=="object"&&t&&Or in t&&Ps(t)}}}function Ps(l,e=new Set){if(typeof l=="object"&&l!==null&&!(l instanceof EventTarget)&&!e.has(l)){e.add(l),l instanceof Date&&l.getTime();for(let s in l)try{Ps(l[s],e)}catch{}const t=yl(l);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const s=Fa(t);for(let a in s){const o=s[a].get;if(o)try{o.call(l)}catch{}}}}}const Nu=["touchstart","touchmove"];function Mu(l){return Nu.includes(l)}let Mo=!1;function Tu(){Mo||(Mo=!0,document.addEventListener("reset",l=>{Promise.resolve().then(()=>{var e;if(!l.defaultPrevented)for(const t of l.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function Fl(l){var e=Ve,t=Be;ar(null),Cr(null);try{return l()}finally{ar(e),Cr(t)}}function Pu(l,e,t,s=t){l.addEventListener(e,()=>Fl(t));const a=l.__on_r;a?l.__on_r=()=>{a(),s(!0)}:l.__on_r=()=>s(!0),Tu()}const To=new Set,zs=new Set;function zu(l,e,t,s={}){function a(o){if(s.capture||el.call(e,o),!o.cancelBubble)return Fl(()=>t==null?void 0:t.call(this,o))}return l.startsWith("pointer")||l.startsWith("touch")||l==="wheel"?Gn(()=>{e.addEventListener(l,a,s)}):e.addEventListener(l,a,s),a}function vn(l,e,t,s,a){var o={capture:s,passive:a},c=zu(l,e,t,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&wu(()=>{e.removeEventListener(l,c,o)})}function vt(l){for(var e=0;e<l.length;e++)To.add(l[e]);for(var t of zs)t(l)}function el(l){var C;var e=this,t=e.ownerDocument,s=l.type,a=((C=l.composedPath)==null?void 0:C.call(l))||[],o=a[0]||l.target,c=0,d=l.__root;if(d){var u=a.indexOf(d);if(u!==-1&&(e===document||e===window)){l.__root=e;return}var f=a.indexOf(e);if(f===-1)return;u<=f&&(c=u)}if(o=a[c]||l.target,o!==e){vs(l,"currentTarget",{configurable:!0,get(){return o||t}});var v=Ve,m=Be;ar(null),Cr(null);try{for(var g,h=[];o!==null;){var p=o.assignedSlot||o.parentNode||o.host||null;try{var _=o["__"+s];if(_!=null&&(!o.disabled||l.target===o))if(rn(_)){var[b,...y]=_;b.apply(o,[l,...y])}else _.call(o,l)}catch(E){g?h.push(E):g=E}if(l.cancelBubble||p===e||p===null)break;o=p}if(g){for(let E of h)queueMicrotask(()=>{throw E});throw g}}finally{l.__root=e,delete l.currentTarget,ar(v),Cr(m)}}}function Ls(l){var e=document.createElement("template");return e.innerHTML=l.replaceAll("<!>","<!---->"),e.content}function mn(l,e){var t=Be;t.nodes_start===null&&(t.nodes_start=l,t.nodes_end=e)}function K(l,e){var t=(e&Ha)!==0,s=(e&Jc)!==0,a,o=!l.startsWith("<!>");return()=>{a===void 0&&(a=Ls(o?l:"<!>"+l),t||(a=Qt(a)));var c=s||oo?document.importNode(a,!0):a.cloneNode(!0);if(t){var d=Qt(c),u=c.lastChild;mn(d,u)}else mn(c,c);return c}}function Lu(l,e,t="svg"){var s=!l.startsWith("<!>"),a=(e&Ha)!==0,o=`<${t}>${s?l:"<!>"+l}</${t}>`,c;return()=>{if(!c){var d=Ls(o),u=Qt(d);if(a)for(c=document.createDocumentFragment();Qt(u);)c.appendChild(Qt(u));else c=Qt(u)}var f=c.cloneNode(!0);if(a){var v=Qt(f),m=f.lastChild;mn(v,m)}else mn(f,f);return f}}function Ce(l,e){return Lu(l,e,"svg")}function Ru(l=""){{var e=Yr(l+"");return mn(e,e),e}}function he(){var l=document.createDocumentFragment(),e=document.createComment(""),t=Yr();return l.append(e,t),mn(e,t),l}function T(l,e){l!==null&&l.before(e)}let Rs=!0;function ve(l,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(l.__t??(l.__t=l.nodeValue))&&(l.__t=t,l.nodeValue=t+"")}function Iu(l,e){return ju(l,e)}const Ln=new Map;function ju(l,{target:e,anchor:t,props:s={},events:a,context:o,intro:c=!0}){pu();var d=new Set,u=m=>{for(var g=0;g<m.length;g++){var h=m[g];if(!d.has(h)){d.add(h);var p=Mu(h);e.addEventListener(h,el,{passive:p});var _=Ln.get(h);_===void 0?(document.addEventListener(h,el,{passive:p}),Ln.set(h,1)):Ln.set(h,_+1)}}};u(ds(To)),zs.add(u);var f=void 0,v=yu(()=>{var m=t??e.appendChild(Yr());return kr(()=>{if(o){ge({});var g=ot;g.c=o}a&&(s.$$events=a),Rs=c,f=l(m,s)||{},Rs=!0,o&&pe()}),()=>{var p;for(var g of d){e.removeEventListener(g,el);var h=Ln.get(g);--h===0?(document.removeEventListener(g,el),Ln.delete(g)):Ln.set(g,h)}zs.delete(u),m!==t&&((p=m.parentNode)==null||p.removeChild(m))}});return qu.set(f,v),f}let qu=new WeakMap;const Is=0,Ol=1,js=2;function qs(l,e,t,s,a){var o=l,c=Dr(),d=ot,u=kt,f,v,m,g=c?un(void 0):Cs(void 0,!1,!1),h=c?un(void 0):Cs(void 0,!1,!1),p=!1;function _(y,C){p=!0,C&&(Cr(b),ar(b),Tn(d));try{y===Is&&t&&(f?Qn(f):f=kr(()=>t(o))),y===js&&a&&(m?Qn(m):m=kr(()=>a(o,h))),y!==Is&&f&&Wr(f,()=>f=null),y!==Ol&&v&&Wr(v,()=>v=null),y!==js&&m&&Wr(m,()=>m=null)}finally{C&&(Tn(null),ar(null),Cr(null),hu())}}var b=Pn(()=>{if(u!==(u=e())){if(Sc(u)){var y=u;p=!1,y.then(C=>{y===u&&(Vr(g,C),_(Ol,!0))},C=>{if(y===u&&(Vr(h,C),_(js,!0),!a))throw h.v}),Gn(()=>{p||_(Is,!0)})}else Vr(g,u),_(Ol,!1);return()=>u=kt}})}function W(l,e,t=!1){var s=l,a=null,o=null,c=kt,d=t?Nn:0,u=!1;const f=(h,p=!0)=>{u=!0,g(p,h)};var v=null;function m(){v!==null&&(v.lastChild.remove(),s.before(v),v=null);var h=c?a:o,p=c?o:a;h&&Qn(h),p&&Wr(p,()=>{c?o=null:a=null})}const g=(h,p)=>{if(c!==(c=h)){var _=Rl(),b=s;if(_&&(v=document.createDocumentFragment(),v.append(b=Yr())),c?a??(a=p&&kr(()=>p(b))):o??(o=p&&kr(()=>p(b))),_){var y=$e,C=c?a:o,E=c?o:a;C&&y.skipped_effects.delete(C),E&&y.skipped_effects.add(E),y.add_callback(m)}else m()}};Pn(()=>{u=!1,e(f),u||g(null,null)},d)}function Rn(l,e,t){var s=l,a=kt,o,c,d=null,u=Dr()?$c:Xa;function f(){o&&Wr(o),d!==null&&(d.lastChild.remove(),s.before(d),d=null),o=c}Pn(()=>{if(u(a,a=e())){var v=s,m=Rl();m&&(d=document.createDocumentFragment(),d.append(v=Yr())),c=kr(()=>t(v)),m?$e.add_callback(f):f()}})}function Ge(l,e){return e}function Fu(l,e,t){for(var s=l.items,a=[],o=e.length,c=0;c<o;c++)Ts(e[c].e,a,!0);var d=o>0&&a.length===0&&t!==null;if(d){var u=t.parentNode;bu(u),u.append(t),s.clear(),Ar(l,e[0].prev,e[o-1].next)}bo(a,()=>{for(var f=0;f<o;f++){var v=e[f];d||(s.delete(v.k),Ar(l,v.prev,v.next)),Er(v.e,!d)}})}function Ye(l,e,t,s,a,o=null){var c=l,d={flags:e,items:new Map,first:null},u=(e&Ua)!==0;if(u){var f=l;c=f.appendChild(Yr())}var v=null,m=!1,g=new Map,h=ks(()=>{var y=t();return rn(y)?y:y==null?[]:ds(y)}),p,_;function b(){Ou(_,p,d,g,c,a,e,s,t),o!==null&&(p.length===0?v?Qn(v):v=kr(()=>o(c)):v!==null&&Wr(v,()=>{v=null}))}Pn(()=>{_??(_=Be),p=r(h);var y=p.length;if(!(m&&y===0)){m=y===0;var C,E,k,S;if(Rl()){var A=new Set,M=$e;for(E=0;E<y;E+=1){k=p[E],S=s(k,E);var N=d.items.get(S)??g.get(S);N?(e&(Cl|Al))!==0&&Po(N,k,E,e):(C=zo(null,d,null,null,k,S,E,a,e,t,!0),g.set(S,C)),A.add(S)}for(const[P,I]of d.items)A.has(P)||M.skipped_effects.add(I.e);M.add_callback(b)}else b();r(h)}})}function Ou(l,e,t,s,a,o,c,d,u){var X,Z,G,$;var f=(c&Dc)!==0,v=(c&(Cl|Al))!==0,m=e.length,g=t.items,h=t.first,p=h,_,b=null,y,C=[],E=[],k,S,A,M;if(f)for(M=0;M<m;M+=1)k=e[M],S=d(k,M),A=g.get(S),A!==void 0&&((X=A.a)==null||X.measure(),(y??(y=new Set)).add(A));for(M=0;M<m;M+=1){if(k=e[M],S=d(k,M),A=g.get(S),A===void 0){var N=s.get(S);if(N!==void 0){s.delete(S),g.set(S,N);var P=b?b.next:p;Ar(t,b,N),Ar(t,N,P),Fs(N,P,a),b=N}else{var I=p?p.e.nodes_start:a;b=zo(I,t,b,b===null?t.first:b.next,k,S,M,o,c,u)}g.set(S,b),C=[],E=[],p=b.next;continue}if(v&&Po(A,k,M,c),(A.e.f&dr)!==0&&(Qn(A.e),f&&((Z=A.a)==null||Z.unfix(),(y??(y=new Set)).delete(A))),A!==p){if(_!==void 0&&_.has(A)){if(C.length<E.length){var R=E[0],q;b=R.prev;var U=C[0],D=C[C.length-1];for(q=0;q<C.length;q+=1)Fs(C[q],R,a);for(q=0;q<E.length;q+=1)_.delete(E[q]);Ar(t,U.prev,D.next),Ar(t,b,U),Ar(t,D,R),p=R,b=D,M-=1,C=[],E=[]}else _.delete(A),Fs(A,p,a),Ar(t,A.prev,A.next),Ar(t,A,b===null?t.first:b.next),Ar(t,b,A),b=A;continue}for(C=[],E=[];p!==null&&p.k!==S;)(p.e.f&dr)===0&&(_??(_=new Set)).add(p),E.push(p),p=p.next;if(p===null)continue;A=p}C.push(A),b=A,p=A.next}if(p!==null||_!==void 0){for(var L=_===void 0?[]:ds(_);p!==null;)(p.e.f&dr)===0&&L.push(p),p=p.next;var F=L.length;if(F>0){var B=(c&Ua)!==0&&m===0?a:null;if(f){for(M=0;M<F;M+=1)(G=L[M].a)==null||G.measure();for(M=0;M<F;M+=1)($=L[M].a)==null||$.fix()}Fu(t,L,B)}}f&&Gn(()=>{var le;if(y!==void 0)for(A of y)(le=A.a)==null||le.apply()}),l.first=t.first&&t.first.e,l.last=b&&b.e;for(var O of s.values())Er(O.e);s.clear()}function Po(l,e,t,s){(s&Cl)!==0&&Vr(l.v,e),(s&Al)!==0?Vr(l.i,t):l.i=t}function zo(l,e,t,s,a,o,c,d,u,f,v){var m=(u&Cl)!==0,g=(u&Bc)===0,h=m?g?Cs(a,!1,!1):un(a):a,p=(u&Al)===0?c:un(c),_={i:p,v:h,k:o,a:null,e:null,prev:t,next:s};try{if(l===null){var b=document.createDocumentFragment();b.append(l=Yr())}return _.e=kr(()=>d(l,h,p,f),Zc),_.e.prev=t&&t.e,_.e.next=s&&s.e,t===null?v||(e.first=_):(t.next=_,t.e.next=_.e),s!==null&&(s.prev=_,s.e.prev=_.e),_}finally{}}function Fs(l,e,t){for(var s=l.next?l.next.e.nodes_start:t,a=e?e.e.nodes_start:t,o=l.e.nodes_start;o!==null&&o!==s;){var c=Ll(o);a.before(o),o=c}}function Ar(l,e,t){e===null?l.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Tt(l,e,t=!1,s=!1,a=!1){var o=l,c="";ae(()=>{var d=Be;if(c!==(c=e()??"")&&(d.nodes_start!==null&&(go(d.nodes_start,d.nodes_end),d.nodes_start=d.nodes_end=null),c!=="")){var u=c+"";t?u=`<svg>${u}</svg>`:s&&(u=`<math>${u}</math>`);var f=Ls(u);if((t||s)&&(f=Qt(f)),mn(Qt(f),f.lastChild),t||s)for(;Qt(f);)o.before(Qt(f));else o.before(f)}})}function Rr(l,e,...t){var s=l,a=xt,o;Pn(()=>{a!==(a=e())&&(o&&(Er(o),o=null),o=kr(()=>a(s,...t)))},Nn)}function tl(l,e,t){var s=l,a,o,c=null,d=null;function u(){o&&(Wr(o),o=null),c&&(c.lastChild.remove(),s.before(c),c=null),o=d,d=null}Pn(()=>{if(a!==(a=e())){var f=Rl();if(a){var v=s;f&&(c=document.createDocumentFragment(),c.append(v=Yr())),d=kr(()=>t(v,a))}f?$e.add_callback(u):u()}},Nn)}function Lo(l){var e,t,s="";if(typeof l=="string"||typeof l=="number")s+=l;else if(typeof l=="object")if(Array.isArray(l)){var a=l.length;for(e=0;e<a;e++)l[e]&&(t=Lo(l[e]))&&(s&&(s+=" "),s+=t)}else for(t in l)l[t]&&(s&&(s+=" "),s+=t);return s}function Du(){for(var l,e,t=0,s="",a=arguments.length;t<a;t++)(l=arguments[t])&&(e=Lo(l))&&(s&&(s+=" "),s+=e);return s}function Bu(l){return typeof l=="object"?Du(l):l??""}const Ro=[...`
\r\f \v\uFEFF`];function Vu(l,e,t){var s=l==null?"":""+l;if(e&&(s=s?s+" "+e:e),t){for(var a in t)if(t[a])s=s?s+" "+a:a;else if(s.length)for(var o=a.length,c=0;(c=s.indexOf(a,c))>=0;){var d=c+o;(c===0||Ro.includes(s[c-1]))&&(d===s.length||Ro.includes(s[d]))?s=(c===0?"":s.substring(0,c))+s.substring(d+1):c=d}}return s===""?null:s}function Yu(l,e){return l==null?null:String(l)}function pt(l,e,t,s,a,o){var c=l.__className;if(c!==t||c===void 0){var d=Vu(t,s,o);d==null?l.removeAttribute("class"):e?l.className=d:l.setAttribute("class",d),l.__className=t}else if(o&&a!==o)for(var u in o){var f=!!o[u];(a==null||f!==!!a[u])&&l.classList.toggle(u,f)}return o}function bt(l,e,t,s){var a=l.__style;if(a!==e){var o=Yu(e);o==null?l.removeAttribute("style"):l.style.cssText=o,l.__style=e}return s}const Wu=Symbol("is custom element"),Uu=Symbol("is html");function H(l,e,t,s){var a=Hu(l);a[e]!==(a[e]=t)&&(e==="loading"&&(l[Mc]=t),t==null?l.removeAttribute(e):typeof t!="string"&&Gu(l).includes(e)?l[e]=t:l.setAttribute(e,t))}function Hu(l){return l.__attributes??(l.__attributes={[Wu]:l.nodeName.includes("-"),[Uu]:l.namespaceURI===Qc})}var Io=new Map;function Gu(l){var e=Io.get(l.nodeName);if(e)return e;Io.set(l.nodeName,e=[]);for(var t,s=l,a=Element.prototype;a!==s;){t=Fa(s);for(var o in t)t[o].set&&e.push(o);s=yl(s)}return e}const Xu=()=>performance.now(),Ir={tick:l=>requestAnimationFrame(l),now:()=>Xu(),tasks:new Set};function jo(){const l=Ir.now();Ir.tasks.forEach(e=>{e.c(l)||(Ir.tasks.delete(e),e.f())}),Ir.tasks.size!==0&&Ir.tick(jo)}function Ku(l){let e;return Ir.tasks.size===0&&Ir.tick(jo),{promise:new Promise(t=>{Ir.tasks.add(e={c:l,f:t})}),abort(){Ir.tasks.delete(e)}}}function Dl(l,e){Fl(()=>{l.dispatchEvent(new CustomEvent(e))})}function Ju(l){if(l==="float")return"cssFloat";if(l==="offset")return"cssOffset";if(l.startsWith("--"))return l;const e=l.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function qo(l){const e={},t=l.split(";");for(const s of t){const[a,o]=s.split(":");if(!a||o===void 0)break;const c=Ju(a.trim());e[c]=o.trim()}return e}const Qu=l=>l;function Fo(l,e,t,s){var a=(l&Gc)!==0,o=(l&Xc)!==0,c=a&&o,d=(l&Kc)!==0,u=c?"both":a?"in":"out",f,v=e.inert,m=e.style.overflow,g,h;function p(){return Fl(()=>f??(f=t()(e,(s==null?void 0:s())??{},{direction:u})))}var _={is_global:d,in(){var E;if(e.inert=v,!a){h==null||h.abort(),(E=h==null?void 0:h.reset)==null||E.call(h);return}o||g==null||g.abort(),Dl(e,"introstart"),g=Os(e,p(),h,1,()=>{Dl(e,"introend"),g==null||g.abort(),g=f=void 0,e.style.overflow=m})},out(E){if(!o){E==null||E(),f=void 0;return}e.inert=!0,Dl(e,"outrostart"),h=Os(e,p(),g,0,()=>{Dl(e,"outroend"),E==null||E()})},stop:()=>{g==null||g.abort(),h==null||h.abort()}},b=Be;if((b.transitions??(b.transitions=[])).push(_),a&&Rs){var y=d;if(!y){for(var C=b.parent;C&&(C.f&Nn)!==0;)for(;(C=C.parent)&&(C.f&An)===0;);y=!C||(C.f&Sl)!==0}y&&Ms(()=>{Wt(()=>_.in())})}}function Os(l,e,t,s,a){var o=s===1;if(Cn(e)){var c,d=!1;return Gn(()=>{if(!d){var b=e({direction:o?"in":"out"});c=Os(l,b,t,s,a)}}),{abort:()=>{d=!0,c==null||c.abort()},deactivate:()=>c.deactivate(),reset:()=>c.reset(),t:()=>c.t()}}if(t==null||t.deactivate(),!(e!=null&&e.duration))return a(),{abort:xt,deactivate:xt,reset:xt,t:()=>s};const{delay:u=0,css:f,tick:v,easing:m=Qu}=e;var g=[];if(o&&t===void 0&&(v&&v(0,1),f)){var h=qo(f(0,1));g.push(h,h)}var p=()=>1-s,_=l.animate(g,{duration:u,fill:"forwards"});return _.onfinish=()=>{_.cancel();var b=(t==null?void 0:t.t())??1-s;t==null||t.abort();var y=s-b,C=e.duration*Math.abs(y),E=[];if(C>0){var k=!1;if(f)for(var S=Math.ceil(C/16.666666666666668),A=0;A<=S;A+=1){var M=b+y*m(A/S),N=qo(f(M,1-M));E.push(N),k||(k=N.overflow==="hidden")}k&&(l.style.overflow="hidden"),p=()=>{var P=_.currentTime;return b+y*m(P/C)},v&&Ku(()=>{if(_.playState!=="running")return!1;var P=p();return v(P,1-P),!0})}_=l.animate(E,{duration:C,fill:"forwards"}),_.onfinish=()=>{p=()=>s,v==null||v(s,1-s),a()}},{abort:()=>{_&&(_.cancel(),_.effect=null,_.onfinish=xt)},deactivate:()=>{a=xt},reset:()=>{s===0&&(v==null||v(1,0))},t:()=>p()}}function Ds(l,e,t=e){var s=Dr(),a=new WeakSet;Pu(l,"input",o=>{var c=o?l.defaultValue:l.value;if(c=Bs(l)?Vs(c):c,t(c),$e!==null&&a.add($e),s&&c!==(c=e())){var d=l.selectionStart,u=l.selectionEnd;l.value=c??"",u!==null&&(l.selectionStart=d,l.selectionEnd=Math.min(u,l.value.length))}}),Wt(e)==null&&l.value&&(t(Bs(l)?Vs(l.value):l.value),$e!==null&&a.add($e)),vo(()=>{var o=e();if(l===document.activeElement){var c=Ml??$e;if(a.has(c))return}Bs(l)&&o===Vs(l.value)||l.type==="date"&&!o&&!l.value||o!==l.value&&(l.value=o??"")})}function Bs(l){var e=l.type;return e==="number"||e==="range"}function Vs(l){return l===""?null:+l}const cs=class cs{constructor(e){zt(this,is);zt(this,en,new WeakMap);zt(this,Un);zt(this,gl);Kt(this,gl,e)}observe(e,t){var s=Oe(this,en).get(e)||new Set;return s.add(t),Oe(this,en).set(e,s),tn(this,is,xc).call(this).observe(e,Oe(this,gl)),()=>{var a=Oe(this,en).get(e);a.delete(t),a.size===0&&(Oe(this,en).delete(e),Oe(this,Un).unobserve(e))}}};en=new WeakMap,Un=new WeakMap,gl=new WeakMap,is=new WeakSet,xc=function(){return Oe(this,Un)??Kt(this,Un,new ResizeObserver(e=>{for(var t of e){cs.entries.set(t.target,t);for(var s of Oe(this,en).get(t.target)||[])s(t)}}))},yr(cs,"entries",new WeakMap);let Ys=cs;var Zu=new Ys({box:"border-box"});function Oo(l,e,t){var s=Zu.observe(l,()=>t(l[e]));Ms(()=>(Wt(()=>t(l[e])),s))}function Do(l,e){return l===e||(l==null?void 0:l[Or])===e}function hn(l={},e,t,s){return Ms(()=>{var a,o;return vo(()=>{a=o,o=[],Wt(()=>{l!==t(...o)&&(e(l,...o),a&&Do(t(...a),l)&&e(null,...a))})}),()=>{Gn(()=>{o&&Do(t(...o),l)&&e(null,...o)})}}),l}function $u(l=!1){const e=ot,t=e.l.u;if(!t)return;let s=()=>Au(e.s);if(l){let a=0,o={};const c=Xn(()=>{let d=!1;const u=e.s;for(const f in u)u[f]!==o[f]&&(o[f]=u[f],d=!0);return d&&a++,a});s=()=>r(c)}t.b.length&&Il(()=>{Bo(e,s),xl(t.b)}),ce(()=>{const a=Wt(()=>t.m.map(Cc));return()=>{for(const o of a)typeof o=="function"&&o()}}),t.a.length&&ce(()=>{Bo(e,s),xl(t.a)})}function Bo(l,e){if(l.l.s)for(const t of l.l.s)r(t);e()}let Bl=!1;function ef(l){var e=Bl;try{return Bl=!1,[l(),Bl]}finally{Bl=e}}const tf={get(l,e){if(!l.exclude.includes(e))return l.props[e]},set(l,e){return!1},getOwnPropertyDescriptor(l,e){if(!l.exclude.includes(e)&&e in l.props)return{enumerable:!0,configurable:!0,value:l.props[e]}},has(l,e){return l.exclude.includes(e)?!1:e in l.props},ownKeys(l){return Reflect.ownKeys(l.props).filter(e=>!l.exclude.includes(e))}};function gn(l,e,t){return new Proxy({props:l,exclude:e},tf)}const rf={get(l,e){let t=l.props.length;for(;t--;){let s=l.props[t];if(Cn(s)&&(s=s()),typeof s=="object"&&s!==null&&e in s)return s[e]}},set(l,e,t){let s=l.props.length;for(;s--;){let a=l.props[s];Cn(a)&&(a=a());const o=qr(a,e);if(o&&o.set)return o.set(t),!0}return!1},getOwnPropertyDescriptor(l,e){let t=l.props.length;for(;t--;){let s=l.props[t];if(Cn(s)&&(s=s()),typeof s=="object"&&s!==null&&e in s){const a=qr(s,e);return a&&!a.configurable&&(a.configurable=!0),a}}},has(l,e){if(e===Or||e===Ya)return!1;for(let t of l.props)if(Cn(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(l){const e=[];for(let t of l.props)if(Cn(t)&&(t=t()),!!t){for(const s in t)e.includes(s)||e.push(s);for(const s of Object.getOwnPropertySymbols(t))e.includes(s)||e.push(s)}return e}};function $t(...l){return new Proxy({props:l},rf)}function Y(l,e,t,s){var E;var a=!Mn||(t&Yc)!==0,o=(t&Uc)!==0,c=(t&Hc)!==0,d=s,u=!0,f=()=>(u&&(u=!1,d=c?Wt(s):s),d),v;if(o){var m=Or in l||Ya in l;v=((E=qr(l,e))==null?void 0:E.set)??(m&&e in l?k=>l[e]=k:void 0)}var g,h=!1;o?[g,h]=ef(()=>l[e]):g=l[e],g===void 0&&s!==void 0&&(g=f(),v&&(a&&jc(),v(g)));var p;if(a?p=()=>{var k=l[e];return k===void 0?f():(u=!0,k)}:p=()=>{var k=l[e];return k!==void 0&&(d=void 0),k===void 0?d:k},a&&(t&Wc)===0)return p;if(v){var _=l.$$legacy;return function(k,S){return arguments.length>0?((!a||!S||_||h)&&v(S?p():k),k):p()}}var b=!1,y=((t&Vc)!==0?Xn:ks)(()=>(b=!1,p()));o&&r(y);var C=Be;return function(k,S){if(arguments.length>0){const A=S?r(y):a&&o?Re(k):k;return V(y,A),b=!0,d!==void 0&&(d=A),k}return fn&&b||(C.f&ln)!==0?y.v:r(y)}}function nf(l){ot===null&&Wa(),Mn&&ot.l!==null?lf(ot).m.push(l):ce(()=>{const e=Wt(l);if(typeof e=="function")return e})}function lf(l){var e=l.l;return e.u??(e.u={a:[],b:[],m:[]})}const sf="5";typeof window<"u"&&((gc=window.__svelte??(window.__svelte={})).v??(gc.v=new Set)).add(sf),tu();function Vo(l,e){We(l)&&Vo(l.v,e);const t=jr(l);if(t[0]===t[1])throw new Error('split: values in a vector "x" should vary.');const s=(t[1]-t[0])/e;return Me.seq(t[0],t[1],s)}function Yo(l){if(We(l))return Yo(l.v);const e=new Me.valuesConstructor(l.length-1);for(let t=0;t<l.length-1;t++)e[t]=l[t+1]-l[t];return new Me(e)}function Vl(l,e){if(We(l))return Vl(l.v,e);e===void 0&&(e=.1);const t=jr(l),s=(t[1]-t[0])*e;return[t[0]-s,t[1]+s]}function jr(l){if(We(l))return jr(l.v);let e=l[0],t=l[0];for(let s=1;s<l.length;s++)l[s]<e&&(e=l[s]),l[s]>t&&(t=l[s]);return[e,t]}function Wo(l,e){return We(l)?Wo(l.v,e):Math.sqrt(Ws(l,e))}function Ws(l,e){if(e===void 0&&(e=!1),We(l))return Ws(l.v);const t=Yl(l);let s=0;for(let a=0;a<l.length;a++){const o=l[a]-t;s=s+o*o}return s/(e?l.length:l.length-1)}function Yl(l){return We(l)?Yl(l.v):Uo(l)/l.length}function Uo(l){if(We(l))return Uo(l.v);let e=0;for(let t=0;t<l.length;t++)e=e+l[t];return e}function Ho(l){if(We(l))return Ho(l.v);let e=1;for(let t=0;t<l.length;t++)e=e*l[t];return e}function In(l){return We(l)||hr(l)?l.v[Us(l.v)-1]:l[Us(l)-1]}function Us(l){if(We(l)||hr(l))return Us(l.v);let e=1,t=l[0];for(let s=2;s<=l.length;s++)l[s-1]<t&&(e=s,t=l[s-1]);return e}function er(l){return We(l)||hr(l)?l.v[Hs(l.v)-1]:l[Hs(l)-1]}function Hs(l){if(We(l)||hr(l))return Hs(l.v);let e=1,t=l[0];for(let s=2;s<=l.length;s++)l[s-1]>t&&(e=s,t=l[s-1]);return e}const Gs=30,af=1e-7,of=1e-7,Go=1e-13,Xo=1e3,cf=100;function Ko(l,e,t,s,a){s===void 0&&(s=Xo),t===void 0&&(t=Go),a===void 0&&(a=cf);let o=t,c=s,d=(c-o)/a;for(let u=0;u<a;u++){let f,v;for(let h=0;h<a;h++){f=o+h*d,v=o+(h+1)*d;const p=e(f),_=e(v);if(p<=l&&_>=l)break}const m=(f+v)/2,g=e(m);if(Math.abs(g-l)<af||(o=f,c=v,d=(c-o)/a,d/c<of))return m}return(o+c)/2}function Jo(l,e=0,t=1){let s=Me.zeros(l);for(let a=0;a<l;a++)s.v[a]=e+Math.random()*(t-e);return s}function Qo(l,e=0,t=1){let s=Me.zeros(l);for(let a=0;a<l;a++){const o=Math.sqrt(-2*Math.log(Math.random())),c=2*Math.PI*Math.random();s.v[a]=o*Math.sin(c)*t+e}return s}function Wl(l,e=0,t=1){if(We(l))return l.apply(a=>Wl(a,e,t));const s=1/(Math.sqrt(2)*t);return .5*(1+ff((l-e)*s))}function Ul(l,e=0,t=1){if(We(l))return l.apply(U=>Ul(U,e,t));if(e!==0||t!==1)return Ul(l)*t+e;if(l<0||l>1)throw Error('Parameter "p" must be between 0 and 1.');if(l<1e-10)return-1/0;if(l>.9999999999)return 1/0;const s=.425,a=5,o=.180625,c=1.6,d=3.3871327179,u=5.0434271938*10,f=1.5929113202*100,v=5.910937472*10,m=1.7895169469*10,g=7.8757757664*10,h=6.71875636*10,p=1.4234372777,_=2.75681539,b=1.3067284816,y=1.7023821103*.1,C=7.370016425*.1,E=1.2021132975*.1,k=6.657905115,S=3.081226386,A=4.2868294337*.1,M=1.7337203997*.01,N=2.4197894225*.1,P=1.2258202635*.01,I=l-.5;let R;if(Math.abs(I)<=s)return R=o-I*I,I*(((v*R+f)*R+u)*R+d)/(((h*R+g)*R+m)*R+1);R=I<0?l:1-l,R=Math.sqrt(-Math.log(R));let q;return R<=a?(R=R-c,q=(((y*R+b)*R+_)*R+p)/((E*R+C)*R+1)):(R=R-a,q=((M*R+A)*R+S+k)/((P*R+N)*R+1)),I<0?-q:q}function Xs(l,e,t){if(t<=0)throw new Error('pf: parameters "df1" and "df2" must be positive numbers.');if(Array.isArray(l))return Xs(it(l),e,t);if(We(l))return l.apply(s=>Xs(s,e,t));if(l<=0)return 0;if(t<=0&&ML_ERR_return_NAN,t==Number.POSITIVE_INFINITY){if(e==Number.POSITIVE_INFINITY){if(l<1)return 0;if(l==1)return .5;if(l>1)return 1}return Hl(l*e,e)}return e==Number.POSITIVE_INFINITY?1-Hl(t/l,t):e*l>t?1-Gl(t/(t+e*l),t/2,e/2):Gl(e*l/(t+e*l),e/2,t/2)}function Zo(l,e,t){if(l===0)return 0;if(l===1)return Inf;if(t<=0)return NaN;let s=Xo,a=Go;if(l>.9997&&t===1?(s=1e7,a=6e5,l=.9997):l>.9992&&t===1?(s=1e7,a=6e5):l>.997&&t===1?(s=1e6,a=45e3):l>.992&&t===1?(s=1e5,a=5e3):l>.97&&t===1&&(s=1e4,a=400),Array.isArray(l))return Zo(it(l),e,t);const o=d=>Xs(d,e,t);function c(d,u,f){return d===0?0:d===1?Inf:u===0?NaN:f===0?NaN:Ko(d,o,a,s)}return We(l)?l.apply(c,e,t):c(l,e,t)}function Hl(l,e){if(Array.isArray(l))return Hl(it(l),e);const t=5/6-1/(9*e)-7/(648*e*e)+25/(2187*e*e*e),s=1/(18*e)+1/(162*e*e)-37/(1164*e*e*e),a=Math.sqrt(s);function o(u){if(u===0)return 0;if(e===0||e>100&&u>e*2||e>50&&u>e*3||e>10&&u>e*5||e>5&&u>e*8||u>e*30)return 1;const f=u/e,v=Math.pow(f,1/6)-.5*Math.pow(f,1/3)+1/3*Math.pow(f,1/2);return Wl(v,t,a)}function c(u){return u===0?0:e===0||e>100&&u>e*2||e>50&&u>e*3||e>10&&u>e*5||e>5&&u>e*8||u>e*30?1:uf(u/2,e/2)/rl(e/2)}const d=e>Gs?o:c;return We(l)?l.apply(d):d(l)}function ir(l,e){if(Array.isArray(l))return ir(it(l),e);const t=5/6-1/(9*e)-7/(648*e*e)+25/(2187*e*e*e),s=1/(18*e)+1/(162*e*e)-37/(1164*e*e*e),a=Math.sqrt(s);function o(u){if(u===0)return 0;if(u===1)return Inf;if(e===0)return 0;const f=Ul(u,t,a),v=Math.pow(Math.sqrt(36*f*f-30*f+13)/4+(3*f-3/2)/2+1/8,1/3);return Math.pow(v-3/(4*v)+.5,6)*e}function c(u){return u===0?0:u===1?Inf:e===0?0:Ko(u,v=>Hl(v,e),0,Gs*10)}const d=e>Gs?o:c;return We(l)?l.apply(d):d(l)}function Gl(l,e,t){if(Array.isArray(l))return Gl(it(l),e,t);if(We(l))return l.apply(a=>Gl(a,e,t));if(l<=0)return 0;if(l>=1)return 1;if(e==0||t==0||!Number.isFinite(e)||!Number.isFinite(t))return e==0&&t==0?.5:e==0||e/t==0?1:t==0||t/e==0||l<.5?0:1;const s=.5-l+.5;return kf(e,t,l,s)}function rl(l){if(We(l))return l.apply(rl);if(l<=0)throw new Error("gamma: the function only works with arguments > 0.");const e=[676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(l<.5)return Math.PI/(Math.sin(Math.PI*l)+rl(1-l));l=l-1;let t=.9999999999998099;for(let a=0;a<e.length;a++)t=t+e[a]/(l+a+1);const s=l+e.length-.5;return Math.sqrt(2*Math.PI)*Math.pow(s,l+.5)*Math.exp(-s)*t}function uf(l,e){let a=0;for(let o=0;o<1e4;o++){const c=Math.pow(l,o)/rl(e+o+1);if(isNaN(c)||c<1e-18)break;a+=c}return Math.pow(l,e)*rl(e)*Math.exp(-l)*a}function ff(l){const e=l>=0?1:-1;l=Math.abs(l);const t=.254829592,s=-.284496736,a=1.421413741,o=-1.453152027,c=1.061405429,u=1/(1+.3275911*l),f=1-((((c*u+o)*u+a)*u+s)*u+t)*u*Math.exp(-l*l);return e*f}function $o(l,e){const t=.564189583547756,s=[77105849500132e-18,-.00133733772997339,.0323076579225834,.0479137145607681,.128379167095513],a=[.00301048631703895,.0538971687740286,.375795757275549],o=[-136864857382717e-21,.564195517478974,7.21175825088309,43.1622272220567,152.98928504694,339.320816734344,451.918953711873,300.459261020162],c=[1,12.7827273196294,77.0001529352295,277.585444743988,638.980264465631,931.35409485061,790.950925327898,300.459260956983],d=[2.10144126479064,26.2370141675169,21.3688200555087,4.6580782871847,.282094791773523],u=[94.153775055546,187.11481179959,99.0191814623914,18.0124575948747];let f,v,m,g,h=Math.abs(e);if(h<=.5)return v=e*e,g=(((s[0]*v+s[1])*v+s[2])*v+s[3])*v+s[4]+1,m=((a[0]*v+a[1])*v+a[2])*v+1,f=.5-e*(g/m)+.5,f=Math.exp(v)*f,f;if(h<=4)g=((((((o[0]*h+o[1])*h+o[2])*h+o[3])*h+o[4])*h+o[5])*h+o[6])*h+o[7],m=((((((c[0]*h+c[1])*h+c[2])*h+c[3])*h+c[4])*h+c[5])*h+c[6])*h+c[7],f=g/m;else{if(e<=-5.6)return f=2,f=Math.exp(e*e)*2,f;v=1/(e*e),g=(((d[0]*v+d[1])*v+d[2])*v+d[3])*v+d[4],m=(((u[0]*v+u[1])*v+u[2])*v+u[3])*v+1,f=(t-v*g/m)/h}return e<0&&(f=Math.exp(e*e)*2-f),f}function ei(l,e){let t=l+e-2;return t<=.25?cr(t+1):t<=1.25?cr(t)+Gr(t):cr(t-1)+Math.log(t*(t+1))}function Xl(l,e){const t=.0833333333333333,s=-.00277777777760991,a=.00079365066682539,o=-.00059520293135187,c=.000837308034031215,d=-.00165322962780713;let u,f,v,m,g,h,p,_,b,y,C,E,k,S,A;return v=Math.min(l,e),m=Math.max(l,e),h=v/m,g=h/(h+1),b=1/(h+1),E=b*b,y=b+E+1,C=b+E*y+1,k=b+E*C+1,S=b+E*k+1,A=b+E*S+1,f=1/m,p=f*f,_=((((d*A*p+c*S)*p+o*k)*p+a*C)*p+s*y)*p+t,_*=g/m,f=1/v,p=f*f,u=(((((d*p+c)*p+o)*p+a)*p+s)*p+t)/v+_,u}function mt(l){let e,t,s,a,o;if(t=l,e=l-.5,e>0&&(t=e-.5),t<0){const c=[-.422784335098468,-.771330383816272,-.244757765222226,.118378989872749,.000930357293360349,-.0118290993445146,.00223047661158249,.000266505979058923,-.000132674909766242],d=.273076135303957,u=.0559398236957378;return o=(((((((c[8]*t+c[7])*t+c[6])*t+c[5])*t+c[4])*t+c[3])*t+c[2])*t+c[1])*t+c[0],a=(u*t+d)*t+1,s=o/a,e>0?t*s/l:l*(s+.5+.5)}else{if(t==0)return 0;{const c=[.577215664901533,-.409078193005776,-.230975380857675,.0597275330452234,.0076696818164949,-.00514889771323592,.000589597428611429],d=[1,.427569613095214,.158451672430138,.0261132021441447,.00423244297896961];return o=(((((c[6]*t+c[5])*t+c[4])*t+c[3])*t+c[2])*t+c[1])*t+c[0],a=(((d[4]*t+d[3])*t+d[2])*t+d[1])*t+1,s=o/a,e>0?t/l*(s-.5-.5):l*s}}}function df(l,e,t){let s,a,o,c;if(l<-1.1||l>1.1)return Number.NaN;c=l*2,o=a=0,s=0;for(let d=1;d<=t;d++)o=a,a=s,s=c*a-o+e[t-d];return(s-o)*.5}function ti(l){const e=[1.037869356274377,-.13364301504908918,.019408249135520562,-.0030107551127535777,.0004869461479715485,-8105488189317536e-20,13778847799559525e-21,-2380221089435897e-21,41640416213865184e-23,-7359582837807599e-23,13117611876241675e-24,-23546709317742423e-25,42522773276035e-23,-771908941348408e-25,1407574648135907e-26,-25769072058024682e-28,4734240666629442e-28,-8724901267474264e-29,1612461490274055e-29,-29875652015665774e-31,5548070120908289e-31,-10324619158271569e-32,19250239203049852e-33,-3595507346526515e-33,6726454253787686e-34,-1260262416873522e-34,2364488440860621e-35,-44419377050807936e-37,8354659446403425e-37,-15731559416479563e-38,29653128740247425e-39,-5594958348181595e-39,1056635426883568e-39,-19972483680670205e-41,3778297781883936e-41,-7153158688908174e-42,13552488463674214e-43,-25694673048487566e-44,48747756066216946e-45,-9254211253084972e-45,1757859784176024e-45,-3341002667773101e-46,6353393618023618e-47],t=22,s=-.999999985;if(l==0)return 0;if(l==-1)return Number.NEGATIVE_INFINITY;if(l<-1)return Number.NaN;if(Math.abs(l)<=.375)return Math.abs(l)<.5*Number.EPSILON?l:0<l&&l<1e-8||-1e-9<l&&l<0?l*(1-.5*l):l*(1-l*df(l/.375,e,t));if(l<s)throw new Error("log1p: error evaluating the functio value.");return Math.log(1+l)}function Hr(l,e){const t=.0833333333333333,s=-.00277777777760991,a=.00079365066682539,o=-.00059520293135187,c=.000837308034031215,d=-.00165322962780713;let u,f,v,m,g,h,p,_,b,y,C,E,k,S;return l>e?(v=e/l,u=1/(v+1),_=v/(v+1),f=l+(e-.5)):(v=l/e,u=v/(v+1),_=1/(v+1),f=e+(l-.5)),C=_*_,b=_+C+1,y=_+C*b+1,E=_+C*y+1,k=_+C*E+1,S=_+C*k+1,m=1/(e*e),p=((((d*S*m+c*k)*m+o*E)*m+a*y)*m+s*b)*m+t,p*=u/e,g=f*Gr(l/e),h=l*(Math.log(e)-1),g>h?p-h-g:p-g-h}function cr(l){if(l<.6){const p=((((((-.00271935708322958*l+-.0673562214325671)*l+-.402055799310489)*l+-.780427615533591)*l+-.168860593646662)*l+.844203922187225)*l+.577215664901533)/((((((.000667465618796164*l+.0325038868253937)*l+.361951990101499)*l+1.56875193295039)*l+3.12755088914843)*l+2.88743195473681)*l+1);return-l*p}else{const e=.422784335098467,t=.848044614534529,s=.565221050691933,a=.156513060486551,o=.017050248402265,c=.000497958207639485,d=1.24313399877507,u=.548042109832463,f=.10155218743983,v=.00713309612391,m=.000116165475989616,g=l-.5-.5,h=(((((c*g+o)*g+a)*g+s)*g+t)*g+e)/(((((m*g+v)*g+f)*g+u)*g+d)*g+1);return g*h}}function vr(l){const e=.418938533204673,t=.0833333333333333,s=-.00277777777760991,a=.00079365066682539,o=-.00059520293135187,c=.000837308034031215,d=-.00165322962780713;if(l<=.8)return cr(l)-Math.log(l);if(l<=2.25)return cr(l-.5-.5);if(l<10){let v=Math.round(l-1.25),m=l,g=1;for(let h=1;h<=v;++h)m+=-1,g*=m;return cr(m-1)+Math.log(g)}let u=1/(l*l),f=(((((d*u+c)*u+o)*u+a)*u+s)*u+t)/l;return e+f+(l-.5)*(Math.log(l)-1)}function Ks(l,e){const t=.918938533204673;let s=Math.min(l,e),a=Math.max(l,e);function o(c,d,u){let f=Math.round(u-1),v=1;for(let m=1;m<=f;++m)u+=-1,v*=u/(d+u);return c+Math.log(v)+(vr(d)+(vr(u)-ei(d,u)))}if(s<8){if(s<1)return a<8?vr(s)+(vr(a)-vr(s+a)):vr(s)+Hr(s,a);let c;if(s<2)return a<=2?vr(s)+vr(a)-ei(s,a):a<8?(c=0,o(c,s,a)):vr(s)+Hr(s,a);if(a<=1e3){let d=Math.round(s-1);c=1;for(let u=1;u<=d;++u){s+=-1;let f=s/a;c*=f/(f+1)}return c=Math.log(c),a>=8?c+vr(s)+Hr(s,a):o(c,s,a)}else{let d=Math.round(s-1);c=1;for(let u=1;u<=d;++u)s+=-1,c*=s/(s/a+1);return log(c)-d*log(a)+(vr(s)+Hr(s,a))}}else{let c=Xl(s,a),d=s/a,u=-(s-.5)*Math.log(d/(d+1)),f=a*Gr(d);return u>f?Math.log(a)*-.5+t+c-f-u:Math.log(a)*-.5+t+c-u-f}}function ri(l){return(l==0?1024:-300)*.69314718055995*.99999}function jn(l){const e=.0566749439387324,t=.0456512608815524,s=.333333333333333,a=-.224696413112536,o=.00620886815375787,c=-1.27408923933623,d=.354508718369557;let u,f,v,m,g;return l<-.39||l>.57?(m=l+.5+.5,l-Math.log(m)):(l<-.18?(u=l+.3,u/=.7,g=e-u*.3):l>.18?(u=l*.75-.25,g=t+u/3):(u=l,g=0),f=u/(u+2),v=f*f,m=((o*v+a)*v+s)/((d*v+c)*v+1),v*2*(1/(1-f)-f*m)+g)}function Gr(l){if(Math.abs(l)>.375)return Math.log(1+l);const e=-1.29418923021993,t=.405303492862024,s=-.0178874546012214,a=-1.62752256355323,o=.747811014037616,c=-.0845104217945565;let d=l/(l+2),u=d*d,f=(((s*u+t)*u+e)*u+1)/(((c*u+o)*u+a)*u+1);return d*2*f}function vf(l){const e=.564189583547756,t=[77105849500132e-18,-.00133733772997339,.0323076579225834,.0479137145607681,.128379167095513],s=[.00301048631703895,.0538971687740286,.375795757275549],a=[-136864857382717e-21,.564195517478974,7.21175825088309,43.1622272220567,152.98928504694,339.320816734344,451.918953711873,300.459261020162],o=[1,12.7827273196294,77.0001529352295,277.585444743988,638.980264465631,931.35409485061,790.950925327898,300.459260956983],c=[2.10144126479064,26.2370141675169,21.3688200555087,4.6580782871847,.282094791773523],d=[94.153775055546,187.11481179959,99.0191814623914,18.0124575948747];let u,f,v,m,g;if(v=Math.abs(l),v<=.5)return u=l*l,g=(((t[0]*u+t[1])*u+t[2])*u+t[3])*u+t[4]+1,m=((s[0]*u+s[1])*u+s[2])*u+1,l*(g/m);if(v<=4){g=((((((a[0]*v+a[1])*v+a[2])*v+a[3])*v+a[4])*v+a[5])*v+a[6])*v+a[7],m=((((((o[0]*v+o[1])*v+o[2])*v+o[3])*v+o[4])*v+o[5])*v+o[6])*v+o[7];let p=.5-Math.exp(-l*l)*g/m+.5;return l<0?-p:p}if(v>=5.8)return l>0?1:-1;f=l*l,u=1/f,g=(((c[0]*u+c[1])*u+c[2])*u+c[3])*u+c[4],m=(((d[0]*u+d[1])*u+d[2])*u+d[3])*u+1,u=(e-g/(f*m))/v;let h=.5-Math.exp(-f)*u+.5;return l<0?-h:h}function mf(l){const e=914041914819518e-24,t=.0238082361044469,s=-.499999999085958,a=.107141568980644,o=-.0119041179760821,c=.000595130811860248;if(Math.abs(l)<=.15)return l*(((t*l+e)*l+1)/((((c*l+o)*l+a)*l+s)*l+1));{let d=Math.exp(l);return l>0?d*(.5-1/d+.5):d-.5-.5}}function nl(l,e){let t;if(e>0){if(l>0||(t=l+e,t<0))return Math.exp(l)*Math.exp(e)}else if(l<0||(t=l+e,t>0))return Math.exp(l)*Math.exp(e);return Math.exp(t)}function hf(l){const e=.785398163397448,t=1.4616321449683622,s=[.0089538502298197,4.77762828042627,142.441585084029,1186.45200713425,3633.51846806499,4138.10161269013,1305.60269827897],a=[44.8452573429826,520.752771467162,2210.0079924783,3641.27349079381,1908.310765963,691091682714533e-20],o=[-2.12940445131011,-7.01677227766759,-4.48616543918019,-.648157123766197],c=[32.2703493791143,89.2920700481861,54.6117738103215,7.77788548522962];let d,u,f,v,m,g,h,p,_,b,y,C,E;if(y=Number.MAX_SAFE_INTEGER,v=.5/(.5*Number.EPSILON),y>v&&(y=v),E=1e-9,p=0,l<.5){if(fabs(l)<=E){if(l==0)return 0;p=-1/l}else{if(m=-l,_=e,m<=0&&(m=-m,_=-_),m>=y)return 0;if(f=Math.round(m),m-=f,f=Math.round(m*4),m=(m-f*.25)*4,u=f/2,u+u!=f&&(m=1-m),g=e*m,d=u/2,d+d!=u&&(_=-_),u=(f+1)/2,d=u/2,d+=d,d==u){if(g==0)return 0;p=_*(cos(g)/sin(g)*4)}else p=_*(sin(g)/cos(g)*4)}l=1-l}if(l<=3){h=l,C=s[0]*l;for(let k=1;k<=5;++k)h=(h+a[k-1])*l,C=(C+s[k])*l;return h=(C+s[6])/(h+a[5]),b=l-t,h*b+p}if(l<y){m=1/(l*l),h=m,C=o[0]*m;for(let k=1;k<=3;++k)h=(h+c[k-1])*m,C=(C+o[k])*m;p=C/(h+c[3])-.5/l+p}return p+log(l)}function gf(l,e,t,s){let a,o,c,d,u,f;if(l>s*.001){if(d=l*Math.log(t),d<Math.exparg(1))return 0;a=Math.exp(d)}else a=1;for(a*=e/l,f=s/l,u=l+1,d=t,c=d/u,u+=1,d=t*d,o=d/u,c+=o;Math.abs(t)>f;)u+=1,d=t*d,o=d/u,c+=o;return a*=l*c+1,a}function pf(l,e,t,s){const a=.577215664901533;let o,c,d,u,f,v,m=e*t;for(f=t-m,c=e*s<=.02?Math.log(t)+hf(e)+a+f:Math.log(m)+a+f,o=s*5*Math.abs(c),d=1,u=0,d+=1,f*=t-m/d,v=f/d,u+=v;Math.abs(v)>o;)d+=1,f*=t-m/d,v=f/d,u+=v;return-l*(c+u)}function Js(l,e,t,s){let a,o,c,d,u,f,v,m,g;if(t==0)return 0;if(v=Math.min(l,e),v>=1)f=l*Math.log(t)-Ks(l,e),o=Math.exp(f)/l;else if(m=Math.max(l,e),m<8)if(m<=1){if(o=Math.pow(t,l),o==0)return o;g=l+e,g>1?(u=l+e-1,f=(mt(u)+1)/g):f=mt(g)+1,c=(mt(l)+1)*(mt(e)+1)/f,o*=c*(e/g)}else{if(u=cr(v),a=Math.round(m-1),a>=1){c=1;for(let y=1;y<=a;++y)m+=-1,c*=m/(v+m);u+=Math.log(c)}f=l*Math.log(t)-u,m+=-1,g=v+m,g>1?(u=v+m-1,d=(mt(u)+1)/g):d=mt(g)+1,o=Math.exp(f)*(v/l)*(mt(m)+1)/d}else u=cr(v)+Hr(v,m),f=l*Math.log(t)-u,o=v/l*Math.exp(f);if(o==0||l<=s*.1)return o;let h=s/l,p=0,_=0,b;for(c=1,p+=1,c*=(.5-e/p+.5)*t,b=c/(l+p),_+=b;p<1e7&&Math.abs(b)>h;)p+=1,c*=(.5-e/p+.5)*t,b=c/(l+p),_+=b;return l*_>-1?o*=l*_+1:o=0,o}function Kl(l,e,t,s,a,o){let c,d,u,f,v,m=l+e,g=l+1;if(a>1&&l>=1&&m>=g*1.1?(u=Math.round(Math.abs(ri(1))),d=Math.round(ri(0)),u>d&&(u=d),f=Math.exp(-u)):(u=0,f=1),c=wf(u,l,e,t,s)/l,a==1||c==0)return c;let h=a-1,p=f;if(d=0,e>1){if(s>1e-4){let _=(e-1)*t/s-l;_>=1&&(d=_<h?Math.round(_):h)}else d=h;for(let _=0;_<d;++_)v=_,f*=(m+v)/(g+v)*t,p+=f}for(let _=d;_<h&&(v=_,f*=(m+v)/(g+v)*t,p+=f,!(f<=o*p));++_);return c*=p,c}function bf(l,e,t,s,a,o){let c,d,u,f,v,m,g,h,p,_,b,y,C,E,k,S,A,M,N;if(!Number.isFinite(a)||(N=_f(l,e,t,s),Number.isNaN(N)))return Number.NaN;if(N==0)return 0;for(c=a+1,p=e/l,_=1/l+1,E=s+1,u=0,f=1,m=l+1,y=0,C=1,k=1,S=c/_,v=_/c,u+=1,g=u/l,h=u*(e-u)*t,d=l/m,M=f*(f+p)*d*d*(h*t),d=(g+1)/(_+g+g),A=u+h/m+d*(c+u*E),f=g+1,m+=2,g=M*y+A*k,y=k,k=g,g=M*C+A*S,C=S,S=g,b=v,v=k/S,y/=S,C/=S,k=v,S=1;u<1e4&&(u+=1,g=u/l,h=u*(e-u)*t,d=l/m,M=f*(f+p)*d*d*(h*t),d=(g+1)/(_+g+g),A=u+h/m+d*(c+u*E),f=g+1,m+=2,g=M*y+A*k,y=k,k=g,g=M*C+A*S,C=S,S=g,b=v,v=k/S,!(Math.abs(v-b)<=o*v));)y/=S,C/=S,k=v,S=1;return N*v}function _f(l,e,t,s){const a=.398942280401433;let o,c,d,u,f,v,m,g,h;if(t==0||s==0)return 0;if(m=Math.min(l,e),m<8){let p,_;if(t<=.375?(p=Math.log(t),_=Gr(-t)):s>.375?(p=Math.log(t),_=Math.log(s)):(p=Gr(-s),_=Math.log(s)),v=l*p+e*_,m>=1)return v-=Ks(l,e),Math.exp(v);if(g=Math.max(l,e),g>=8)return u=cr(m)+Hr(m,g),m*Math.exp(v-u);if(g<=1){let y=Math.exp(v);return y==0?0:(h=l+e,h>1?(u=l+e-1,v=(mt(u)+1)/h):v=mt(h)+1,c=(mt(l)+1)*(mt(e)+1)/v,y*(m*c)/(m/g+1))}if(u=cr(m),o=Math.round(g-1),o>=1){c=1;for(let y=1;y<=o;++y)g+=-1,c*=g/(m+g);u=Math.log(c)+u}v-=u,g+=-1,h=m+g;let b;return h>1?(u=m+g-1,b=(mt(u)+1)/h):b=mt(h)+1,m*Math.exp(v)*(mt(g)+1)/b}else{let p,_,b,y;return l<=e?(p=l/e,_=p/(p+1),b=1/(p+1),y=l-(l+e)*t):(p=e/l,_=1/(p+1),b=p/(p+1),y=(l+e)*s-e),d=-y/l,u=Math.abs(d)>.6?d-Math.log(t/_):jn(d),d=y/e,f=Math.abs(d)<=.6?jn(d):d-Math.log(s/b),v=Math.exp(-(l*u+e*f)),a*Math.sqrt(e*_)*v*Math.exp(-Xl(l,e))}}function wf(l,e,t,s,a){const o=.398942280401433;let c,d,u,f,v,m,g,h;if(m=Math.min(e,t),m<8){let p,_;if(s<=.375?(p=Math.log(s),_=Gr(-s)):a>.375?(p=Math.log(s),_=Math.log(a)):(p=Gr(-a),_=Math.log(a)),v=e*p+t*_,m>=1)return v-=Ks(e,t),nl(l,v);if(g=Math.max(e,t),g>=8)return u=cr(m)+Hr(m,g),m*nl(l,v-u);if(g<=1){let y=nl(l,v);return y==0?y:(h=e+t,h>1?(u=e+t-1,v=(mt(u)+1)/h):v=mt(h)+1,c=(mt(e)+1)*(mt(t)+1)/v,y*(m*c)/(m/g+1))}u=cr(m);let b=Math.round(g-1);if(b>=1){c=1;for(let y=1;y<=b;++y)g+=-1,c*=g/(m+g);u+=Math.log(c)}return v-=u,g+=-1,h=m+g,d=h>1?(mt(h-1)+1)/h:mt(h)+1,m*nl(l,v)*(mt(g)+1)/d}else{let p,_,b,y;e>t?(p=t/e,_=1/(p+1),b=p/(p+1),y=(e+t)*a-t):(p=e/t,_=p/(p+1),b=1/(p+1),y=e-(e+t)*s),-ti(t/e);let C=-y/e;return u=Math.abs(C)>.6?C-Math.log(s/_):jn(C),C=y/t,f=Math.abs(C)>.6?C-Math.log(a/b):jn(C),v=nl(l,-(e*u+t*f)),o*Math.sqrt(t*_)*v*Math.exp(-Xl(e,t))}}function Qs(l,e,t,s,a,o){let d=Array(30),u=Array(30),f=e-.5-.5,v=l+f*.5,m=s>.375?Math.log(t):Gr(-s),g=-v*m;if(e*g==0)throw new Error("bgrat: expansion can not be computed.");let h=Math.log(e)+ti(mt(e))+e*Math.log(g)+v*m,p=h-(Hr(e,l)+e*Math.log(v)),_=Math.exp(p);if(p==Number.NEGATIVE_INFINITY)throw new Error("bgrat: expansion can not be computed.");let b=_==0,y=a==0?0:Math.exp(Math.log(a)-p),C=yf(e,g,h,o),E=.25/(v*v),k=m*.25*m,S=C,A=S,M=1,N=1,P=0;for(let I=1;I<=30;++I){let R=e+P;S=(R*(R+1)*S+(g+R+1)*M)*E,P+=2,M*=k,N/=P*(P+1);let q=I-1;d[q]=N;let U=0;if(I>1){let L=e-I;for(let F=1;F<=q;++F)U+=L*d[F-1]*u[q-F],L+=e}u[q]=f*N+U/I;let D=u[q]*S;if(A+=D,A<=0)throw new Error("bgrat: expansion can not be computed.");if(Math.abs(D)<=o*(A+y))break}return a+=b?Math.exp(p+Math.log(A)):_*A,a}function yf(l,e,t,s){const a=1.772453850905516;if(l*e==0)return e<=l?Math.exp(-t):0;if(l==.5){if(e<.25)return(.5-vf(Math.sqrt(e))+.5)*Math.exp(-t);{let o=Math.sqrt(e);return $o(1,o)/o*a}}else if(e<1.1){let o=3,c=e,d=e/(l+3),u=s*.1/(l+1),f;for(o+=1,c*=-(e/o),f=c/(l+o),d+=f;Math.abs(f)>u;)o+=1,c*=-(e/o),f=c/(l+o),d+=f;let v=l*e*((d/6-.5/(l+2))*e+1/(l+1)),m=l*Math.log(e),g=mt(l),h=g+1;if(e>=.25&&l<e/2.59||m>-.13394){let p=mf(m),_=((p+.5+.5)*v-p)*h-g;return _<=0?0:_*Math.exp(-t)}else return(.5-Math.exp(m)*h*(.5-v+.5)+.5)*Math.exp(-t)}else{let o=1,c=1,d=e,u=e+(1-l),f=1,v,m;o=e*c+f*o,d=e*u+f*d,v=o/d,f+=1;let g=f-l;for(c=o+g*c,u=d+g*u,m=c/u;Math.abs(m-v)>=s*m;)o=e*c+f*o,d=e*u+f*d,v=o/d,f+=1,g=f-l,c=o+g*c,u=d+g*u,m=c/u;return m}}function xf(l,e,t,s){const o=1.12837916709551,c=.353553390593274,d=Array(21),u=Array(21),f=Array(21),v=Array(21);let m=l*jn(-t/l)+e*jn(t/e),g;if(g=Math.exp(-m),g==0)return 0;let h=Math.sqrt(m),p=h/c*.5,_=m+m,b,y,C,E;l<e?(b=l/e,y=1/(b+1),C=(e-l)/e,E=1/Math.sqrt(l*(b+1))):(b=e/l,y=1/(b+1),C=(e-l)/l,E=1/Math.sqrt(e*(b+1))),d[0]=C*.6666666666666666,f[0]=d[0]*-.5,v[0]=-f[0];let k=.5/o*$o(1,h),S=c,A=k+v[0]*E*S,M=1,N=b*b,P=1,I=E,R=p,q=_;for(let D=2;D<=20;D+=2){P*=N,d[D-1]=y*2*(b*P+1)/(D+2);let L=D+1;M+=P,d[L-1]=C*2*M/(D+3);for(let O=D;O<=L;++O){let X=(O+1)*-.5;u[0]=X*d[0];for(let G=2;G<=O;++G){let $=0;for(let le=1;le<=G-1;++le){let te=G-le;$+=(le*X-te)*d[le-1]*u[te-1]}u[G-1]=X*d[G-1]+$/G}f[O-1]=u[O-1]/(O+1);let Z=0;for(let G=1;G<=O-1;++G)Z+=v[O-G-1]*f[G-1];v[O-1]=-(Z+f[O-1])}k=c*R+(D-1)*k,S=c*q+D*S,R=_*R,q=_*q,I*=E;let F=v[D-1]*I*k;I*=E;let B=v[L-1]*I*S;if(A+=F+B,Math.abs(F)+Math.abs(B)<=s*A)break}let U=Math.exp(-Xl(l,e));return o*g*U*A}function kf(l,e,t,s){let o=0,c=0;function d(b,y,C,E){const k=Js(b,y,C,1e-15);return E?.5-k+.5:k}function u(b,y,C,E){const k=Js(y,b,C,1e-15);return E?k:.5-k+.5}function f(b,y,C,E,k,S){const A=bf(b,y,C,E,k,15000000000000002e-30);return S?.5-A+.5:A}function v(b,y,C,E,k){let S=Math.round(y);y=y-S,y===0&&(S=S-1,y=1);let A=Kl(y,b,E,C,S,1e-15);return C<=.7?(A=A+Js(b,y,C,1e-15),k?.5-A+.5:A):(b<=15&&(S=20,A=A+Kl(b,y,C,E,S,1e-15),b=b+S),A=Qs(b,y,C,E,A,15*1e-15),k?.5-A+.5:A)}if(l<1e-15*.001&&e<1e-15*.001)return e/(l+e);let m,g,h,p,_;if(l<=1||e<=1){if(t>.5?(_=!0,m=e,h=s,g=l,p=t):(_=!1,m=l,h=t,g=e,p=s),g<Math.min(1e-15,1e-15*m))return o=gf(m,g,h,1e-15),_?.5-o+.5:o;if(m<Math.min(1e-15,1e-15*g)&&g*h<=1)return c=pf(m,g,h,1e-15),_?c:.5-c+.5;if(Math.max(m,g)>1){if(g<=1)return d(m,g,h,_);if(h>=.29)return u(m,g,p,_);if(h<.1&&Math.pow(h*g,m)<=.7)return d(m,g,h,_)}else{if(m>=Math.min(.2,g)||Math.pow(h,m)<=.9)return d(m,g,h,_);if(h>=.3)return u(m,g,p,_)}let b=!1;return Math.max(m,g)>1&&g>15?c=0:(b=!0,c=Kl(g,m,p,h,20,1e-15),g+=20),c=Qs(g,m,p,h,c,15*1e-15),c==0||0<c&&c<Number.MIN_VALUE?(b?c=Kl(g-n,m,p,h,n,1e-15):c=Number.NEGATIVE_INFINITY,c=Qs(g,m,p,h,c,15*1e-15),o=-expm1(c),_?.5-o+.5:o):(o=.5-c+.5,_?.5-o+.5:o)}else{let b=Number.isFinite(l+e)?l>e?(l+e)*s-e:l-(l+e)*t:l*s-e*t;const y=b<0;let C,E,k,S;if(y?(b=-b,C=e,k=s,E=l,S=t):(C=l,k=t,E=e,S=s),E<40)return E*k<=.7?d(C,E,k,y):v(C,E,k,S,y);if(C>E){if(E<=100||b>E*.03)return f(C,E,k,S,b,y)}else{if(C<=100)return f(C,E,k,S,b,y);if(b>C*.03)return f(C,E,k,S,b,y)}return o=xf(C,E,b,1e-15*100),y?.5-o+.5:o}}function ni(l){const e=l.nrows,t=l.ncols;if(e<t){const c=ni(l.subset([],Pt.seq(1,e)));return{Q:c.Q,R:Sf(c.Q,l)}}let s=Lt.eye(e),a=l.t();for(let c=1;c<=t;c++)for(let d=e;d>=c+1;d--){const u=a.v.subarray((d-2)*t,d*t),f=s.v.subarray((d-2)*e,d*e),v=u.slice(),m=f.slice(),[g,h,p]=Ef(v[c-1],v[c-1+t]);for(let _=0;_<t;_++)u[_]=v[_]*g+v[_+t]*h,u[_+t]=v[_]*-h+v[_+t]*g,f[_]=m[_]*g+m[_+e]*h,f[_+e]=m[_]*-h+m[_+e]*g;for(let _=t;_<e;_++)f[_]=m[_]*g+m[_+e]*h,f[_+e]=m[_]*-h+m[_+e]*g}const o=Pt.seq(1,t);return{Q:e===t?s:s.subset([],o),R:e===t?a.t():a.subset([],o).t()}}function Ef(l,e){if(l==0)return[0,1,e];if(Math.abs(l)>Math.abs(e)){const o=e/l,c=Math.sqrt(1+o*o),d=1/c;return[d,o*d,l*c]}const t=l/e,s=Math.sqrt(1+t*t),a=1/s;return[t*a,a,e*s]}function li(l){return typeof l=="number"}function si(l,e){e===void 0&&(e=l);const t=l.nrows,s=l.ncols,a=e.nrows;e.ncols;const o=t,c=a,d=s,u=new Float64Array(o*c);for(let f=0;f<d;f++){const v=l.v.subarray(f*t,(f+1)*t),m=e.v.subarray(f*a,(f+1)*a);for(let g=0;g<c;g++){const h=u.subarray(g*o,(g+1)*o);for(let p=0;p<o;p++)h[p]+=v[p]*m[g]}}return new Lt(u,o,c)}function Sf(l,e){if(e===void 0&&(e=l),!mr(l)||!mr(e))throw Error("crossprod: both X and Y must be instance of Matrix class.");const t=l.nrows,s=l.ncols,a=e.nrows,o=e.ncols,c=s,d=o,u=t,f=new Float64Array(c*d);for(let v=0;v<d;v++){const m=e.v.subarray(v*a,(v+1)*a),g=f.subarray(v*c,(v+1)*c);for(let h=0;h<c;h++){const p=l.v.subarray(h*t,(h+1)*t);let _=0;for(let b=0;b<u;b++)_+=p[b]*m[b];g[h]=_}}return new Lt(f,c,d)}function ai(l,e,t){if(t===void 0){if(e!==l.v.length)throw Error("reshape: provided dimension does not match number of values in the object.");return new Me(l.v)}if(l.v.length!==e*t)throw Error("reshape: provided dimension does not match number of values in the object.");return new Lt(l.v,e,t)}function mr(l){return l&&l.constructor===Lt}function Cf(l,e,t){return new Lt(new Float64Array(l),e,t)}const je=class je{constructor(e,t,s){if(!ArrayBuffer.isView(e)||e.constructor!==je.valuesConstructor)throw Error('Matrix: parameter "values" must be Float64Array.');if(t===0||s===0)throw Error("Matrix: can not create matrix with zero rows or columns.");if(e.length!==t*s)throw Error('Matrix: number elements in "values" is not equal to "nrows" x "ncols".');this.v=e,this.nrows=t,this.ncols=s}inv(){if(this.nrows!==this.ncols)throw Error("inv: only squared matrices can be inverted.");const e=this.ncols;if(this.isuppertriangular()){if(this.islowertriangular())return je.diagm(this.diag().apply(u=>Math.abs(u)>Number.EPSILON?1/u:x));const s=je.eye(e),a=je.eye(e),o=this.t(),c=o.v[(e-1)*e+(e-1)],d=e-1;for(let u=0;u<e;u++)a.v[d*e+u]=s.v[d*e+u]/c;for(let u=e-2;u>=0;u--){let f=s.getcolumn(u+1);const v=o.getcolref(u+1);for(let m=u+1;m<e;m++){const g=a.getcolumn(m+1);f=f.subtract(g.mult(v[m]))}a.v.set(f.divide(v[u]).v,u*e)}return a.t()}if(this.islowertriangular()){const s=this.diag();if(Ho(s)<Number.EPSILON)throw Error("inv: the matrix is not invertible.");const a=je.eye(e),o=je.eye(e),c=this.t(),d=0,u=c.v[0];for(let f=0;f<e;f++)o.v[d*e+f]=a.v[d*e+f]/u;for(let f=1;f<e;f++){let v=a.getcolumn(f+1);const m=c.getcolref(f+1);for(let g=0;g<f;g++){const h=o.getcolumn(g+1);v=v.subtract(h.mult(m[g]))}o.v.set(v.divide(m[f]).v,f*e)}return o.t()}const t=ni(this);if(!t.R.isuppertriangular())throw Error("inv: QR decomposition of the matrix returned incorrect result.");return t.R.inv().dot(t.Q.t())}islowertriangular(){if(this.nrows!==this.ncols)return!1;for(let e=1;e<this.ncols;e++)for(let t=0;t<e;t++)if(Math.abs(this.v[e*this.nrows+t])>je.TOLERANCE)return!1;return!0}isuppertriangular(){if(this.nrows!==this.ncols)return!1;for(let e=0;e<this.ncols;e++)for(let t=e+1;t<this.nrows;t++)if(Math.abs(this.v[e*this.nrows+t])>je.TOLERANCE)return!1;return!0}diag(){const e=Math.min(this.nrows,this.ncols),t=new Float64Array(e);for(let s=0;s<e;s++)t[s]=this.getcolref(s+1)[s];return new Me(t)}t(){const e=this.nrows,t=this.ncols,s=new je.valuesConstructor(this.v.length);if(this.ncols<this.nrows){for(let a=0;a<this.ncols;a++){const o=this.v.subarray(a*this.nrows,(a+1)*this.nrows);for(let c=0;c<this.nrows;c++)s[c*t+a]=o[c]}return new je(s,t,e)}for(let a=0;a<this.nrows;a++){const o=s.subarray(a*t,(a+1)*t);for(let c=0;c<this.ncols;c++)o[c]=this.v[c*this.nrows+a]}return new je(s,t,e)}dot(e){if(We(e))return new je(ea(this.v,e.v,this.nrows,this.ncols,e.length,1),this.nrows,1);if(mr(e))return new je(ea(this.v,e.v,this.nrows,this.ncols,e.nrows,e.ncols),this.nrows,e.ncols);throw Error("dot: argument 'X' must be a matrix or a vector.")}op(e,t,s){if(mr(e))return new je(Zs(this.v,e.v,t),this.nrows,this.ncols);if(li(e))return new je($s(this.v,e,t),this.nrows,this.ncols);if(!We(e))throw new Error('op: argument "x" must be a matrix, a vector or a number.');if(s===void 0&&(s=e.length===this.ncols?2:1),s===2&&e.length===this.ncols){const a=new je.valuesConstructor(this.v.length);for(let o=0;o<this.ncols;o++)a.set($s(this.getcolref(o+1),e.v[o],t),o*this.nrows);return new je(a,this.nrows,this.ncols)}if(s===1&&e.length===this.nrows){const a=new je.valuesConstructor(this.v.length);for(let o=0;o<this.ncols;o++)a.set(Zs(this.getcolref(o+1),e.v,t),o*this.nrows);return new je(a,this.nrows,this.ncols)}throw new Error('op: length of vector "X" does not match number of rows nor number of columns of the maytrix.')}add(e){return this.op(e,(t,s)=>t+s)}subtract(e){return this.op(e,(t,s)=>t-s)}mult(e){return this.op(e,(t,s)=>t*s)}divide(e){return this.op(e,(t,s)=>t/s)}apply(e,t){if(t===void 0&&(t=2),t==2){const s=this.ncols,a=new je.valuesConstructor(s);for(let o=0;o<s;o++)a[o]=e(this.getcolref(o+1));return new Me(a)}if(t==1)return this.t().apply(e,2);if(t==0){const s=this.v.length,a=new je.valuesConstructor(s);for(let o=0;o<s;o++)a[o]=e(this.v[o]);return new je(a,this.nrows,this.ncols)}}replace(e,t,s){typeof t=="number"&&(t=[t]),t.length===0&&(t=Pt.seq(1,this.nrows)),hr(t)||(t=gr(t)),typeof s=="number"&&(s=[s]),s.length===0&&(s=Pt.seq(1,this.ncols)),hr(s)||(s=gr(s));const a=t.length,o=s.length;if(In(t)<1||er(t)>this.nrows)throw Error("Matrix.replace: row indices do not match the dimension of matrix.");if(In(s)<1||er(s)>this.ncols)throw Error("Matrix.replace: column indices do not match the dimension of matrix.");if(e.nrows!==a||e.ncols!==o)throw Error('Matrix.replace: dimension of "X" does not match the indices.');for(let c=0;c<s.length;c++){const d=e.getcolref(c+1),u=(s.v[c]-1)*this.nrows;for(let f=0;f<t.length;f++){const v=t.v[f];this.v[u+v-1]=d[f]}}return this}copy(){return new je(this.v.slice(),this.nrows,this.ncols)}getrow(e){if(e<1||e>this.nrows)throw Error("getrow: wrong row index.");const t=new Me.valuesConstructor(this.ncols);for(let s=0;s<this.ncols;s++)t[s]=this.getcolref(s+1)[e-1];return new Me(t)}getcolumn(e){if(e<1||e>this.ncols)throw Error("getcolumn: wrong column index.");return new Me(this.v.slice((e-1)*this.nrows,e*this.nrows))}getcolref(e){return this.v.subarray((e-1)*this.nrows,e*this.nrows)}subset(e,t){if(typeof e=="number"&&(e=gr([e])),typeof t=="number"&&(t=gr([t])),Array.isArray(e)&&(e=e.length===0?null:gr(e)),Array.isArray(t)&&(t=t.length===0?null:gr(t)),e!==null&&!hr(e))throw Error('subset: parameter "rind" can be a number, null or instance of Index.');if(t!==null&&!hr(t))throw Error('subset: parameter "cind" can be a number, null or instance of Index.');if(e!==null&&(In(e)<1||er(e)>this.nrows))throw Error('subset: parameter "rind" does not match size of the matrix.');if(t!==null&&(In(t)<1||er(t)>this.ncols))throw Error('subset: parameter "cind" does not match size of the matrix.');if(e===null){const d=t.length,u=this.nrows,f=new je.valuesConstructor(u*d);for(let v=0;v<t.length;v++)f.set(this.v.slice((t.v[v]-1)*this.nrows,t.v[v]*this.nrows),v*this.nrows);return new je(f,u,d)}if(t==null)return this.t().subset(t,e).t();const s=e.length,a=t.length,o=new je.valuesConstructor(s*a);let c=new je.valuesConstructor(s);for(let d=0;d<a;d++){const u=this.v.subarray((t.v[d]-1)*this.nrows,t.v[d]*this.nrows);for(let f=0;f<s;f++)c[f]=u[e.v[f]-1];o.set(c,d*s)}return new je(o,s,a)}toString(e){function t(c,d){return" ".repeat(d-c.length)+c}e===void 0&&(e=2),this.ncols;const s=Math.round(Math.abs(Math.log10(er(this.v))))+e+3;let a="";const o=this.t();for(let c=1;c<=o.ncols;c++)a+=Array.from(o.getcolref(c)).map(d=>t(d.toFixed(e),s)).join(" ")+`
`;return a}toCSV(e,t,s,a){e===void 0&&(e=","),t===void 0&&(t=e===";"?",":".");const o=a!=null&&a.length>0,c=s!=null&&s.length>0;if(o&&a.length!==this.nrows)throw Error("Matrix.toCSV: number of elements in labels array must match number of rows in the matrix.");if(c&&s.length!==this.ncols+(o?1:0))throw Error("Matrix.toCSV: number of elements in header must match number of columns in the matrix.");const d=this.t();let u=c?s.join(e)+`
`:"";for(let f=1;f<=d.ncols;f++)u=u+(o?a[f-1]+e:"")+d.getcolref(f).join(e)+`
`;return u=u.replace(/\./g,t),u}static randn(e,t,s,a){return ai(Qo(e*t,s,a),e,t)}static rand(e,t,s,a){return ai(Jo(e*t,s,a),e,t)}static eye(e,t){t===void 0&&(t=e);const s=new Float64Array(e*t);for(let a=0;a<Math.min(e,t);a++)s[a*e+a]=1;return new je(s,e,t)}static diagm(e){if(!We(e))throw Error('diagm: the argument "x" must be a Vector.');const t=e.length,s=new Float64Array(t*t);for(let a=0;a<t;a++)s[a*t+a]=e.v[a];return new je(s,t,t)}static zeros(e,t){return t===void 0&&(t=e),new je(new Float64Array(e*t),e,t)}static ones(e,t){return je.fill(1,e,t)}static fill(e,t,s){s===void 0&&(s=t);const a=new Float64Array(t*s);for(let o=0;o<a.length;o++)a[o]=e;return new je(a,t,s)}static outer(e,t,s){if(Array.isArray(e)&&(e=it(e)),Array.isArray(t)&&(t=it(t)),!We(e))throw Error('Matrix.outer: parameter "x" must be a vector or an array with numbers.');if(!We(t))throw Error('Matrix.outer: parameter "y" must be a vector or an array with numbers.');const a=je.zeros(e.length,t.length);for(let o=0;o<t.length;o++){const c=t.v[o],d=a.getcolref(o+1);for(let u=0;u<e.length;u++)d[u]=s(e.v[u],c)}return a}static parseCSV(e,t,s,a){function o(b){return b.some(y=>Number.isNaN(Number.parseFloat(y.trim())))}t===void 0&&(t=",");const c=t===";"?",":".";e=e.replace(/^\uFEFF/gm,"").replace(/^\u00EF?\u00BB\u00BF/gm,""),e=e.replace(/\r/gm,"");let d=e.split(/\n/),u=[],f=0;const v=d[0].split(t);(s||s===void 0&&o(v))&&(u=v,f=1),d=d.filter(b=>b.trim().length>1);let m=[],g=0;a&&(g=1);const h=d.length-f,p=v.length-g;if(h<1)throw Error("Data file should contain at least 1 row with values.");if(p<1)throw Error("Data file should contain at least 1 column with values.");const _=je.zeros(p,h);for(let b=f;b<h+f;b++){const y=d[b].split(t);let C;if(a?(m[b-f]=y[0],C=y.slice(1).map(E=>Number.parseFloat(E.trim().replace(c,".")))):C=y.map(E=>Number.parseFloat(E.trim().replace(c,"."))),C.some(E=>Number.isNaN(E)))throw Error("Some of the values can not be converted to numbers, check your CSV file and try again.");if(C.length!=p)throw Error("Wrong number of values in row #"+b);_.v.set(new Float64Array(C),(b-f)*p)}return{values:_.t(),header:u,labels:m,sep:t,dec:c}}};yr(je,"valuesConstructor",Float64Array),yr(je,"TOLERANCE",Math.pow(10,-9));let Lt=je;function We(l){return l&&l.constructor===Me}function it(l){return new Me(new Float64Array(l))}const ht=class ht{constructor(e){if(!ArrayBuffer.isView(e)||e.constructor!==Float64Array)throw Error('Vector: parameter "values" must be Float64Array.');this.v=e,this.length=e.length}which(e){const t=new Pt.valuesConstructor(this.length);let s=0;for(let a=0;a<this.length;a++)e(this.v[a],a)&&(t[s]=a+1,s=s+1);return new Pt(t.subarray(0,s))}filter(e){const t=new ht.valuesConstructor(this.length);let s=0;for(let a=0;a<this.length;a++)e(this.v[a],a)&&(t[s]=this.v[a],s=s+1);return new ht(t.subarray(0,s))}shuffle(){return new ht(ui(this.v))}sort(e){return new ht(fi(this.v,e))}sortind(e){return new Pt(di(this.v,e))}rep(e){return ii(this,e)}repeach(e){return ci(this,e)}replace(e,t){typeof t=="number"&&(t=[t]),t.length===0&&(t=Pt.seq(1,this.length)),hr(t)||(t=gr(t));const s=t.length;if(In(t)<1||er(t)>this.length)throw Error("Vector.replace: indices do not match the lenght of the vector.");if(e.length!==s)throw Error('Vector.replace: length of "x" does not match the indices.');for(let a=0;a<t.length;a++){const o=t.v[a];this.v[o-1]=e.v[a]}return this}subset(e){if(typeof e=="number"&&(e=gr([e])),Array.isArray(e)&&(e=typeof e[0]=="boolean"?Pt.bool2ind(e):gr(e)),!hr(e))throw Error('subset: parameter "ind" must be number, array of instance of class Index.');const t=e.length,s=ht.zeros(t);for(let a=0;a<t;a++){if(e.v[a]<1)throw Error("subset: indices must start with 1 (not 0).");if(e.v[a]>this.length)throw Error("subset: index exceeds the length of the vector.");s.v[a]=this.v[e.v[a]-1]}return s}slice(e,t){if(e===null&&(e=1),t==null&&(t=this.length),e<1)throw Error("slice: indices must start with 1 (not 0).");if(t>this.length)throw Error("slice: index exceeds the length of the vector.");if(t<e)throw Error('slice: "end" must not be smaller than "start".');return new ht(this.v.slice(e-1,t))}copy(){return new ht(this.v.slice())}dot(e){return e===void 0&&(e=this),ea(this.v,e.v,1,this.length,e.length,1)[0]}op(e,t){if(We(e))return new ht(Zs(this.v,e.v,t));if(li(e))return new ht($s(this.v,e,t));throw new Error('op: argument "x" must be a vector or a number.')}add(e){return this.op(e,(t,s)=>t+s)}subtract(e){return this.op(e,(t,s)=>t-s)}mult(e){return this.op(e,(t,s)=>t*s)}divide(e){return this.op(e,(t,s)=>t/s)}apply(e){const t=this.v.length,s=ht.zeros(t);for(let a=0;a<t;a++)s.v[a]=e(this.v[a]);return s}static c(...e){if(e.length===1)return e[0];const t=e.reduce((o,c)=>o+(typeof c=="number"?1:c.length),0),s=new ht.valuesConstructor(t);let a=0;for(const o of e)typeof o=="number"?(s[a]=o,a+=1):(s.set(We(o)?o.v:new ht.valuesConstructor(o),a),a+=typeof o=="number"?1:o.length);return new ht(s)}static seq(e,t,s){return oi(e,t,s,ht)}static randn(e,t,s){return Qo(e,t,s)}static rand(e,t,s){return Jo(e,t,s)}static zeros(e){return new ht(new ht.valuesConstructor(e))}static ones(e){return ht.fill(1,e)}static fill(e,t){const s=new ht.valuesConstructor(t);for(let a=0;a<s.length;a++)s[a]=e;return new ht(s)}};yr(ht,"valuesConstructor",Float64Array);let Me=ht;function hr(l){return l.constructor===Pt}function gr(l){return new Pt(new Int32Array(l))}const Nt=class Nt{constructor(e){if(!ArrayBuffer.isView(e)||e.constructor!==Int32Array)throw Error('Index: parameter "values" must be Int32Array.');this.v=e,this.length=e.length}which(e){const t=new Nt.valuesConstructor(this.length);let s=0;for(let a=0;a<this.length;a++)e(this.v[a],a)&&(t[s]=a+1,s=s+1);return new Nt(t.subarray(0,s))}filter(e){const t=new Nt.valuesConstructor(this.length);let s=0;for(let a=0;a<this.length;a++)e(this.v[a],a)&&(t[s]=this.v[a],s=s+1);return new Nt(t.subarray(0,s))}shuffle(){return new Nt(ui(this.v))}sort(e){return new Nt(fi(this.v,e))}sortind(e){return new Nt(di(this.v,e))}rep(e){return ii(this,e)}repeach(e){return ci(this,e)}subset(e){if(typeof e=="number"&&(e=gr([e])),Array.isArray(e)&&(e=gr(e)),!hr(e))throw Error('subset: parameter "ind" must be number, array of instance of class Index.');const t=e.length,s=new Nt.valuesConstructor(t);for(let a=0;a<t;a++){if(e.v[a]<1)throw Error("subset: indices must start with 1 (not 0).");if(e.v[a]>this.length)throw Error("subset: index exceeds the length of the vector.");s[a]=this.v[e.v[a]-1]}return new Nt(s)}slice(e,t){if(e===null&&(e=1),t==null&&(t=this.length),e<1)throw Error("slice: indices must start with 1 (not 0).");if(t>this.length)throw Error("slice: index exceeds the length of the vector.");if(t<e)throw Error('slice: "end" must not be smaller than "start".');return new Nt(this.v.slice(e-1,t))}static seq(e,t,s){return oi(e,t,s,Nt)}static ones(e){return Nt.fill(1,e)}static fill(e,t){const s=new Nt.valuesConstructor(t);for(let a=0;a<s.length;a++)s[a]=e;return new Nt(s)}static bool2ind(e){let t=0;const s=new Nt.valuesConstructor(e.length);for(let a=0;a<e.length;a++)e[a]&&(s[t]=a+1,t=t+1);return new Nt(s.subarray(0,t))}};yr(Nt,"valuesConstructor",Int32Array);let Pt=Nt;function oi(l,e,t,s){t===void 0&&(t=l<=e?1:-1);const a=Math.floor((e-l)/t)+1;if(a<1)throw Error("seq: wrong combination of parameters.");const o=new s.valuesConstructor(a);for(let c=0;c<a;c++)o[c]=l+c*t;return new s(o)}function ii(l,e){const t=l.length*e,s=new l.constructor.valuesConstructor(t);for(let a=1;a<=e;a++)for(let o=0;o<l.length;o++)s[(a-1)*l.length+o]=l.v[o];return new l.constructor(s)}function ci(l,e){if(e<1||Math.round(e)!==e)throw Error('rep: parameter "n" must be an integer number > 1.');const t=l.length*e,s=new l.constructor.valuesConstructor(t);for(let a=0;a<l.length;a++)for(let o=0;o<e;o++)s[a*e+o]=l.v[a];return new l.constructor(s)}function Zs(l,e,t){if(l.length!==e.length)throw new Error("_opvv: arrays sizes do not match.");if(l.constructor!==e.constructor)throw new Error("_opvv: array types do not match.");const s=new l.constructor(l.length);for(let a=0;a<l.length;a++)s[a]=t(l[a],e[a]);return s}function $s(l,e,t){const s=new l.constructor(l.length);for(let a=0;a<l.length;a++)s[a]=t(l[a],e);return s}function ea(l,e,t,s,a,o){if(s!==a)throw Error("_dot: matrix dimensions do not much.");const c=t,d=o,u=s,f=new l.constructor(c*d);for(let v=0;v<d;v++){const m=e.subarray(v*a,(v+1)*a),g=f.subarray(v*c,(v+1)*c);for(let h=0;h<u;h++){const p=m[h],_=l.subarray(h*t,(h+1)*t);for(let b=0;b<c;b++)g[b]+=_[b]*p}}return f}function ui(l){let e=l.slice(),t=e.length,s,a;for(;t;)a=Math.floor(Math.random()*t--),s=e[t],e[t]=e[a],e[a]=s;return e}function fi(l,e=!1){return e?l.slice().sort((t,s)=>s-t):l.slice().sort((t,s)=>t-s)}function di(l,e=!1){const t=Pt.seq(1,l.length).v;return e?t.sort((s,a)=>l[a-1]-l[s-1]):t.sort((s,a)=>l[s-1]-l[a-1])}function Af(l,e,t){return 5*l*e+e+4*t*e+l*t}function Nf(l,e){return 2+2*l+l*e+17*e}function rt(l,e,t){if(!l||!l.class||!l.class.includes("pcamodel"))throw new Error('pcamodel_get: parameter "m" must be JSON with PCA model.');const s=l.ncols,a=l.ncomp;let o,c;switch(e){case"mX":o=2,c=s;break;case"sX":o=2+s,c=s;break;case"loadings":case"xloadings":o=2+2*s+(t-1)*s,c=s;break;case"P":o=2+2*s,c=a*s;break;case"eigenvals":case"xeigenvals":o=2+2*s+s*a,c=a;break;case"cq0":o=2+2*s+s*a+a,c=a;break;case"cNq":o=2+2*s+s*a+2*a,c=a;break;case"rq0":o=2+2*s+s*a+3*a,c=a;break;case"rNq":o=2+2*s+s*a+4*a,c=a;break;case"ch0":o=2+2*s+s*a+5*a,c=a;break;case"cNh":o=2+2*s+s*a+6*a,c=a;break;case"rh0":o=2+2*s+s*a+7*a,c=a;break;case"rNh":o=2+2*s+s*a+8*a,c=a;break;case"cr0":o=2+2*s+s*a+9*a,c=a;break;case"cNr":o=2+2*s+s*a+10*a,c=a;break;case"rr0":o=2+2*s+s*a+11*a,c=a;break;case"rNr":o=2+2*s+s*a+12*a,c=a;break;case"cg0":o=2+2*s+s*a+13*a,c=a;break;case"cNg":o=2+2*s+s*a+14*a,c=a;break;case"rg0":o=2+2*s+s*a+15*a,c=a;break;case"rNg":o=2+2*s+s*a+16*a,c=a;break;default:throw Error("pcamodel_get: wrong outcome name.")}return l.v.subarray(o,o+c)}function tr(l,e,t){if(!l||!l.class||!l.class.includes("pcares"))throw new Error('pcares_get: parameter "r" must be JSON with PCA results.');const s=l.ncols,a=l.nrows,o=l.ncomp;let c,d;switch(e){case"scores":case"xscores":c=(t-1)*a,d=a;break;case"T":c=0,d=a*o;break;case"hdist":c=a*o+(t-1)*a,d=a;break;case"qdist":c=2*a*o+(t-1)*a,d=a;break;case"xcumexpvar":case"cumexpvar":c=3*a*o,d=o;break;case"fdistc":c=3*a*o+o+(t-1)*a,d=a;break;case"fdistr":c=4*a*o+o+(t-1)*a,d=a;break;case"gdist":c=5*a*o+o+(t-1)*s,d=s;break;case"rdist":c=5*a*o+o+s*o+(t-1)*s,d=s;break;case"idistc":c=5*a*o+o+2*s*o+(t-1)*s,d=s;break;case"idistr":c=5*a*o+o+3*s*o+(t-1)*s,d=s;break;case"E":c=5*a*o+o+3*s*o+o*s,d=a*s;break;default:throw new Error("pcares_get: wrong outcome name.")}return l.v.subarray(c,c+d)}function Jl(l,e,t){if(!Array.isArray(l))return!1;if(l.length===0)return!0;for(let s=0;s<l.length;s++){const a=l[s];if(a<e||a>t)return!1}return!0}function Mf(l,e,t,s,a,o,c){if(!mr(e))throw new Error("pca_fit: X must be a matrix.");o||(o=[]);const d=o&&Array.isArray(o)?o.length:0;if(!Jl(o,0,e.nrows-1))throw new Error('pca_fit: some indices in "outliers" array are outside the expected range.');c||(c=[]);const u=c&&Array.isArray(c)?c.length:0;if(!Jl(c,0,e.ncols-1))throw new Error('pca_fit: some indices in "exclvars" array are outside the expected range.');const f=e.nrows-d,v=e.ncols-u;if(f<3||v<2)throw new Error("pca_fit: X must have at least 3 rows and 2 columns.");if(s===void 0&&(s=!0),a===void 0&&(a=!1),t===void 0&&(t=Math.min(f-1,v)),t<1||t>Math.min(f-1,v))throw new Error('pca_fit: the value of "ncomp" does not match the dimension of X.');const m=l._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);l.HEAPF64.set(e.v,m/e.v.BYTES_PER_ELEMENT);let g=null;if(d>0){const E=new Int32Array(o);g=l._malloc(E.length*E.BYTES_PER_ELEMENT),l.HEAP32.set(E,g/E.BYTES_PER_ELEMENT)}let h=null;if(u>0){const E=new Int32Array(c);h=l._malloc(E.length*E.BYTES_PER_ELEMENT),l.HEAP32.set(E,h/E.BYTES_PER_ELEMENT)}const p=Nf(v,t),_=Float64Array,b=l._malloc(p*_.BYTES_PER_ELEMENT);if(l.ccall("pcafit_wasm",["number"],["number","number","number","number","number","number","number","number","number","number","number"],[m,e.nrows,e.ncols,t,s,a,b,g,d,h,u])!==1)throw new Error("pca_fit: PCA failed.");const C=l.HEAPF64.slice(b/_.BYTES_PER_ELEMENT,b/_.BYTES_PER_ELEMENT+p);return l._free(m),l._free(b),g&&l._free(g),h&&l._free(h),{class:["pcamodel"],v:C,ncomp:t,nrows:f,ncols:v,exclvars:c,center:s,scale:a}}function Tf(l,e,t,s){if(!e||!e.class||!e.class.includes("pcamodel"))throw new Error('pca_predict: parameter "m" must be JSON with PCA model.');if(!mr(t))throw new Error("pca_predict: X must be a matrix.");s||(s=[]);const a=s&&Array.isArray(s)?s.length:0;if(!Jl(s,0,t.nrows-1))throw new Error('pca_predict: some indices in "outliers" array are outside the expected range.');let o=e.exclvars.length;e.exclvars;const c=t.nrows-a;t.ncols===e.ncols&&(o=0);const d=t.ncols-o;if(c<1)throw new Error("pca_predict: X must have at least 1 row.");if(d!==e.ncols)throw new Error("pca_predict: X must have the same number of columns (without excluded ones) as the training set.");const u=l._malloc(t.v.length*t.v.BYTES_PER_ELEMENT);l.HEAPF64.set(t.v,u/t.v.BYTES_PER_ELEMENT);let f=null;if(a>0){const N=new Int32Array(s);f=l._malloc(N.length*N.BYTES_PER_ELEMENT),l.HEAP32.set(N,f/N.BYTES_PER_ELEMENT)}let v=null;if(o>0){const N=new Int32Array(e.exclvars);v=l._malloc(N.length*N.BYTES_PER_ELEMENT),l.HEAP32.set(N,v/N.BYTES_PER_ELEMENT)}const m=l._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);l.HEAPF64.set(e.v,m/e.v.BYTES_PER_ELEMENT);const g=Af(c,e.ncomp,d),h=Float64Array,p=l._malloc(g*h.BYTES_PER_ELEMENT);if(l.ccall("pcapredict_wasm",["number"],["number","number","number","number","number","number","number","number","number"],[u,t.nrows,t.ncols,m,p,f,a,v,o])!==1)throw new Error("pca_predict: PCA prediction failed.");const b=l.HEAPF64.slice(p/h.BYTES_PER_ELEMENT,p/h.BYTES_PER_ELEMENT+g);l._free(u),l._free(m),l._free(p),f&&l._free(f),v&&l._free(v);const y={class:["pcares"],v:b,ncomp:e.ncomp,nrows:c,ncols:d,npred:d,outliers:s,exclvars:e.exclvars,center:e.center,scale:e.scale},C=new Array(e.ncomp),E=new Array(e.ncomp),k=new Array(e.ncomp),S=new Array(e.ncomp),A=new Array(e.ncomp),M=tr(y,"xcumexpvar");A[0]=1,S[0]=M[0],k[0]=1-M[0],C[0]=M[0],E[0]=1-M[0];for(let N=1;N<e.ncomp;N++)A[N]=N+1,S[N]=M[N],k[N]=1-M[N],C[N]=M[N]-M[N-1],E[N]=1-C[N];return y.stat={components:A,resvar:E,expvar:C,cumexpvar:S,cumresvar:k},y}function Pf(l,e,t,s,a,o,c,d){if(!e||!e.class||!e.class.includes("pcamodel"))throw new Error('pcapcv: parameter "m" must be JSON with PCA results.');if(!mr(t))throw new Error("pcapcv: X must be a matrix.");d||(d=[]);const u=d&&Array.isArray(d)?d.length:0;if(!Jl(d,0,t.nrows-1))throw new Error('pca_predict: some indices in "outliers" array are outside the expected range.');const f=e.exclvars.length,v=t.nrows-u,m=t.ncols-f;if(v<3)throw new Error("pcapcv: X must have at least 3 rows.");if(m!==e.ncols)throw new Error("pcapcv: X must have the same number of columns as the training set.");if(!Number.isInteger(o)||![0,1,2].includes(o))throw new Error('pcapcv: parameter "cv_type" must be one of 0 ("loo"), 1 ("ven"), 2 ("rand).');if(!Number.isInteger(c)||![0,1].includes(c))throw new Error('pcapcv: parameter "cv_scope" must be 0 ("global") or 1 ("local").');if(o>0&&(!Number.isInteger(a)||a<2))throw new Error('pcapcv: parameter "cv_nseg" must be a number ≥ 2.');if(o>0&&a>v)throw new Error('pcapcv: the value of "cv_nseg" is too large for the given X.');if(!Number.isInteger(s)||s<1)throw new Error('pcapcv: the value of "ncomp" must be a number >= 1.');const g=Math.min(o===0?v-2:v-Math.ceil(v/a)-1,m,e.ncomp);if(s>g)throw new Error('pcapcv: the value of "ncomp" is too large.');const h=l._malloc(t.v.length*t.v.BYTES_PER_ELEMENT);l.HEAPF64.set(t.v,h/t.v.BYTES_PER_ELEMENT);let p=null;if(u>0){const A=new Int32Array(d);p=l._malloc(A.length*A.BYTES_PER_ELEMENT),l.HEAP32.set(A,p/A.BYTES_PER_ELEMENT)}let _=null;if(f>0){const A=new Int32Array(e.exclvars);_=l._malloc(A.length*A.BYTES_PER_ELEMENT),l.HEAP32.set(A,_/A.BYTES_PER_ELEMENT)}const b=l._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);l.HEAPF64.set(e.v,b/e.v.BYTES_PER_ELEMENT);const y=v*m,C=t.v.constructor,E=l._malloc(y*C.BYTES_PER_ELEMENT);if(l.ccall("pcvpca_wasm",["number"],["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"],[h,t.nrows,t.ncols,s,e.center,e.scale,o,a,c,b,E,p,u,_,f])!==1)throw new Error("pcapcv: PCVPCA failed.");const S=l.HEAPF64.slice(E/C.BYTES_PER_ELEMENT,E/C.BYTES_PER_ELEMENT+y);return l._free(h),l._free(b),l._free(E),p&&l._free(p),_&&l._free(_),new Lt(S,v,m)}function zf(l,e){if(e[0]===0){const t=e[1]+2;return 2+t+l*t+2*l+t}return 3+l}const Xr=[{id:"norm",title:"Normalization",mpl:2,get_mpl_new:(l,e)=>2,mp:[0,0]},{id:"savgol",title:"Savitzky-Golay",mpl:3,get_mpl_new:(l,e)=>e[0]*e[0],mp:[3,1,0]},{id:"scale",title:"Scaling",mpl:2,get_mpl_new:(l,e)=>2*l,mp:[1,0]},{id:"baseline",title:"Baseline",mpl:3,get_mpl_new:zf,mp:[0,0,0]},{id:"trim",title:"Trim tails",mpl:2,get_mpl_new:(l,e)=>2,mp:[0,0]},{id:"spikes",title:"Spike removal",mpl:2,get_mpl_new:(l,e)=>2+3*l+e[0],mp:[5,5]}];function Lf(l){let e="<ul>";for(let t=0;t<l.ml.length;t++){const s=Xr[l.ml[t]].title;e=e+"<li>"+s+" <span>"+l.info[t]+"</span></li>"}return e=e+"</ul>",e}function vi(l,e,t){const s=Xr.findIndex(m=>m.id==="trim");let a=0,o=l.ncols-e,c=0;for(let m=0;m<t.ml.length;m++){if(t.ml[m]!==s){c+=t.mpl_new[m];continue}a=Math.max(a,t.mp_new[c]),o=Math.min(o,t.mp_new[c+1]),c+=t.mpl_new[m]}const d=l.nrows,f=o-a+e,v=Lt.zeros(d,f);return c=0,e>0&&(v.v.set(l.v.slice(0,e*d),c),c+=e*d),v.v.set(l.v.slice((e+a)*d,(e+o)*d),c),[a,o,v]}function Rf(l,e){if(!l||!e||typeof e!="object"||Object.keys(e).length===0)return l;const t=Xr.findIndex(d=>d.id==="trim");if(e.ml.findIndex(d=>d===t)<0)return l;const[a,o,c]=vi(l.values,l.nresp,e);return l.values=c,l.varlabels=l.nresp>0?l.varlabels.slice(0,l.nresp).concat(l.varlabels.slice(l.nresp+a,l.nresp+o)):l.varlabels.slice(a,o),l.varindices=l.nresp>0?Nr(0,l.nresp-1).concat(Nr(0,o-a-1)):Nr(0,o-a-1),l.varvalues=l.nresp>0?l.varvalues.slice(0,l.nresp).concat(l.varvalues.slice(l.nresp+a,l.nresp+o)):l.varvalues.slice(a,o),l}function mi(l,e,t,s,a=!0,o=[]){if(!mr(e))throw new Error("prep: D must be a matrix.");if(!Array.isArray(s)||s.length<1)throw new Error("prep_fit: list with methods is not correct.");let c,d;a?(c=e.ncols,d=e.nrows-t):(c=e.nrows,d=e.ncols-t);const u=s.length;if(u<1)throw new Error("prep_fit: no preprocessing methods are provided.");const f=new Int32Array(u),v=new Int32Array(u),m=new Int32Array(u);let g=0,h=0;for(let q=0;q<s.length;q++){const U=s[q].id,D=s[q].params,L=Xr.findIndex(B=>B.id==U);if(L<0)throw new Error("prep_fit: wrong method name: "+U+".");const F=Xr[L];if(D.length!==F.mpl)throw new Error("prep_fit: wrong number of parameters for method: "+U+".");f[q]=L,v[q]=F.mpl,m[q]=F.get_mpl_new(d,D),g=g+v[q],h=h+m[q]}const p=new Float64Array(g);let _=0;for(let q=0;q<s.length;q++){const U=s[q].id,D=s[q].params;Xr.findIndex(L=>L.id==U),p.set(D,_),_=_+v[q]}const b=l._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);l.HEAPF64.set(e.v,b/e.v.BYTES_PER_ELEMENT);const y=l._malloc(f.length*f.BYTES_PER_ELEMENT);l.HEAP32.set(f,y/f.BYTES_PER_ELEMENT);const C=l._malloc(v.length*v.BYTES_PER_ELEMENT);l.HEAP32.set(v,C/v.BYTES_PER_ELEMENT);const E=l._malloc(m.length*m.BYTES_PER_ELEMENT);l.HEAP32.set(m,E/m.BYTES_PER_ELEMENT);const k=l._malloc(p.length*p.BYTES_PER_ELEMENT);l.HEAPF64.set(p,k/p.BYTES_PER_ELEMENT);const S=l._malloc(h*p.BYTES_PER_ELEMENT),A=new Int32Array(o),M=A.length,N=l._malloc(M*A.BYTES_PER_ELEMENT);if(l.HEAP32.set(A,N/A.BYTES_PER_ELEMENT),l.ccall("prepfit_wasm",["number"],["number","number","number","number","number","number","number","number","number","number","number","number","numbers"],[b,c,d,t,u,y,C,k,E,S,a,N,M])!==1)throw new Error("prep_fit: unexpected error.");const I=l.HEAPF64.slice(S/p.BYTES_PER_ELEMENT,S/p.BYTES_PER_ELEMENT+h);return l._free(b),l._free(y),l._free(k),l._free(C),l._free(N),l._free(S),l._free(E),{ml:f,mpl:v,mp:p,mpl_new:m,mp_new:I,npred:d,class:["prepmodel"]}}function ta(l,e,t,s,a=!0,o=!1){if(!mr(e))throw new Error("prep_apply: D must be a matrix.");let c,d;if(a?(c=e.ncols,d=e.nrows-t):(c=e.nrows,d=e.ncols-t),d!==s.npred)throw new Error("prep_apply: D has wrong number of predictors (expected "+s.npred+" got "+d+").");const u=s.ml,f=s.mpl_new,v=s.mp_new,m=f.reduce((S,A)=>S+A,0);if(!u||u.length<1||!f||f.length!==u.length||v.length!==m)throw new Error("prep_apply: wrong structure of the model object.");const g=u.length,h=l._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);l.HEAPF64.set(e.v,h/e.v.BYTES_PER_ELEMENT);const p=l._malloc(u.length*u.BYTES_PER_ELEMENT);l.HEAP32.set(u,p/u.BYTES_PER_ELEMENT);const _=l._malloc(f.length*f.BYTES_PER_ELEMENT);l.HEAP32.set(f,_/f.BYTES_PER_ELEMENT);const b=l._malloc(v.length*v.BYTES_PER_ELEMENT);l.HEAPF64.set(v,b/v.BYTES_PER_ELEMENT);const y=l._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);if(l.ccall("prepapply_wasm",["number"],["number","number","number","number","number","number","number","number","number","number"],[h,c,d,t,g,p,_,b,y,a])!==1)throw new Error("prep_apply: unexpected error.");const E=l.HEAPF64.slice(y/e.v.BYTES_PER_ELEMENT,y/e.v.BYTES_PER_ELEMENT+e.v.length);l._free(h),l._free(p),l._free(_),l._free(b),l._free(y);const k=new Lt(E,e.nrows,e.ncols);if(o){const[S,A,M]=vi(k,t,s);return M}return k}function Nr(l,e,t=1){const s=Math.round((e-l+1)/t),a=Array(s);for(let o=0;o<s;o++)a[o]=l+o*t;return a}function If(l,e){let t,s,a;if(e.length>0){const o=l.values.nrows,c=l.objindices,d=o-e.length;t=Array(d),s=Array(d),a=Array(d);let u=0;for(let f=0;f<o;f++)e.includes(f)||(t[u]=c[f],s[u]=l.classes[f],a[u]=l.objlabels[f],u=u+1)}else t=l.objindices,a=l.objlabels,s=l.classes;return[t,a,s]}function ra(){const l=new Date;return`${l.getFullYear()}${(l.getMonth()+1).toString().padStart(2,"0")}${l.getDate().toString().padStart(2,"0")}${l.getHours().toString().padStart(2,"0")}${l.getMinutes().toString().padStart(2,"0")}${l.getSeconds().toString().padStart(2,"0")}${l.getMilliseconds().toString().padStart(3,"0")}`}function na(l,e,t,s,a=!1){const[o,c,d]=If(t,s),u=a&&e.prep&&e.prep.ml&&e.prep.ml.length>0?ta(l,t.values,0,e.prep,!1,!0):t.values,f=Tf(l,e,u,s);f.hash=ra(),f.objindices=o,f.objlabels=c,f.classes=d,f.classNames=t.classNames,f.varlabels=t.varlabels,f.eigenvals=rt(e,"eigenvals"),f.cNh=rt(e,"cNh"),f.cNq=rt(e,"cNq"),f.ch0=rt(e,"ch0"),f.cq0=rt(e,"cq0"),f.rNh=rt(e,"rNh"),f.rNq=rt(e,"rNq"),f.rh0=rt(e,"rh0"),f.rq0=rt(e,"rq0");const v=e.nrows;return f.T2lim=2*(v-1)/(v-2)*Zo(.95,2,v-2),f}function jf(l,e="."){return Array.isArray(l)&&l.length>0?e==="."?l.map(t=>Number.parseFloat(t.trim())):l.map(t=>Number.parseFloat(t.trim().replace(e,"."))):e==="."?Number.parseFloat(l.trim()):Number.parseFloat(l.trim().replace(e,"."))}function ll(l){return l.some(e=>Number.isNaN(e))}function pn(l){return l.replace("	","").trim().replace(/^(['"])(.*)\1$/,"$2")}function hi(l){let e=l.replace(/^\uFEFF/gm,"").replace(/^\u00EF?\u00BB\u00BF/gm,"");return e=e.replace(/\r/gm,""),e.split(/\n/).filter(t=>t.trim().length>1)}function qf(l,e,t,s,a,o,c,d=0){if(e===void 0&&(e=","),!(e===","||e===";"))throw new Error("Values separator can be either comma or semicolon.");const u=e===";"?",":".";let f=hi(l);if(f.length<1)throw new Error("Could not find non-empty rows with values, check your CSV file and try again.");f=f.filter(L=>L.replaceAll(e,"").trim().length>0);const v=f[0].split(e);if(v.length<2)throw new Error("Found only one column, looks like your delimiter is not correct.");let m=0,g;const h=t!=="no";(h||h===void 0&&ll(firstRow))&&(g=v,m=1);const p=f.length-m;if(p<1)throw new Error("Data file should contain at least 1 row with values.");let _,b,y,C=Array(p);s?(_=h?pn(g[0]):"",y=Array(p),b=1):(_="",y=[],b=0);let E,k=[],S;a?(E=h?pn(g[b]):"",S=Array(p),b=b+1):(E="",S=[]);const A=v.length-b;if(A<1)throw new Error("Data file should contain at least 1 column with values.");const M=Lt.zeros(A,p);for(let L=m;L<p+m;L++){const F=L-m;C[F]=F;let B=f[L].split(e);if(s&&(y[F]=B[0],B.shift()),a){const X=B[0];S[F]=X,B.shift(),(k.length===0||k.indexOf(X)<0)&&k.push(X)}const O=u==="."?B.map((X,Z)=>Number.parseFloat(X.trim())):B.map((X,Z)=>Number.parseFloat(X.trim().replace(u,".")));if(O.some(X=>Number.isNaN(X)))throw new Error("Some of the values can not be converted to numbers, check your CSV file and try again.");if(O.length!=A)throw new Error("Wrong number of values in row #"+L);M.v.set(new Float64Array(O),(L-m)*A)}if(!s||y.length!==p){y=Array(p);for(let L=0;L<p;L++)y[L]="O"+(L+1)}y=y.map(L=>pn(L)),S=S.map(L=>pn(L)),k=k.map(L=>pn(L));let N,P=Array(A),I=Array(A);if(g&&g.length===A+b){N=g.map(L=>pn(L)).slice(b);for(let L=0;L<A;L++)P[L]=L>=d?L-d:L,I[L]=L>=d?L-d+1:L+1}else{N=Array(A);for(let L=0;L<A;L++)P[L]=L>=d?L-d:L,N[L]=L>=d?"V"+(L-d+1):"Y"+(L+1),I[L]=L>=d?L-d+1:L+1}let R;if(t==="values"){if(R=u==="."?N.map((L,F)=>F<d?F:Number.parseFloat(L.trim())):N.map((L,F)=>F<d?F:Number.parseFloat(L.trim().replace(u,"."))),R.some(L=>Number.isNaN(L)))throw new Error("Some of the header values can not be converted to numbers, check your CSV file and try again.")}else R=I;Array.isArray(R)||(R=[]),o||(o=""),c||(c=""),o=R.length>0&&o.length>0?o:"Variables",c=R.length>0&&c.length>0?c:"";const q=o+(c.length>0?", "+c:""),U=R[1]<R[0];return{values:M.t(),nresp:d,header:t,hasLabels:s,hasClassNames:a,labelsVarname:_,classLabelsVarname:E,objlabels:y,objindices:C,varlabels:N,varvalues:R,varindices:P,varrev:U,classes:S,classNames:k,sep:e,dec:u,varvaluesName:o,varvaluesUnits:c,varAxisTitle:q}}function Ff(l){if(ll(l[0].slice(2)))return!0;const e=l[0].length,t=[];for(let s=2;s<e;s++){let a=[];for(let f=1;f<l.length;f++)a.push(l[f][s]);const o=l[0][s],c=Yl(a),d=Wo(a),u=Math.abs((o-c)/d);t.push(u)}return t.every(s=>s>5)}function Of(l){const t=l[0].split(","),s=l[1].split(","),a=t.length,o=s.length,c=";",d=l[0].split(c),u=l[1].split(c),f=d.length,v=u.length;let m,g;if(a>1&&o>1&&a===o&&a>f)g=",",m=a;else if(f>1&&v>1&&f===v)g=c,m=f;else throw new Error("Values in the CSV file should be separated by coma or by semicolon.");return[g,g===","?".":",",m]}function Df(l,e=0){const t=hi(l),s=t.length;if(s<3)throw new Error("It looks like the dataset has less then three rows, minimum three is needed, check your CSV file and try again.");const[a,o,c]=Of(t),d=Math.min(c,5),u=Math.min(s,5);let f=t[0].split(a).length,v=t.slice(0,u).map(P=>P.split(a).slice(0,d));v=v.map(P=>P.map(I=>pn(I)));const m=v.map(P=>jf(P.slice(),o));for(let P=1;P<u;P++)if(ll(m[P].slice(2)))throw new Error("Some of the data values expected to be numeric are not, check your CSV file.");const g=Ff(m);let h=0;const p=g?1:0,_=p+1,b=v[p][0],y=v[_][0],C=m[p][0],E=m[_][0],k=m[p][1],S=m[_][1];let A=!1,M=!1;if(Number.isNaN(C)&&Number.isNaN(E)&&b!==y?(A=!0,h=h+1):Number.isNaN(k)&&Number.isNaN(S)&&b!==y&&(A=!0,M=!0,h=h+2),!M){const P=A?1:0,I=m[p][P],R=m[_][P];M=ll([I,R]),h=h+M}let N="no";if(g){h>0?v[0].slice(h+e):v[e];const P=h>0?m[0].slice(h+e):m[e];N=ll(P)?"labels":"values"}return[a,A,M,N,f]}function Bf(l){const e=l.values.t(),t=l.sep,s=l.dec;let a=null;l.header!=="no"&&(a=l.header==="values"?l.nresp&&l.nresp>0?l.varlabels.slice(0,l.nresp).concat(l.varvalues.slice(l.nresp)):l.varvalues.slice():l.varlabels.slice()),a&&l.hasClassNames&&(a=[l.classLabelsVarname,...a]),a&&l.hasLabels&&(a=[l.labelsVarname,...a]);const o=l.classes&&l.classes.length===e.ncols,c=l.objlabels&&l.objlabels.length===e.ncols;let d=a?a.join(t):"";for(let u=0;u<e.ncols;u++){let f=e.getcolref(u+1).join(t);s!=="."&&(f=f.replace(".",s)),o&&(f=l.classes[u]+l.sep+f),c&&(f=l.objlabels[u]+l.sep+f),d=d+`
`+f}return d=d+`
`,s!=="."&&(d=d.replace(/\./g,s)),d}function Vf(l,e){const t=Bf(l),s=new Blob([t],{type:"text/csv"}),a=window.URL.createObjectURL(s),o=document.createElement("a");o.setAttribute("href",a),o.setAttribute("download",`${e}.csv`),o.click()}function Yf(l){if(!l.length)return"";l.sort((a,o)=>a-o);let e=[],t=l[0],s=t;for(let a=1;a<l.length;a++)l[a]===s+1?s=l[a]:(t===s?e.push(`${t}`):e.push(`${t}-${s}`),t=l[a],s=t);return t===s?e.push(`${t}`):e.push(`${t}-${s}`),e.join(" ")}function sl(l,e){return mr(e)?{__type:"matrix",nrows:e.nrows,ncols:e.ncols,v:Array.from(e.v)}:We(e)?{__type:"vector",length:e.length,v:Array.from(e.v)}:ArrayBuffer.isView(e)?{__type:e.constructor.name,data:Array.from(e)}:e}function la(l,e){if(e&&typeof e=="object"&&e.__type){if(e.__type==="matrix")return Cf(e.v,e.nrows,e.ncols);if(e.__type==="vector")return it(e.v);const t=globalThis[e.__type];if(typeof t=="function")return new t(e.data)}return e}function sa(l){const e=l.getFullYear(),t=String(l.getMonth()+1).padStart(2,"0"),s=String(l.getDate()).padStart(2,"0"),a=String(l.getHours()).padStart(2,"0"),o=String(l.getMinutes()).padStart(2,"0"),c=String(l.getSeconds()).padStart(2,"0");return`${e}${t}${s}${a}${o}${c}`}function Ql(l,e){return Object.keys(l).reduce((t,s)=>(t[s]=e(l,s),t),{})}function gi(l){return Array.from({length:8},(e,t)=>l>>7-t&1).reverse()}function Zl(l,e,t){let s="";for(let a=0;a<e;a++){const o=l.getUint8(t++);if(o===0)break;s+=String.fromCharCode(o)}return s}function Wf(l){const e=["A.U.","cm^–1","µm","nm","s","min","Hz","KHz","MHz","M/z","ppm","days","years","cm^–1","eV","","","","","F","C","K","","msec","µsec","nsec","GHz","cm","m","mm","h",""],t=["Arbitrary","Wavenumber","Micrometers","Nanometers","Seconds","Minutes","Hertz","Kilohertz","Megahertz","Mass","Parts per million","Days","Years","Raman shift","Electron Volts","X,Y,Z text labels in fcatxt (old 4Dh version only)","Diode Number","Channel","Degrees","Temperature","Temperature","Temperature","Data Points","Milliseconds","Microseconds","Nanoseconds","Gigahertz","Centimeters","Meters","Millimeters","Hours","Double interferogram (no display labels)"],s=["Arbitrary Intensity","Interferogram","Absorbance","Kubelka-Munk","Counts","Volts","Degrees","Milliamps","Millimeters","Millivolts","Log (1/R)","Percent","Intensity","Relative Intensity","Energy",null,"Decibel",null,null,"Temperature (F)","Temperature (C)","Temperature (K)","Index of Refraction [N]","Extinction Coeff. [K]","Real","Imaginary","Complex"],a=["Transmission","Reflectance","Arbitrary or Single Beam with Valley Peaks","Emission"];let o=0;const c=l.getUint8(o);o+=1;const d=l.getUint8(o);if(o+=1,d===77)throw new Error("SPC file has old format which is not supported.");const u=d===75,f=l.getUint8(o);o+=1;const v=l.getInt8(o);o+=1;const m=l.getUint32(o,u);o+=4;const g=l.getFloat64(o,u);o+=8;const h=l.getFloat64(o,u);o+=8;const p=l.getUint32(o,u);o+=4;const _=l.getUint8(o);o+=1;const b=l.getUint8(o);o+=1;const y=l.getUint8(o);o+=1;const C=l.getUint8(o);o+=1;const E=l.getUint32(o,u);o+=4;const k=Zl(l,9,o);o+=9;const S=Zl(l,9,o);o+=9;const A=l.getUint16(o,u);o+=2;const M=Array.from({length:8},()=>{const $=l.getFloat32(o,u);return o+=4,$}),N=Zl(l,130,o);o+=130;const P=Zl(l,30,o);o+=30;const I=l.getUint32(o,u);o+=4;const[R,q,U,D,L,F,B,O]=gi(c),X=_===255?t[31]:t[_],Z=_===255?e[31]:e[_],G=b<=26?s[b]:b>=128&&b<=131?a[b]:"Unknown";return{ftflgsv:c,ftflgs:{TSPREC:R,TCGRAM:q,TMULTI:U,TRANDM:D,TORDRD:L,TALABS:F,TXYXYS:B,TXVALS:O},fexper:f,fexp:v,fnpts:m,ffirst:g,flast:h,fnsub:p,fxtype:_,fytype:b,fztype:y,fpost:C,fdate:E,fres:k,fsource:S,fpeakpt:A,fspare:M,fcmnt:N,fcatxt:P,flogoff:I,xaxisName:X,xaxisUnit:Z,yaxisName:G}}function Uf(l,e){const t=gi(l.getUint8(e));e+=1;const s=l.getInt8(e);e+=1;const a=l.getUint16(e,!0);e+=2;const o=l.getFloat32(e,!0);e+=4;const c=l.getFloat32(e,!0);e+=4;const d=l.getFloat32(e,!0);e+=4;const u=l.getInt32(e,!0);e+=4;const f=l.getInt32(e,!0);e+=4;const v=l.getFloat32(e,!0);return e+=4,{flags:t,exp:s,index:a,time:o,next:c,noise:d,nPoints:u,nScans:f,wAxis:v}}async function pi(l){if(l.name.slice(-3).toLowerCase()!=="spc")throw new Error(`One of the selected files is not SPC (${l.name}).`);const t=l.name.slice(0,-4),s=await l.arrayBuffer(),a=new DataView(s);let o=0;const c=Wf(a);o+=512;const d=c.fnpts;if(d<2)throw new Error(`Error reading SPC file (${l.name}).`);let u=new Array(d);if(c.ftflgs.TXVALS)for(let m=0;m<d;m++){const g=a.getFloat32(o,!0);o=o+4,u[m]=g}else{(c.flast-c.ffirst)/(d-1);for(let m=0;m<d;m++)u[m]=c.ffirst+m*c.flast}const f=new Float64Array(d*c.fnsub);for(let m=0;m<c.fnsub;m++){Uf(a,o),o=o+32;for(let g=0;g<d;g++){const h=a.getFloat32(o,!0);o=o+4,f[m*d+g]=h}}const v=[];return c.fnsub>1?Nr(1,c.fnsub).forEach(g=>{v.push(t+"_"+g)}):v.push(t),{hdr:c,xvalues:u,yvalues:f,objlabels:v}}async function Hf(l){if(!(l instanceof FileList||Array.isArray(l)))throw new Error("readSPCFiles: expected FileList or array of files.");const e=l.length,t=[];let s=[],a=[];const o=await pi(l[0]),c=o.xvalues.length;if(t.push(o.yvalues),s=s.concat(o.objlabels),a.push(o.hdr.fnsub),e>1)for(let p=1;p<e;p++){const _=await pi(l[p]);if(_.xvalues.length!==c)throw new Error("Number of spectral values in SPC files is different.");t.push(_.yvalues),s=s.concat(_.objlabels),a.push(_.hdr.fnsub)}const d=a.reduce((p,_)=>p+_,0),u=new Float64Array(d*c);let f=0;for(let p=0;p<t.length;p++)u.set(t[p].slice(),f),f+=a[p]*c;const v=new Lt(u,c,d),m=Nr(0,c-1),g=Nr(0,d-1),h=o.xvalues.map(p=>p.toFixed(1));return{values:v.t(),nresp:0,header:"values",hasLabels:!0,hasClassNames:!1,labelsVarname:"",classLabelsVarname:"",classes:[],classNames:[],objlabels:s,objindices:g,varlabels:h,varvalues:o.xvalues,varindices:m,varev:o.xvalues[1]<o.xvalues[0],sep:",",dec:".",varvaluesName:o.hdr.xaxisName,varvaluesUnits:o.hdr.xaxisUnit,varAxisTitle:"",fileName:`${e} SPC files`}}function bi(l,e){const t=1-e/100,a=1.96*Math.sqrt(l*t*(1-t))/l;return[t,a]}var Gf=K('<button tabindex="0" class="button svelte-ymtj5z"> </button>');function lt(l,e){let t=Y(e,"text",3,"button");var s=Gf();s.__click=function(...o){var c;(c=e.onclick)==null||c.apply(this,o)};var a=j(s);ae(()=>ve(a,t())),T(l,s)}vt(["click"]);var Xf=K('<button tabindex="0"></button>');function bn(l,e){Y(e,"disable",3,!1);var t=Xf();t.__click=function(...s){var a;(a=e.onclick)==null||a.apply(this,s)},ae(()=>{H(t,"title",e.title),H(t,"aria-label",e.title),H(t,"alt",e.title),pt(t,1,`button ${e.className??""}`,"svelte-bx9fh5")}),T(l,t)}vt(["click"]);function Mr(l,e){let t=Y(e,"title",3,"Reset");bn(l,{get title(){return t()},get onclick(){return e.onclick},className:"button-cancel"})}function Kf(l,e){let t=Y(e,"title",3,"Undo");bn(l,{get title(){return t()},get onclick(){return e.onclick},className:"button-undo"})}function Jf(l,e){let t=Y(e,"title",3,"Download");bn(l,{get title(){return t()},get onclick(){return e.onclick},className:"button-download"})}function Qf(l,e){let t=Y(e,"title",3,"Add");bn(l,{get title(){return t()},get onclick(){return e.onclick},className:"button-add"})}function _i(l,e){let t=Y(e,"title",3,"Settings");bn(l,{get title(){return t()},get onclick(){return e.onclick},className:"button-settings"})}function Zf(l,e){let t=Y(e,"title",3,"Move up");bn(l,{get title(){return t()},get onclick(){return e.onclick},className:"button-up"})}function $f(l,e){let t=Y(e,"title",3,"Move down");bn(l,{get title(){return t()},get onclick(){return e.onclick},className:"button-down"})}function Rt(l){const e={};for(const t of Object.keys(l))e[t]=l[t].default;return e}var ed=K('<span class="label svelte-1986c5z"> </span>'),td=K("<div><!> <!></div>");function oe(l,e){let t=Y(e,"label",3,null),s=Y(e,"name",3,""),a=Y(e,"status",3,""),o=Y(e,"colors",3,""),c=Y(e,"labelWidth",3,12);var d=td(),u=j(d);{var f=m=>{var g=ed(),h=j(g);ae(()=>{bt(g,`flex-basis:${c()??""}ch;`),ve(h,t())}),T(m,g)};W(u,m=>{t()&&m(f)})}var v=z(u,2);Rr(v,()=>e.children??xt),ae(()=>{pt(d,1,`control-element ${s()??""} ${a()??""}`,"svelte-1986c5z"),bt(d,o())}),T(l,d)}const wi=(l,e,t,s)=>{const a=e(l);a<0||a>1||V(t,a*100>r(s)-5&&a*100<r(s)+5,!0)},yi=(l,e,t,s,a,o)=>{V(e,!1);const c=t(l);c<0||c>1||(s(a(c)),o()&&o()(s()))},xi=(l,e,t,s,a,o)=>{if(!r(e))return;const c=t(l);c<0||c>1||(s(a(c)),o()&&o()(s()))},rd=(l,e,t,s,a,o)=>{if(l.key==="ArrowLeft"){e(e()-t()<s()?s():e()-t()),a()&&a()(e());return}if(l.key==="ArrowRight"){e(e()+t()>o()?o():e()+t()),a()&&a()(e());return}};var nd=K('<div role="slider" class="range-slider-container svelte-vhx0r0" tabindex="0"><div><span> </span></div></div>');function qn(l,e){ge(e,!0);let t=Y(e,"min",7,0),s=Y(e,"max",3,100),a=Y(e,"value",31,()=>Re(t())),o=Y(e,"decNum",3,1),c=Y(e,"step",19,()=>+((s()-t())/100).toFixed(4)),d=Y(e,"onchange",3,null);ce(()=>{a()<t()&&(a(t()),d()&&d()(a())),a()>s()&&(a(s()),d()&&d()(a())),t()>s()&&t(s())});let u=ne(void 0),f=ne(void 0),v=ne(!1);const m=A=>{const M=t()+A*(s()-t());return+(Math.round(M/c())*c()).toFixed(4)},g=A=>{const M=r(u).getBoundingClientRect(),N=r(f).getBoundingClientRect(),P=M.x,I=N.x+N.width;return(A.clientX-P)/(I-P)},h=A=>{V(v,!1)},p=A=>{let M=a()+c()*A.deltaY*.5;M<t()&&(M=t()),M>s()&&(M=s()),a(+(Math.round(M/c())*c()).toFixed(4)),A.preventDefault(),d()&&d()(a())},_=w(()=>t()===s()?100:(a()-t())/(s()-t())*100);var b=nd();b.__keydown=[rd,a,c,t,d,s],b.__mousemove=[xi,v,g,a,m,d],b.__mousedown=[wi,g,v,_],b.__mouseup=[yi,v,g,a,m,d],b.__touchmove=[xi,v,g,a,m,d],b.__touchstart=[wi,g,v,_],b.__touchend=[yi,v,g,a,m,d];var y=j(b);let C;var E=j(y);let k;var S=j(E);hn(y,A=>V(u,A),()=>r(u)),hn(b,A=>V(f,A),()=>r(f)),ae((A,M,N)=>{H(b,"aria-valuenow",a()),H(b,"aria-valuemin",t()),H(b,"aria-valuemax",s()),C=pt(y,1,"range-slider svelte-vhx0r0",null,C,A),bt(y,`width:${r(_)??""}%`),k=pt(E,1,"range-value svelte-vhx0r0",null,k,M),ve(S,N)},[()=>({"range-slider_right":r(_)<50}),()=>({"range-value_right":r(_)<50}),()=>a().toFixed(o())]),vn("mousewheel",b,p),vn("mouseleave",b,h),vn("touchcancel",b,h),T(l,b),pe()}vt(["keydown","mousemove","mousedown","mouseup","touchmove","touchstart","touchend"]);const ki=(l,e,t,s,a)=>{const o=e(l);o<0||o>1||V(t,o>r(s)&&o<r(a)+r(s),!0)},Ei=(l,e,t,s,a)=>{V(e,!1);const o=t(l);if(o<0||o>1)return;const c=s(o);a()!==c&&a(c)},Si=(l,e,t,s,a)=>{if(!r(e))return;const o=t(l);if(o<0||o>1)return;const c=s(o);c!=a()&&a(c)},ld=(l,e,t,s,a)=>{if(l.key==="ArrowLeft"){e(e()-t()<s()?s():e()-t());return}if(l.key==="ArrowRight"){e(e()+t()>a()?a():e()+t());return}};var sd=K('<div role="slider" class="range-slider-container range-slider-container_discrete svelte-xdlm7u" tabindex="0"><div><span> </span></div></div>');function Tr(l,e){ge(e,!0);let t=Y(e,"min",3,0),s=Y(e,"max",3,10),a=Y(e,"value",31,()=>Re(t())),o=Y(e,"step",3,1);a()<t()&&(console.log('RangeDiscrete: the "value" is outside of the provided range.'),a(t())),a()>s()&&(console.log('RangeDiscrete: the "value" is outside of the provided range.'),a(s())),t()>s()&&console.error("The min and max values must be distinct.");let c=ne(void 0),d=ne(void 0),u=ne(!1);const f=w(()=>t()===s()?0:(a()-t())/(s()-t()+o())),v=w(()=>o()/(s()-t()+o())),m=w(()=>s()<100?`background: repeating-linear-gradient(to right, var(--bg-color-light, #f4f4f4), var(--bg-color-light, #f4f4f4), var(--bg-color-light, #f4f4f4) ${r(v)*100}%, var(--bg-color-light2, #e8e8e8) ${r(v)*100}%, var(--bg-color-light2, #e8e8e8) ${200*r(v)}%)`:"background: #f0f0f0"),g=A=>{if(A<0||A>1)return a();let M=a();return Math.round(r(v)/A),A<r(f)&&r(f)>0&&(M=a()-o()*Math.ceil((r(f)-A)/r(v))),A>r(f)+r(v)&&r(f)+r(v)<1&&(M=a()+o()*Math.ceil((A-(r(f)+r(v)))/r(v))),M<t()&&(M=t()),M>s()&&(M=s()),M},h=A=>{const M=r(d).getBoundingClientRect(),N=M.x,P=M.x+M.width;return(A.clientX-N)/(P-N)},p=A=>{V(u,!1)},_=A=>{let M=a()+Math.round(A.deltaY*.5)*o();M<t()&&(M=t()),M>s()&&(M=s()),a(M),A.preventDefault()};var b=sd();b.__keydown=[ld,a,o,t,s],b.__mousemove=[Si,u,h,g,a],b.__mousedown=[ki,h,u,f,v],b.__mouseup=[Ei,u,h,g,a],b.__touchmove=[Si,u,h,g,a],b.__touchstart=[ki,h,u,f,v],b.__touchend=[Ei,u,h,g,a];var y=j(b);let C;var E=j(y);let k;var S=j(E);hn(y,A=>V(c,A),()=>r(c)),hn(b,A=>V(d,A),()=>r(d)),ae((A,M,N)=>{H(b,"aria-valuenow",a()),H(b,"aria-valuemin",t()),H(b,"aria-valuemax",s()),bt(b,r(m)),C=pt(y,1,"range-slider svelte-xdlm7u",null,C,A),bt(y,`width: max(2px, ${r(v)*100}%);left:${r(f)*100}%;`),k=pt(E,1,"range-value svelte-xdlm7u",null,k,M),ve(S,N)},[()=>({"range-slider_left":r(v)<.1&&r(f)<.5,"range-slider_right":r(v)<.1&&r(f)>=.5}),()=>({"range-value_right":r(v)<.1&&r(f)>.5,"range-value_left":r(v)<.1&&r(f)<=.5}),()=>a().toFixed(0)]),vn("mousewheel",b,_),vn("mouseleave",b,p),vn("touchcancel",b,p),T(l,b),pe()}vt(["keydown","mousemove","mousedown","mouseup","touchmove","touchstart","touchend"]);const ad=(l,e,t)=>{if(l.key==="ArrowLeft"){const s=e.options.findIndex(a=>a===t());s>0&&t(e.options[s-1]);return}if(l.key==="ArrowRight"){const s=e.options.findIndex(a=>a===t());s<e.options.length-1&&t(e.options[s+1]);return}};var od=(l,e,t)=>e(t),id=K('<button tabindex="-1"><!></button>'),cd=K('<div role="radiogroup" tabindex="0"></div> <input class="svelte-1i17tox"/>',1);function Xe(l,e){ge(e,!0);let t=Y(e,"value",31,()=>Re(e.options[0])),s=Y(e,"className",3,"");var a=cd(),o=J(a);o.__keydown=[ad,e,t],Ye(o,20,()=>e.options,d=>d,(d,u)=>{var f=id();f.__click=[od,t,u];let v;var m=j(f);Tt(m,()=>u),ae((g,h)=>v=pt(f,1,`option option_${g??""}`,"svelte-1i17tox",v,h),[()=>u.toString().replace(".","_"),()=>({selected:u==t()})]),T(d,f)});var c=z(o,2);ae(()=>pt(o,1,`selector ${s()??""}`,"svelte-1i17tox")),Ds(c,t),T(l,a),pe()}vt(["keydown","click"]);function rr(l,e){ge(e,!0);let t=Y(e,"options",19,()=>["no","yes"]),s=Y(e,"value",15,!1),a=ne(!0);const o=w(()=>t().length!=2?(console.error('Switch: parameter "option" must gave two values.'),null):t());ce(()=>V(a,s()?t()[1]:t()[0],!0)),ce(()=>s(r(a)===t()[1]));var c=he(),d=J(c);{var u=f=>{Xe(f,{get options(){return r(o)},get value(){return r(a)},set value(v){V(a,v,!0)}})};W(d,f=>{r(o)&&f(u)})}T(l,c),pe()}function Ci(l,e,t){r(e)&&r(e).files.length>0?t(r(e).files.length===1?r(e).files[0]:r(e).files):t(null)}function Ai(l,e){(l.type==="click"||l.type==="keydown"&&(l.code==="Space"||l.code==="Enter"))&&r(e).click()}var ud=K('<input type="file" multiple class="svelte-1k0x7uv"/>'),fd=K('<input type="file" class="svelte-1k0x7uv"/>'),dd=K('<div tabindex="0" role="radiogroup"> <!></div> <!>',1);function $l(l,e){ge(e,!0);let t=Y(e,"file",15),s=Y(e,"message",3,"Select CSV file with dataset"),a=Y(e,"acceptType",3,".csv"),o=Y(e,"multiple",3,!1),c=ne(void 0);function d(y){r(c).value=null,t(null)}var u=dd(),f=J(u);f.__keydown=[Ai,c],f.__click=[Ai,c];let v;var m=j(f),g=z(m);{var h=y=>{var C=ud();C.__change=[Ci,c,t],hn(C,E=>V(c,E),()=>r(c)),ae(()=>H(C,"accept",a())),T(y,C)},p=y=>{var C=fd();C.__change=[Ci,c,t],hn(C,E=>V(c,E),()=>r(c)),ae(()=>H(C,"accept",a())),T(y,C)};W(g,y=>{o()?y(h):y(p,!1)})}var _=z(f,2);{var b=y=>{Mr(y,{onclick:d})};W(_,y=>{t()&&y(b)})}ae(y=>{v=pt(f,1,"file-selector svelte-1k0x7uv",null,v,y),ve(m,`${(t()?t().name:s())??""} `)},[()=>({selected:t()})]),T(l,u),pe()}vt(["keydown","click","change"]);function vd(l,e,t,s){e()&&V(t,e()(s()),!0)}var md=K('<div class="error-message svelte-1qtiwcs"> </div>'),hd=K('<div><input type="text" class="svelte-1qtiwcs"/> <!></div>');function Ni(l,e){ge(e,!0);let t=Y(e,"value",15,""),s=Y(e,"className",3,""),a=Y(e,"placeholder",3,""),o=Y(e,"maxLength",3,25),c=Y(e,"validator",3,null),d=ne("");var u=hd();let f;var v=j(u);v.__input=[vd,c,d,t];var m=z(v,2);{var g=h=>{var p=md(),_=j(p);ae(()=>ve(_,r(d))),T(h,p)};W(m,h=>{r(d)&&r(d).length>0&&h(g)})}ae(h=>{f=pt(u,1,`textinput ${s()??""}`,"svelte-1qtiwcs",f,h),H(v,"placeholder",a()),H(v,"maxlength",o())},[()=>({error:r(d)&&r(d).length>0})]),Ds(v,t),T(l,u),pe()}vt(["input"]);var gd=K('<div class="spinner svelte-n48urb"></div>');function aa(l){var e=gd();T(l,e)}const pd=(l,e,t)=>{if(l.key==="ArrowLeft"){const s=e().findIndex(a=>a===t());s>0&&t(e()[s-1]);return}if(l.key==="ArrowRight"){const s=e().findIndex(a=>a===t());s<e().length-1&&t(e()[s+1]);return}};var bd=(l,e,t)=>e(t),_d=K('<button tabindex="-1"><!></button>'),wd=K('<div role="radiogroup" tabindex="0" class="selector plot-selector svelte-yf64an"></div> <input class="svelte-yf64an"/>',1);function Mi(l,e){ge(e,!0);let t=Y(e,"options",19,()=>["p","l","b","h","qq"]),s=Y(e,"value",31,()=>Re(t()[0]));const a='<svg width="3em" height="1.5em" viewBox="0 0 32 20" fill="transparent" xmlns="http://www.w3.org/2000/svg">',o={bp:'<rect x="8" y="5" width="16" height="10" stroke-width="2"/><line x1="15" y1="14" x2="15" y2="4" stroke-width="2"/><line x1="30" y1="10" x2="25" y2="10" stroke-width="2"/><line x1="8" y1="10" x2="2" y2="10" stroke-width="2"/>',hm:'<rect x="5" y="4" width="23" height="12"stroke-width="2"/><line x1="13" y1="16" x2="13" y2="3" stroke-width="2"/><line x1="21" y1="16" x2="21" y2="3" stroke-width="2"/><line x1="28" y1="10" x2="5" y2="10" stroke-width="2"/>',l:'<path d="M4.23178 14.3598L15.5 5" stroke-width="2"/><line x1="14.4846" y1="5.17692" x2="26.4846" y2="10.1769" stroke-width="2"/>',p:'<circle cx="6.5" cy="12.5" r="1" stroke-width="4"/><circle cx="15.2" cy="5.8" r="1" stroke-width="4"/><circle cx="25" cy="10" r="1" stroke-width="4"/>',h:'<line x1="9" y1="15" x2="9" y2="9" stroke-width="6"/><line x1="17" y1="15" x2="17" y2="3" stroke-width="6"/><line x1="25" y1="15" x2="25" y2="7" stroke-width="6"/>',qq:'<circle cx="6.5" cy="15.0" r="1" stroke-width="4"/><circle cx="15.2" cy="10" r="1" stroke-width="4"/><circle cx="25" cy="5.8" r="1" stroke-width="4"/>'};o.b=o.l+o.p;const c={bp:"boxplot",hm:"heatmap",l:"line",p:"scatter",b:"line + scatter",h:"bar",qq:"qq-plot"};var d=wd(),u=J(d);u.__keydown=[pd,t,s],Ye(u,20,t,v=>v,(v,m)=>{var g=_d();g.__click=[bd,s,m];let h;var p=j(g);Tt(p,()=>a+o[m]+"</svg"),ae(_=>{h=pt(g,1,"option svelte-yf64an",null,h,_),H(g,"title",c[m])},[()=>({selected:m==s()})]),T(v,g)});var f=z(u,2);Ds(f,s),T(l,d),pe()}vt(["keydown","click"]),vt(["keydown","click"]);var yd=K("<h2> </h2>"),xd=K("<!> <!>",1),kd=K('<div class="widget"><!></div>');function Ed(l,e){ge(e,!0);let t=Y(e,"title",3,""),s=Y(e,"value",15),a=Y(e,"labelWidth",3,13);function o(f){const v={};for(const m of Object.keys(f))v[m]=f[m].default;return v}ce(()=>{!s()&&e.options&&s(o(e.options))});var c=kd(),d=j(c);{var u=f=>{var v=xd(),m=J(v);{var g=p=>{oe(p,{children:(_,b)=>{var y=yd(),C=j(y);ae(()=>ve(C,t())),T(_,y)},$$slots:{default:!0}})};W(m,p=>{t()&&p(g)})}var h=z(m,2);Ye(h,17,()=>Object.keys(e.options),Ge,(p,_)=>{var b=he();const y=w(()=>e.options[r(_)]);var C=J(b);{var E=k=>{oe(k,{get name(){return r(y).name},get label(){return r(y).label},get labelWidth(){return a()},children:(S,A)=>{var M=he(),N=J(M);tl(N,()=>r(y).el,(P,I)=>{I(P,$t(()=>r(y).props,{get value(){return s()[r(_)]},set value(R){s(s()[r(_)]=R,!0)}}))}),T(S,M)},$$slots:{default:!0}})};W(C,k=>{r(y).hidden||k(E)})}T(p,b)}),T(f,v)};W(d,f=>{s()&&f(u)})}T(l,c),pe()}function Ti(l,e,t){return l<e?["regular","in"]:l>t?["outlier","out"]:["extreme","out"]}function Sd(l,e,t,s,a,o,c,d){if(!d||d.length===0)return[0,0];let u=0,f=0;for(let v of d){const m=l[v],[g,h]=Ti(m,e,t);o[g]+=1,c[h]+=1,s[v]=g,a[v]=h,u=u+(h==="in"),f=f+(h!=="in")}return[u,f]}function Pi(l,e,t,s,a,o,c,d,u){if(!u||u.length===0)return[0,0,0,0,0,0,0,0,0,0];let f=0,v=0;for(let U of u){const D=l[U],[L,F]=Ti(D,t,s);d[F]+=1,a[U]="alien",c.alien+=1,o[U]=F,f=f+(F!=="in"),v=v+(F==="in")}const m=u.slice();m.sort((U,D)=>l[U]-l[D]);let g=m.length;const h=m.map(U=>l[U]);let p=-1,_=0,b=0,y=0,C=0;for(;p<0;)_>0&&(a[m[g-1]]="external",c.alien=c.alien-1,c.external=c.external+1,g=g-1,m.pop(),h.pop()),b=Yl(h),y=Ws(h),C=y/(b*b),p=4-2*e*C,_=_+1;const E=(2+Math.sqrt(p))/C,k=E-e,S=b/E,A=t/S,M=1-2*(e+k)*(e+3*k)/(3*(e+2*k)**2),N=(M-1)*(1-3*M),P=(e+2*k)/(e+k)**2,I=1+M*P*(M-1-.5*(2-M)*N*P),R=M*Math.sqrt(2*P)*(1+.5*N*P),q=Wl((Math.pow(A/(e+k),M)-I)/R);return[f,v,q,k,S,M,I,R,e,b]}function es(l,e,t,s,a){const o=l.ncomp,c=l.nrows;let d,u,f;a?(d=a.members.length,u=a.strangers.length,f=0):(a={members:[],strangers:[],unknown:Nr(0,c-1)},d=0,u=0,f=c);const v=new Array(o),m=new Array(o),g=new Array(o),h=new Array(o),p=new Array(o),_=new Array(o),b=new Array(o),y=e==="robust"?l.rNq:l.cNq,C=e==="robust"?l.rNh:l.cNh;for(let E=0;E<o;E++){const k=C[E]+y[E],S=tr(l,e==="robust"?"fdistr":"fdistc",E+1),A=new Array(c),M=new Array(c),N={regular:0,extreme:0,outlier:0,alien:0,external:0},P={in:0,out:0},[I,R]=Sd(S,t[E],s[E],M,A,N,P,a.members),[q,U,D,L,F,B,O,X,Z,G]=Pi(S,k,t[E],s[E],M,A,N,P,a.strangers);f>0&&Pi(S,k,t[E],s[E],M,A,N,P,a.unknown),m[E]=I>0?I/(I+R):0,g[E]=q>0?q/(q+U):0,h[E]=1-D,p[E]=Math.sqrt(m[E]*g[E]),_[E]=I>0&&q>0?(I+q)/(I+q+U+R):0,b[E]=E+1,v[E]={f:S,decs:A,rols:M,decsNum:P,rolsNum:N,TP:I,FN:R,TN:q,FP:U,beta:D,s:L,f0:F,hz:B,Mz:O,Sz:X,k:Z,m:G}}return{class:["simcares"],classes:l.classes,classNames:l.classNames,ind:a,nMembers:d,nStrangers:u,nUnknown:f,v,nrows:l.nrows,stat:{sensitivity:m,specificity:g,selectivity:h,efficiency:p,accuracy:_,components:b}}}function ts(l,e,t,s,a,o){(!o||!Array.isArray(o))&&(o=[]);let c=l.exclvars;(!c||!Array.isArray(c))&&(c=[]);const d=s.values.nrows,u=o.length,f=d-u,v=e.ncomp,m=tr(t.pca,"qdist",v),g=tr(t.pca,"hdist",v),h=e.limType==="classic"?"c":"r",p=tr(t.pca,"fdist"+h,v),_=rt(l,h+"Nh")[v-1],b=rt(l,h+"Nq")[v-1],y=rt(l,h+"h0")[v-1],C=rt(l,h+"q0")[v-1],E=_+b,k=t.simca.v[v-1],S=s.sep,A=t.simca.classes&&t.simca.classes.length===f,M=A?["","","","",""]:["","","",""];let N="";if(N+=["Reference classes:",A?"provided":"not provided",...M].join(S)+`
`,N+=["Number of components:",v,...M].join(S)+`
`,N+=["Alpha:",(e.alpha/100).toFixed(3),...M].join(S)+`
`,N+=["Limits estimator:",e.limType,...M].join(S)+`
`,N+=`
`,N+=["Nh:",_,...M].join(S)+`
`,N+=["Nq:",b,...M].join(S)+`
`,N+=["Nf:",E,...M].join(S)+`
`,N+=`
`,N+=["F crit (extremes):",e.eCrit[v-1],...M].join(S)+`
`,N+=["F crit (outliers):",e.oCrit[v-1],...M].join(S)+`
`,N+=`
`,c.length>0&&(N+=["Number of excluded variables:",c.length,...M].join(S)+`
`,N+=["Indices of excluded variables:",Yf(c),...M].join(S)+`
`,N+=`
`),N+=["Objects:",d,...M].join(S)+`
`,N+=["In:",k.decsNum.in,...M].join(S)+`
`,N+=["Out:",k.decsNum.out,...M].join(S)+`
`,t.simca.nMembers>0&&(N+=`
`,N+=["Members:",t.simca.nMembers,...M].join(S)+`
`,N+=["Regular:",k.rolsNum.regular,...M].join(S)+`
`,N+=["Extreme:",k.rolsNum.extreme,...M].join(S)+`
`,N+=["Outliers:",k.rolsNum.outlier,...M].join(S)+`
`,N+=["Sensitivity:",t.simca.stat.sensitivity[v-1],...M].join(S)+`
`),t.simca.nStrangers>0&&(N+=`
`,N+=["Strangers:",t.simca.nStrangers,...M].join(S)+`
`,N+=["In:",k.decsNum.in-k.rolsNum.regular,...M].join(S)+`
`,N+=["Aliens:",k.rolsNum.alien,...M].join(S)+`
`,N+=["External:",k.rolsNum.external,...M].join(S)+`
`,N+=["Specificity:",t.simca.stat.specificity[v-1],...M].join(S)+`
`,N+=["Selectivity:",t.simca.stat.selectivity[v-1],...M].join(S)+`
`,N+=`
`,N+=["Beta:",k.beta,...M].join(S)+`
`,N+=["Non-centrality, s:",k.s,...M].join(S)+`
`,N+=["Scaling, f0:",k.f0,...M].join(S)+`
`,t.simca.nMembers>0)){const D=k.TP/(k.TP+k.FP),L=t.simca.stat.sensitivity[v-1],F=1-t.simca.stat.specificity[v-1],B=2*D*L/(D+L),O=L/F,X=(1-L)/(1-F);N+=`
`,N+=["Efficiency:",t.simca.stat.efficiency[v-1],...M].join(S)+`
`,N+=["Accuracy:",t.simca.stat.accuracy[v-1],...M].join(S)+`
`,N+=["Precision:",D,...M].join(S)+`
`,N+=["F1-score:",B,...M].join(S)+`
`,N+=["PLR:",O,...M].join(S)+`
`,N+=["NLR:",X,...M].join(S)+`
`}N+=`
`,N+=["","object","class","role","decision","h/h0","q/q0","f"].join(S)+`
`;let P=0;k.rols?k.rols:new Array(d).fill("-");for(let D=0;D<d;D++){if(u>0&&o.includes(D)){N+=["",s.objlabels[D],"-","removed","-","-","-","-"].join(S)+`
`;continue}N+=["",s.objlabels[P],t.pca.classes[P],k.rols[P],k.decs[P],g[P]/y,m[P]/C,p[P]].join(S)+`
`,P=P+1}N+=`
`,s.dec!=="."&&(N=N.replace(/\./g,s.dec)),N=["Target class:",e.className,...M].join(S)+`
`+N,N=["Data filename:",s.fileName,...M].join(S)+`
`+N;let I=["DD-SIMCA results ("+a+")","https://mda.tools/ddsimca/",...M].join(S)+`

`;const R=new Blob([I+N],{type:"text/csv"}),q=window.URL.createObjectURL(R),U=document.createElement("a");U.setAttribute("href",q),U.setAttribute("download",`ddsimca-results-${a}.csv`),U.click()}function oa(l,e,t){t&&(l.prep=t);const s=new Blob([JSON.stringify({pca:l,simca:e},sl)],{type:"application/json"}),a=window.URL.createObjectURL(s),o=document.createElement("a");o.setAttribute("href",a),o.setAttribute("download","ddsimca-model.json"),o.click()}var Cd=K('<span class="item svelte-1ggez3e"> </span>'),Ad=K('<p class="outliers svelte-1ggez3e"><span style="color:#a0a0a0;">Removed:</span> <!></p> <!> <!>',1);function ia(l,e){ge(e,!0);var t=he(),s=J(t);{var a=o=>{oe(o,{children:(c,d)=>{var u=Ad(),f=J(u),v=z(j(f),2);Ye(v,17,()=>e.outliers,Ge,(p,_)=>{var b=Cd(),y=j(b);ae(()=>ve(y,e.dataset.objlabels[r(_)])),T(p,b)});var m=z(f,2);{var g=p=>{Kf(p,{get onclick(){return e.undoOutliers}})};W(m,p=>{e.outliers.length>1&&p(g)})}var h=z(m,2);Mr(h,{get onclick(){return e.resetOutliers}}),T(c,u)},$$slots:{default:!0}})};W(s,o=>{e.dataset&&e.outliers&&e.outliers.length>0&&o(a)})}T(l,t),pe()}const Nd={small:30,medium:40,large:50,xlarge:60},Md={small:5,medium:8,large:12,xlarge:15},Td={small:6,medium:10,large:14,xlarge:18},ca={small:4,medium:6,large:8,xlarge:10},Pd={small:12,medium:15,large:19,xlarge:21},ua={small:11,medium:15,large:17,xlarge:19},al={small:["0","3,3","1,1","3,1,1,1"],medium:["0","5,5","2,2","5,2,2,2"],large:["0","7,7","3,3","7,3,2,3"],xlarge:["0","9,9","4,4","9,3,3,3"]},Fn=["●","◼","▲","▼","⬥","＋","✳","✕"],zd=.8,zi=.5,Ld={small:5,medium:8,large:12,xlarge:15},It={MIDDLEGRAY:"#dadada",DARKGRAY:"#606060",LEGEND:"#303030",PRIMARY:"#2679B2",PRIMARY_TEXT:"#333",CLEGEND_LABELS:"#808080"};function Li(l,e){return Array.isArray(l)&&l.length===e&&!l.some(t=>t===void 0)&&!l.some(t=>isNaN(t))}function Ri(l,e){if(l!=null&&(Array.isArray(l)&&(l=it(l)),!(!We(l)||l.length<1)))return l.apply(t=>ga((t-e[1])*e[0]+e[2])).v}function _t(l,e){return Ri(l,e.coords)}function fa(l,e){return Ri(l,e.objects)}function Ii(l,e){if(l!=null&&(Array.isArray(l)&&(l=it(l)),!(!We(l)||l.length<1)))return l.apply(t=>(t-e[2])/e[0]+e[1]).v}function ji(l,e){return Ii(l,e.coords)}function qi(l,e){return Ii(l,e.objects)}function da(l){return l===0?"":`<tspan>&times;10</tspan><tspan font-size="0.75em" dy="-0.5em">${l.toString()}</tspan>`}function _n(l){if(l===Math.round(l))return l;if(Math.abs(l)>10**6)return Math.round(l);if(Math.abs(l)<10**-6)return l;let e=l.toPrecision(10);return e=e.replace(/\.?0+$/,""),parseFloat(e)}function va(l){if(l===void 0)return[0,void 0];if(l.length<1)return[0,void 0];if(l.length===1)return[0,[l[0].toString()]];let e=_n(Math.abs(In(Yo(l)))),t=0;if(e>=1)return e<100?[0,Array.from(l).map(o=>o.toFixed(0))]:(t=Math.ceil(_n(Math.log10(e)))-2,[t,Array.from(l).map(o=>(o/Math.pow(10,t)).toFixed(0))]);let s=Math.ceil(-_n(Math.log10(e)));return s<=2?[0,Array.from(l).map(a=>a.toFixed(s))]:(t=s-2,s=2,_n(Math.abs(er(l)))<=10?[-t,Array.from(l).map(a=>(a*Math.pow(10,t)).toFixed(s))]:[-t,Array.from(l).map(a=>(a/Math.pow(10,t)).toString())])}function Bt(l,e,t){return Array.isArray(l)&&(l=it(l)),We(l)?l.length<1?(console.error(e+": vector with coordinates is empty."),null):t&&l.length!==t?(console.error(e+": vector does not have the expected length of "+t+"."),null):l:(console.error(e+": coordinates must be provided as array or instance of Vector class."),null)}function ma(l,e,t,s){if(!l||!e||l.length!==e.length)return console.error("val2p: provided coordinate values are not correct."),null;const a=t.coords,o=s.coords;let c="";for(let d=0;d<l.length;d++){const u=ga((l.v[d]-a[1])*a[0]+a[2]),f=ga((e.v[d]-o[1])*o[0]+o[2]);c+=u+","+f+" "}return c}function Fi(l,e){return l?Array.isArray(l)?!e||e.length<1?[null,"tick labels must be accompanied with tick values."]:e.v.length!==l.length?[null,"number of tick labels and values should be the same."]:[l.map(t=>Kr(t)),""]:[null,"tick labels must be provided as array."]:[null,""]}function Oi(l,e){if(Array.isArray(l)&&(l=it(l)),!We(l))return[null,"tick values must be provided as an array or as a vector."];if(l.v.some(c=>isNaN(c)))return[null,"tick values must be numeric"];const t=new Set(l.v);if(l.length!==t.size)return[null,"ticks values must be unique."];const s=e[0]<e[1]?e[0]:e[1],a=e[0]<e[1]?e[1]:e[0],o=l.filter(c=>c>=s&c<=a);return o.length!==l.length?[null,"some of ticks values are outside axis limits."]:[o,""]}function ha(l,e,t,s,a,o){a==null&&(a=!1),o===void 0&&(o=1e-4);const c=e[0]<e[1]?e:[e[1],e[0]];if(l)return l;if(typeof c!="object"||c[0]===void 0||c[1]===void 0){console.error("getAxisTicks: provided axis limits are not valid.");return}const d=Math.abs(c[1]-c[0])*o,u=c[1]-c[0]-2*d,f=Math.floor(Math.log10(u)),v=1/Math.pow(10,f-1),m=Math.round(u*v)/v;let g=Rd(m/t);a&&(Math.abs(c[1]-c[0])<=1?console.error('getAxisTicks: parameter "whole" will be ignored as axis limits are too narrow to fit whole ticks.'):(g<1&&(g=1),g=Math.round(g)));let h=Math.ceil((c[0]+d)/g)*g,p=Math.floor((c[1]-d)/g)*g;Math.abs(c[0]-h)<g/10&&(h=h+g),Math.abs(c[1]-p)<g/10&&(p=p-g),t=Math.ceil(_n((p-h)/g))+1,l=Me.zeros(t);for(let _=0;_<t;_++)l.v[_]=h+g*_;if(Math.abs(g)<1){const _=Math.pow(10,1+Math.round(-Math.log10(g)));l=l.apply(b=>Math.round((b+Number.EPSILON)*_)/_)}return l.filter(_=>_>=c[0]&_<=c[1])}function Rd(l,e){const t=Math.floor(Math.log10(l)),s=l/Math.pow(10,t);let a;return s<=1?a=1:s<=2?a=2:s<=5?a=5:a=10,a*Math.pow(10,t)}function ga(l){return Math.round(l*10)/10}function Id(l,e){return e<300.2||l<400.2?"small":e<400.2||l<700.2?"medium":e<650.2||l<850.2?"large":"xlarge"}function Di(l,e){return l<400.2?"small":l<700.2?"medium":l<900.2?"large":"xlarge"}function jd(){const l=new Int32Array(256);for(let e=0;e<256;e++){let t=e;for(let s=0;s<8;s++)t=t&1?3988292384^t>>>1:t>>>1;l[e]=t}return l}function qd(l){let e=-1,t=jd();for(let s=0;s<l.length;s++)e=t[(e^l[s])&255]^e>>>8;return e^-1}function Fd(l,e){const t=new Uint8Array(13);e*=39.3701,t[0]=112,t[1]=72,t[2]=89,t[3]=115,t[4]=e>>>24,t[5]=e>>>16,t[6]=e>>>8,t[7]=e&255,t[8]=t[4],t[9]=t[5],t[10]=t[6],t[11]=t[7],t[12]=1;const s=qd(t),a=new Uint8Array(4);a[0]=s>>>24,a[1]=s>>>16,a[2]=s>>>8,a[3]=s&255;const o=new Uint8Array(4);o[0]=0,o[1]=0,o[2]=0,o[3]=9;const c=new Uint8Array(54);return c.set(l,0),c.set(o,33),c.set(t,37),c.set(a,50),c}function Od(l,e){const t=l.split(","),s=t[0],a=t[1],o=33/3*4,c=a.substring(0,o),d=a.substring(o),u=atob(c),f=new Uint8Array(u.length);for(let g=0;g<f.length;g++)f[g]=u.charCodeAt(g);const v=Fd(f,e),m=btoa(String.fromCharCode(...v));return[s,",",m,d].join("")}function Dd(l,e,t,s,a){if(t||(t=10),s||(s=10),a||(a=300),t<1||t>30)return console.error('Parameter "width" must be between 1 and 30 (cm).'),null;if(s<1||s>30)return console.error('Parameter "height" must be between 1 and 30 (cm).'),null;if(a<50||a>1200)return console.error('Parameter "res" must be between 50 and 1200 (ppi).'),null;if(!l||!(l instanceof SVGElement))return console.error('Parameter "svg" is not an instance of SVGElement.'),null;(!e||e.trim()==="")&&(e="plot");const o=t/2.54*a,c=s/2.54*a;setTimeout(()=>{const d=l.clientHeight,u=l.clientWidth;let f=Math.max(o/u,c/d),v=1;f<1&&(v=f,f=1);const m=document.createElement("canvas"),g=m.getContext("2d");m.width=u*(v<1?v:f),m.height=d*(v<1?v:f),l.setAttribute("width",u*f),l.setAttribute("height",d*f),g.fillStyle="white",g.fillRect(0,0,m.width,m.height),g.scale(f,f);const h=new XMLSerializer().serializeToString(l),p=new Blob([h],{type:"image/svg+xml;charset=utf-8"}),_=URL.createObjectURL(p),b=new Image;b.onload=function(){v<0&&(b.width=b.width*v,b.height=b.height*v),g.drawImage(b,0,0,m.width,m.height);const y=m.toDataURL("image/png"),C=Od(y,a),E=document.createElement("a");E.href=C,E.download=`${e}.png`,E.click()},b.src=_},20)}function Bd(l,e){if(!l||!(l instanceof SVGElement))return console.error('Variable "svg" is not an instance of SVGElement.'),null;(!e||e.trim()==="")&&(e="plot");const t=l.clientHeight,s=l.clientWidth;l.setAttribute("width",s+"px"),l.setAttribute("height",t+"px"),l.setAttribute("viewBox",`0 0 ${s} ${t}`);const a=new Blob([l.outerHTML],{type:"image/svg+xml"}),o=window.URL.createObjectURL(a),c=document.createElement("a");c.setAttribute("href",o),c.setAttribute("download",`${e}.svg`),c.click()}function Vd(l,e,t,s){const a=l.textContent;navigator.clipboard.write([new ClipboardItem({"image/png":Yd(e,t,s)})]).then(()=>{l.classList.add("copied"),l.textContent="✓ done",setTimeout(()=>{l.classList.remove("copied"),l.textContent=a},500)},o=>{console.error(o),l.classList.add("error"),l.textContent="x copy",setTimeout(()=>{l.classList.remove("error"),l.textContent=a},500)}).catch(o=>console.error(o))}async function Yd(l,e,t){const s=l.clientHeight,a=l.clientWidth,o=Math.max(e/a,t/s),c=document.createElement("canvas"),d=c.getContext("2d");return c.width=a*o,c.height=s*o,d.scale(o,o),l.setAttribute("width",c.width),l.setAttribute("height",c.height),await new Promise((f,v)=>{const m=new XMLSerializer().serializeToString(l),g=new Blob([m],{type:"image/svg+xml;charset=utf-8"}),h=window.URL||window.webkitURL||window,p=h.createObjectURL(g),_=new Image;_.onload=function(){d.drawImage(_,0,0,c.width,c.height),h.revokeObjectURL(p),c.toBlob(function(b){b?f(b):v(new Error("Failed to create blob"))},"image/png")},_.onerror=function(b){v(b)},_.src=p})}function rs(l,e){return l>16&&(l=16),[["#2679B2"],["#2679B2","#D22C2F"],["#2679B2","#92B42A","#D22C2F"],["#2679B2","#2E9658","#F2B825","#D22C2F"],["#2679B2","#22988A","#92B42A","#F79426","#D22C2F"],["#2679B2","#1C9AA8","#379531","#EED524","#FB7F28","#D22C2F"],["#2679B2","#1D94A9","#2E9658","#92B42A","#F2B825","#F47129","#D22C2F"],["#2679B2","#1E90AA","#279775","#519E2F","#D3CB25","#F5A326","#EF672A","#D22C2F"],["#2679B2","#1F8DAB","#22988A","#33953F","#92B42A","#EFCA24","#F79426","#EB5F2A","#D22C2F"],["#2679B2","#208BAC","#1E999A","#2E9658","#5FA32E","#C5C626","#F2B825","#F98827","#E85A2B","#D22C2F"],["#2679B2","#2089AD","#1C9AA8","#29976C","#379531","#92B42A","#EED524","#F4AA26","#FB7F28","#E6552B","#D22C2F"],["#2679B2","#2188AD","#1C97A8","#25987C","#329546","#68A62D","#BCC327","#F0C524","#F69E26","#F77728","#E4512B","#D22C2F"],["#2679B2","#2186AD","#1D94A9","#22988A","#2E9658","#469A2F","#92B42A","#DECF25","#F2B825","#F79426","#F47129","#E34E2C","#D22C2F"],["#2679B2","#2285AE","#1E92AA","#209995","#2A9767","#34953A","#6FA82D","#B5C128","#EFCE24","#F3AD25","#F98C27","#F16B29","#E14B2C","#D22C2F"],["#2679B2","#2284AE","#1E90AA","#1D999F","#279775","#31964A","#519E2F","#92B42A","#D3CB25","#F0C224","#F5A326","#FA8527","#EF672A","#E0492C","#D22C2F"],["#2679B2","#2283AE","#1F8FAB","#1C9AA8","#249880","#2E9658","#379531","#73AA2C","#B0BF28","#EDD424","#F2B825","#F69B26","#FB7F28","#ED632A","#DF472C","#D22C2F"]][l-1]}function Wd(l,e,t,s,a){let o=a.ticks,c=a.tickLabels,d=0;const u=ha(o,l,Md[t.x],!0,a.whole),f=u.length,v=qi([ca[t.plot]],s)[0],m=Me.fill(e[0],f),g=m.add(v),h=Me.fill(e[1],f);if(c||(o?(d=0,c=o.v.map(N=>_n(N).toString())):[d,c]=va(u.v)),!c||c.length!==u.length)return console.error('XAxis: "tickLabels" must be a array of the same size as ticks.'),null;const p=[[u,m],[u,h]],_=[[it([l[0]]),it([e[0]])],[it([l[1]]),it([e[0]])]],b=[[u,g],[u,m]],y=(l[1]-l[0])*.01,C=[[null,null],[[l[1]-(d>9?1:0)*y],[m.v[f-1]]]],E=da(d),k=c.length,S=Math.abs(l[1]>l[0]?l[1]-u.v[k-1]:l[1]-u.v[0]),A=Math.abs(l[1]-l[0]),M=Math.abs(u.v[1]-u.v[0]);if(E.length>0&&S<A*.1&&S<M*.5){const N=l[1]>l[0]?k-1:0;c[N]=" "}return{grid:p,axisLine:_,tickCoords:b,tfCoords:C,ticks:o,tickLabels:c,tickFactor:d,tfLabel:E}}function Ud(l,e,t,s,a){let o=a.ticks,c=a.tickLabels,d=0;const u=ha(a.ticks,e,Td[t.y],!0,a.whole),f=u.length,v=qi([ca[t.plot]],s)[0],m=Me.fill(l[0],f),g=m.add(v),h=Me.fill(l[1],f);if(c||(o?(d=0,c=o.v.map(M=>_n(M).toString())):[d,c]=va(u.v)),c.length!==u.length)return console.error('YAxis: "tickLabels" must be a array of the same size as ticks.'),null;const p=[[m,u],[h,u]],_=[[it([l[0]]),it([e[0]])],[it([l[0]]),it([e[1]])]],b=[[m,u],[g,u]],y=[[[],[]],[[g.v[f-1]+(Math.abs(d)>9?3:2)*v],[e[1]]]],C=da(d),E=c.length,k=Math.abs(e[1]>e[0]?e[1]-u.v[E-1]:e[1]-u.v[0]),S=Math.abs(e[1]-e[0]),A=Math.abs(u.v[1]-u.v[0]);if(C.length>0&&k<S*.1&&k<A*.5){const M=e[1]>e[0]?E-1:0;c[M]=" "}return{grid:p,axisLine:_,tickCoords:b,tfCoords:y,ticks:o,tickLabels:c,tickFactor:d,tfLabel:C}}function Hd(l){if(!l.breaks)return console.error("ColormapLegend: breaks values must be provided."),null;const e=We(l.breaks)?l.breaks.v:l.breaks;if(e.length<2)return console.error("ColormapLegend: incorrect breaks values."),null;if(!l.colmap)return console.error('ColormapLegend: values for "colmap" parameter must be provided.'),null;if(!Array.isArray(l.colmap))return console.error('ColormapLegend: parameter "colmap" must be array with colors.'),null;if(l.colmap.length!==e.length-1)return console.error('ColormapLegend: number of color values in "colmap" does not match number of intervals defined by breaks.'),null;const t=l.colmap;let s,a;if(l.labels?(s=l.labels,a=0):[a,s]=va(e),!(s.length===e.length-1||s.length===e.length))return console.error('ColormapLegend: number of values in "labels" should be equal to or by one less than number of values in "breaks".'),null;const o=s.length===t.length;return{colmap:t,breaks:e,labels:s,isCentered:o,labelsFactor:a,fontSize:l.fontSize,labelColor:l.labelColor}}function Gd(l,e,t,s){const a=l.colmap.length,o=e*zd,c=o/a,d=t[1]+(e-o)*.5,u=Ld[s.y],f=t[2]+u*zi,v=f+u*(1+zi),m=l.isCentered?c/2:0;return{start:d,top:f,height:u,width:c,dxl:m,ltop:v}}function wn(l,e,t){if(!l||!e||!t||typeof t!="function")return;const s=l.target;if(s.tagName===e){const a=Array.prototype.indexOf.call(s.parentNode.children,s);if(a<0)return;t(a),l.stopPropagation()}}function Xd(l,e){const s=document.createElement("canvas").getContext("2d");return s.font=e,s.measureText(l.replace(/<(.|\n)*?>/g,"")).width}function Kd(l,e){const t="Arial",s=e/8,a=e*1.5,o=Array(l.length),c=Array(l.length);let d=0,u=0,f=0;for(let m=0;m<l.length;m++){const g=Xd("  "+l[m].label+"  ",e+"px "+t);f=g>f?g:f;const h=e*l[m].labelHeight+2*s;o[m]=h,c[m]=d,d=d+h,u=u+h}const v=a+2*s+f;return[c,o,a,s,u,v]}function Jd(l,e,t,s,a){const[o,c,d,u,f,v]=Kd(l.items,s*l.fontSize),m=l.position.includes("left")?e[0]+a:l.position.includes("right")?e[1]-v-a:(e[1]+e[0]-v)*.5,g=l.position.includes("top")?t[1]+a:l.position.includes("bottom")?t[0]-f-a:(t[1]+t[0]-f)*.5;return{lgl:m,lgt:g,lgw:v,lgh:f,ely:o,elh:c,elw:d,elp:u}}function Kr(l){if(!l||l.length<1)return l;function e(o){return'<tspan font-size="0.75em" dy="-0.5em">'+o+'</tspan><tspan dy="0.4em"> </tspan>'}function t(o){return'<tspan font-size="0.75em" dy="0.5em">'+o+'</tspan><tspan dy="-0.4em"> </tspan>'}let s=0,a="";for(;s<l.length;){const o=l[s];if((o==="^"||o==="_")&&s<l.length-1){const c=o==="^";if(s++,l[s]==="("){let d=s+1;for(;d<l.length&&l[d]!==")";)d++;const u=l.slice(s+1,d);a+=c?e(u):t(u),s=d+1}else if(l[s]==="-"||l[s]==="–"){const d=l.slice(s,s+2);a+=c?e(d):t(d),s=s+2}else a+=c?e(l[s]):t(l[s]),s++}else a+=o,s++}return a}var Qd=Ce('<line vector-effect="non-scaling-stroke"></line>'),Zd=Ce("<g></g>");function pa(l,e){ge(e,!0);let t=Y(e,"lineCoords",19,()=>[]),s=Y(e,"lineColor",19,()=>It.DARKGRAY),a=Y(e,"lineType",3,1),o=Y(e,"lineWidth",3,1),c=Y(e,"className",3,"");const d=Yt("axes");let u=w(()=>_t(t()[0][0],d.tX())),f=w(()=>_t(t()[1][0],d.tX())),v=w(()=>_t(t()[0][1],d.tY())),m=w(()=>_t(t()[1][1],d.tY())),g=w(()=>`stroke:${s()};stroke-width: ${o()}px;stroke-dasharray:${al[d.scales().plot][a()-1]}`);var h=he(),p=J(h);{var _=b=>{var y=Zd();Ye(y,21,()=>r(u),Ge,(C,E,k)=>{var S=Qd();ae(()=>{H(S,"x1",r(u)[k]),H(S,"x2",r(f)[k]),H(S,"y1",r(v)[k]),H(S,"y2",r(m)[k]),bt(S,r(g))}),T(C,S)}),ae(()=>pt(y,0,Bu(c()))),T(b,y)};W(p,b=>{r(u)&&r(v)&&r(f)&&b(_)})}T(l,h),pe()}var $d=Ce('<text text-anchor="middle"><!></text>'),ev=Ce("<text><!></text>"),tv=Ce("<text><!></text>"),rv=Ce('<g class="tick-labels"><!></g>');function Bi(l,e){ge(e,!0);let t=Y(e,"pos",3,1),s=Y(e,"las",3,1),a=w(()=>["middle","middle","start","middle","end"][t()]),o=w(()=>`fill:${e.textColor};`);const c=Yt("axes");let d=w(()=>_t(e.tickCoords[1][0],c.tX())),u=w(()=>_t(e.tickCoords[1][1],c.tY())),f=w(()=>ua[c.scales().plot]),v=w(()=>[0,0,r(f),0,-r(f)][t()]),m=w(()=>[0,r(f),0,-r(f),0][t()]);var g=rv(),h=j(g);{var p=b=>{var y=he(),C=J(y);Ye(C,17,()=>r(d),Ge,(E,k,S)=>{var A=$d();H(A,"data-id",S),H(A,"dx",0);var M=j(A);Tt(M,()=>e.tickLabels[S],!0),ae(()=>{H(A,"x",r(d)[S]),H(A,"y",r(u)[S]),H(A,"dy",r(v)*1.25),H(A,"transform",`rotate(-90, ${r(d)[S]}, ${r(u)[S]})`)}),T(E,A)}),T(b,y)},_=b=>{var y=he(),C=J(y);{var E=S=>{var A=he(),M=J(A);Ye(M,17,()=>r(d),Ge,(N,P,I)=>{var R=ev();H(R,"data-id",I),H(R,"dy",0),H(R,"text-anchor","end");var q=j(R);Tt(q,()=>e.tickLabels[I],!0),ae(()=>{H(R,"x",r(d)[I]),H(R,"y",r(u)[I]),H(R,"dx",-r(m)/2),H(R,"transform",`rotate(-90, ${r(d)[I]}, ${r(u)[I]})`)}),T(N,R)}),T(S,A)},k=S=>{var A=he(),M=J(A);Ye(M,17,()=>r(d),Ge,(N,P,I)=>{var R=tv();H(R,"data-id",I);var q=j(R);Tt(q,()=>e.tickLabels[I],!0),ae(()=>{H(R,"x",r(d)[I]),H(R,"y",r(u)[I]),H(R,"dx",r(v)),H(R,"dy",r(m)),H(R,"text-anchor",r(a))}),T(N,R)}),T(S,A)};W(C,S=>{s()===2&&t()===1?S(E):S(k,!1)},!0)}T(b,y)};W(h,b=>{s()===2&&t()===4?b(p):b(_,!1)})}ae(()=>bt(g,r(o))),T(l,g),pe()}const nv=(l,e=xt,t=xt)=>{var s=uv();const a=w(()=>e().colmap.length);var o=J(s);Ye(o,17,()=>e().colmap,Ge,(v,m,g)=>{var h=ov();const p=w(()=>t().start+g*t().width);var _=J(h),b=z(_);H(b,"dy",0);var y=j(b);Tt(y,()=>e().labels[g],!0),ae(()=>{H(_,"x",r(p)),H(_,"y",t().top),H(_,"width",t().width),H(_,"height",t().height),H(_,"fill",r(m)),H(b,"x",r(p)),H(b,"y",t().ltop),H(b,"dx",t().dxl),H(b,"fill",e().labelColor),H(b,"font-size",e().fontSize+"em")}),T(v,h)});var c=z(o);{var d=v=>{var m=iv();const g=w(()=>t().start+r(a)*t().width);H(m,"dx",0),H(m,"dy",0);var h=j(m);Tt(h,()=>e().labels[r(a)],!0),ae(()=>{H(m,"x",r(g)),H(m,"y",t().ltop),H(m,"fill",e().labelColor),H(m,"font-size",`${e().fontSize??""}em`)}),T(v,m)};W(c,v=>{e().isCentered||v(d)})}var u=z(c);{var f=v=>{var m=cv();const g=w(()=>t().start+r(a)*t().width);var h=j(m);Tt(h,()=>da(e().labelsFactor),!0),ae(()=>{H(m,"x",r(g)),H(m,"y",t().ltop),H(m,"fill",e().labelColor),H(m,"font-size",`${e().fontSize??""}em`)}),T(v,m)};W(u,v=>{e().labelsFactor!==0&&v(f)})}T(l,s)};function Vi(l,e,t){l.preventDefault(),e(l,t())}function Yi(l,e,t){l.preventDefault(),e(l,t())}function Wi(l,e,t){l.preventDefault(),e(l,t())}function ns(l,e,t){l.preventDefault(),e(l,t())}async function Ui(l,e,t,s){Vd(l.target,r(e),t(),s())}function Hi(l,e,t){Bd(r(e),t())}function Gi(l,e,t,s,a,o){Dd(r(e),t(),s(),a(),o())}var lv=Ce('<text fill="crimson" text-anchor="middle"> </text>'),sv=Ce('<text dy="10px" fill="crimson" text-anchor="middle" dominant-baseline="hanging"> </text>'),av=Ce("<!><!><!><!><!>",1),ov=Ce('<rect></rect><text dominant-baseline="hanging" text-anchor="middle"><!></text>',1),iv=Ce('<text dominant-baseline="hanging" text-anchor="middle"><!></text>'),cv=Ce('<text dx="1.2em" dy="-0.25em" dominant-baseline="hanging" text-anchor="right"><!></text>'),uv=Ce("<!><!><!>",1),fv=Ce("<line></line>"),dv=Ce('<text dominant-baseline="middle" text-anchor="middle"> </text>'),vv=Ce('<svg><!><!><text class="legend-text" xml:space="preserve" dominant-baseline="middle" text-anchor="start"><!></text></svg>'),mv=Ce('<svg><rect height="100%" width="100%"></rect><!></svg>'),hv=Ce('<text dominant-baseline="middle" style="font-size:1.1em;"><!></text>'),gv=Ce('<text dominant-baseline="middle" style="font-size:1.1em;"><!></text>'),pv=Ce('<text dominant-baseline="middle" style="font-size:1.2em;"><!></text>'),bv=Ce('<g class="plot-labels"><!><!><!></g>'),_v=Ce('<g class="axis x-axis"><!></g>'),wv=Ce('<g class="axis y-axis"><!></g>'),yv=Ce('<rect fill="transparent" id="axes-box"></rect>'),xv=Ce('<rect stroke="transparent" fill="transparent" id="axes-box"></rect>'),kv=Ce('<g class="colormap-legend" style="stroke:0;stroke-width:0px;"><!></g>'),Ev=Ce('<g class="group-legend" style="stroke:0;stroke-width:0px;"><!></g>'),Sv=Ce('<!><!><g class="axes-box"><!></g><g class="axes-content svelte-1jtdxd0"><!></g><!><!>',1),Cv=K('<p class="message-error svelte-1jtdxd0">Axes component was not properly initialized. <br/> Check that you defined axes limits and margins correctly.</p>'),Av=K('<div class="download-links svelte-1jtdxd0"><button class="svelte-1jtdxd0">⇩ svg</button> <button class="svelte-1jtdxd0">⇩ png</button> <button class="svelte-1jtdxd0">⧉ copy</button></div>'),Nv=K(`<div><svg class="plot svelte-1jtdxd0" xmlns="http://www.w3.org/2000/svg"><style>.plot {
            font-family: Arial, Helvetica, sans-serif;
         }

         .plot-labels text {
            font-weight:bold;
            text-anchor:middle;
            user-select: none;
         }

         .series-points text {
            /* dominant-baseline: central;
            alignment-baseline: central */
         }

         .tick-labels text,
         .tick-labels tspan,
         .series-textlabels text,
         .series-textlabels tspan,
         .series-text text,
         .series-text tspan {
            dominant-baseline: middle;
            cursor: default;
            user-select: none;
            -webkit-user-select: none;
         }


         .colormap-legend text,
         .colormap-legend tspan,
         .series-points text,
         .series-points tspan {
            cursor: default;
            user-select: none;
            -webkit-user-select: none;
         }

         .series-points1 text,
         .series-points1 tspan {
            dominant-baseline: middle;
            alignment-baseline: middle;
         }

         .series-points2 text,
         .series-points2 tspan {
            dominant-baseline: central;
            alignment-baseline: central;
         }

         .series-text text,
         .series-text tspan {
            dominant-baseline: middle;
            alignment-baseline: middle;
            text-anchor: middle;
            user-select: none;
            -webkit-user-select: none;
         }

         .tick-labels text,
         .tick-labels tspan {
            user-select: none;
            -webkit-user-select: none;
         }</style><!><svg preserveAspectRatio="none" class="axes"><defs><clipPath><rect></rect></clipPath></defs><!></svg></svg> <!></div>`);function Xi(l,e){ge(e,!0);const t=(Le,Te=xt,Ne=xt)=>{var Ie=he(),Et=J(Ie);{var _r=Xt=>{var st=he(),Ze=J(st);{var jt=wt=>{var ft=lv(),fr=j(ft);ae(()=>{H(ft,"x",r(te)[0]-10),H(ft,"y",r($)),H(ft,"transform",`rotate(-90, ${r(te)[0]-10}, ${r($)})`),ve(fr,Ne().error)}),T(wt,ft)},St=wt=>{var ft=sv(),fr=j(ft);ae(()=>{H(ft,"x",r(le)),H(ft,"y",r(se)[0]),ve(fr,Ne().error)}),T(wt,ft)};W(Ze,wt=>{Ne().pos===4?wt(jt):wt(St,!1)})}T(Xt,st)},Vt=Xt=>{var st=av(),Ze=J(st);{var jt=Ae=>{pa(Ae,{get lineCoords(){return Te().grid},get lineColor(){return It.MIDDLEGRAY},lineType:3})};W(Ze,Ae=>{Ne().showGrid&&Ae(jt)})}var St=z(Ze);pa(St,{get lineCoords(){return Te().axisLine},get lineColor(){return It.DARKGRAY},lineType:1});var wt=z(St);pa(wt,{get lineCoords(){return Te().tickCoords},get lineColor(){return It.DARKGRAY},lineType:1});var ft=z(wt);{var fr=Ae=>{Bi(Ae,{get las(){return Ne().las},get pos(){return Ne().pos},get tickCoords(){return Te().tickCoords},get tickLabels(){return Te().tickLabels},get tickColor(){return It.DARKGRAY},get hideLast(){return Ne().hideLast}})};W(ft,Ae=>{Te().tickCoords.length===2&&Te().tickLabels.length===Te().tickCoords[1][0].length&&Ae(fr)})}var kn=z(ft);{var nt=Ae=>{{let qt=w(()=>[Te().tfLabel]);Bi(Ae,{get pos(){return Ne().pos},get tickCoords(){return Te().tfCoords},get tickLabels(){return r(qt)},get textColor(){return It.DARKGRAY}})}};W(kn,Ae=>{Te().tickFactor!==0&&Ae(nt)})}T(Xt,st)};W(Et,Xt=>{Ne().error?Xt(_r):Xt(Vt,!1)})}T(Le,Ie)},s=(Le,Te=xt,Ne=xt)=>{var Ie=mv();const Et=w(()=>Ne().elw+2*Ne().elp),_r=w(()=>Ne().elp),Vt=w(()=>Ne().elh),Xt=w(()=>Ne().ely);var st=j(Ie),Ze=z(st);Ye(Ze,17,()=>Te().items,Ge,(jt,St,wt)=>{var ft=vv();H(ft,"x",0);var fr=j(ft);{var kn=zr=>{var Ct=fv();ae(()=>{H(Ct,"x1",r(_r)),H(Ct,"x2",r(Et)-r(_r)),H(Ct,"y1",r(Vt)[wt]/2),H(Ct,"y2",r(Vt)[wt]/2),H(Ct,"stroke",r(St).line.lineColor),H(Ct,"stroke-width",r(St).line.lineWidth),H(Ct,"stroke-dasharray",r(R)[r(St).line.lineType-1])}),T(zr,Ct)};W(fr,zr=>{r(St).line&&zr(kn)})}var nt=z(fr);{var Ae=zr=>{var Ct=dv(),us=j(Ct);ae(()=>{H(Ct,"x",r(Et)/2),H(Ct,"y",r(Vt)[wt]/2),H(Ct,"fill",r(St).point.faceColor),H(Ct,"stroke-width",r(St).point.lineWidth),H(Ct,"stroke",r(St).point.lineColor),H(Ct,"font-size",`${r(St).point.markerSize??""}em`),ve(us,Fn[r(St).point.marker-1])}),T(zr,Ct)};W(nt,zr=>{r(St).point&&zr(Ae)})}var qt=z(nt),La=j(qt);Tt(La,()=>r(St).label,!0),ae(()=>{H(ft,"y",r(Xt)[wt]),H(ft,"width",Ne().lgw),H(ft,"height",r(Vt)[wt]),H(qt,"x",r(Et)+r(_r)),H(qt,"y",r(Vt)[wt]/2),H(qt,"fill",It.LEGEND),H(qt,"font-size",`${Te().fontSize??""}em`)}),T(jt,ft)}),ae(()=>{H(Ie,"x",Ne().lgl),H(Ie,"y",Ne().lgt),H(Ie,"height",Ne().lgh),H(Ie,"width",Ne().lgw),H(st,"fill",Te().faceColor),H(st,"stroke",Te().lineColor),H(st,"stroke-width",Te().lineWidth)}),T(Le,Ie)};let a=Y(e,"limX",19,()=>[0,1]),o=Y(e,"limY",19,()=>[0,1]),c=Y(e,"margins",19,()=>[1,1.1,.55,.6]),d=Y(e,"downloadLinks",3,"none"),u=Y(e,"fileName",3,"plot"),f=Y(e,"pngWidth",3,8),v=Y(e,"pngHeight",3,8),m=Y(e,"pngRes",3,300),g=Y(e,"clipboardWidth",3,1200),h=Y(e,"clipboardHeight",3,800),p=Y(e,"onclick",3,null),_=Y(e,"onmousemove",3,null),b=Y(e,"onmousedown",3,null),y=Y(e,"onmouseup",3,null);function C(Le,Te){if(Te&&Le.target.id=="axes-box"){const Ne=ji([Le.offsetX-r(U)],r(Z))[0],Ie=ji([Le.offsetY-r(D)],r(G))[0];Te(Ne,Ie)}}const E="plottingArea"+Math.round(Math.random()*1e4);let k=ne(0),S=ne(0),A=ne(0);const M=w(()=>({plot:Id(r(S),r(A)),x:Di(r(S)),y:Di(r(A))})),N=w(()=>c().map(Le=>Le*Nd[r(M).plot])),P=w(()=>Pd[r(M).plot]),I=w(()=>ca[r(M).plot]),R=w(()=>al[r(M).plot]),q=w(()=>r(de).show&&r(de).label!==""?r(P)*1.5:0),U=w(()=>r(ye).show&&r(ye).label!==""?r(P)*1.5:0),D=w(()=>e.title&&e.title!==""?r(P)*1.5:0),L=w(()=>r(S)>r(U)?r(S)-r(U):0),F=w(()=>r(A)>r(q)+r(D)?r(A)-r(q)-r(D):0),B=w(()=>r(F)-r(N)[0]-r(N)[2]),O=w(()=>r(L)-r(N)[1]-r(N)[3]),X=w(()=>Li(a(),2)&&Li(o(),2)&&r(L)>r(N)[1]+r(N)[3]&&r(F)>r(N)[0]+r(N)[2]),Z=w(()=>r(X)?{coords:[r(O)/(a()[1]-a()[0]),a()[0],r(N)[1]],objects:[r(O)/(a()[1]-a()[0]),0,0]}:{coords:[1,0,0],objects:[1,0,0]}),G=w(()=>r(X)?{coords:[-r(B)/(o()[1]-o()[0]),o()[1],r(N)[2]],objects:[r(B)/(o()[1]-o()[0]),0,0]}:{coords:[0,1,0],objects:[0,1,0]}),$=w(()=>r(B)*.5+r(D)+r(N)[2]),le=w(()=>r(O)*.5+r(U)+r(N)[1]),te=w(()=>r(X)?_t(a(),r(Z)):[0,1]),se=w(()=>r(X)?_t(o(),r(G)):[1,0]),_e=w(()=>Kr(e.title)),Se=w(()=>r(_e)?r(_e).length===e.title.left?1:1.4:0);let xe=ne(Re({show:!1})),de=ne(Re({show:!1,error:""})),ye=ne(Re({show:!1,error:""})),me=ne(Re({show:!1,colmap:null,breaks:null})),ee=ne(Re({show:!1,items:null,position:null}));const ie=w(()=>r(X)&&r(me)&&r(me).show?Hd(r(me)):null),ue=w(()=>r(X)&&r(de).show?Wd(a(),o(),r(M),r(G),r(de)):null),be=w(()=>r(X)&&r(ye).show?Ud(a(),o(),r(M),r(Z),r(ye)):null),fe=w(()=>r(X)&&r(ie)?Gd(r(ie),r(O),r(N),r(M)):null),ke=w(()=>r(X)&&r(ee)&&r(ee).show&&r(te)?Jd(r(ee),r(te),r(se),r(P),r(I)):null);lu("axes",{setBox:Le=>V(xe,Le,!0),setXAxis:Le=>V(de,Le,!0),setYAxis:Le=>V(ye,Le,!0),setColmapLegend:Le=>V(me,Le,!0),setGroupLegend:Le=>V(ee,Le,!0),scales:()=>r(M),tX:()=>r(Z),tY:()=>r(G),limX:()=>a(),limY:()=>o()});var De=Nv();let Ue;var He=j(De),Ke=z(j(He));{var gt=Le=>{var Te=bv(),Ne=j(Te);{var Ie=st=>{var Ze=hv();H(Ze,"dx",0),H(Ze,"dy",0);var jt=j(Ze);Tt(jt,()=>r(de).label,!0),ae(()=>{H(Ze,"x",r(le)),H(Ze,"y",r(F)+r(D))}),T(st,Ze)};W(Ne,st=>{r(de).show&&r(de).label&&r(de).label!==""&&st(Ie)})}var Et=z(Ne);{var _r=st=>{var Ze=gv();H(Ze,"dx",0),H(Ze,"dy",0);var jt=j(Ze);Tt(jt,()=>r(ye).label,!0),ae(()=>{H(Ze,"x",r(P)/1.1*r(ye).labelHeight),H(Ze,"y",r($)),H(Ze,"transform",`rotate(-90, ${r(P)*r(ye).labelHeight/1.1}, ${r($)})`)}),T(st,Ze)};W(Et,st=>{r(ye).show&&r(ye).label&&r(ye).label!==""&&st(_r)})}var Vt=z(Et);{var Xt=st=>{var Ze=pv();H(Ze,"dx",0),H(Ze,"dy",0);var jt=j(Ze);Tt(jt,()=>r(_e),!0),ae(()=>{H(Ze,"x",r(le)),H(Ze,"y",r(P)*r(Se))}),T(st,Ze)};W(Vt,st=>{r(_e)&&r(_e)!==""&&st(Xt)})}T(Le,Te)};W(Ke,Le=>{r(X)&&Le(gt)})}var et=z(Ke),qe=j(et),Fe=j(qe),Ee=j(Fe),ze=z(qe);{var Pe=Le=>{var Te=Sv(),Ne=J(Te);{var Ie=nt=>{var Ae=_v(),qt=j(Ae);t(qt,()=>r(ue),()=>r(de)),T(nt,Ae)};W(Ne,nt=>{r(de).show&&r(ue)&&nt(Ie)})}var Et=z(Ne);{var _r=nt=>{var Ae=wv(),qt=j(Ae);t(qt,()=>r(be),()=>r(ye)),T(nt,Ae)};W(Et,nt=>{r(ye).show&&r(be)&&nt(_r)})}var Vt=z(Et),Xt=j(Vt);{var st=nt=>{var Ae=yv();Ae.__keydown=[ns,C,p],Ae.__click=[ns,C,p],Ae.__mousemove=[Wi,C,_],Ae.__mousedown=[Vi,C,b],Ae.__mouseup=[Yi,C,y],ae(()=>{H(Ae,"stroke",r(xe).lineColor),H(Ae,"stroke-width",`${r(xe).lineWidth??""}px`),H(Ae,"x",r(te)[0]),H(Ae,"y",r(se)[1]),H(Ae,"width",r(te)[1]-r(te)[0]),H(Ae,"height",r(se)[0]-r(se)[1])}),T(nt,Ae)},Ze=nt=>{var Ae=xv();Ae.__keydown=[ns,C,p],Ae.__click=[ns,C,p],Ae.__mousemove=[Wi,C,_],Ae.__mousedown=[Vi,C,b],Ae.__mouseup=[Yi,C,y],ae(()=>{H(Ae,"x",r(te)[0]),H(Ae,"y",r(se)[1]),H(Ae,"width",r(te)[1]-r(te)[0]),H(Ae,"height",r(se)[0]-r(se)[1])}),T(nt,Ae)};W(Xt,nt=>{r(xe).show?nt(st):nt(Ze,!1)})}var jt=z(Vt),St=j(jt);Rr(St,()=>e.children??xt);var wt=z(jt);{var ft=nt=>{var Ae=kv(),qt=j(Ae);nv(qt,()=>r(ie),()=>r(fe)),T(nt,Ae)};W(wt,nt=>{r(fe)&&nt(ft)})}var fr=z(wt);{var kn=nt=>{var Ae=Ev(),qt=j(Ae);s(qt,()=>r(ee),()=>r(ke)),T(nt,Ae)};W(fr,nt=>{r(ke)&&nt(kn)})}ae(()=>H(jt,"clip-path",`url(#${E})`)),T(Le,Te)};W(ze,Le=>{r(X)&&Le(Pe)})}hn(He,Le=>V(k,Le),()=>r(k));var Mt=z(He,2);{var pl=Le=>{var Te=Cv();T(Le,Te)},bl=Le=>{var Te=Av(),Ne=j(Te);Ne.__click=[Hi,k,u],Ne.__keydown=[Hi,k,u];var Ie=z(Ne,2);Ie.__click=[Gi,k,u,f,v,m],Ie.__keydown=[Gi,k,u,f,v,m];var Et=z(Ie,2);Et.__click=[Ui,k,g,h],Et.__keydown=[Ui,k,g,h],T(Le,Te)};W(Mt,Le=>{r(X)?Le(bl,!1):Le(pl)})}ae(Le=>{Ue=pt(De,1,`plot-container show-download-links-${d()??""}`,"svelte-1jtdxd0",Ue,Le),bt(He,`font-size:${r(P)??""}px`),H(et,"x",r(U)),H(et,"y",r(D)),H(et,"width",r(L)),H(et,"height",r(F)),H(Fe,"id",E),H(Ee,"x",r(te)[0]),H(Ee,"y",r(se)[1]),H(Ee,"width",r(te)[1]-r(te)[0]),H(Ee,"height",r(se)[0]-r(se)[1])},[()=>({"plot-error":!r(X)})]),Oo(He,"clientWidth",Le=>V(S,Le)),Oo(He,"clientHeight",Le=>V(A,Le)),T(l,De),pe()}vt(["keydown","click","mousemove","mousedown","mouseup"]);function Ki(l,e){ge(e,!0);let t=Y(e,"tickLabels",7),s=Y(e,"las",3,1),a=Y(e,"whole",3,!1),o=Y(e,"show",3,!0),c=Y(e,"showGrid",3,!1);const d=Yt("axes");ce(()=>{const u=Kr(e.label),f=u?u.length===e.label.length?1:1.4:0;let v,m="";e.ticks&&([v,m]=Oi(e.ticks,d.limX())),!m&&t()&&(g=>{var h=ms(g,2);t(h[0]),m=h[1]})(Fi(t(),v)),d.setXAxis({show:o(),error:m,label:u,ticks:v,labelHeight:f,showGrid:c(),las:s(),whole:a(),tickLabels:t()})}),pe()}function Ji(l,e){ge(e,!0);let t=Y(e,"tickLabels",7),s=Y(e,"las",3,1),a=Y(e,"whole",3,!1),o=Y(e,"show",3,!0),c=Y(e,"showGrid",3,!1);const d=Yt("axes");ce(()=>{const u=Kr(e.label),f=u?u.length===e.label.length?1:1.4:0;let v,m="";e.ticks&&([v,m]=Oi(e.ticks,d.limY())),!m&&t()&&(g=>{var h=ms(g,2);t(h[0]),m=h[1]})(Fi(t(),v)),d.setYAxis({show:o(),error:m,label:u,ticks:v,labelHeight:f,showGrid:c(),las:s(),whole:a(),tickLabels:t(),pos:4})}),pe()}function Qi(l,e){ge(e,!0);let t=Y(e,"lineWidth",3,1),s=Y(e,"lineColor",3,"#606060");const a=Yt("axes");ce(()=>{a.setBox({show:!0,lineWidth:t(),lineColor:s()})}),pe()}var Mv=(l,e)=>wn(l,"rect",e.onclick),Tv=Ce("<rect></rect>"),Pv=Ce("<g></g>");function ol(l,e){ge(e,!0);let t=Y(e,"faceColor",19,()=>It.PRIMARY),s=Y(e,"lineColor",19,t),a=Y(e,"lineWidth",3,1),o=Y(e,"className",3,"series-rect");const c=w(()=>Bt(e.left,"Rectangles (left)")),d=w(()=>r(c)?Bt(e.top,"Rectangles (top)",r(c).length):null),u=w(()=>r(d)?typeof e.width!="object"?Me.fill(e.width,r(c).length):e.width:null),f=w(()=>r(d)?typeof e.height!="object"?Me.fill(e.height,r(c).length):e.height:null),v=Yt("axes"),m=w(()=>r(c)?_t(r(c),v.tX()):null),g=w(()=>r(d)?_t(r(d),v.tY()):null),h=w(()=>r(u)?fa(r(u),v.tX()):null),p=w(()=>r(f)?fa(r(f),v.tY()):null),_=w(()=>`fill:${t()};stroke:${s()};stroke-width:${a()}px;`),b=w(()=>r(m)&&r(g)&&r(h)&&r(p)&&r(h).length===r(m).length&&r(p).length===r(m).length);var y=he(),C=J(y);{var E=k=>{var S=Pv();S.__click=[Mv,e],Ye(S,21,()=>e.left,Ge,(A,M,N)=>{var P=Tv();ae(()=>{H(P,"x",r(m)[N]),H(P,"y",r(g)[N]),H(P,"width",r(h)[N]),H(P,"height",r(p)[N])}),T(A,P)}),ae(()=>{pt(S,0,`series ${o()??""}`),bt(S,r(_))}),T(k,S)};W(C,k=>{r(b)&&k(E)})}T(l,y),pe()}vt(["click"]);var zv=(l,e)=>wn(l,"line",e.onclick),Lv=Ce("<line></line>"),Rv=Ce('<g class="series series-segment"></g>');function pr(l,e){ge(e,!0);let t=Y(e,"lineColor",19,()=>It.PRIMARY),s=Y(e,"lineType",3,1),a=Y(e,"lineWidth",3,1);const o=w(()=>Bt(e.xStart,"Segments")),c=w(()=>r(o)?Bt(e.yStart,"Segments",r(o).length):null),d=w(()=>r(c)?Bt(e.xEnd,"Segments",r(o).length):null),u=w(()=>r(d)?Bt(e.yEnd,"Segments",r(o).length):null),f=Yt("axes"),v=w(()=>r(o)?_t(r(o),f.tX()):null),m=w(()=>r(d)?_t(r(d),f.tX()):null),g=w(()=>r(c)?_t(r(c),f.tY()):null),h=w(()=>r(u)?_t(r(u),f.tY()):null),p=w(()=>`stroke:${t()};stroke-width: ${a()}px;stroke-dasharray:${al[f.scales().plot][s()-1]}`),_=w(()=>r(v)&&r(m)&&r(g)&&r(h));var b=he(),y=J(b);{var C=E=>{var k=Rv();k.__click=[zv,e],Ye(k,21,()=>r(v),Ge,(S,A,M)=>{var N=Lv();ae(()=>{H(N,"x1",r(v)[M]),H(N,"x2",r(m)[M]),H(N,"y1",r(g)[M]),H(N,"y2",r(h)[M])}),T(S,N)}),ae(()=>bt(k,r(p))),T(E,k)};W(y,E=>{r(_)&&E(C)})}T(l,b),pe()}vt(["click"]);var Iv=(l,e)=>wn(l,"text",e.onclick),jv=Ce("<text><!></text>"),qv=Ce("<text><!></text>"),Fv=Ce("<text><!></text>"),Ov=Ce('<g class="series series-textlabels"><!></g>');function ls(l,e){ge(e,!0);let t=Y(e,"pos",3,0),s=Y(e,"faceColor",19,()=>It.PRIMARY_TEXT),a=Y(e,"lineColor",3,"transparent"),o=Y(e,"lineWidth",3,0),c=Y(e,"textSize",3,1),d=Y(e,"rotateAngle",3,0);const u=["middle","middle","start","middle","end"],f=w(()=>Bt(e.xValues,"TextLabels")),v=w(()=>r(f)?Bt(e.yValues,"TextLabels",r(f).length):null),m=w(()=>r(v)?Array.isArray(e.labels)&&e.labels.length!==r(v).length?(console.error('TextLabels: number of elements in "labels" does not match number of coordinates'),null):e.labels:null),g=w(()=>r(m)?typeof e.labels=="string"&&typeof t()!="number"?(console.error('TextLabels: parameter "labels" is provided as single string, so "pos" must be a single number.'),null):t():null),h=Yt("axes"),p=w(()=>r(f)&&r(g)!==null?_t(r(f),h.tX()):null),_=w(()=>r(v)&&r(p)?_t(r(v),h.tY()):null),b=w(()=>ua[h.scales().plot]),y=w(()=>[0,0,-r(b),0,r(b),r(b)]),C=w(()=>[0,r(b),0,-r(b),0,r(b)]),E=w(()=>`fill:${s()};stroke-width:${o()}px;stroke:${a()};font-size:${c()}em;`),k=w(()=>r(p)&&r(_)&&r(g)!==null&&r(m)&&r(p).length===r(_).length);var S=he(),A=J(S);{var M=N=>{var P=Ov();P.__click=[Iv,e];var I=j(P);{var R=U=>{var D=he(),L=J(D);Ye(L,17,()=>r(p),Ge,(F,B,O)=>{var X=jv();H(X,"data-id",O);var Z=j(X);Tt(Z,()=>e.labels,!0),ae(()=>{H(X,"x",r(p)[O]),H(X,"y",r(_)[O]),H(X,"dx",r(y)[t()]),H(X,"dy",r(C)[t()]),H(X,"transform",d()!==void 0?`rotate(${d()}, ${r(p)[O]+r(y)[t()]}, ${r(_)[O]+r(C)[t()]})`:""),H(X,"text-anchor",u[t()[O]])}),T(F,X)}),T(U,D)},q=U=>{var D=he(),L=J(D);{var F=O=>{var X=he(),Z=J(X);Ye(Z,17,()=>r(p),Ge,(G,$,le)=>{var te=qv();H(te,"data-id",le);var se=j(te);Tt(se,()=>e.labels[le],!0),ae(()=>{H(te,"x",r(p)[le]),H(te,"y",r(_)[le]),H(te,"dx",r(y)[t()[le]]),H(te,"dy",r(C)[t()[le]]),H(te,"transform",d()!==void 0?`rotate(${d()}, ${r(p)[le]+r(y)[t()]}, ${r(_)[le]+r(C)[t()]})`:""),H(te,"text-anchor",u[t()[le]])}),T(G,te)}),T(O,X)},B=O=>{var X=he(),Z=J(X);Ye(Z,17,()=>r(p),Ge,(G,$,le)=>{var te=Fv();H(te,"data-id",le);var se=j(te);Tt(se,()=>e.labels[le],!0),ae(()=>{H(te,"x",r(p)[le]),H(te,"y",r(_)[le]),H(te,"dx",r(y)[t()]),H(te,"dy",r(C)[t()]),H(te,"transform",d()!==void 0?`rotate(${d()}, ${r(p)[le]+r(y)[t()]}, ${r(_)[le]+r(C)[t()]})`:""),H(te,"text-anchor",u[t()])}),T(G,te)}),T(O,X)};W(L,O=>{Array.isArray(t())||ArrayBuffer.isView(t())?O(F):O(B,!1)},!0)}T(U,D)};W(I,U=>{typeof e.labels=="string"?U(R):U(q,!1)})}ae(()=>bt(P,r(E))),T(N,P)};W(A,N=>{r(k)&&N(M)})}T(l,S),pe()}vt(["click"]),vt(["click"]);var Dv=(l,e)=>wn(l,"text",e.onclick),Bv=Ce("<text> </text>"),Vv=Ce('<g text-anchor="middle"></g>');function Zi(l,e){ge(e,!0);let t=Y(e,"marker",3,1),s=Y(e,"faceColor",3,"transparent"),a=Y(e,"lineColor",19,()=>It.PRIMARY),o=Y(e,"lineWidth",3,1),c=Y(e,"markerSize",3,1);const d=w(()=>typeof t()!="number"||t()<1||t()>Fn.length?(console.error('Points: parameter "marker" must be a number from 1 to '+Fn.length+"."),null):Fn[t()-1]),u=w(()=>Bt(e.xValues,"Points")),f=w(()=>r(u)?Bt(e.yValues,"Points",r(u).length):null),v=Yt("axes"),m=w(()=>r(u)?_t(r(u),v.tX()):null),g=w(()=>r(m)&&r(f)?_t(r(f),v.tY()):null),h=w(()=>["＋","✳","✕"].includes(r(d))?`fill:${a()&&a()!=="transparent"?a():s()};stroke-width:0px;font-size:${c()}em;`:`fill:${s()};stroke-width:${o()}px;stroke:${a()}; font-size:${c()}em;`),p=w(()=>["◼","⬥","＋","✳","✕"].includes(r(d))?"series-points2":"series-points1"),_=w(()=>r(m)&&r(g)&&r(m).length===r(g).length);var b=he(),y=J(b);{var C=E=>{var k=Vv();k.__click=[Dv,e],Ye(k,21,()=>r(m),Ge,(S,A,M)=>{var N=Bv(),P=j(N);ae(()=>{H(N,"x",r(m)[M]),H(N,"y",r(g)[M]),ve(P,r(d))}),T(S,N)}),ae(()=>{pt(k,0,`series series-points ${r(p)??""}`),bt(k,r(h))}),T(E,k)};W(y,E=>{r(_)&&E(C)})}T(l,b),pe()}vt(["click"]);var Yv=(l,e)=>wn(l,"polyline",e.onclick),Wv=Ce('<g class="series series-line"><polyline class="line"></polyline></g>');function Ht(l,e){ge(e,!0);let t=Y(e,"lineColor",19,()=>It.PRIMARY),s=Y(e,"lineType",3,1),a=Y(e,"lineWidth",3,1);const o=w(()=>Bt(e.xValues,"Lines")),c=w(()=>r(o)?Bt(e.yValues,"Lines",r(o).length):null),d=Yt("axes"),u=w(()=>r(o)&&r(c)?ma(r(o),r(c),d.tX(),d.tY()):null),f=w(()=>`fill:transparent;stroke:${t()};stroke-width: ${a()}px; stroke-dasharray:${al[d.scales().plot][s()-1]}`);var v=he(),m=J(v);{var g=h=>{var p=Wv();p.__click=[Yv,e];var _=j(p);ae(()=>{bt(p,r(f)),H(_,"points",r(u))}),T(h,p)};W(m,h=>{r(u)&&h(g)})}T(l,v),pe()}vt(["click"]);var Uv=(l,e)=>wn(l,"polyline",e.onclick),Hv=Ce('<polyline class="line"></polyline>'),Gv=Ce('<g class="series series-multiline"></g>');function $i(l,e){ge(e,!0);let t=Y(e,"lineColor",19,()=>It.PRIMARY),s=Y(e,"lineType",3,1),a=Y(e,"lineWidth",3,1);const o=w(()=>Bt(e.xValues,"Multilines")),c=w(()=>r(o)?mr(e.yValues)?(r(o).length!==e.yValues.nrows&&console.error('Multilines: parameter "xValues" must have the same number of values as number of rows in "yValues".'),e.yValues):(console.error('Multilines: parameter "yValues" must be a matrix.'),null):null),d=Yt("axes"),u=w(()=>{if(!r(o)||!r(c))return null;const h=new Array(r(c).ncols);for(let p=0;p<h.length;p++)h[p]=ma(r(o),r(c).getcolumn(p+1),d.tX(),d.tY());return h}),f=w(()=>`fill:transparent;stroke:${t()};stroke-width: ${a()}px; stroke-dasharray:${al[d.scales().plot][s()-1]}`);var v=he(),m=J(v);{var g=h=>{var p=Gv();p.__click=[Uv,e],Ye(p,21,()=>r(u),Ge,(_,b)=>{var y=Hv();ae(()=>H(y,"points",r(b))),T(_,y)}),ae(()=>bt(p,r(f))),T(h,p)};W(m,h=>{r(u)&&r(u).length>0&&h(g)})}T(l,v),pe()}vt(["click"]);function On(l,e){ge(e,!0);let t=Y(e,"show",3,!0),s=Y(e,"position",3,"topleft"),a=Y(e,"lineColor",19,()=>It.LEGEND),o=Y(e,"lineWidth",3,1),c=Y(e,"faceColor",3,"#fff"),d=Y(e,"fontSize",3,.85);function u(m){return typeof m!="string"?(console.error('Legend: value of "position" must be a string.'),null):["top","left","right","topleft","topright","bottom","bottomleft","bottomright"].includes(m)?m:(console.error('Legend: wrong value of "position" property'),null)}function f(m){if(!m||!Array.isArray(m)||m.length<1)return console.error('Legend: property "items" must be provided as array of JSONs.'),null;for(let g=0;g<m.length;g++){const h=m[g];if(!h.label)return console.error('Legend: all elements of "items" must include at least one field: "label".'),null;const p=Kr(h.label),_=p.length===h.label?1:1.4;h.label=p,h.labelHeight=_,h.line&&(h.line.lineType||(h.line.lineType=1),h.line.lineType>0&&h.line.lineType<=4||console.error('Legend: parameter "lineType" for legend item '+(g+1)+" is incorrect."),h.line.lineColor=h.line.lineColor?h.line.lineColor:It.PRIMARY,h.line.lineWidth=h.line.lineWidth?h.line.lineWidth:1),h.point&&(h.point.marker||(h.point.marker=1),h.point.marker>0&&h.point.marker<=Fn.length||console.error('Legend: parameter "marker" for legend item '+(g+1)+" is incorrect."),h.point.faceColor=h.point.faceColor?h.point.faceColor:"transparent",h.point.lineWidth=h.point.lineWidth?h.point.lineWidth:1,h.point.markerSize=h.point.markerSize?h.point.markerSize:1,h.point.lineColor=h.point.lineColor?h.point.lineColor:It.PRIMARY)}return m}const v=Yt("axes");ce(()=>{const m=f(e.items),g=u(s());v.setGroupLegend(m&&g?{show:t(),position:s(),items:e.items,lineColor:a(),faceColor:c(),lineWidth:o(),fontSize:d()}:{show:!1,position:null,items:null})}),pe()}function ba(l,e){ge(e,!0);let t=Y(e,"show",3,!0),s=Y(e,"labels",3,null),a=Y(e,"labelColor",19,()=>It.CLEGEND_LABELS),o=Y(e,"fontSize",3,.85);const c=Yt("axes");ce(()=>{c.setColmapLegend({show:t(),breaks:e.breaks,colmap:e.colmap,labels:s(),labelColor:a(),fontSize:o()})}),pe()}const Xv=l=>l;function ec(l,{delay:e=0,duration:t=400,easing:s=Xv}={}){const a=+getComputedStyle(l).opacity;return{delay:e,duration:t,easing:s,css:o=>`opacity: ${o*a}`}}var Kv=K('<div><div class="modal svelte-q7wo60"><div class="header svelte-q7wo60"><button class="close-button svelte-q7wo60">✕</button></div> <div class="body svelte-q7wo60"><!></div></div></div>');function _a(l,e){ge(e,!0);let t=Y(e,"isDark",3,!1);function s(m){m.key==="Escape"&&e.closeModal()}var a=Kv();vn("keydown",Ns,s);let o;var c=j(a),d=j(c),u=j(d);u.__click=function(...m){var g;(g=e.closeModal)==null||g.apply(this,m)};var f=z(d,2),v=j(f);Rr(v,()=>e.children),ae(m=>o=pt(a,1,"drop svelte-q7wo60",null,o,m),[()=>({isdark:t()})]),Fo(7,a,()=>ec),T(l,a),pe()}vt(["click"]);const Jv=[1,1.1,.45,.4],Jr={regular:"#2679B2",extreme:"#F2B825",outlier:"#D22C2F",alien:"#2679B2",external:"#D22C2F"},Gt={cal:1,pv:2,test:2,new:2},At={cal:"#2679B2",pv:"#D22C2F",test:"#a05e5e",new:"#5e85a0"},wa={cal:"#f0f8ff",pv:"#f4e5e5",test:"#fff0f8",new:"#f0f8ff"},Qr={cal:"#2679B230",pv:"#D22C2F30",test:"#f05e5e30",new:"#5e85a030"},tc="#808090",rc="#a0a0a0",nc="#909090",ss="#909090",il=8,Qv=8,Zv=8,$v=600;function lc(l,e){return!l||!e||e<0||e>l.ncomp?"":`PC${e} (${(l.stat.expvar[e-1]*100).toFixed(1)}%)`}function e1(l,e){if(l.length===e.length)return l;const t=e.length,s=new l.constructor(t);for(let a in e)s[a]=l[e[a]];return s}function t1(l,e){let t=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;for(let c=0;c<l.length;c++)s=Math.min(s,l[c]),t=Math.max(t,l[c]);let a=ha(void 0,[s,t],e-1,!0,!1,0).v;const o=a[1]-a[0];if(a[0]>s){const c=a[0]-o;a=[c<s?c:s,...a]}if(a[a.length-1]<t){const c=a[a.length-1]+o;a=[...a,c>t?c:t]}return a}function r1(l){const e=l.length;if(e<1||e>16)throw Error("getClassColors: can not create color map for more than 16 categories.");const t=rs(e);return l.reduce((a,o,c)=>(a[o]=t[c],a),{})}function sc(l,e,t){const s=e.length,a=new Array(l.length),o=e[1]-e[0];for(let c=0;c<l.length;c++)for(let d=0;d<s-1;d++){const u=l[c]>=e[d],f=d===s-2?l[c]<e[d+1]+o:l[c]<e[d+1];if(u&&f){a[c]=t[d];break}}return a}function ya(l,e,t,s,a="cal",o){if(!e)return null;let c,d,u,f,v,m,g=!0;if((t==="groups"||t==="classes")&&e.classNames){const h=r1(e.classNames);d=Object.keys(h).map(p=>h[p]),c=e.classNames,f=e.classes.map(p=>h[p]),u=new Array(c.length+1).map((p,_)=>_-.5),v=null}else if(t==="variable"){const h=e1(l.values.getcolref(s),e.objindices);v=l.varlabels[s-1],v.length>30&&(v=v.substring(0,29)+"..."),u=t1(h,10),d=rs(u.length-1),f=sc(h,u,d)}else if(o){const h=o.values;c=o.labels;const p=o.classColmap;d=Object.keys(p).map(_=>p[_]),f=h.map(_=>p[_]),u=new Array(c.length+1).map((_,b)=>b-.5),v=null,o.filled&&o.filled.length===h.length&&(m=o.filled),o.showBar!==void 0&&(g=o.showBar)}else c=null,u=null,d=null,f=Array(e.nrows).fill(At[a]);return{labels:c,map:d,breaks:u,colors:f,varname:v,filled:m,showBar:g,mainColor:At[a],faceColor:wa[a],faceTColor:Qr[a]}}function n1(l,e,t=.95){const a=2*Math.PI/99,[o,c,d]=l,u=Math.sqrt((o+d)**2-4*(o*d-c*c));let f=.5*(o+d-u),v=.5*(o+d+u);if(f<v){let M=f;f=v,v=M}const m=ir(t,2),g=Math.sqrt(m*f),h=Math.sqrt(m*v);let p;if(Math.abs(c)<1e-7)p=0;else{let M=-c/(o-f),N=1;const P=Math.sqrt(M*M+N*N);M=M/P,N=N/P,p=Math.atan2(N,M),p<0&&(p=p+2*Math.PI)}const _=Math.cos(p),b=Math.sin(p),y=Me.zeros(100),C=Me.zeros(100);let E=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,S=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY;for(let M=0;M<100;M++){const N=M*a,P=g*Math.cos(N),I=h*Math.sin(N),R=P*_-I*b+e[0],q=P*b+I*_+e[1];y.v[M]=R,C.v[M]=q,E=Math.min(E,R),k=Math.max(k,R),S=Math.min(S,q),A=Math.max(A,q)}return[y,C,E,k,S,A]}function l1(l,e,t,s,a,o){if(!l||!e||!t||!s||!a)return null;const c=l.length,d=s.length,u=new Array(d).fill(0),f=new Array(d*2).fill(0);for(let b=0;b<c;b++){const y=s.indexOf(t[b]);u[y]+=1,f[y*2]+=l.v[b],f[y*2+1]+=e.v[b]}for(let b=0;b<d;b++)f[b*2]=f[b*2]/u[b],f[b*2+1]=f[b*2+1]/u[b];const v=new Array(d*3).fill(0);for(let b=0;b<c;b++){const y=s.indexOf(t[b]),C=l.v[b]-f[y*2],E=e.v[b]-f[y*2+1];v[y*3]+=C*C,v[y*3+1]+=C*E,v[y*3+2]+=E*E}let m=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY;const _=Array(d);for(let b=0;b<d;b++){const[y,C,E,k,S,A]=n1([v[b*3]/(u[b]-1),v[b*3+1]/(u[b]-1),v[b*3+2]/(u[b]-1)],[f[b*2],f[b*2+1]],o);_[b]={x:y,y:C,c:a[b]},m=Math.min(m,E),g=Math.max(g,k),h=Math.min(h,S),p=Math.max(p,A)}return{ellipses:_,xRange:[m,g],yRange:[h,p]}}function s1(l){const e=l.charAt(0),t=l.substring(1);return e.toUpperCase()+t}function ac(l,e,t,s){if(!l||!e)return null;const a=l.length;let o=Me.zeros(a),c=Number.NEGATIVE_INFINITY,d=Number.POSITIVE_INFINITY;if(s==="log")for(let u=0;u<a;u++){const f=Math.log(1+l[u]/t);o.v[u]=f,c=Math.max(c,f),d=Math.min(d,f)}else for(let u=0;u<a;u++){const f=l[u]/t;o.v[u]=f,c=Math.max(c,f),d=Math.min(d,f)}return{values:o,min:d,max:c}}function oc(l,e){return{z:"Full y-distance",f:"Full x-distance",q:"Orthogonal distance",h:"Score distance"}[l]+", "+(e==="log"?"log(1 + "+l+"/"+l+"0)":l+"/"+l+"0")}function ic(l,e,t,s){const o=e+t,d=ir(l,o)/t,u=-e/t,f=-d/u,v=Me.seq(0,f*1,f/100),m=v.apply(g=>g*u+d);return{x:s==="log"?v.apply(g=>Math.log(1+g)):v,y:s==="log"?m.apply(g=>Math.log(1+g)):m}}function a1(l,e=Qr){return l?l.map(t=>({id:t,label:t,point:{marker:Gt[t],faceColor:e[t],lineColor:At[t],markerSize:Gt[t]===1?.85:.65,lineWidth:1.5}})):null}var o1=K("<!> <!> <!> <!>",1);function Pr(l,e){let t=Y(e,"whole",3,!1),s=gn(e,["$$slots","$$events","$$legacy","title","limX","limY","xLabel","yLabel","whole","fileName","children"]);Xi(l,$t({get title(){return e.title},get limX(){return e.limX},get limY(){return e.limY},get fileName(){return e.fileName},downloadLinks:"hover",get margins(){return Jv},get pngWidth(){return Qv},get pngHeight(){return Zv},get pngRes(){return $v}},()=>s,{children:(a,o)=>{var c=o1(),d=J(c);Rr(d,()=>e.children);var u=z(d,2);Ki(u,{showGrid:!0,get label(){return e.xLabel},get whole(){return t()}});var f=z(u,2);Ji(f,{showGrid:!0,get label(){return e.yLabel}});var v=z(f,2);Qi(v,{}),T(a,c)},$$slots:{default:!0}}))}function i1(l,e){if(l.target.tagName!=="rect"){V(e,-1);return}const t=Array.from(l.target.parentNode.children).indexOf(l.target);if(t<0){V(e,-1);return}r(e)!==t&&V(e,t,!0)}var c1=K("<!> <!> <!>",1),u1=K("<!> <!> <!> <!> <!>",1),f1=K("<div><!></div>"),d1=K('<div class="wrapper svelte-ha02r1"><div class="plot-container svelte-ha02r1" role="tooltip"><!></div> <div class="msg-select svelte-ha02r1">click inside the plot to see a variable label</div> <div class="plot-controls svelte-ha02r1"><div><!></div> <!></div></div>');function xa(l,e){ge(e,!0);let t=Y(e,"outliers",19,()=>[]),s=Y(e,"model_getter",3,rt),a=Y(e,"res_getter",3,tr),o=ne("residual"),c=ne(-1);const d=w(()=>e.res?Object.keys(e.res):null);let u=ne(Re(r(d)?r(d)[0]:null));const f=w(()=>{if(!e.model)return null;const Z=e.model.nresp?e.model.nresp:0,G=it(e.model.varvalues.filter((xe,de)=>de>=Z)),$=G.length,le=(G.v[1]-G.v[0])/2,te=(G.v[$-1]-G.v[$-2])/2,se=[G.v[0],G.v[$-1]],_e=[se[0]-le,se[1]+te],Se=(se[1]-se[0])/$;return{values:G,lim:_e,width:Se,hwidth:Se*.5}}),v=w(()=>r(f)?r(f).values.apply(Z=>Z-r(f).hwidth):null),m=w(()=>r(u)?e.res[r(u)]:null),g=w(()=>r(m)?new Lt(a()(r(m),"T"),r(m).nrows,r(m).ncomp):null),h=w(()=>r(m)?new Lt(a()(r(m),"E"),r(m).nrows,r(m).npred).t():null),p=w(()=>e.model?new Lt(s()(e.model,"P"),e.model.npred?e.model.npred:e.model.ncols,e.model.ncomp):null),_=w(()=>e.ncomp?Pt.seq(1,e.ncomp):null),b=w(()=>e.ncomp<e.model.ncomp?Pt.seq(e.ncomp+1,e.model.ncomp):null),y=w(()=>r(g)&&r(_)?r(g).subset(null,r(_)):null),C=w(()=>r(g)&&r(_)?r(p).subset(null,r(_)):null),E=w(()=>r(g)&&r(b)?r(g).subset(null,r(b)):null),k=w(()=>r(g)&&r(b)?r(p).subset(null,r(b)):null),S=w(()=>r(y)&&r(C)?si(r(C),r(y)):null),A=w(()=>r(E)&&r(k)?si(r(k),r(E)).add(r(h)):r(h)),M=w(()=>r(S)&&r(A)?r(S).add(r(A)):null);let N=w(()=>r(S)?r(S).getcolumn(e.selected+1):null),P=w(()=>r(A)?r(A).getcolumn(e.selected+1):null),I=w(()=>r(M)?r(M).getcolumn(e.selected+1):null),R=w(()=>{if(!r(N)||!r(P)||!r(I))return null;const Z=r(o)==="explained"?{all:r(S),sel:r(N),label:"Explained part, TP^T"}:r(o)==="residual"?{all:r(A),sel:r(P),label:"Residuals, E"}:{all:r(M),sel:r(I),label:"Preprocessed data, X"},G=jr(Z.all.v),$=G[1]-G[0],le=[G[0]-$/50,G[1]+$/12],te=Me.fill(G[1],Z.sel.length);return Z.lim=le,Z.top=te,Z.height=$,Z});const q=w(()=>r(f)&&r(c)>=0?r(f).values.v[r(c)]:null),U=w(()=>r(R)&&r(c)>=0?r(R).sel.v[r(c)]:null),D=w(()=>e.model&&r(c)>=0?e.model.varlabels[r(c)]:null),L=w(()=>r(m)&&e.selected>=0?`Object ${r(m).objlabels[e.selected].replace("_","-")}`:null),F=w(()=>e.model?e.model.varvaluesName+(e.model.varvaluesUnits?", "+e.model.varvaluesUnits:""):null);var B=he(),O=J(B);{var X=Z=>{_a(Z,{get closeModal(){return e.closeModal},children:(G,$)=>{var le=d1(),te=j(le);te.__click=[i1,c];var se=j(te);Pr(se,{get title(){return r(L)},get yLabel(){return r(R).label},get xLabel(){return r(F)},get limY(){return r(R).lim},get limX(){return r(f).lim},fileName:"plot-contributions",children:(me,ee)=>{var ie=u1(),ue=J(ie);$i(ue,{get xValues(){return r(f).values},get yValues(){return r(R).all},lineColor:"#e0e0e0"});var be=z(ue,2);{var fe=Ke=>{var gt=he(),et=J(gt);Ye(et,17,t,Ge,(qe,Fe)=>{{let Ee=w(()=>r(R).all.getcolumn(r(Fe)+1));Ht(qe,{get xValues(){return r(f).values},get yValues(){return r(Ee)},lineColor:"#ffdd88"})}}),T(Ke,gt)};W(be,Ke=>{t().length>0&&Ke(fe)})}var ke=z(be,2);Ht(ke,{get xValues(){return r(f).values},get yValues(){return r(R).sel},lineColor:"crimson"});var De=z(ke,2);ol(De,{get left(){return r(v)},get top(){return r(R).top},get height(){return r(R).height},get width(){return r(f).width},faceColor:"transparent",borderColor:"transparent"});var Ue=z(De,2);{var He=Ke=>{var gt=c1(),et=J(gt);{let Ee=w(()=>[r(q)]),ze=w(()=>[r(R).top.v[0]]),Pe=w(()=>[r(D)]);ls(et,{get xValues(){return r(Ee)},get yValues(){return r(ze)},get labels(){return r(Pe)},pos:3,textSize:.85})}var qe=z(et,2);{let Ee=w(()=>[r(q)]),ze=w(()=>[r(U)]);Zi(qe,{get xValues(){return r(Ee)},get yValues(){return r(ze)},faceColor:"crimson",lineColor:"crimson"})}var Fe=z(qe,2);{let Ee=w(()=>[r(v).v[r(c)]]),ze=w(()=>[r(R).top.v[r(c)]]);ol(Fe,{get left(){return r(Ee)},get top(){return r(ze)},get height(){return r(R).height},get width(){return r(f).width},faceColor:"#ff000015"})}T(Ke,gt)};W(Ue,Ke=>{r(c)>=0&&Ke(He)})}T(me,ie)},$$slots:{default:!0}});var _e=z(te,4),Se=j(_e),xe=j(Se);oe(xe,{label:"Show",children:(me,ee)=>{Xe(me,{id:"type",options:["full","explained","residual"],get value(){return r(o)},set value(ie){V(o,ie,!0)}})},$$slots:{default:!0}});var de=z(Se,2);{var ye=me=>{var ee=f1(),ie=j(ee);oe(ie,{label:"For",children:(ue,be)=>{Xe(ue,{id:"type",get options(){return r(d)},get value(){return r(u)},set value(fe){V(u,fe,!0)}})},$$slots:{default:!0}}),T(me,ee)};W(de,me=>{r(d).length>1&&me(ye)})}T(G,le)},$$slots:{default:!0}})};W(O,Z=>{r(f)&&r(R)&&Z(X)})}T(l,B),pe()}vt(["click"]);function v1(l,e){let t=0,s=0;l.nresp>0&&(t=new Me(l.values.v.slice(0,l.values.nrows)),s=1);const a=new Lt(l.values.v.slice(s*l.values.nrows),l.values.nrows,l.values.ncols-s).t(),o=a.ncols<e?1:Math.round(a.ncols/e),c=Pt.seq(1,a.ncols,o),d=a.subset(null,c),u=t?t.subset(c):null,f=l.classes?l.classes.filter((v,m)=>c.v.includes(m)):null;return{classNames:l.classNames,classes:f,resp:u,values:d,varvalues:l.varvalues.filter((v,m)=>m>=s),varindices:l.varindices.filter((v,m)=>m>=s),varaxisLabel:l.varvaluesUnits?l.varvaluesName+" "+l.varvaluesUnits:l.varvaluesName,varaxisUnits:l.varvaluesUnits}}function ka(l,e){return{values:e||l.values.copy(),varvalues:l.varvalues,varindices:l.varindices,varaxisLabel:l.varaxisLabel}}function m1(l,e){if(!e||e.nrows!==l.values.nrows||e.ncols!==l.values.ncols)throw new Error("Object with values seems to be wrong for cloning.");const t=structuredClone(l);return t.values=e,t}var h1=K('<span class="info-details svelte-1l1cvmx"> <span class="svelte-1l1cvmx"><!></span></span>');function Ea(l,e){ge(e,!0);var t=he(),s=J(t);{var a=c=>{var d=h1(),u=j(d),f=z(u),v=j(f);Tt(v,()=>Lf(e.prepmodel)),ae(()=>ve(u,`${e.prepmodel.ml.length+" method"+(e.prepmodel.ml.length>1?"s":"")} `)),T(c,d)},o=c=>{var d=Ru("skipped");T(c,d)};W(s,c=>{e.prepmodel.ml?c(a):c(o,!1)})}T(l,t),pe()}var g1=K('<span>file:</span> <span class="file-name svelte-1dxrrpt"> </span><br/>',1),p1=K('<p class="info-text svelte-1dxrrpt"><span style="display:inline-block;font-weight:bold;padding-bottom: 0.25em;">Preprocessing model</span><br/> <!> <span style="color:#a0a0a0;">variables</span>, <!></p> <!>',1);function b1(l,e){ge(e,!0);var t=he(),s=J(t);{var a=o=>{oe(o,{name:"info",children:(c,d)=>{var u=p1(),f=J(u),v=z(j(f),3);{var m=b=>{var y=g1(),C=z(J(y),2),E=j(C);ae(()=>{H(C,"title",e.model.fileName),ve(E,e.model.fileName)}),T(b,y)};W(v,b=>{e.model.fileName&&b(m)})}var g=z(v),h=z(g,3);Ea(h,{get prepmodel(){return e.model}});var p=z(f,2);{var _=b=>{Mr(b,{get onclick(){return e.reset}})};W(p,b=>{e.reset&&b(_)})}ae(()=>ve(g,` ${e.model.npred??""} `)),T(c,u)},$$slots:{default:!0}})};W(s,o=>{e.model&&o(a)})}T(l,t),pe()}var _1=K("<!> <!>",1),w1=K("<p><!></p>"),y1=K("<!> <!>",1);function x1(l,e){ge(e,!0);let t=Y(e,"model",15),s=ne(""),a=ne("neutral"),o=ne("");function c(b){try{const y=JSON.parse(b,la);if(Array.isArray(y.v)&&(y.v=Float64Array.from(y.v)),!Object.keys(y).includes("class")||y.class[0]!=="prepmodel")throw Error("The JSON file you selected does not contain preprocessing model.");y.fileName=r(f),t(y),V(a,"success"),V(o,"")}catch(y){console.log(y),t(null),V(a,"error"),V(o,y,!0)}}function d(b){const y=new FileReader;y.onload=()=>{c(y.result)},y.readAsText(r(s))}function u(){V(s,""),t(null),V(a,"neutral"),V(o,"")}ce(()=>{r(s)===null?(t(null),V(a,"neutral"),V(o,"")):(V(a,"neutral"),V(o,""))});let f=w(()=>r(s)?r(s).name.replace(/\.[^/.]+$/,""):"");var v=y1(),m=J(v);{var g=b=>{var y=_1(),C=J(y);Rn(C,()=>r(s),S=>{oe(S,{name:"file-selector",children:(A,M)=>{$l(A,{id:"modelFile",acceptType:".json",message:"Select file with model",get file(){return r(s)},set file(N){V(s,N,!0)}})},$$slots:{default:!0}})});var E=z(C,2);{var k=S=>{oe(S,{name:"load-button",label:" ",children:(A,M)=>{lt(A,{onclick:d,text:"Load"})},$$slots:{default:!0}})};W(E,S=>{r(s)&&S(k)})}T(b,y)},h=b=>{b1(b,{get model(){return t()},reset:u})};W(m,b=>{t()?b(h,!1):b(g)})}var p=z(m,2);{var _=b=>{oe(b,{name:"error",status:"error",children:(y,C)=>{var E=w1(),k=j(E);Tt(k,()=>r(o)),T(y,E)},$$slots:{default:!0}})};W(p,b=>{(r(a)==="error"||r(o))&&b(_)})}T(l,v),pe()}var k1=K('<p class="title"> </p>'),E1=K('<div class="method-open svelte-2gffce"><!> <!> <!></div>'),S1=(l,e)=>e.open(e.pos),C1=K('<p> <span title="Edit" class="svelte-2gffce"> </span></p> <!> <!> <!>',1);function Dn(l,e){ge(e,!0);var t=he(),s=J(t);{var a=c=>{var d=E1(),u=j(d);oe(u,{children:(m,g)=>{var h=k1(),p=j(h);ae(()=>ve(p,e.title)),T(m,h)},$$slots:{default:!0}});var f=z(u,2);Rr(f,()=>e.children);var v=z(f,2);oe(v,{label:" ",children:(m,g)=>{lt(m,{text:"Save",get onclick(){return e.apply}})},$$slots:{default:!0}}),Fo(3,d,()=>ec,()=>({duration:10})),T(c,d)},o=c=>{oe(c,{children:(d,u)=>{var f=C1(),v=J(f),m=j(v),g=z(m);g.__click=[S1,e];var h=j(g),p=z(v,2);Zf(p,{onclick:()=>e.moveUp(e.pos)});var _=z(p,2);$f(_,{onclick:()=>e.moveDown(e.pos)});var b=z(_,2);Mr(b,{onclick:()=>e.remove(e.pos)}),ae(()=>{ve(m,`${e.title??""} `),ve(h,e.settings)}),T(d,f)},$$slots:{default:!0}})};W(s,c=>{e.isOpen?c(a):c(o,!1)})}T(l,t),pe()}vt(["click"]);var A1=K("<!> <!>",1);function N1(l,e){ge(e,!0);let t=Y(e,"params",31,()=>Re([0,0])),s=Y(e,"varind",15),a=Y(e,"settings",15),o=Y(e,"nvars",3,0),c=gn(e,["$$slots","$$events","$$legacy","params","varind","settings","isOpen","nvars"]);const d={snv:0,area:1,length:2,var:3},u=Object.keys(d);let f=ne(Re(u[t()[0]])),v=ne(t()[1]+1);const m="Normalization";ce(()=>{a(r(f)+(r(f)==="var"?" #"+r(v):""))}),ce(()=>{r(f)==="var"?s(s()[0]=t()[1]>0?t()[1]:1,!0):s(s()[0]=-1,!0)}),ce(()=>{r(f)==="var"&&e.isOpen?s(s()[0]=t()[1],!0):s(s()[0]=-1,!0)}),ce(()=>{r(f)&&t(t()[0]=d[r(f)],!0)}),ce(()=>{r(v)&&t(t()[1]=r(v)-1,!0)}),Dn(l,$t({id:"norm",title:m,get settings(){return a()},get isOpen(){return e.isOpen}},()=>c,{children:(g,h)=>{var p=A1(),_=J(p);oe(_,{label:"Type",children:(C,E)=>{Xe(C,{get options(){return u},get value(){return r(f)},set value(k){V(f,k,!0)}})},$$slots:{default:!0}});var b=z(_,2);{var y=C=>{oe(C,{label:"Variable index",children:(E,k)=>{Tr(E,{min:1,get max(){return o()},step:1,get value(){return r(v)},set value(S){V(v,S,!0)}})},$$slots:{default:!0}})};W(b,C=>{r(f)==="var"&&C(y)})}T(g,p)},$$slots:{default:!0}})),pe()}var M1=K("<!> <!> <!>",1);function T1(l,e){ge(e,!0);let t=Y(e,"params",31,()=>Re([3,1,0])),s=Y(e,"settings",15),a=gn(e,["$$slots","$$events","$$legacy","params","settings","nvars"]);const o=w(()=>{if(!e.nvars)return 3;const f=Math.round(e.nvars*.25);return f>39?39:f%2<1?f+1:f}),c=w(()=>t()[1]<2?[0,1]:[0,1,2]),d=w(()=>t()[0]<5?[1,2]:[1,2,3]);ce(()=>{t()[0]<5&&t()[1]>2&&t(t()[1]=2,!0)}),ce(()=>{t()[2]>t()[1]&&t(t()[2]=t()[1],!0)}),ce(()=>{s(t()[0]+", "+t()[1]+", "+t()[2])}),Dn(l,$t({id:"savgol",title:"Savitzkiy-Golay",get settings(){return s()}},()=>a,{children:(f,v)=>{var m=M1(),g=J(m);oe(g,{label:"Width",children:(_,b)=>{Tr(_,{min:3,get max(){return r(o)},step:2,get value(){return t()[0]},set value(y){t(t()[0]=y,!0)}})},$$slots:{default:!0}});var h=z(g,2);oe(h,{label:"Polynomial",children:(_,b)=>{Xe(_,{get options(){return r(d)},get value(){return t()[1]},set value(y){t(t()[1]=y,!0)}})},$$slots:{default:!0}});var p=z(h,2);oe(p,{label:"Derivative",children:(_,b)=>{Xe(_,{get options(){return r(c)},get value(){return t()[2]},set value(y){t(t()[2]=y,!0)}})},$$slots:{default:!0}}),T(f,m)},$$slots:{default:!0}})),pe()}var P1=K("<!> <!>",1);function z1(l,e){ge(e,!0);let t=Y(e,"params",31,()=>Re([1,0]));Y(e,"varind",27,()=>-1);let s=Y(e,"settings",15);Y(e,"nvars",3,0);let a=gn(e,["$$slots","$$events","$$legacy","params","varind","settings","nvars"]);const o={no:0,mean:1,median:2},c={no:0,sd:1,iqr:2,range:3,pareto:4},d=Object.keys(o),u=Object.keys(c);let f=ne(Re(d[t()[0]])),v=ne(Re(u[t()[1]]));const m="Scaling";ce(()=>{s(r(f)+"/"+r(v))}),ce(()=>{r(f)&&t(t()[0]=o[r(f)],!0)}),ce(()=>{r(v)&&t(t()[1]=c[r(v)],!0)}),Dn(l,$t({id:"scale",title:m,get settings(){return s()}},()=>a,{children:(g,h)=>{var p=P1(),_=J(p);oe(_,{label:"Center",children:(y,C)=>{Xe(y,{get options(){return d},get value(){return r(f)},set value(E){V(f,E,!0)}})},$$slots:{default:!0}});var b=z(_,2);oe(b,{label:"Scale",children:(y,C)=>{Xe(y,{get options(){return u},get value(){return r(v)},set value(E){V(v,E,!0)}})},$$slots:{default:!0}}),T(g,p)},$$slots:{default:!0}})),pe()}var L1=K("<!> <!> <!>",1),R1=K("<!> <!> <!>",1);function I1(l,e){ge(e,!0);let t=Y(e,"params",31,()=>Re([0,1,.1]));Y(e,"varind",27,()=>-1);let s=Y(e,"settings",15,"");Y(e,"nvars",3,0);let a=gn(e,["$$slots","$$events","$$legacy","params","varind","settings","nvars"]);const o="Baseline correction",c={emsc:0,als:1},d=Object.keys(c);function u(p){const _=Math.ceil(Math.log10(p));return Math.pow(10,_)}let f=ne(Re(d[t()[0]])),v=ne(Re(t()[2]>0?u(t()[2]).toString():"0.1")),m=w(()=>parseFloat(r(v))),g=w(()=>r(m)/10),h=w(()=>Math.ceil(-Math.log10(r(m)))+1);ce(()=>{if(r(f)!=="als")return;const p=parseFloat(r(v));(t()[2]<r(g)||t()[2]>p-r(g))&&t(t()[2]=r(g),!0)}),ce(()=>{s(r(f)+" ("+(r(f)=="emsc"?t()[1].toFixed(0):t()[1].toFixed(1)+","+t()[2].toFixed(3))+")")}),ce(()=>{r(f)&&t(t()[0]=c[r(f)],!0)}),Dn(l,$t({id:"scale",title:o,get settings(){return s()}},()=>a,{children:(p,_)=>{var b=R1(),y=J(b);oe(y,{label:"Type",children:(A,M)=>{Xe(A,{get options(){return d},get value(){return r(f)},set value(N){V(f,N,!0)}})},$$slots:{default:!0}});var C=z(y,2);{var E=A=>{var M=L1(),N=J(M);oe(N,{label:"Lambda",children:(R,q)=>{qn(R,{min:1,max:7,step:.1,get value(){return t()[1]},set value(U){t(t()[1]=U,!0)}})},$$slots:{default:!0}});var P=z(N,2);oe(P,{label:"Penalty range",children:(R,q)=>{Xe(R,{options:["1","0.1","0.01"],get value(){return r(v)},set value(U){V(v,U,!0)}})},$$slots:{default:!0}});var I=z(P,2);oe(I,{label:"Penalty",children:(R,q)=>{{let U=w(()=>r(m)-r(g));qn(R,{get min(){return r(g)},get max(){return r(U)},get step(){return r(g)},get decNum(){return r(h)},get value(){return t()[2]},set value(D){t(t()[2]=D,!0)}})}},$$slots:{default:!0}}),T(A,M)};W(C,A=>{r(f)==="als"&&A(E)})}var k=z(C,2);{var S=A=>{oe(A,{label:"Polynomial",children:(M,N)=>{Tr(M,{min:0,max:5,step:1,decNum:0,get value(){return t()[1]},set value(P){t(t()[1]=P,!0)}})},$$slots:{default:!0}})};W(k,A=>{r(f)==="emsc"&&A(S)})}T(p,b)},$$slots:{default:!0}})),pe()}var j1=K("<!> <!>",1);function q1(l,e){ge(e,!0);let t=Y(e,"params",15),s=Y(e,"varind",15),a=Y(e,"settings",15),o=gn(e,["$$slots","$$events","$$legacy","params","varind","settings","isOpen","left","right","nvars"]);const c="Trim tails";let d=ne(!1);const u=w(()=>e.nvars?Math.round(e.nvars*.1):1);ce(()=>{e.isOpen?((t()[0]===void 0||t()[0]===null||t()[0]<e.left||t()[0]>e.right-r(u))&&t(t()[0]=e.left,!0),(t()[1]===void 0||t()[1]===null||t()[1]>e.right||t()[1]<e.left+r(u))&&t(t()[1]=e.right,!0),s(s()[1]=t()[0],!0),s(s()[2]=t()[1],!0),V(d,!0)):(s(s()[1]=-1,!0),s(s()[2]=-1,!0),V(d,!1))}),ce(()=>{a("left: "+t()[0]+" right: "+t()[1])}),Dn(l,$t({id:"norm",title:c,get settings(){return a()},get isOpen(){return e.isOpen}},()=>o,{children:(f,v)=>{var m=he(),g=J(m);{var h=p=>{var _=j1(),b=J(_);oe(b,{label:"Left",children:(C,E)=>{{let k=w(()=>e.right-r(u));qn(C,{get min(){return e.left},get max(){return r(k)},step:1,decNum:0,get value(){return t()[0]},set value(S){t(t()[0]=S,!0)}})}},$$slots:{default:!0}});var y=z(b,2);oe(y,{label:"Right",children:(C,E)=>{{let k=w(()=>e.left+r(u));qn(C,{get min(){return r(k)},get max(){return e.right},step:1,decNum:0,get value(){return t()[1]},set value(S){t(t()[1]=S,!0)}})}},$$slots:{default:!0}}),T(p,_)};W(g,p=>{r(d)&&p(h)})}T(f,m)},$$slots:{default:!0}})),pe()}var F1=K("<!> <!>",1);function O1(l,e){ge(e,!0);let t=Y(e,"params",31,()=>Re([3,5]));Y(e,"varind",27,()=>-1);let s=Y(e,"settings",15);Y(e,"nvars",3,0);let a=gn(e,["$$slots","$$events","$$legacy","params","varind","settings","nvars"]);const o="Spike removal";ce(()=>{s(t()[0]+"/"+t()[1])}),Dn(l,$t({id:"scale",title:o,get settings(){return s()}},()=>a,{children:(c,d)=>{var u=F1(),f=J(u);oe(f,{label:"Window",children:(m,g)=>{Tr(m,{min:3,max:15,step:2,get value(){return t()[0]},set value(h){t(t()[0]=h,!0)}})},$$slots:{default:!0}});var v=z(f,2);oe(v,{label:"Threshold",children:(m,g)=>{Tr(m,{min:3,max:50,get value(){return t()[1]},set value(h){t(t()[1]=h,!0)}})},$$slots:{default:!0}}),T(c,u)},$$slots:{default:!0}})),pe()}var D1=K("<h2>Selected methods</h2> <!>",1),B1=K("<p>No methods selected</p>"),V1=K("<p> </p>"),Y1=K("<h2>Available methods</h2>"),W1=K("<p>Maximum number of methods is selected.</p>"),U1=K("<p> </p> <!>",1),H1=K('<div><!> <!> <!></div> <div class="downloads-block"><!></div> <div class="methods-list svelte-15cx0gr"><!> <!></div>',1);function G1(l,e){ge(e,!0);let t=Y(e,"prepobj",31,()=>Re([])),s=Y(e,"meta",15),a=Y(e,"varind",31,()=>-1),o=Y(e,"rawdataShort",15),c=Y(e,"prepdataShort",15),d=Y(e,"prepmodel",3,null),u=Y(e,"reset",3,null),f=Y(e,"finalize",3,null);const v=30,m=8,g={savgol:T1,norm:N1,scale:z1,baseline:I1,trim:q1,spikes:O1};let h=ne("neutral"),p=ne(""),_=ne(void 0),b=ne(""),y=ne(Re([])),C=ne(Re([])),E=ne(Re([]));s(new Array(m).fill(""));const k=w(()=>e.rawdata.values.ncols-e.rawdata.nresp);let S=Re(e.rawdata.values.nrows<3?Object.keys(g).filter(ee=>ee!=="scale"):Object.keys(g));M(),t().length!==0&&A();async function A(){t().length!==0&&V(_,e.WASM().then(ee=>{V(h,"applying");const ie=mi(ee,o().values,0,t(),!0,[]),ue=ta(ee,o().values,0,ie,!0);c(ka(o(),ue)),V(h,"success")}).catch(ee=>{c(ka(o())),console.error(ee),V(h,"error"),V(p,ee,!0)}),!0)}function M(){if(!e.rawdata)return;if(!t()||t().length<1){e.setLeft(0),e.setRight(e.rawdata.values.ncols),V(C,[],!0),V(E,[],!0);return}let ee=[],ie=[],ue=0,be=e.rawdata.values.ncols-e.rawdata.nresp;for(let fe of t())fe.id==="trim"?(ee.push(ue),ie.push(be),fe.params[0]<ue&&(fe.params[0]=ue),fe.params[1]>be&&(fe.params[1]=be),ue=fe.params[0]>ue?fe.params[0]:ue,be=fe.params[1]>0&&fe.params[1]<be?fe.params[1]:be):(ee.push(ue),ie.push(be));V(C,ee,!0),V(E,ie,!0),e.setLeft(ue),e.setRight(be)}function N(ee){const ie=Xr.find(ue=>ue.id===ee);ie&&(r(C).push(e.left),r(E).push(e.right),t().push({id:ie.id,params:ie.mp}),V(b,t().length-1))}function P(ee){if(ee<=0)return;const ie=t()[ee],ue=t()[ee-1];t(t()[ee-1]=ie,!0),t(t()[ee]=ue,!0),D()}function I(ee){if(ee<0||ee===t().length-1)return;const ie=t()[ee],ue=t()[ee+1];t(t()[ee+1]=ie,!0),t(t()[ee]=ue,!0),D()}function R(ee){ee<0||ee>=t().length||(t(t().filter((ie,ue)=>ue!==ee)),D())}function q(ee){V(b,ee,!0)}function U(){V(b,null)}function D(){V(h,"neutral"),V(p,""),V(b,null),M(),A(),a(a()[1]=-1,!0),a(a()[2]=-1,!0)}ce(()=>{e.rawdata&&!o()&&o(v1(e.rawdata,v))}),ce(()=>{o()&&!c()&&c(ka(o()))}),ce(()=>{(!t()||t().length===0)&&(V(y,[],!0),c(null),V(C,[],!0),V(E,[],!0),V(b,""),s(new Array(m).fill("")))});var L=H1(),F=J(L);let B;var O=j(F);oe(O,{label:"",children:(ee,ie)=>{var ue=D1(),be=z(J(ue),2);{var fe=ke=>{_i(ke,{text:"edit",get onclick(){return u()}})};W(be,ke=>{d()&&u()&&ke(fe)})}T(ee,ue)},$$slots:{default:!0}});var X=z(O,2);{var Z=ee=>{oe(ee,{label:"",children:(ie,ue)=>{var be=B1();T(ie,be)},$$slots:{default:!0}})},G=ee=>{var ie=he(),ue=J(ie);Ye(ue,17,t,Ge,(be,fe,ke)=>{var De=he();const Ue=w(()=>g[r(fe).id]);var He=J(De);{var Ke=et=>{var qe=he(),Fe=J(qe);{let Ee=w(()=>ke===r(b));tl(Fe,()=>r(Ue),(ze,Pe)=>{Pe(ze,{get isOpen(){return r(Ee)},get left(){return r(C)[ke]},get right(){return r(E)[ke]},pos:ke,get nvars(){return r(k)},moveUp:P,moveDown:I,apply:D,open:q,close:U,remove:R,get params(){return r(fe).params},set params(Mt){r(fe).params=Mt},get varind(){return a()},set varind(Mt){a(Mt)},get settings(){return s()[ke]},set settings(Mt){s(s()[ke]=Mt,!0)}})})}T(et,qe)},gt=et=>{var qe=he(),Fe=J(qe);{let Ee=w(()=>ke===r(b));tl(Fe,()=>r(Ue),(ze,Pe)=>{Pe(ze,{pos:ke,get isOpen(){return r(Ee)},get left(){return r(C)[ke]},get right(){return r(E)[ke]},get nvars(){return r(k)},moveUp:P,moveDown:I,apply:D,open:q,close:U,remove:R,get params(){return r(fe).params},set params(Mt){r(fe).params=Mt},get settings(){return s()[ke]},set settings(Mt){s(s()[ke]=Mt,!0)}})})}T(et,qe)};W(He,et=>{r(fe).id==="norm"||r(fe).id==="trim"?et(Ke):et(gt,!1)})}T(be,De)}),T(ee,ie)};W(X,ee=>{t().length===0?ee(Z):ee(G,!1)})}var $=z(X,2);{var le=ee=>{oe(ee,{status:"error",children:(ie,ue)=>{var be=V1(),fe=j(be);ae(()=>ve(fe,r(p))),T(ie,be)},$$slots:{default:!0}})};W($,ee=>{(r(h)==="error"||r(p))&&ee(le)})}var te=z(F,2),se=j(te);{var _e=ee=>{oe(ee,{label:" ",children:(ie,ue)=>{lt(ie,{get onclick(){return f()},text:"Finalize"})},$$slots:{default:!0}})};W(se,ee=>{!d()&&!r(b)&&t().length>0&&ee(_e)})}var Se=z(te,2),xe=j(Se);oe(xe,{label:"",children:(ee,ie)=>{var ue=Y1();T(ee,ue)},$$slots:{default:!0}});var de=z(xe,2);{var ye=ee=>{oe(ee,{label:"",children:(ie,ue)=>{var be=W1();T(ie,be)},$$slots:{default:!0}})},me=ee=>{var ie=he(),ue=J(ie);Ye(ue,17,()=>S,Ge,(be,fe)=>{const ke=w(()=>Xr.find(De=>De.id===r(fe)));oe(be,{children:(De,Ue)=>{var He=U1(),Ke=J(He),gt=j(Ke),et=z(Ke,2);Qf(et,{onclick:()=>N(r(ke).id)}),ae(()=>ve(gt,r(ke).title)),T(De,He)},$$slots:{default:!0}})}),T(ee,ie)};W(de,ee=>{t().length>=m?ee(ye):ee(me,!1)})}ae(ee=>B=pt(F,1,"selected-methods-list svelte-15cx0gr",null,B,ee),[()=>({final:d()!==null&&d()!==void 0})]),T(l,L),pe()}var X1=K("<!> <!>",1),K1=K("<!> <!>",1),J1=K("<!> <!>",1),Q1=K("<!> <!> <!> <!> <!> <!> <!> <!>",1),Z1=K("<h2>Plot settings</h2>"),$1=K("<!> <!>",1),em=K('<div class="plot-area svelte-x8qn01"><div class="plot svelte-x8qn01"><!></div></div> <div class="plot-controls-area svelte-x8qn01"><!> <!> <!></div>',1),tm=K('<div class="plot-panel svelte-x8qn01"><!></div>');function rm(l,e){ge(e,!0);let t=ne(!0),s=ne("none"),a=ne(!1);const o=w(()=>(r(t)?"Preprocessed":"Raw")+" data (selected rows)"),c=w(()=>r(t)&&e.prepdata?e.prepdata:e.rawdata),d=w(()=>r(c)?r(c).varaxisLabel:"Variables"),u=w(()=>e.rawdata.varaxisUnits),f=w(()=>r(t)&&r(c)&&e.left>=0&&e.right<r(c).values.nrows&&e.left<e.right?Pt.seq(e.left+1,e.right):null),v=w(()=>r(f)?r(c).varvalues.filter((S,A)=>A>=e.left&&A<e.right):r(c).varvalues),m=w(()=>r(f)?r(c).values.subset(r(f),null):r(c).values),g=w(()=>r(m)?Vl(r(m).v):null),h=w(()=>r(g)?(r(g)[1]-r(g)[0])*.05:null),p=w(()=>r(g)?[r(g)[0],r(g)[1]+(r(s)!=="none")*r(h)]:[0,1]),_=w(()=>r(c)?Vl(r(c).varvalues):[0,1]),b=w(()=>r(a)?[r(c).varvalues[e.left],r(c).varvalues[e.right-1]]:r(_)),y=w(()=>{if(!e.rawdata)return null;const S={none:{colors:"#ff0000"}};if(e.rawdata.classes&&e.rawdata.classNames&&e.rawdata.classNames.length>1){const A=rs(e.rawdata.classNames.length);S.groups={colors:e.rawdata.classes.map(M=>A[e.rawdata.classNames.findIndex(N=>N===M)]),breaks:Nr(0,e.rawdata.classNames.length),labels:e.rawdata.classNames,map:A}}if(e.rawdata.resp&&e.rawdata.resp.length===e.rawdata.values.ncols){const A=Vo(e.rawdata.resp,8),M=rs(A.length-1);S.response={colors:sc(e.rawdata.resp.v,A.v,M),labels:null,breaks:A,map:M}}return S});ce(()=>{(e.left<1||e.right<1||e.right>=e.left)&&V(a,!1)});var C=tm(),E=j(C);{var k=S=>{var A=em(),M=J(A),N=j(M),P=j(N);Xi(P,{get title(){return r(o)},get limY(){return r(p)},get limX(){return r(b)},fileName:"plot-preprocessed",children:(L,F)=>{var B=Q1(),O=J(B);{var X=me=>{$i(me,{get xValues(){return r(v)},get yValues(){return r(m)}})},Z=me=>{var ee=he(),ie=J(ee);Ye(ie,17,()=>r(y)[r(s)].colors,Ge,(ue,be,fe)=>{{let ke=w(()=>r(m).getcolumn(fe+1));Ht(ue,{get xValues(){return r(v)},get yValues(){return r(ke)},get lineColor(){return r(be)}})}}),T(me,ee)};W(O,me=>{r(s)==="none"?me(X):me(Z,!1)})}var G=z(O,2);{var $=me=>{var ee=X1();const ie=w(()=>r(c).varvalues[e.varind[0]]);var ue=J(ee);{let fe=w(()=>[r(ie),r(ie)]);Ht(ue,{get xValues(){return r(fe)},get yValues(){return r(p)},lineColor:"#00000060"})}var be=z(ue,2);{let fe=w(()=>[r(ie)]),ke=w(()=>[r(p)[1]-r(h)*(r(s)==="none"?1:2)]),De=w(()=>Kr(r(ie).toFixed(2)+" "+r(u)));ls(be,{get xValues(){return r(fe)},get yValues(){return r(ke)},get labels(){return r(De)},textColor:"#a0a0a0",textSize:.8,pos:2})}T(me,ee)};W(G,me=>{e.varind&&e.varind[0]>0&&me($)})}var le=z(G,2);{var te=me=>{var ee=K1();const ie=w(()=>r(c).varvalues[e.varind[1]]);var ue=J(ee);{let fe=w(()=>[r(b)[0]]),ke=w(()=>[r(c).varvalues[e.varind[1]]-r(b)[0]]),De=w(()=>[r(p)[1]]),Ue=w(()=>[r(p)[1]-r(p)[0]]);ol(ue,{get left(){return r(fe)},get width(){return r(ke)},get top(){return r(De)},get height(){return r(Ue)},lineColor:"transparent",faceColor:"#00000040"})}var be=z(ue,2);{let fe=w(()=>[r(ie)]),ke=w(()=>[r(p)[1]-r(h)*(r(s)==="none"?1:2)]),De=w(()=>Kr(r(ie).toFixed(2)+" "+r(u)));ls(be,{get xValues(){return r(fe)},get yValues(){return r(ke)},get labels(){return r(De)},textColor:"#a0a0a0",textSize:.8,pos:2})}T(me,ee)};W(le,me=>{e.varind&&e.varind[1]>0&&me(te)})}var se=z(le,2);{var _e=me=>{var ee=J1();const ie=w(()=>r(c).varvalues[e.varind[2]-1]);var ue=J(ee);{let fe=w(()=>[r(c).varvalues[e.varind[2]-1]]),ke=w(()=>[r(b)[1]-r(c).varvalues[e.varind[2]-1]]),De=w(()=>[r(p)[1]]),Ue=w(()=>[r(p)[1]-r(p)[0]]);ol(ue,{get left(){return r(fe)},get width(){return r(ke)},get top(){return r(De)},get height(){return r(Ue)},lineColor:"transparent",faceColor:"#00000040"})}var be=z(ue,2);{let fe=w(()=>[r(ie)]),ke=w(()=>[r(p)[1]-r(h)*(r(s)==="none"?1:2)]),De=w(()=>Kr(r(ie).toFixed(2)+" "+r(u)));ls(be,{get xValues(){return r(fe)},get yValues(){return r(ke)},get labels(){return r(De)},textColor:"#a0a0a0",textSize:.8,pos:2})}T(me,ee)};W(se,me=>{e.varind&&e.varind[2]<r(c).varvalues.length&&e.varind[2]>0&&me(_e)})}var Se=z(se,2);{let me=w(()=>r(s)!=="none");ba(Se,{get show(){return r(me)},get labels(){return r(y)[r(s)].labels},get breaks(){return r(y)[r(s)].breaks},get colmap(){return r(y)[r(s)].map}})}var xe=z(Se,2);Ki(xe,{get label(){return r(d)},showGrid:!0});var de=z(xe,2);Ji(de,{showGrid:!0});var ye=z(de,2);Qi(ye,{}),T(L,B)},$$slots:{default:!0}});var I=z(M,2),R=j(I);oe(R,{label:"",children:(L,F)=>{var B=Z1();T(L,B)},$$slots:{default:!0}});var q=z(R,2);oe(q,{label:"Show",children:(L,F)=>{rr(L,{options:["raw","preprocessed"],get value(){return r(t)},set value(B){V(t,B,!0)}})},$$slots:{default:!0}});var U=z(q,2);{var D=L=>{var F=$1(),B=J(F);oe(B,{label:"Color by",children:(Z,G)=>{{let $=w(()=>Object.keys(r(y)));Xe(Z,{get options(){return r($)},get value(){return r(s)},set value(le){V(s,le,!0)}})}},$$slots:{default:!0}});var O=z(B,2);{var X=Z=>{oe(Z,{label:"Zoom (x-axis)",children:(G,$)=>{rr(G,{options:["off","on"],get value(){return r(a)},set value(le){V(a,le,!0)}})},$$slots:{default:!0}})};W(O,Z=>{e.left>0&&e.right>e.left&&Z(X)})}T(L,F)};W(U,L=>{Object.keys(r(y)).length>1&&L(D)})}T(S,A)};W(E,S=>{r(v)&&r(m)&&S(k)})}T(l,C),pe()}var nm=K('<div class="widget-container svelte-1soqt9v"><div class="app-controls svelte-1soqt9v"><div class="prep-creator svelte-1soqt9v"><!></div></div> <div class="app-content svelte-1soqt9v"><!></div></div>');function lm(l,e){ge(e,!0);let t=Y(e,"left",15),s=Y(e,"right",15),a=Y(e,"prepobj",15),o=Y(e,"meta",15),c=Y(e,"finalize",3,null),d=ne(Re([-1,0,0])),u=ne(null),f=ne(null);function v(E){const k=e.rawdata.values.ncols-e.rawdata.nresp;e.rawdata&&E>=0&&E<k&&E<s()&&t(E)}function m(E){const k=e.rawdata.values.ncols-e.rawdata.nresp;e.rawdata&&E<=k&&E>t()&&s(E)}var g=nm(),h=j(g),p=j(h),_=j(p);G1(_,{get WASM(){return e.WASM},get rawdata(){return e.rawdata},get outliers(){return e.outliers},get left(){return t()},get right(){return s()},setLeft:v,",":!0,setRight:m,get finalize(){return c()},get varind(){return r(d)},set varind(E){V(d,E,!0)},get prepobj(){return a()},set prepobj(E){a(E)},get rawdataShort(){return r(u)},set rawdataShort(E){V(u,E,!0)},get prepdataShort(){return r(f)},set prepdataShort(E){V(f,E,!0)},get meta(){return o()},set meta(E){o(E)}});var b=z(h,2),y=j(b);{var C=E=>{rm(E,{get rawdata(){return r(u)},get prepdata(){return r(f)},get left(){return t()},get right(){return s()},get varind(){return r(d)}})};W(y,E=>{r(u)&&E(C)})}T(l,g),pe()}var sm=K('<p class="info-text"><span style="color:#a0a0a0;">Preprocessing:</span> <!></p>'),am=K("<!> <!> <!>",1),om=K('<p class="info-text"><span style="color:#a0a0a0;">Preprocessing:</span> skipped</p> <div><!></div>',1),im=K("<!> <!> <!>",1),cm=K("<p><strong>Preprocessing model</strong></p>"),um=K("<!> <!>",1),fm=K("<p> </p>"),dm=K('<div class="prep-widget"><!></div> <!> <!>',1);function vm(l,e){ge(e,!0);let t=Y(e,"prepType",15),s=Y(e,"prepobj",15),a=Y(e,"prepdata",15),o=Y(e,"prepmodel",15),c=Y(e,"prepmeta",15),d=ne(!1),u=ne(0),f=ne(Re(e.rawdata?e.rawdata.values.ncols-e.rawdata.nresp:0)),v=ne("neutral"),m=ne(""),g=ne(void 0);async function h(q,U,D){!U||!q||U.length===0||V(g,e.WASM().then(L=>{V(v,"applying");const F=mi(L,q.values,q.nresp,U,!1,D);F.info=c(),o(F)}).catch(L=>{o(null),console.error(L),V(v,"error"),V(m,L,!0)}),!0)}async function p(q,U){if(!U||typeof U!="object"){a(null);return}if(Object.keys(U).length===0){a(q);return}V(g,e.WASM().then(D=>{V(v,"applying");const L=ta(D,q.values,q.nresp,U,!1,!1),F=m1(nu(q),L);a(Rf(F,U))}).catch(D=>{a(null),console.error(D),V(v,"error"),V(m,D,!0)}),!0)}function _(){t(null),a(null),o(null),s([]),setLeft(0),setRight(e.rawdata.values.ncols-e.rawdata.nresp)}function b(){h(e.rawdata,s(),e.outliers),V(d,!1)}function y(){t("create"),a(null),o(null),V(d,!0)}function C(){t("skip"),o({})}ce(()=>{o(),e.rawdata&&p(e.rawdata,o())}),ce(()=>{t()==="create"&&s()&&!o()&&h(e.rawdata,s(),e.outliers)}),ce(()=>{t()==="skip"&&a()===null&&(o({}),s([]),a(e.rawdata))});var E=dm(),k=J(E),S=j(k);{var A=q=>{oe(q,{name:"info",children:(U,D)=>{var L=am(),F=J(L);{var B=G=>{var $=sm(),le=z(j($),2);Ea(le,{get prepmodel(){return o()}}),T(G,$)};W(F,G=>{r(d)||G(B)})}var O=z(F,2);{var X=G=>{_i(G,{onclick:y})};W(O,G=>{t()==="create"&&G(X)})}var Z=z(O,2);Mr(Z,{onclick:_}),T(U,L)},$$slots:{default:!0}})},M=q=>{var U=he(),D=J(U);{var L=B=>{oe(B,{name:"prep-info",children:(O,X)=>{var Z=om(),G=z(J(Z),2),$=j(G);Mr($,{onclick:_}),T(O,Z)},$$slots:{default:!0}})},F=B=>{var O=he(),X=J(O);{var Z=$=>{oe($,{label:"Preprocessing",name:"prep-container",children:(le,te)=>{var se=im(),_e=J(se);lt(_e,{text:"Skip",onclick:C});var Se=z(_e,2);lt(Se,{text:"Load",onclick:()=>t("file")});var xe=z(Se,2);lt(xe,{text:"Create",onclick:y}),T(le,se)},$$slots:{default:!0}})},G=$=>{var le=he(),te=J(le);{var se=_e=>{var Se=um(),xe=J(Se);oe(xe,{children:(ye,me)=>{var ee=cm();T(ye,ee)},$$slots:{default:!0}});var de=z(xe,2);x1(de,{get model(){return o()},set model(ye){o(ye)},get prepobj(){return s()},set prepobj(ye){s(ye)},get left(){return r(u)},set left(ye){V(u,ye,!0)},get right(){return r(f)},set right(ye){V(f,ye,!0)}}),T(_e,Se)};W(te,_e=>{t()==="file"&&_e(se)},!0)}T($,le)};W(X,$=>{t()?$(G,!1):$(Z)},!0)}T(B,O)};W(D,B=>{t()==="skip"?B(L):B(F,!1)},!0)}T(q,U)};W(S,q=>{o()&&a()&&o().ml?q(A):q(M,!1)})}var N=z(k,2);{var P=q=>{_a(q,{closeModal:b,isDark:!0,children:(U,D)=>{lm(U,{get WASM(){return e.WASM},get rawdata(){return e.rawdata},get outliers(){return e.outliers},finalize:b,get prepobj(){return s()},set prepobj(L){s(L)},get left(){return r(u)},set left(L){V(u,L,!0)},get right(){return r(f)},set right(L){V(f,L,!0)},get meta(){return c()},set meta(L){c(L)}})},$$slots:{default:!0}})};W(N,q=>{r(d)&&q(P)})}var I=z(N,2);{var R=q=>{oe(q,{status:"error",children:(U,D)=>{var L=fm(),F=j(L);ae(()=>ve(F,r(m))),T(U,L)},$$slots:{default:!0}})};W(I,q=>{(r(v)==="error"||r(m))&&q(R)})}T(l,E),pe()}var mm=K('<span style="font-weight:bold"> </span><br/>',1),hm=K('<span class="file-size svelte-gdjwex"> </span> <span>(X)</span>, <span class="file-size svelte-gdjwex"> </span> <span>(Y)</span>',1),gm=K('<span class="file-size svelte-gdjwex"> </span>'),pm=K('<p class="dataset-info svelte-gdjwex"><!> <span>Data file:</span> <span class="file-name svelte-gdjwex"> </span><br/> <span>Size:</span> <!></p> <!>',1);function bm(l,e){ge(e,!0);let t=Y(e,"title",3,"");var s=he(),a=J(s);{var o=c=>{oe(c,{children:(d,u)=>{var f=pm(),v=J(f),m=j(v);{var g=E=>{var k=mm(),S=J(k),A=j(S);ae(()=>ve(A,t())),T(E,k)};W(m,E=>{t()&&t()!==""&&E(g)})}var h=z(m,4),p=j(h),_=z(h,5);{var b=E=>{var k=hm(),S=J(k),A=j(S),M=z(S,4),N=j(M);ae(()=>{ve(A,`${e.dataset.values.nrows??""}×${e.dataset.values.ncols-e.dataset.nresp}`),ve(N,`${e.dataset.values.nrows??""}×${e.dataset.nresp??""}`)}),T(E,k)},y=E=>{var k=gm(),S=j(k);ae(()=>ve(S,`${e.dataset.values.nrows??""}×${e.dataset.values.ncols??""}`)),T(E,k)};W(_,E=>{e.dataset.nresp&&e.dataset.nresp>0?E(b):E(y,!1)})}var C=z(v,2);Mr(C,{get onclick(){return e.reset}}),ae(()=>{H(h,"title",e.dataset.fileName),ve(p,e.dataset.fileName)}),T(d,f)},$$slots:{default:!0}})};W(a,c=>{e.dataset&&c(o)})}T(l,s),pe()}var _m=K("<!> <!>",1),wm=K("<!> <!> <!> <!> <!> <!>",1),ym=K("<!> <!>",1),xm=K("<p> </p>"),km=K("<!> <p> </p>",1),Em=K("<p> </p>"),Sm=K("<!> <!> <!>",1);function Sa(l,e){ge(e,!0);let t=Y(e,"model",3,null),s=Y(e,"outliers",19,()=>[]),a=Y(e,"className",3,"Class"),o=Y(e,"classMandatory",3,!1),c=Y(e,"classUnique",3,!1),d=Y(e,"title",3,""),u=Y(e,"dataset",15),f=Y(e,"resobj",15),v=Y(e,"csvOnly",3,!0);const m=[",",";"],g=w(()=>t()?["no","yes"]:["no","labels","values"]);let h=ne(void 0),p=ne(""),_=ne(""),b=ne(","),y=ne("no"),C=ne(!1),E=ne(!1),k=ne(null),S=ne("neutral"),A=ne("");function M(te){V(S,"error"),V(A,te,!0),console.error(te)}function N(){V(S,"neural"),V(A,"")}function P(){V(S,"success"),V(A,"")}function I(te,se,_e){V(k,e.WASM().then(Se=>{f(na(Se,te,se,_e,!0)),P()}).catch(Se=>{f(null),M(Se)}),!0)}function R(te,se){if(!te||te.size<10)return;const Se=te.slice(0,1e5),xe=new FileReader;xe.onload=()=>{const de=xe.result;!de||de.length<0||((ye=>{var me=ms(ye,4);V(b,me[0],!0),V(C,me[1],!0),V(E,me[2],!0),V(y,me[3],!0)})(Df(de)),V(E,o()||r(E),!0),se&&r(y)!=="no"&&V(y,"yes"))},xe.onerror=function(de){csvString=null,V(S,"error"),V(A,de,!0),console.error("Error reading CSV file.",de)},xe.readAsText(Se)}function q(te){try{const se=qf(te,r(b),r(y)==="yes"?"labels":r(y),r(C),r(E),r(p),r(_));if(se.values.nrows<1)throw new Error("Dataset must have at least 1 row.");if(t()&&se.values.ncols!==t().ncols+t().exclvars.length)throw new Error("Dataset has different number of columns than the training set.");if(se.classNames.length>se.values.nrows/2)throw new Error("Dataset has too many unique "+a().toLowerCase()+" labels ("+se.classNames.length+"), check your CSV file.");if(o()&&se.classNames.length===0)throw new Error("Dataset set must have a column filled with class names.");if(c()&&se.classNames.length>1)throw new Error("Dataset set must have a column filled with only single (target) class name.");se.fileName=r(h).name.replace(/\.[^/.]+$/,""),t()&&(se.varrev=t().varrev,se.header=t().header,se.varlabels=t().varlabels,se.varvalues=t().varvalues,se.varvaluesName=t().varvaluesName,se.varvaluesUnits=t().varvaluesUnits),u(se),P()}catch(se){u(null),M(se)}}function U(te){const se=new FileReader;se.onload=()=>{q(se.result)},se.readAsText(r(h))}async function D(te){try{const se=r(h)instanceof FileList?r(h):[r(h)];u(await Hf(se)),P()}catch(se){M("Failed to read SPC file: "+se)}}function L(){V(h,""),u(null),f(null),V(p,""),V(_,""),N()}ce(()=>{if(!(r(h)===0||r(h)===void 0||u())){if(r(h)===null||r(h)===""){L();return}if(Array.isArray(r(h))){if(r(h).filter(te=>te.slice(-4)===".spc").length!==r(h).length){M("Multiple file selection is allowed only for SPC files.");return}D(r(h));return}r(h)&&(r(h).type==="text/csv"||r(h).type==="application/vnd.ms-excel")?(R(r(h),t()),N()):D([r(h)])}}),ce(()=>{r(b)&&N()}),ce(()=>{if(u()&&t()&&!f()&&!r(A))try{f(I(t(),u(),s())),P()}catch(te){u(null),f(null),M(te)}});var F=Sm(),B=J(F);{var O=te=>{var se=ym(),_e=J(se);Rn(_e,()=>r(h)===void 0,de=>{oe(de,{children:(ye,me)=>{var ee=he(),ie=J(ee);{var ue=fe=>{$l(fe,{id:"dataFile",message:"Select CSV file with dataset",get file(){return r(h)},set file(ke){V(h,ke,!0)}})},be=fe=>{$l(fe,{id:"dataFile",message:"Select CSV or SPC file with dataset",acceptType:".csv, .spc",multiple:!0,get file(){return r(h)},set file(ke){V(h,ke,!0)}})};W(ie,fe=>{v()?fe(ue):fe(be,!1)})}T(ye,ee)},$$slots:{default:!0}})});var Se=z(_e,2);{var xe=de=>{var ye=wm(),me=J(ye);oe(me,{label:"Delimiter",children:(Ue,He)=>{Xe(Ue,{id:"sep",get options(){return m},get value(){return r(b)},set value(Ke){V(b,Ke,!0)}})},$$slots:{default:!0}});var ee=z(me,2);oe(ee,{label:"Row labels",children:(Ue,He)=>{rr(Ue,{id:"hasLabels",options:["no","yes"],get value(){return r(C)},set value(Ke){V(C,Ke,!0)}})},$$slots:{default:!0}});var ie=z(ee,2);{var ue=Ue=>{oe(Ue,{get label(){return`${a()??""} labels`},children:(He,Ke)=>{rr(He,{id:"hasLabels",options:["no","yes"],get value(){return r(E)},set value(gt){V(E,gt,!0)}})},$$slots:{default:!0}})};W(ie,Ue=>{o()||Ue(ue)})}var be=z(ie,2);oe(be,{label:"Header",children:(Ue,He)=>{Xe(Ue,{id:"header",get options(){return r(g)},get value(){return r(y)},set value(Ke){V(y,Ke,!0)}})},$$slots:{default:!0}});var fe=z(be,2);{var ke=Ue=>{var He=_m(),Ke=J(He);oe(Ke,{label:"Header name",children:(et,qe)=>{Ni(et,{id:"varvaluesName",placeholder:"e.g. Wavelength",get value(){return r(p)},set value(Fe){V(p,Fe,!0)}})},$$slots:{default:!0}});var gt=z(Ke,2);oe(gt,{label:"Header units",children:(et,qe)=>{Ni(et,{id:"varvaluesUnits",maxLength:10,placeholder:"e.g. nm",get value(){return r(_)},set value(Fe){V(_,Fe,!0)}})},$$slots:{default:!0}}),T(Ue,He)};W(fe,Ue=>{r(y)==="values"&&Ue(ke)})}var De=z(fe,2);oe(De,{label:" ",children:(Ue,He)=>{lt(Ue,{text:"Load",onclick:U})},$$slots:{default:!0}}),T(de,ye)};W(Se,de=>{r(h)&&!Array.isArray(r(h))&&(r(h).type==="text/csv"||r(h).type==="application/vnd.ms-excel")&&de(xe)})}T(te,se)},X=te=>{var se=he(),_e=J(se);{var Se=xe=>{var de=he(),ye=J(de);qs(ye,()=>r(k),me=>{oe(me,{children:(ee,ie)=>{var ue=km(),be=J(ue);aa(be);var fe=z(be,2),ke=j(fe);ae(()=>ve(ke,t()?"Loading data and apply model...":"Loading data...")),T(ee,ue)},$$slots:{default:!0}})},void 0,(me,ee)=>{oe(me,{status:"error",children:(ie,ue)=>{var be=xm(),fe=j(be);ae(()=>ve(fe,r(ee))),T(ie,be)},$$slots:{default:!0}})}),T(xe,de)};W(_e,xe=>{r(k)&&xe(Se)})}T(te,se)};W(B,te=>{u()?te(X,!1):te(O)})}var Z=z(B,2);{var G=te=>{bm(te,{get dataset(){return u()},reset:L,get title(){return d()}})};W(Z,te=>{u()&&te(G)})}var $=z(Z,2);{var le=te=>{oe(te,{status:"error",children:(se,_e)=>{var Se=Em(),xe=j(Se);ae(()=>ve(xe,r(A))),T(se,Se)},$$slots:{default:!0}})};W($,te=>{(r(S)==="error"||r(A))&&te(le)})}T(l,F),pe()}var Cm=K("<!> <!> <!> <!>",1),Am=K("<p> </p>"),Nm=K("<!> <p>Computing global model...</p>",1),Mm=K('<p><span style="color:#a0a0a0;">PCA model:</span> </p> <!>',1),Tm=K('<div class="buttons"><!> <!></div>'),Pm=K("<!> <!>",1),zm=K("<p> </p>"),Lm=K("<!> <!> <!> <!>",1);function Rm(l,e){ge(e,!0);let t=Y(e,"outliers",19,()=>[]),s=Y(e,"resobj",15),a=Y(e,"model",15),o=Y(e,"downloadModel",3,null),c=Y(e,"downloadResults",3,null),d=ne("neutral"),u=ne(""),f=ne(1),v=ne(!0),m=ne(!1),g=ne(void 0);async function h(I,R,q,U){V(g,e.WASM().then(D=>{V(d,"computing");const L=Mf(D,I.values,R,q,U,t());L.hash=ra(),L.exclvars=[],L.varlabels=I.varlabels,L.varindices=I.varindices,L.varvalues=I.varvalues,L.varvaluesName=I.varvaluesName,L.varvaluesUnits=I.varvaluesUnits,L.varrev=I.varrev,L.prep=[];const F=na(D,L,I,t());a(L),s(F),V(d,"success")}).catch(D=>{console.error(D),a(null),V(d,"error"),V(u,D,!0)}),!0)}function p(I){V(d,"neutral"),V(u,null),h(e.dataset,r(f),r(v),r(m))}function _(){V(d,"neutral"),V(g,null),s(null),a(null),V(u,null)}let b=w(()=>e.dataset?Math.min(e.dataset.values.nrows-2-t().length,e.dataset.values.ncols-1,50):null);ce(()=>{e.dataset===null&&_()}),ce(()=>{V(f,r(b)?Math.min(r(b),20):null,!0)});var y=Lm(),C=J(y);{var E=I=>{var R=Cm(),q=J(R);oe(q,{name:"ncomp",label:"# of PCs",children:(F,B)=>{qn(F,{id:"ncomp",min:1,get max(){return r(b)},step:1,decNum:0,get value(){return r(f)},set value(O){V(f,O,!0)}})},$$slots:{default:!0}});var U=z(q,2);oe(U,{name:"center",label:"Center",children:(F,B)=>{rr(F,{id:"center",options:["no","yes"],get value(){return r(v)},set value(O){V(v,O,!0)}})},$$slots:{default:!0}});var D=z(U,2);oe(D,{name:"scale",label:"Scale",children:(F,B)=>{rr(F,{id:"scale",options:["no","yes"],get value(){return r(m)},set value(O){V(m,O,!0)}})},$$slots:{default:!0}});var L=z(D,2);oe(L,{name:"create-model",label:" ",children:(F,B)=>{lt(F,{onclick:p,text:"Create model"})},$$slots:{default:!0}}),T(I,R)};W(C,I=>{e.dataset&&!a()&&r(d)!=="computing"&&I(E)})}var k=z(C,2);{var S=I=>{var R=he(),q=J(R);qs(q,()=>r(g),U=>{oe(U,{name:"spinner",children:(D,L)=>{var F=Nm(),B=J(F);aa(B),T(D,F)},$$slots:{default:!0}})},void 0,(U,D)=>{oe(U,{name:"error",status:"error",children:(L,F)=>{var B=Am(),O=j(B);ae(()=>ve(O,r(D))),T(L,B)},$$slots:{default:!0}})}),T(I,R)};W(k,I=>{r(g)&&I(S)})}var A=z(k,2);{var M=I=>{var R=Pm(),q=J(R);oe(q,{name:"info",children:(L,F)=>{var B=Mm(),O=J(B),X=z(j(O)),Z=z(O,2);Mr(Z,{onclick:_}),ae(()=>ve(X,` ${a().ncomp??""} PCs${a().center?", centered":""}${a().scale?", scaled":""}`)),T(L,B)},$$slots:{default:!0}});var U=z(q,2);{var D=L=>{oe(L,{name:"download-buttons",label:"Download",children:(F,B)=>{var O=Tm(),X=j(O);lt(X,{onclick:()=>c()(s(),e.dataset,"train",t(),a()),text:"Results"});var Z=z(X,2);lt(Z,{onclick:()=>o()(a()),text:"Model"}),T(F,O)},$$slots:{default:!0}})};W(U,L=>{o()&&c()&&L(D)})}T(I,R)};W(A,I=>{a()&&I(M)})}var N=z(A,2);{var P=I=>{oe(I,{name:"error",status:"error",children:(R,q)=>{var U=zm(),D=j(U);ae(()=>ve(D,r(u))),T(R,U)},$$slots:{default:!0}})};W(N,I=>{(r(d)==="error"||r(u))&&I(P)})}T(l,y),pe()}var Im=K("<!> <!> <!>",1),jm=K("<p> </p>"),qm=K("<!> <p>Computing PV-set...</p>",1),Fm=K('<p><span style="color:#a0a0a0;">PV-set:</span> </p> <!> <!>',1),Om=K("<p> </p>"),Dm=K("<!> <!> <!> <!>",1);function Bm(l,e){ge(e,!0);let t=Y(e,"outliers",19,()=>[]),s=Y(e,"pvset",15),a=Y(e,"pvres",15),o=ne("neutral"),c=ne(""),d=ne(Re(["ven","rand","loo"])),u=ne("ven"),f=ne(void 0),v=e.calset.values.nrows-t().length,m=e.calset&&e.calset.values.nrows>0?[3,4,5,10,20].filter(P=>P>=v/(v-e.model.ncomp-1)&&P<=v/2):[],g=ne(Re(m.length>0?m[0]:0));ce(()=>{m.length===0&&(V(d,["loo"],!0),V(u,"loo"))});async function h(P,I,R){V(f,e.WASM().then(q=>{const U=R.type=="loo"?0:R.type=="rand"?2:1,D=Pf(q,I,P.values,I.ncomp,R.nseg,U,0,t());s({classLabelsVarname:P.classLabelsVarname,classNames:P.classNames,dec:P.dec,fileName:P.fileName+"-pcv",hasClassNames:P.hasClassNames,hasLabels:P.hasLabels,header:P.header,labelsVarname:P.labelsVarname,classes:e.calres.classes,objindices:e.calres.objindices,objlabels:e.calres.objlabels,responses:e.calres.responses,sep:P.sep,values:D,varAxisTitle:P.varAxisTitle,varindices:I.varindices,varlabels:I.varlabels,varrev:I.varrev,varvalues:I.varvalues,varvaluesName:I.varvaluesName,varvaluesUnits:I.varvaluesUnits}),a(na(q,I,s(),[]))}).catch(q=>{console.error(q),s(null),a(null),V(o,"error"),V(c,q,!0)}),!0)}function p(P){V(o,"neutral"),V(c,""),h(e.calset,e.model,{type:r(u),nseg:r(g)})}function _(){V(o,"neutral"),V(c,""),V(f,null),s(null),a(null)}ce(()=>{e.model===null&&_()});var b=Dm(),y=J(b);{var C=P=>{var I=Im(),R=J(I);oe(R,{name:"split",label:"Split type:",children:(L,F)=>{Xe(L,{id:"cvType",get options(){return r(d)},get value(){return r(u)},set value(B){V(u,B,!0)}})},$$slots:{default:!0}});var q=z(R,2);{var U=L=>{oe(L,{name:"nseg",label:"Segments:",children:(F,B)=>{Xe(F,{id:"nseg",get options(){return m},get value(){return r(g)},set value(O){V(g,O,!0)}})},$$slots:{default:!0}})};W(q,L=>{r(u)!=="loo"&&L(U)})}var D=z(q,2);oe(D,{name:"run-button",label:" ",children:(L,F)=>{lt(L,{onclick:p,text:"Compute PV-set"})},$$slots:{default:!0}}),T(P,I)};W(y,P=>{e.model&&!s()&&r(o)!=="busy"&&P(C)})}var E=z(y,2);{var k=P=>{var I=he(),R=J(I);qs(R,()=>r(f),q=>{oe(q,{name:"spinner",children:(U,D)=>{var L=qm(),F=J(L);aa(F),T(U,L)},$$slots:{default:!0}})},void 0,(q,U)=>{oe(q,{name:"error",status:"error",children:(D,L)=>{var F=jm(),B=j(F);ae(()=>ve(B,r(U))),T(D,F)},$$slots:{default:!0}})}),T(P,I)};W(E,P=>{r(f)&&P(k)})}var S=z(E,2);{var A=P=>{oe(P,{name:"info",children:(I,R)=>{var q=Fm(),U=J(q),D=z(j(U)),L=z(U,2);Jf(L,{onclick:()=>Vf(s(),e.calset.fileName+"-pv")});var F=z(L,2);Mr(F,{onclick:_}),ae(()=>ve(D,` ${s().values.nrows??""} × ${s().values.ncols??""}, ${r(u)??""}
      ${r(u)!=="loo"?r(g)+" seg":""}`)),T(I,q)},$$slots:{default:!0}})};W(S,P=>{s()&&P(A)})}var M=z(S,2);{var N=P=>{oe(P,{name:"error",status:"error",children:(I,R)=>{var q=Om(),U=j(q);ae(()=>ve(U,r(c))),T(I,q)},$$slots:{default:!0}})};W(M,P=>{r(o)==="error"&&r(c)&&P(N)})}T(l,b),pe()}var Vm=K('<tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Crit (outliers)</td><td class="svelte-kg0b31"></td><td class="svelte-kg0b31"></td><td class="svelte-kg0b31"> </td></tr>'),Ym=K('<table class="svelte-kg0b31"><thead><tr class="svelte-kg0b31"><th class="svelte-kg0b31"></th><th class="svelte-kg0b31">h</th><th class="svelte-kg0b31">q</th><th class="svelte-kg0b31">f</th></tr></thead><tbody><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">DoF (Nu)</td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"> </td></tr><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Mean (u0)</td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"></td></tr><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Crit (extreme)</td><td class="svelte-kg0b31"></td><td class="svelte-kg0b31"></td><td class="svelte-kg0b31"> </td></tr><!></tbody></table>');function Ca(l,e){ge(e,!0);let t=Y(e,"isAlt",3,!1),s=w(()=>e.simca?e.simca.limType==="classic"?"c":"r":null),a=w(()=>e.model&&r(s)?rt(e.model,r(s)+"Nh"):null),o=w(()=>e.model&&r(s)?rt(e.model,r(s)+"Nq"):null),c=w(()=>e.model&&r(s)?rt(e.model,r(s)+"h0"):null),d=w(()=>e.model&&r(s)?rt(e.model,r(s)+"q0"):null),u=w(()=>e.simca?e.simca.ncomp:null);var f=he(),v=J(f);{var m=g=>{var h=Ym(),p=z(j(h)),_=j(p),b=z(j(_)),y=j(b),C=z(b),E=j(C),k=z(C),S=j(k),A=z(_),M=z(j(A)),N=j(M),P=z(M),I=j(P),R=z(A),q=z(j(R),3),U=j(q),D=z(R);{var L=F=>{var B=Vm(),O=z(j(B),3),X=j(O);ae(Z=>ve(X,Z),[()=>e.simca.oCrit[r(u)-1].toFixed(1)]),T(F,B)};W(D,F=>{t()||F(L)})}ae((F,B,O)=>{ve(y,r(a)[r(u)-1]),ve(E,r(o)[r(u)-1]),ve(S,r(a)[r(u)-1]+r(o)[r(u)-1]),ve(N,F),ve(I,B),ve(U,O)},[()=>r(c)[r(u)-1].toFixed(3),()=>r(d)[r(u)-1].toFixed(r(d)[r(u)-1]>99?0:3),()=>e.simca.eCrit[r(u)-1].toFixed(1)]),T(g,h)};W(v,g=>{e.model&&e.simca&&r(u)>0&&g(m)})}T(l,f),pe()}var Wm=K('<p class="title"> </p>'),Um=K("<!> <!> <!> <!> <!>",1);function Aa(l,e){ge(e,!0);let t=Y(e,"isAlt",3,!1),s=Y(e,"simca",15),a=ne(void 0),o=ne(void 0);if(!s()&&e.model){const h="classic",p=rt(e.model,"cNh"),_=rt(e.model,"cNq"),b=p.map((S,A)=>S+_[A]),y=1-5/100,C=Math.pow(1-1/100,1/e.model.nrows),E=b.map(S=>ir(y,S)),k=b.map(S=>ir(C,S));V(a,5),V(o,1),s({ncomp:1,alpha:5,gamma:1,limType:h,Nf:b,eCrit:E,oCrit:k,className:e.className,hash:ra()})}const c=[10,5,1,.1],d=[5,1,.1,.01];ce(()=>{if(s().alpha&&r(a)!==s().alpha){const m=1-s().alpha/100;s(s().eCrit=s().Nf.map(g=>ir(m,g)),!0),V(a,s().alpha,!0)}if(s().gamma&&r(o)!==s().gamma){const m=Math.pow(1-s().gamma/100,1/e.model.nrows);s(s().oCrit=s().Nf.map(g=>ir(m,g)),!0),V(o,s().gamma,!0)}}),ce(()=>{const m=s().limType.charAt(0),g=rt(e.model,m+"Nh"),h=rt(e.model,m+"Nq"),p=g.map((E,k)=>E+h[k]),_=1-s().alpha/100,b=Math.pow(1-s().gamma/100,1/e.model.nrows),y=p.map(E=>ir(_,E)),C=p.map(E=>ir(b,E));s(s().Nf=p,!0),s(s().eCrit=y,!0),s(s().oCrit=C,!0)});var u=he(),f=J(u);{var v=m=>{var g=Um(),h=J(g);oe(h,{name:"target-class",label:"",children:(E,k)=>{var S=Wm(),A=j(S);ae(()=>ve(A,`Target class: ${s().className??""}`)),T(E,S)},$$slots:{default:!0}});var p=z(h,2);oe(p,{name:"ncomp",label:"# of PCs",children:(E,k)=>{qn(E,{min:1,get max(){return e.model.ncomp},step:1,decNum:0,get value(){return s().ncomp},set value(S){s(s().ncomp=S,!0)}})},$$slots:{default:!0}});var _=z(p,2);oe(_,{name:"alpha",label:"Alpha, %:",children:(E,k)=>{Xe(E,{get options(){return c},get value(){return s().alpha},set value(S){s(s().alpha=S,!0)}})},$$slots:{default:!0}});var b=z(_,2);{var y=E=>{oe(E,{name:"gamma",label:"Gamma, %:",children:(k,S)=>{Xe(k,{get options(){return d},get value(){return s().gamma},set value(A){s(s().gamma=A,!0)}})},$$slots:{default:!0}})};W(b,E=>{t()||E(y)})}var C=z(b,2);oe(C,{name:"limits",label:"Limits:",children:(E,k)=>{Xe(E,{options:["classic","robust"],get value(){return s().limType},set value(S){s(s().limType=S,!0)}})},$$slots:{default:!0}}),T(m,g)};W(f,m=>{s()&&m(v)})}T(l,u),pe()}var Hm=K('<table class="svelte-kg0b31"><thead><tr class="svelte-kg0b31"><th class="svelte-kg0b31"></th><th class="svelte-kg0b31">Cal</th><th class="svelte-kg0b31">PV</th></tr></thead><tbody><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Objects</td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"> </td></tr><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Extremes</td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"> </td></tr><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Outliers</td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"> </td></tr><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Sensitivity</td><td class="svelte-kg0b31"> </td><td class="svelte-kg0b31"> </td></tr></tbody></table>');function Gm(l,e){ge(e,!0);let t=w(()=>e.calres?e.calres.v[0].rols.length:0);var s=he(),a=J(s);{var o=c=>{var d=Hm(),u=z(j(d)),f=j(u),v=z(j(f)),m=j(v),g=z(v),h=j(g),p=z(f),_=z(j(p)),b=j(_),y=z(_),C=j(y),E=z(p),k=z(j(E)),S=j(k),A=z(k),M=j(A),N=z(E),P=z(j(N)),I=j(P),R=z(P),q=j(R);ae((U,D)=>{ve(m,r(t)),ve(h,r(t)),ve(b,e.calres.v[e.ncomp-1].rolsNum.extreme),ve(C,e.pvres.v[e.ncomp-1].rolsNum.extreme),ve(S,e.calres.v[e.ncomp-1].rolsNum.outlier),ve(M,e.pvres.v[e.ncomp-1].rolsNum.outlier),ve(I,U),ve(q,D)},[()=>e.calres.stat.sensitivity[e.ncomp-1].toFixed(3),()=>e.pvres.stat.sensitivity[e.ncomp-1].toFixed(3)]),T(c,d)};W(a,c=>{e.calres&&e.pvres&&c(o)})}T(l,s),pe()}var Xm=K('<div class="msg-select"> </div>'),Km=K('<div class="msg-select"> </div>'),Jm=K('<div class="msg-select"> </div>'),Qm=K('<div class="msg-select"> </div>'),Zm=K('<div class="selected-buttons svelte-8mh2yv"><!></div>'),$m=K('<div class="selected-buttons svelte-8mh2yv"><!></div>'),e0=K("<!> <!> <!>",1),t0=()=>switchPlot(i),r0=(l,e,t)=>V(e,r(t),!0),n0=K("<button> </button>"),l0=K('<div class="plot-panel svelte-8mh2yv"><div class="plot-area svelte-8mh2yv"><div class="plot svelte-8mh2yv"><!></div> <div class="plot-select-msg svelte-8mh2yv"><!> <!></div></div> <div class="plot-controls-area svelte-8mh2yv"></div></div>');function Na(l,e){ge(e,!0);let t=Y(e,"selobjText",3,"Click to select an object..."),s=Y(e,"selvarText",3,"Make rectangular selection of variable to exclude ..."),a=Y(e,"clearText",3,"Click anywhere to remove selection..."),o=Y(e,"params",15),c=Re({objects:-1,variables:[]}),d=ne(Re(Object.keys(e.plots)[0]));function u(P,I){c.objects=I?I[P]:P}function f(P){c.objects=-1}function v(P){c.variables=P}function m(P){c.variables=[]}let g={objects:{select:u,unselect:f},variables:{select:v,unselect:m},stats:{}},h=w(()=>r(d)?e.plots[r(d)]:null),p=w(()=>r(h)?r(h).component:null);var _=l0(),b=j(_),y=j(b),C=j(y);tl(C,()=>r(p),(P,I)=>{I(P,{get params(){return o()[r(d)]},get callbacks(){return g[r(h).scope]},get selected(){return c[r(h).scope]},get props(){return e.props}})});var E=z(y,2),k=j(E);{var S=P=>{var I=he(),R=J(I);{var q=D=>{var L=Xm(),F=j(L);ae(()=>ve(F,t())),T(D,L)},U=D=>{var L=Km(),F=j(L);ae(()=>ve(F,a())),T(D,L)};W(R,D=>{c[r(h).scope]<0?D(q):D(U,!1)})}T(P,I)};W(k,P=>{r(h).scope==="objects"&&o()[r(d)].plotType!=="l"&&t().length>0&&P(S)})}var A=z(k,2);{var M=P=>{var I=he(),R=J(I);{var q=D=>{var L=Jm(),F=j(L);ae(()=>ve(F,s())),T(D,L)},U=D=>{var L=Qm(),F=j(L);ae(()=>ve(F,a())),T(D,L)};W(R,D=>{c[r(h).scope].length===0?D(q):D(U,!1)})}T(P,I)};W(A,P=>{r(h).scope==="variables"&&o()[r(d)].plotType!=="l"&&s().length>0&&P(M)})}var N=z(b,2);Ye(N,21,()=>Object.keys(e.plots),Ge,(P,I)=>{var R=he(),q=J(R);{var U=L=>{var F=e0(),B=J(F);Ed(B,{get title(){return r(h).label},labelWidth:12,get options(){return e.controls[r(d)]},get value(){return o()[r(d)]},set value($){o(o()[r(d)]=$,!0)}});var O=z(B,2);{var X=$=>{var le=Zm(),te=j(le);Rr(te,()=>r(h).buttons,()=>c.objects),T($,le)};W(O,$=>{r(h).scope==="objects"&&r(h).buttons&&c.objects>=0&&$(X)})}var Z=z(O,2);{var G=$=>{var le=$m(),te=j(le);Rr(te,()=>r(h).buttons,()=>c.variables),T($,le)};W(Z,$=>{r(h).scope==="variables"&&r(h).buttons&&c.variables.length>0&&$(G)})}T(L,F)},D=L=>{var F=n0();F.__keydown=[t0],F.__click=[r0,d,I];var B=j(F);ae(()=>{pt(F,1,`plot-selector plot-selector-${r(I)??""}`,"svelte-8mh2yv"),ve(B,e.plots[r(I)].label)}),T(L,F)};W(q,L=>{r(h)&&r(d)===r(I)?L(U):L(D,!1)})}T(P,R)}),T(l,_),pe()}vt(["keydown","click"]);function cc(l,e,t){!e.callbacks||!e.callbacks.select||wn(l,l.target.tagName,s=>e.callbacks.select(s,t()))}function s0(l,e){!e.callbacks||!e.callbacks.unselect||e.callbacks.unselect()}var a0=Ce("<text> </text>"),o0=Ce('<g class="series series-textlabels"></g>'),i0=Ce('<g class="series series-line"><polyline class="line"></polyline></g>'),c0=Ce("<rect></rect>"),u0=Ce('<g class="series series-bar"></g>'),f0=Ce("<text> </text>"),d0=Ce('<g class="series series-points series-points1"></g>'),v0=Ce('<rect width="100%" height="100%" fill="#ffffff00"></rect>'),m0=Ce('<g class="series series-points series-points1"><text> </text></g>'),h0=Ce('<g class="series series-bar"><rect></rect></g>'),g0=Ce('<g class="series series-text"><text> </text></g>'),p0=Ce("<!><!><!>",1),b0=Ce("<!><!><!><!><!>",1);function ur(l,e){ge(e,!0);let t=Y(e,"shortenLabels",3,!0),s=Y(e,"lineWidth",3,1),a=Y(e,"nBars",3,1),o=Y(e,"barNum",3,1),c=Y(e,"markerSize",3,null),d=Y(e,"markerWidth",3,2),u=Y(e,"marker",3,1),f=Y(e,"colors",3,void 0),v=Y(e,"filled",3,void 0),m=Y(e,"mainColor",19,()=>At.cal),g=Y(e,"faceColor",3,null),h=Y(e,"selected",19,()=>-1),p=Y(e,"maskSelected",3,!0),_=Y(e,"xRange",15),b=Y(e,"yRange",15),y=Y(e,"ind",3,null);const C=Yt("axes"),E=w(()=>Bt(e.xValues,"PlotSeries")),k=w(()=>r(E)?Bt(e.yValues,"PlotSeries",r(E).length):null);ce(()=>{if(y()){const ee=y().map(ie=>ie+1);_(r(E)?jr(r(E).subset(ee)):null),b(r(k)?jr(r(k).subset(ee)):null)}else _(r(E)?jr(r(E)):null),b(r(k)?jr(r(k)):null)});const S=w(()=>g()===null?e.plotType==="p"?"transparent":"white":g()),A=[1,.8,.8,.8,.8,.8,.8,.8],M=[.85,.65,.65,.65,.65,.65,.65,.65],N=w(()=>c()?c():e.plotType==="p"?A[u()-1]:M[u()-1]),P=w(()=>Fn[u()-1]),I=w(()=>ua[C.scales().plot]),R=w(()=>_t([0],C.tY())[0]),q=w(()=>fa([.8],C.tX())[0]),U=w(()=>e.plotType==="h"?r(q)/a():0),D=w(()=>e.plotType==="h"?r(q)/2-(o()-1)*r(U):0),L=w(()=>r(I));let F=w(()=>e.plotType==="l"||e.plotType==="b"?ma(r(E),r(k),C.tX(),C.tY()):null),B=w(()=>r(E)?_t(r(E),C.tX()):null),O=w(()=>r(k)?_t(r(k),C.tY()):null),X=w(()=>e.labels&&Array.isArray(e.labels)?t()?e.labels.map(ee=>ee.slice(0,il)):e.labels:null);const Z=w(()=>y()?y():Nr(0,r(B).length-1));let G=w(()=>f()&&f().length===r(E).length?f():Array(r(E).length).fill(m())),$=w(()=>v()&&v().length===r(E).length?v().map(ee=>ee?"ff":"30"):Array(r(E).length).fill("30")),le=w(()=>f()&&f().length===r(E).length?f().map((ee,ie)=>ee+r($)[ie]):Array(r(E).length).fill(g()));const te=w(()=>`font-size:${r(N)}em;fill:${r(S)};cursor:default;text-anchor:middle;stroke-width:${d()}px;user-select:none;`),se=`font-size:0.85em;fill:${rc};cursor:default;text-anchor:middle;stroke:${rc};stroke-width:0.1px;user-select:none;`,_e=w(()=>`font-size:${r(N)}em;fill:none;text-anchor:middle;text-anchor:middle;cursor:default;stroke-width:2px;user-select:none;`),Se=`fill:transparent;stroke-width:${s()}px;`,xe=`stroke-width:${s()}px;`;ce(()=>{h()&&y()&&y().indexOf(h())<0&&e.callbacks.unselect()});var de=he(),ye=J(de);{var me=ee=>{var ie=b0(),ue=J(ie);{var be=qe=>{var Fe=o0();Ye(Fe,21,()=>r(Z),Ge,(Ee,ze)=>{var Pe=a0(),Mt=j(Pe);ae(()=>{H(Pe,"opacity",r(ze)===h()),H(Pe,"x",r(B)[r(ze)]-r(D)+r(U)/2),H(Pe,"y",r(O)[r(ze)]),H(Pe,"dy",r(k).v[r(ze)]<0?r(L):-r(L)),ve(Mt,r(X)[r(ze)])}),T(Ee,Pe)}),ae(()=>bt(Fe,se+(h()>=0?"opacity:0.2;":""))),T(qe,Fe)};W(ue,qe=>{e.showLabels&&r(X)&&qe(be)})}var fe=z(ue);{var ke=qe=>{var Fe=i0(),Ee=j(Fe);ae(()=>{bt(Fe,Se),H(Ee,"points",r(F)),H(Ee,"stroke",m())}),T(qe,Fe)};W(fe,qe=>{(e.plotType==="l"||e.plotType==="b")&&qe(ke)})}var De=z(fe);{var Ue=qe=>{var Fe=u0();Fe.__click=[cc,e,y],Ye(Fe,21,()=>r(Z),Ge,(Ee,ze)=>{var Pe=c0();ae(()=>{H(Pe,"x",r(B)[r(ze)]-r(D)),H(Pe,"y",r(k).v[r(ze)]<0?r(R):r(O)[r(ze)]),H(Pe,"fill",r(G)[r(ze)]),H(Pe,"width",r(U)),H(Pe,"height",r(k).v[r(ze)]<0?r(O)[r(ze)]-r(R):r(R)-r(O)[r(ze)])}),T(Ee,Pe)}),ae(()=>bt(Fe,xe+(h()>=0?"opacity:0.2;":""))),T(qe,Fe)};W(De,qe=>{e.plotType==="h"&&qe(Ue)})}var He=z(De);{var Ke=qe=>{var Fe=d0();Fe.__click=[cc,e,y],Ye(Fe,21,()=>r(Z),Ge,(Ee,ze)=>{var Pe=f0(),Mt=j(Pe);ae(()=>{H(Pe,"x",r(B)[r(ze)]),H(Pe,"y",r(O)[r(ze)]),H(Pe,"fill",r(le)[r(ze)]),H(Pe,"stroke",r(G)[r(ze)]),ve(Mt,r(P))}),T(Ee,Pe)}),ae(()=>bt(Fe,r(te)+(h()>=0?"opacity:0.2;":""))),T(qe,Fe)};W(He,qe=>{(e.plotType==="p"||e.plotType==="b")&&qe(Ke)})}var gt=z(He);{var et=qe=>{var Fe=p0(),Ee=J(Fe);{var ze=Te=>{var Ne=v0();H(Ne,"x",0),H(Ne,"y",0),Ne.__click=[s0,e],T(Te,Ne)};W(Ee,Te=>{p()&&Te(ze)})}var Pe=z(Ee);{var Mt=Te=>{var Ne=m0(),Ie=j(Ne),Et=j(Ie);ae(()=>{bt(Ne,r(_e)),H(Ie,"x",r(B)[h()]),H(Ie,"y",r(O)[h()]),H(Ie,"stroke",r(G)[h()]),H(Ie,"fill",r(le)[h()]),ve(Et,r(P))}),T(Te,Ne)},pl=Te=>{var Ne=h0(),Ie=j(Ne);ae(()=>{bt(Ne,xe),H(Ie,"stroke",r(G)[h()]),H(Ie,"fill",r(G)[h()]),H(Ie,"x",r(B)[h()]-r(D)),H(Ie,"y",r(k).v[h()]<0?r(R):r(O)[h()]),H(Ie,"width",r(U)),H(Ie,"height",r(k).v[h()]<0?r(O)[h()]-r(R):r(R)-r(O)[h()])}),T(Te,Ne)};W(Pe,Te=>{e.plotType!=="h"?Te(Mt):Te(pl,!1)})}var bl=z(Pe);{var Le=Te=>{var Ne=g0(),Ie=j(Ne),Et=j(Ie);ae(()=>{bt(Ne,se),H(Ie,"stroke",nc),H(Ie,"fill",nc),H(Ie,"x",r(B)[h()]),H(Ie,"y",r(O)[h()]),H(Ie,"dy",r(k).v[h()]<0?r(L):-r(L)),ve(Et,r(X)[h()])}),T(Te,Ne)};W(bl,Te=>{e.showLabels&&r(X)&&r(X).length>0&&Te(Le)})}T(qe,Fe)};W(gt,qe=>{h()>=0&&qe(et)})}T(ee,ie)};W(ye,ee=>{r(B)&&r(O)&&ee(me)})}T(l,de),pe()}vt(["click"]);var _0=K("<!> <!> <!> <!>",1);function cl(l,e){ge(e,!0);let t=w(()=>e.props&&e.props.data?e.props.data:null),s=w(()=>e.props&&e.props.res?e.props.res:null);const a=w(()=>r(s)&&e.params.resID?r(s)[e.params.resID]:null),o=w(()=>r(s)&&e.params.resID?r(t)[e.params.resID]:null),c="#909090",d=100;let u=w(()=>e.params.limType==="classic"?{h:r(a).cNh,q:r(a).cNq}:{h:r(a).rNh,q:r(a).rNq}),f=w(()=>e.params.limType==="classic"?{h:r(a).ch0,q:r(a).cq0}:{h:r(a).rh0,q:r(a).rq0}),v=w(()=>({h:r(u).h[e.params.ncomp-1],q:r(u).q[e.params.ncomp-1]})),m=w(()=>({h:r(f).h[e.params.ncomp-1],q:r(f).q[e.params.ncomp-1]})),g=w(()=>e.params.alpha?1-e.params.alpha/100:.95),h=w(()=>e.params.gamma?1-e.params.gamma/100:.99),p=w(()=>ic(r(g),r(v).h,r(v).q,e.params.transType)),_=w(()=>ic(Math.pow(r(h),1/r(a).nrows),r(v).h,r(v).q,e.params.transType)),b=w(()=>r(a)?tr(r(a),"hdist",e.params.ncomp):null),y=w(()=>r(a)?tr(r(a),"qdist",e.params.ncomp):null),C=w(()=>ac(r(b),r(v).h,r(m).h,e.params.transType)),E=w(()=>ac(r(y),r(v).q,r(m).q,e.params.transType)),k=w(()=>r(a)?r(a).objlabels.map(B=>B.slice(0,il)):null),S=w(()=>e.params.title?e.params.title:"Distances (A = "+e.params.ncomp+")"),A=w(()=>oc("h",e.params.transType)),M=w(()=>oc("q",e.params.transType)),N=ne(void 0),P=ne(void 0),I=w(()=>ya(r(o),r(a),e.params.colorBy,e.params.colorByVar,e.params.resID,e.params.colorByObj)),R=w(()=>e.params.colorByObj?e.params.colorByObj.ind:null),q=w(()=>{if(!r(_)||!r(N))return[0,1];const B=Math.max(r(N)[1],r(_).x.v[d-1]);return[-.02*(B-r(N)[0]),1.05*B]}),U=w(()=>{if(!r(_)||!r(P))return[0,1];const B=Math.max(r(P)[1],r(_).y.v[0]);return[-.02*(B-r(P)[0]),(1.05+.1*(e.params.colorBy!=="none")+.05*e.params.showLabels)*B]});var D=he(),L=J(D);{var F=B=>{Pr(B,{get title(){return r(S)},get limX(){return r(q)},get limY(){return r(U)},get xLabel(){return r(A)},get yLabel(){return r(M)},fileName:"plot-distance",get onclick(){return e.callbacks.unselectObject},children:(O,X)=>{var Z=_0(),G=J(Z);{var $=xe=>{Ht(xe,{get xValues(){return r(p).x},get yValues(){return r(p).y},lineColor:c,lineType:2})};W(G,xe=>{r(p)&&xe($)})}var le=z(G,2);{var te=xe=>{Ht(xe,{get xValues(){return r(_).x},get yValues(){return r(_).y},lineColor:c,lineType:3})};W(le,xe=>{r(_)&&e.params.resID&&e.params.resID!=="new"&&xe(te)})}var se=z(le,2);ur(se,{get labels(){return r(k)},get selected(){return e.selected},get callbacks(){return e.callbacks},get xValues(){return r(C).values},get yValues(){return r(E).values},plotType:"p",get showLabels(){return e.params.showLabels},get marker(){return Gt[e.params.resID]},get colors(){return r(I).colors},get filled(){return r(I).filled},get ind(){return r(R)},get xRange(){return r(N)},set xRange(xe){V(N,xe,!0)},get yRange(){return r(P)},set yRange(xe){V(P,xe,!0)}});var _e=z(se,2);{var Se=xe=>{{let de=w(()=>r(I).breaks!==null);ba(xe,{get show(){return r(de)},get colmap(){return r(I).map},get breaks(){return r(I).breaks},get labels(){return r(I).labels}})}};W(_e,xe=>{r(I)&&r(I).showBar&&xe(Se)})}T(O,Z)},$$slots:{default:!0}})};W(L,B=>{r(C)&&r(E)&&B(F)})}T(l,D),pe()}var w0=K("<!> <!> <!> <!>",1);function ul(l,e){ge(e,!0);const t="Objects",s="topright",a={q:"Orthogonal distance, q/q0",h:"Score distance, h/h0",f:"Full distance, f/f0"},o="#909090",c=w(()=>e.props&&e.props.res?e.props.res:null),d=w(()=>e.props&&e.props.simca?e.props.simca:null),u=w(()=>e.props&&e.props.model?e.props.model:null),f=w(()=>r(c)?r(c)[Object.keys(r(c))[0]]:null),v=w(()=>r(d)?r(d).ncomp:null),m=w(()=>r(d)?r(d).Nf:null),g=w(()=>r(d)?r(d).limType.charAt(0):null),h=w(()=>r(u)?rt(r(u),r(g)+"h0"):null),p=w(()=>r(u)?rt(r(u),r(g)+"q0"):null),_=(O,X,Z,G)=>new Me(tr(O,X,Z).map($=>$/G)),b=w(()=>r(c)&&r(v)?Ql(r(c),(O,X)=>_(O[X],"hdist",r(v),r(h)[r(v)-1])):null),y=w(()=>r(c)&&r(v)?Ql(r(c),(O,X)=>_(O[X],"qdist",r(v),r(p)[r(v)-1])):null),C=w(()=>r(c)&&r(v)?Ql(r(c),(O,X)=>_(O[X],"fdist"+r(g),r(v),r(m)[r(v)-1])):null),E=w(()=>r(b)&&r(y)&&r(C)?{h:r(b),q:r(y),f:r(C)}:null),k=w(()=>{if(!r(E))return null;if(e.params.resID==="both")return Ql(r(E)[e.params.distType],(X,Z)=>({values:X[Z],mainColor:At[Z],faceColor:Qr[Z],marker:Gt[Z],max:er(X[Z])}));if(e.params.resID==="diff"){const X=r(E)[e.params.distType].cal,Z=r(E)[e.params.distType].pv,G=X.subtract(Z).apply($=>Math.abs($));return{"abs(cal - pv)":{values:G,mainColor:"#a0a0a0",faceColor:"#a0a0a0",max:er(G)}}}const O={};return O[e.params.resID]={values:r(E)[e.params.distType][e.params.resID],max:er(r(E)[e.params.distType][e.params.resID]),mainColor:At[e.params.resID],faceColor:Qr[e.params.resID],marker:Gt[e.params.resID]},O});let S=w(()=>r(k)?Object.keys(r(k)).map(O=>({id:O,label:O,point:{marker:e.params.resID==="diff"?2:r(k)[O].marker,faceColor:r(k)[O].faceColor,lineColor:r(k)[O].mainColor,markerSize:.85,lineWidth:1.5}})):null);const A=w(()=>r(d)&&e.params.distType==="f"&&e.params.resID!=="diff"?r(d).eCrit[r(v)-1]/r(m)[r(v)-1]:0),M=w(()=>r(d)&&e.params.distType==="f"&&e.params.resID!=="diff"?r(d).oCrit[r(v)-1]/r(m)[r(v)-1]:0),N=w(()=>r(k)?er(Object.keys(r(k)).map(O=>r(k)[O].max).concat([r(M)])):null),P=w(()=>r(f)?Me.seq(1,r(f).nrows):null),I=w(()=>r(f)?[0,r(f).nrows+1]:[0,1]),R=w(()=>r(N)?[-r(N)*.05,r(N)*1.2]:[0,1]),q=w(()=>a[e.params.distType]),U=w(()=>r(f)?r(f).objlabels.map(O=>O.slice(0,il)):null),D=w(()=>e.params.title?e.params.title:"Distances (A = "+r(v)+")");var L=he(),F=J(L);{var B=O=>{Pr(O,{get title(){return r(D)},get limX(){return r(I)},get limY(){return r(R)},xLabel:t,get yLabel(){return r(q)},fileName:"plot-distances",get onclick(){return e.callbacks.unselectObject},children:(X,Z)=>{var G=w0(),$=J(G);{var le=de=>{{let ye=w(()=>[r(A),r(A)]);Ht(de,{get xValues(){return r(I)},get yValues(){return r(ye)},lineColor:o,lineType:2})}};W($,de=>{r(A)>0&&de(le)})}var te=z($,2);{var se=de=>{{let ye=w(()=>[r(M),r(M)]);Ht(de,{get xValues(){return r(I)},get yValues(){return r(ye)},lineColor:o,lineType:3})}};W(te,de=>{r(M)>0&&de(se)})}var _e=z(te,2);Ye(_e,17,()=>Object.keys(r(k)),Ge,(de,ye)=>{{let me=w(()=>e.params.resID==="diff"?"h":"p");ur(de,{get labels(){return r(U)},get selected(){return e.selected},get callbacks(){return e.callbacks},get xValues(){return r(P)},get yValues(){return r(k)[r(ye)].values},get mainColor(){return r(k)[r(ye)].mainColor},get faceColor(){return r(k)[r(ye)].faceColor},get marker(){return r(k)[r(ye)].marker},get plotType(){return r(me)},get showLabels(){return e.params.showLabels}})}});var Se=z(_e,2);{var xe=de=>{On(de,{get items(){return r(S)},position:s})};W(Se,de=>{r(S)&&r(S).length>0&&de(xe)})}T(X,G)},$$slots:{default:!0}})};W(F,O=>{r(P)&&r(k)&&O(B)})}T(l,L),pe()}var y0=K("<!> <!> <!> <!>",1);function x0(l,e){ge(e,!0);const t="Components",s="Degrees of freedom, Nu",a="DoF",o="plot-dof",c={Nh:"#2679B2",Nq:"#D22C2F"},d={Nh:"#f0f8ff",Nq:"#fff8f0"};let u=w(()=>e.props&&e.props.simca?e.props.simca:null),f=w(()=>e.props&&e.props.model?e.props.model:null),v=w(()=>r(u)?r(u).ncomp:null),m=w(()=>e.params.dfID!=="both"?[e.params.dfID]:["Nh","Nq"]),g=w(()=>e.params.legendPosition?e.params.legendPosition:"topleft"),h=w(()=>r(m)?r(m).map(S=>({id:S,label:S,point:{marker:1,lineColor:c[S],faceColor:"white",markerSize:.85,lineWidth:1.5},line:{lineColor:c[S],lineWidth:1.5}})):null),p=w(()=>r(f)?Me.seq(1,r(f).ncomp):null),_=w(()=>r(u)&&r(m)?r(m).reduce((S,A)=>{const M=r(u).limType==="classic"?"c":"r";return S[A]=new Me(rt(r(f),M+A)),S},{}):null),b=w(()=>r(f)?[.5,r(f).ncomp+.5]:[0,1]),y=w(()=>{const S=Object.keys(r(_));if(S.length<1)return[0,1];const A=S.map(M=>er(r(_)[M]));return[0,er(A)*1.2]});var C=he(),E=J(C);{var k=S=>{Pr(S,{title:a,xLabel:t,yLabel:s,get limX(){return r(b)},get limY(){return r(y)},fileName:o,whole:!0,children:(A,M)=>{var N=y0(),P=J(N);{var I=F=>{{let B=w(()=>[r(v)]),O=w(()=>[r(v)]),X=w(()=>[r(y)[0]]),Z=w(()=>[r(y)[1]]);pr(F,{get xStart(){return r(B)},get xEnd(){return r(O)},get yStart(){return r(X)},get yEnd(){return r(Z)},lineColor:"#a0a0a0"})}};W(P,F=>{r(v)&&F(I)})}var R=z(P,2);Ye(R,17,()=>r(m),Ge,(F,B)=>{ur(F,{get xValues(){return r(p)},get yValues(){return r(_)[r(B)]},plotType:"b",showLabels:!1,get faceColor(){return d[r(B)]},get mainColor(){return c[r(B)]},lineWidth:1.5})});var q=z(R,2);{var U=F=>{var B=he(),O=J(B);Ye(O,17,()=>r(m),Ge,(X,Z)=>{{let G=w(()=>[r(p).v[r(v)-1]]),$=w(()=>[r(_)[r(Z)].v[r(v)-1]]);ur(X,{get xValues(){return r(G)},get yValues(){return r($)},plotType:"p",showLabels:!1,get faceColor(){return c[r(Z)]},mainColor:"#a0a0a0",markerSize:1.2,lineWidth:1})}}),T(F,B)};W(q,F=>{r(v)&&F(U)})}var D=z(q,2);{var L=F=>{On(F,{get items(){return r(h)},get position(){return r(g)}})};W(D,F=>{r(h)&&r(h).length>0&&F(L)})}T(A,N)},$$slots:{default:!0}})};W(E,S=>{r(p)&&r(_)&&S(k)})}T(l,C),pe()}var k0=K("<!> <!> <!>",1),E0=K("<!> <!> <!>",1);function Ma(l,e){ge(e,!0);const t="#e0e0e0",s="Number of extremes (expected)",a="Number of extremes (observed)",o="plot-extremes";function c(P){const I=Me.zeros(P+1),R=Me.zeros(P+1),q=Me.zeros(P+1),U=Me.zeros(P+1);for(let D=1;D<P;D++){const L=D/P,F=2*Math.sqrt(D*(1-L));I.v[D]=D,q.v[D]=D,R.v[D]=D-F,U.v[D]=D+F}return I.v[P]=P,q.v[P]=P,R.v[P]=P,U.v[P]=P,{xStart:I,xEnd:q,yStart:R,yEnd:U}}function d(P,I,R){const q=P.v[R-1].f,U=I.Nf[R-1],D=P.nMembers,L=Me.zeros(D);for(let F=1;F<=D;F++){const B=F/D,O=ir(1-B,U);let X=0;for(let Z=0;Z<D;Z++)q[P.ind.members[Z]]>O&&(X+=1);L.v[F-1]=X}return L}let u=w(()=>e.props&&e.props.classres?e.props.classres:null),f=w(()=>e.props&&e.props.simca?e.props.simca:null),v=w(()=>e.props&&e.props.ncomp?e.props.ncomp:null),m=w(()=>Object.keys(r(u))),g=w(()=>e.params.resID!=="both"?[e.params.resID]:r(m)),h=w(()=>e.params.legendPosition?e.params.legendPosition:"bottomright"),p=w(()=>r(g)?r(g).map(P=>({id:P,label:P,point:{marker:1,lineColor:At[P],faceColor:Qr[P],marker:Gt[P],markerSize:.85,lineWidth:1.5}})):null),_=w(()=>r(u)&&r(g)?r(g).reduce((P,I)=>(P[I]=Me.seq(1,r(u)[I].nMembers),P),{}):null),b=w(()=>r(u)&&r(m)&&r(v)?r(m).reduce((P,I)=>(P[I]=d(r(u)[I],r(f),r(v)),P),{}):null),y=w(()=>r(g)?r(g).reduce((P,I)=>Math.max(P,r(_)[I].length),0):1),C=w(()=>r(y)>1?c(r(y)):null),E=w(()=>r(_)?[-1,r(y)+2]:[0,1]),k=w(()=>r(_)?[-1,r(y)+2]:[0,1]),S=w(()=>r(v)?`Extremes (A = ${r(v)})`:"Extremes");var A=he(),M=J(A);{var N=P=>{Pr(P,{get title(){return r(S)},xLabel:s,yLabel:a,get limX(){return r(E)},get limY(){return r(k)},fileName:o,whole:!0,children:(I,R)=>{var q=E0(),U=J(q);{var D=O=>{var X=k0(),Z=J(X);pr(Z,$t(()=>r(C),{lineColor:t}));var G=z(Z,2);Ht(G,{get xValues(){return r(C).xStart},get yValues(){return r(C).yStart},lineColor:t});var $=z(G,2);Ht($,{get xValues(){return r(C).xEnd},get yValues(){return r(C).yEnd},lineColor:t}),T(O,X)};W(U,O=>{r(C)&&O(D)})}var L=z(U,2);Ye(L,17,()=>r(g),Ge,(O,X)=>{ur(O,{get xValues(){return r(_)[r(X)]},get yValues(){return r(b)[r(X)]},plotType:"p",showLabels:!1,get faceColor(){return Qr[r(X)]},get mainColor(){return At[r(X)]},get marker(){return Gt[r(X)]},lineWidth:1.5})});var F=z(L,2);{var B=O=>{On(O,{get items(){return r(p)},get position(){return r(h)}})};W(F,O=>{r(p)&&r(p).length>0&&O(B)})}T(I,q)},$$slots:{default:!0}})};W(M,P=>{r(u)&&P(N)})}T(l,A),pe()}var S0=K("<!> <!>",1),C0=K("<!> <!> <!> <!> <!>",1);function as(l,e){ge(e,!0);const t={sens:"sensitivity",sel:"selectivity",spec:"specificity",eff:"efficiency"},s=w(()=>t[e.params.statName]),a=w(()=>"plot-"+r(s)),o=w(()=>e.props&&e.props.classres?e.props.classres:null),c=w(()=>e.props&&e.props.ncomp?e.props.ncomp:null),d=w(()=>e.params.resID!=="both"?[e.params.resID]:Object.keys(r(o))),u=w(()=>e.params.legendPosition?e.params.legendPosition:"bottomright"),f=w(()=>r(d)?r(d).map(k=>({id:k,label:k,point:{marker:1,lineColor:At[k],faceColor:wa[k],marker:Gt[k],markerSize:.85,lineWidth:1.5}})):null);let v=w(()=>{if(!e.params.ci||!e.params.ci[e.params.statName])return null;const k=e.params.ci[e.params.statName];return!Array.isArray(k)||k.length!==2?null:k});const m=w(()=>r(o)?r(o)[r(d)[0]].stat.components.length:1),g=w(()=>r(m)>10?r(m)*.05:.5),h=w(()=>r(m)>1?1:0),p=w(()=>r(m)>1?r(m):2),_=w(()=>[r(h)-r(g),r(p)+r(g)]);let b=w(()=>{if(!e.params.zoom)return[0,1.1];if(!r(d)||r(d).length<1)return[0,1];const k=r(d).map(S=>jr(r(o)[S].stat[r(s)]));return Vl(k.flat(),.2)});var y=he(),C=J(y);{var E=k=>{{let S=w(()=>s1(r(s)));Pr(k,{get title(){return r(S)},xLabel:"Components",get yLabel(){return r(s)},get limX(){return r(_)},get limY(){return r(b)},get fileName(){return r(a)},whole:!0,children:(A,M)=>{var N=C0(),P=J(N);{var I=O=>{{let X=w(()=>[r(c)]),Z=w(()=>[r(c)]),G=w(()=>[r(b)[0]]),$=w(()=>[r(b)[1]]);pr(O,{get xStart(){return r(X)},get xEnd(){return r(Z)},get yStart(){return r(G)},get yEnd(){return r($)},lineColor:"#a0a0a0"})}};W(P,O=>{r(c)&&O(I)})}var R=z(P,2);{var q=O=>{var X=S0();const Z=w(()=>r(_)[1]-r(_)[0]);var G=J(X);{let le=w(()=>[r(_)[0]]),te=w(()=>[r(v)[0]+r(v)[1]]),se=w(()=>[2*r(v)[1]]),_e=w(()=>[r(Z)]);ol(G,{get left(){return r(le)},get top(){return r(te)},get height(){return r(se)},get width(){return r(_e)},lineColor:"#transparent",faceColor:"#00000010"})}var $=z(G,2);{let le=w(()=>[r(_)[0]]),te=w(()=>[r(Z)]),se=w(()=>[r(v)[0]]),_e=w(()=>[r(v)[0]]);pr($,{get xStart(){return r(le)},get xEnd(){return r(te)},get yStart(){return r(se)},get yEnd(){return r(_e)},lineColor:"#a0a0a0",lineType:2})}T(O,X)};W(R,O=>{r(v)&&O(q)})}var U=z(R,2);Ye(U,17,()=>r(d),Ge,(O,X)=>{ur(O,{get xValues(){return r(o)[r(X)].stat.components},get yValues(){return r(o)[r(X)].stat[r(s)]},plotType:"b",showLabels:!1,get faceColor(){return wa[r(X)]},get mainColor(){return At[r(X)]},get marker(){return Gt[r(X)]},lineWidth:1.5})});var D=z(U,2);{var L=O=>{var X=he(),Z=J(X);Ye(Z,17,()=>r(d),Ge,(G,$)=>{{let le=w(()=>[r(o)[r($)].stat.components[r(c)-1]]),te=w(()=>[r(o)[r($)].stat[r(s)][r(c)-1]]);ur(G,{get xValues(){return r(le)},get yValues(){return r(te)},plotType:"b",showLabels:!1,get faceColor(){return At[r($)]},get mainColor(){return At[r($)]},get marker(){return Gt[r($)]},markerSize:1,lineWidth:1})}}),T(O,X)};W(D,O=>{r(c)&&O(L)})}var F=z(D,2);{var B=O=>{On(O,{get items(){return r(f)},get position(){return r(u)}})};W(F,O=>{r(f)&&r(f).length>0&&O(B)})}T(A,N)},$$slots:{default:!0}})}};W(C,k=>{r(o)&&k(E)})}T(l,y),pe()}function A0(l,e){ge(e,!0);let t=Y(e,"lineColor",3,"#606060"),s=Y(e,"lineType",3,2),a=Y(e,"alpha",3,.05),o=Y(e,"xRange",15),c=Y(e,"yRange",15);const d=Me.seq(0,2*Math.PI,.05);function u(b,y,C,E){const k=b.eigenvals[y-1],S=ir(1-a(),2),A=Math.sqrt(S*k),M=Me.zeros(E.length);for(let N=0;N<E.length;N++)M.v[N]=A*C(E.v[N]);return[M,-A,A]}let f=w(()=>e.comp?e.comp[0]:null),v=w(()=>r(f)?u(e.resobj,r(f),Math.cos,d):null);ce(()=>{o(r(v)?[r(v)[1],r(v)[2]]:null)});let m=w(()=>e.comp?e.comp[1]:null),g=w(()=>r(m)?u(e.resobj,r(m),Math.sin,d):null);ce(()=>{c(r(g)?[r(g)[1],r(g)[2]]:null)});var h=he(),p=J(h);{var _=b=>{Ht(b,{get xValues(){return r(v)[0]},get yValues(){return r(g)[0]},get lineColor(){return t()},get lineType(){return s()}})};W(p,b=>{r(v)&&r(g)&&b(_)})}T(l,h),pe()}function N0(l,e){ge(e,!0);let t=Y(e,"confLevel",3,.95),s=Y(e,"xRange",15),a=Y(e,"yRange",15),o=w(()=>l1(e.xValues,e.yValues,e.groups,e.groupNames,e.groupColors,t()));ce(()=>{r(o)?(s(r(o).xRange),a(r(o).yRange)):(s(null),a(null))});var c=he(),d=J(c);{var u=f=>{var v=he(),m=J(v);Ye(m,17,()=>r(o).ellipses,Ge,(g,h,p)=>{Ht(g,{get xValues(){return r(h).x},get yValues(){return r(h).y},get lineColor(){return e.groupColors[p]}})}),T(f,v)};W(d,f=>{r(o)&&r(o).ellipses&&f(u)})}T(l,c),pe()}var M0=K("<!> <!> <!> <!> <!> <!> <!> <!>",1);function fl(l,e){ge(e,!0);let t=Y(e,"alpha",3,.05);const s=w(()=>e.props&&e.props.data?e.props.data:null),a=w(()=>e.props&&e.props.res?e.props.res:null),o=w(()=>r(a)&&e.params?e.params.resID==="both"?Object.keys(r(a)):[e.params.resID]:null),c=w(()=>r(o)?r(a)[r(o)[0]]:null),d=w(()=>r(o)&&r(o).length>1?r(a)[r(o)[1]]:null),u=w(()=>r(o)?r(s)[r(o)[0]]:null);function f(de,ye,me,ee,ie,ue){if(!me)return null;let be=me[0],fe=me[1];ee&&(be=Math.min(be,ee[0]),fe=Math.max(fe,ee[1])),de&&ie&&(be=Math.min(be,ie[0]),fe=Math.max(fe,ie[1])),ye!=="none"&&ue&&(be=Math.min(be,ue[0]),fe=Math.max(fe,ue[1]));const ke=(fe-be)*.1;return{min:be,max:fe,d:ke}}function v(de,ye){if(!(!de||!ye||ye<1||ye>de.ncomp))return new Me(tr(de,"scores",ye))}let m=ne(void 0),g=ne(void 0),h=ne(void 0),p=ne(void 0),_=ne(void 0),b=ne(void 0),y=ne(void 0),C=ne(void 0),E=w(()=>r(c)?it(r(c).objindices):null),k=w(()=>r(d)?it(r(d).objindices):null),S=w(()=>r(c)?r(c).objlabels.map(de=>de.slice(0,il)):null),A=w(()=>r(d)?r(d).objlabels.map(de=>de.slice(0,il)):null),M=w(()=>v(r(c),e.params.comp1)),N=w(()=>v(r(d),e.params.comp1)),P=w(()=>e.params.plotType==="p"?r(M):r(E)),I=w(()=>e.params.plotType==="p"?r(N):r(k)),R=w(()=>e.params.comp2?e.params.comp2:null),q=w(()=>v(r(c),r(R))),U=w(()=>r(d)?v(r(d),r(R)):null),D=w(()=>ya(r(u),r(c),e.params.colorBy,e.params.colorByVar,r(o)[0])),L=w(()=>Gt[r(o)[0]]),F=w(()=>r(o).length>1?ya(null,r(d),"none",0,r(o)[1]):null),B=w(()=>r(o).length>1?Gt[r(o)[1]]:null),O=w(()=>e.params.plotType==="p"?lc(r(c),e.params.comp1):"Objects"),X=w(()=>lc(r(c),e.params.comp2)),Z=w(()=>f(e.params.showEllipse,e.params.confEllipse,r(m),r(h),r(_),r(y))),G=w(()=>r(Z)?[r(Z).min-r(Z).d,r(Z).max+r(Z).d]:[0,1]),$=w(()=>f(e.params.showEllipse,e.params.confEllipse,r(g),r(p),r(b),r(C))),le=w(()=>r($)?[r($).min-r($).d,r($).max+r($).d*(1+(e.params.colorBy!=="none"))]:[0,1]),te=w(()=>e.params.plotType==="l"||e.params.colorBy==="none"||!r(D)?"Scores":e.params.colorBy==="groups"?"Scores (colored by groups)":"Scores (colored by "+r(D).varname+(r(u).varvaluesUnits?" "+r(u).varvaluesUnits:"")+")");const se=w(()=>a1(r(o)));var _e=he(),Se=J(_e);{var xe=de=>{Pr(de,{get title(){return r(te)},get limX(){return r(G)},get limY(){return r(le)},get xLabel(){return r(O)},get yLabel(){return r(X)},fileName:"plot-scores",get onclick(){return e.callbacks.unselectObject},children:(ye,me)=>{var ee=M0(),ie=J(ee);{let Ee=w(()=>[r(G)[0]]),ze=w(()=>[r(G)[1]]);pr(ie,{get xStart(){return r(Ee)},get xEnd(){return r(ze)},yStart:[0],yEnd:[0],get lineColor(){return ss}})}var ue=z(ie,2);{var be=Ee=>{{let ze=w(()=>[r(le)[0]]),Pe=w(()=>[r(le)[1]]);pr(Ee,{xStart:[0],xEnd:[0],get yStart(){return r(ze)},get yEnd(){return r(Pe)},get lineColor(){return ss}})}};W(ue,Ee=>{e.params.plotType==="p"&&Ee(be)})}var fe=z(ue,2);{var ke=Ee=>{{let ze=w(()=>[e.params.comp1,e.params.comp2]);A0(Ee,{get alpha(){return t()},get resobj(){return r(c)},get comp(){return r(ze)},get xRange(){return r(_)},set xRange(Pe){V(_,Pe,!0)},get yRange(){return r(b)},set yRange(Pe){V(b,Pe,!0)}})}};W(fe,Ee=>{e.params.showEllipse&&e.params.plotType==="p"&&Ee(ke)})}var De=z(fe,2);{var Ue=Ee=>{{let ze=w(()=>Number.parseInt(e.params.confEllipse)/100);N0(Ee,{get xValues(){return r(P)},get yValues(){return r(q)},get confLevel(){return r(ze)},get groups(){return r(c).classes},get groupNames(){return r(c).classNames},get groupColors(){return r(D).map},get xRange(){return r(y)},set xRange(Pe){V(y,Pe,!0)},get yRange(){return r(C)},set yRange(Pe){V(C,Pe,!0)}})}};W(De,Ee=>{e.params.colorBy==="groups"&&e.params.confEllipse!=="none"&&e.params.plotType==="p"&&r(D)&&Ee(Ue)})}var He=z(De,2);ur(He,{get xValues(){return r(P)},get yValues(){return r(q)},get labels(){return r(S)},get marker(){return r(L)},get nBars(){return r(o).length},barNum:1,get plotType(){return e.params.plotType},get showLabels(){return e.params.showLabels},get colors(){return r(D).colors},get mainColor(){return r(D).mainColor},get faceColor(){return r(D).faceTColor},get selected(){return e.selected},get callbacks(){return e.callbacks},get xRange(){return r(m)},set xRange(Ee){V(m,Ee,!0)},get yRange(){return r(g)},set yRange(Ee){V(g,Ee,!0)}});var Ke=z(He,2);{var gt=Ee=>{{let ze=w(()=>e.params.showLabels&&e.params.plotType==="p");ur(Ee,{get xValues(){return r(I)},get yValues(){return r(U)},get labels(){return r(A)},get selected(){return e.selected},get callbacks(){return e.callbacks},get nBars(){return r(o).length},barNum:2,get plotType(){return e.params.plotType},get showLabels(){return r(ze)},get marker(){return r(B)},get colors(){return r(F).colors},get mainColor(){return r(F).mainColor},get faceColor(){return r(F).faceTColor},get xRange(){return r(h)},set xRange(Pe){V(h,Pe,!0)},get yRange(){return r(p)},set yRange(Pe){V(p,Pe,!0)}})}};W(Ke,Ee=>{r(I)&&r(U)&&Ee(gt)})}var et=z(Ke,2);{var qe=Ee=>{{let ze=w(()=>r(D).breaks!==null);ba(Ee,{get show(){return r(ze)},get colmap(){return r(D).map},get breaks(){return r(D).breaks},get labels(){return r(D).labels}})}};W(et,Ee=>{r(D)&&Ee(qe)})}var Fe=z(et,2);{let Ee=w(()=>e.params.colorBy==="none");On(Fe,{get items(){return r(se)},get show(){return r(Ee)}})}T(ye,ee)},$$slots:{default:!0}})};W(Se,de=>{r(P)&&r(q)&&de(xe)})}T(l,_e),pe()}var T0=K("<!> <!> <!>",1);function P0(l,e){ge(e,!0);let t=w(()=>e.props?e.props.model:null);function s(k,S){return!k||!S||S<1||S>k.ncomp?null:new Me(rt(k,"loadings",S))}let a=ne(void 0),o=ne(void 0),c=w(()=>r(t)?it(r(t).varvalues):null),d=w(()=>r(t)?it(r(t).varindices):null),u=w(()=>s(r(t),e.params.comp1)),f=w(()=>!r(t)||!e.params.comp1?null:e.params.plotType==="p"?{values:r(u),label:`PC${e.params.comp1}`}:e.params.plotType==="l"&&r(c)?{values:r(c),label:r(t).varvaluesName+(r(t).varvaluesUnits?", "+r(t).varvaluesUnits:"")}:{values:r(d),label:"Variables"}),v=w(()=>r(f)?r(f).values:null),m=w(()=>r(f)?r(f).label:null),g=w(()=>s(r(t),e.params.comp2)),h=w(()=>`PC${e.params.comp2}`),p=w(()=>{if(r(o)&&r(o)[0]<Number.POSITIVE_INFINITY&&r(o)[1]>Number.NEGATIVE_INFINITY){const k=(r(o)[1]-r(o)[0])*.1;return[r(o)[0]-k,r(o)[1]+k]}else return[0,1]}),_=w(()=>{if(r(a)&&r(a)[0]<Number.POSITIVE_INFINITY&&r(a)[1]>Number.NEGATIVE_INFINITY){const k=(r(a)[1]-r(a)[0])*.1;return e.params.plotType==="l"&&r(t).varrev?[r(a)[1]+k,r(a)[0]-k]:[r(a)[0]-k,r(a)[1]+k]}else return[0,1]}),b=w(()=>{if(e.params.axesEqual)if(e.params.plotType==="p"){const k=Math.max(Math.abs(r(_)[0]),Math.abs(r(p)[0]),r(_)[1],r(p)[1])*1.05;return{x:[-k,k],y:[-k,k]}}else{const k=Math.max(Math.abs(r(p)[0]),r(p)[1])*1.05;return{x:r(_),y:[-k,k]}}return{x:r(_),y:r(p)}});var y=he(),C=J(y);{var E=k=>{Pr(k,{title:"Loadings",fileName:"plot-loadings",get xLabel(){return r(m)},get yLabel(){return r(h)},get limX(){return r(b).x},get limY(){return r(b).y},children:(S,A)=>{var M=T0(),N=J(M);{let q=w(()=>[r(b).x[0]]),U=w(()=>[r(b).x[1]]);pr(N,{get xStart(){return r(q)},get xEnd(){return r(U)},yStart:[0],yEnd:[0],get lineColor(){return ss}})}var P=z(N,2);{var I=q=>{{let U=w(()=>[r(b).y[0]]),D=w(()=>[r(b).y[1]]);pr(q,{xStart:[0],xEnd:[0],get yStart(){return r(U)},get yEnd(){return r(D)},get lineColor(){return ss}})}};W(P,q=>{e.params.plotType==="p"&&q(I)})}var R=z(P,2);{let q=w(()=>tc+"30");ur(R,{get xValues(){return r(v)},get yValues(){return r(g)},get selected(){return e.selected},seriesTitle:"loadings",get plotType(){return e.params.plotType},get showLabels(){return e.params.showLabels},get labels(){return r(t).varlabels},shortenLabels:!1,get mainColor(){return tc},get faceColor(){return r(q)},get xRange(){return r(a)},set xRange(U){V(a,U,!0)},get yRange(){return r(o)},set yRange(U){V(o,U,!0)}})}T(S,M)},$$slots:{default:!0}})};W(C,k=>{r(v)&&r(g)&&k(E)})}T(l,y),pe()}function Ta(l){const e=Object.keys(l),t=l[e[0]],s=t.nMembers>0&&t.nStrangers>0,a=t.nMembers>0?"members":t.nStrangers>0?"strangers":"all",o={resID:{el:Xe,hidden:e.length==1,default:e[0],label:"Show",props:{options:e}},subset:{el:Xe,hidden:!s,default:a,label:"Show",props:{options:["members","strangers","all"]}},transType:{el:Xe,hidden:!1,default:"no",label:"Transform",props:{options:["no","log"]}},showLabels:{el:rr,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}};return t.nStrangers>0&&t.nStrangers==0&&t.classNames&&t.classNames.length>1&&(o.colorBy={el:Xe,hidden:!1,default:"roles",label:"Color by",props:{options:["roles","classes"]}}),o}function uc(l){const e=Object.keys(l),t=l[e[0]],s=[...e,"both"],a=t.nMembers>0?t.nStrangers>0?["sens","spec","eff","sel"]:["sens"]:["spec","sel"];return{resID:{el:Xe,hidden:e.length==1,default:e[0],label:"Show",props:{options:s}},statName:{el:Xe,hidden:a.length==1,default:a[0],label:"FoM",props:{options:a}},zoom:{el:rr,hidden:!1,default:!1,label:"Zoom",props:{options:["off","on"]}}}}function Pa(l){const e=Object.keys(l),t=e.concat(["both","diff"]);return{resID:{el:Xe,hidden:e.length==1,default:e[0],label:"Result",props:{options:t}},distType:{el:Xe,hidden:!1,default:"h",label:"Distance",props:{options:["h","q","f"]}},showLabels:{el:rr,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function z0(){return{dfID:{el:Xe,hidden:!1,default:"both",label:"DoF type",props:{options:["both","Nh","Nq"]}}}}function L0(l){return{resID:{el:Xe,hidden:l.length==1,default:l[0],label:"Results",props:{options:l}}}}function R0(l){return{resID:{el:Xe,hidden:l.length==1,default:l[0],label:"Results",props:{options:l}}}}function fc(l){return{resID:{el:Xe,hidden:l.length==1,default:l[0],label:"Results",props:{options:l}}}}function I0(l){return{plotType:{el:Mi,hidden:!1,default:"p",label:"Plot type",props:{options:["p","l","h"]}},comp2:{el:Tr,hidden:!1,default:l.ncomp>1?2:1,label:"PC (y-axis)",props:{min:1,max:l.ncomp}},comp1:{el:Tr,hidden:!1,default:1,label:"PC (x-axis)",props:{min:1,max:l.ncomp}},showLabels:{el:rr,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}},axesEqual:{el:rr,hidden:!1,default:!1,label:"Axes",props:{options:["normal","equal"]}}}}function za(l){const e=Object.keys(l),t=l[e[0]],s=t.classNames&&t.classNames.length>1?["none","groups","variable"]:["none","variable"],a=e.concat(["both"]);return{resID:{el:Xe,hidden:e.length==1,default:e[0],label:"Show",props:{options:a}},plotType:{el:Mi,hidden:!1,default:"p",label:"Plot type",props:{options:["p","l","h"]}},comp2:{el:Tr,hidden:!1,default:t.ncomp>1?2:1,label:"PC (y-axis)",props:{min:1,max:t.ncomp}},comp1:{el:Tr,hidden:!1,default:1,label:"PC (x-axis)",props:{min:1,max:t.ncomp}},showLabels:{el:rr,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}},showEllipse:{el:rr,hidden:!1,default:!1,label:"T2 ellipse",props:{options:["hide","show"]}},colorBy:{el:Xe,hidden:!1,default:"none",label:"Color by",props:{options:s}},colorByVar:{el:Tr,hidden:!0,default:1,label:"Variable",props:{min:1,max:t.ncols}},confEllipse:{el:Xe,hidden:!0,default:"none",label:"Conf ellipse",props:{options:["none","90","95","99"]}}}}var j0=K("<!> <!>",1);function q0(l,e){ge(e,!0);const t=(h,p=xt)=>{oe(h,{label:"Selected",children:(_,b)=>{lt(_,{onclick:()=>e.markOutlier(p()),text:"remove"})},$$slots:{default:!0}})},s=(h,p=xt)=>{oe(h,{label:"Selected",children:(_,b)=>{var y=j0(),C=J(y);lt(C,{onclick:()=>e.showContributions(p()),text:"plot"});var E=z(C,2);lt(E,{onclick:()=>e.markOutlier(p()),text:"remove"}),T(_,y)},$$slots:{default:!0}})},a={cal:e.calres.pca,pv:e.pvres.pca},o={cal:e.calset,pv:e.pvset},c=w(()=>({cal:e.calres.simca,pv:e.pvres.simca})),d={regular:Jr.regular,extreme:Jr.extreme,outlier:Jr.outlier},u=w(()=>({acceptance:{label:"Acceptance",scope:"objects",component:cl,buttons:s},distances:{label:"Distances",scope:"objects",component:ul,buttons:s},dof:{label:"DoF",scope:"stats",component:x0},extremes:{label:"Extremes",scope:"stats",component:Ma},sensitivity:{label:"Sensitivity",scope:"stats",component:as},loadings:{label:"Loadings",scope:"stats",component:P0},scores:{label:"Scores",scope:"objects",component:fl,buttons:t}})),f=Re({acceptance:Ta(a),distances:Pa(a),dof:z0(),extremes:fc(["cal","pv","both"]),sensitivity:uc(r(c)),scores:za(a),loadings:I0(e.model)});let v=ne(Re({acceptance:Rt(f.acceptance),distances:Rt(f.distances),dof:Rt(f.dof),extremes:Rt(f.extremes),sensitivity:Rt(f.sensitivity),scores:Rt(f.scores),loadings:Rt(f.loadings)}));ce(()=>{const h={};e.calres.simca.nMembers>0&&(h.sens=bi(e.calres.simca.nMembers,e.simca.alpha)),r(v).sensitivity.ci=h}),ce(()=>{r(v).acceptance.ncomp=e.simca.ncomp,r(v).acceptance.title=`Acceptance (A = ${e.simca.ncomp})`,r(v).acceptance.limType=e.simca.limType,r(v).acceptance.alpha=e.simca.alpha,r(v).acceptance.gamma=e.simca.gamma}),ce(()=>{if(e.simca.limType){const p={cal:e.calres.simca,pv:e.pvres.simca}[r(v).acceptance.resID].v[e.simca.ncomp-1];r(v).acceptance.colorByObj={classColmap:d,labels:[`regular: ${p.rolsNum.regular}`,`extreme: ${p.rolsNum.extreme}`,`outliers: ${p.rolsNum.outlier}`],values:p.rols}}}),ce(()=>{r(v).scores.plotType!=="p"?(f.scores.comp1.hidden=!0,f.scores.showEllipse.hidden=!0,r(v).scores.showEllipse=!1):(f.scores.comp1.hidden=!1,f.scores.showEllipse.hidden=!1),r(v).scores.plotType==="l"||r(v).scores.plotType==="b"?(f.scores.colorBy.hidden=!0,r(v).scores.colorBy="none"):f.scores.colorBy.hidden=!1,r(v).scores.colorBy==="variable"?f.scores.colorByVar.hidden=!1:f.scores.colorByVar.hidden=!0,r(v).scores.colorBy==="groups"&&r(v).scores.plotType==="p"?f.scores.confEllipse.hidden=!1:(f.scores.confEllipse.hidden=!0,r(v).scores.confEllipse="none"),r(v).scores.colorBy==="variable"?(r(v).scores.resID==="both"&&(r(v).scores.resID="cal"),f.scores.resID.props.options=["cal","pv"]):f.scores.resID.props.options=["cal","pv","both"]}),ce(()=>{r(v).loadings.plotType!=="p"?f.loadings.comp1.hidden=!0:f.loadings.comp1.hidden=!1});const m=w(()=>({res:a,classres:r(c),model:e.model,simca:e.simca,data:o,ncomp:e.simca.ncomp})),g={markOutlier:e.markOutlier,showContributions:e.showContributions};Na(l,{get plots(){return r(u)},get controls(){return f},get props(){return r(m)},get callbacks(){return g},get params(){return r(v)},set params(h){V(v,h,!0)}}),pe()}var F0=K('<div class="outliers-pane svelte-1v0yar6"><!></div>'),O0=K('<div class="model-calculator svelte-1v0yar6"><!></div>'),D0=K('<div class="pcv-calculator svelte-1v0yar6"><!></div>'),B0=K('<div class="buttons"><!> <!> <!></div>'),V0=K('<div class="model-stats svelte-1v0yar6"><!></div> <div class="result-stats svelte-1v0yar6"><!></div>',1),Y0=K(`<p class="svelte-1v0yar6">In this tab you can train a DD-SIMCA model and optimize its parameters using Procrustes cross-validation. After creating the model you can save it to a file and use it in other tabs. For example, validate and tune it using test set with target class members (tab <strong>Predict: Target</strong>) or apply it to a dataset with non-target class members (tab <strong>Predict: New</strong>).</p> <p class="svelte-1v0yar6"><strong>Step 1.</strong></p> <p class="svelte-1v0yar6">Load your training set from a CSV file. The file should contain data as numeric values delimited
               by comma (with dot as decimal separator) or by semicolon (with comma as decimal separator). Rows correspond to observations or objects, columns — to variables.</p> <p class="svelte-1v0yar6">First column must contain class names for each row. All rows in the training set should belong to the target class, so it is expected that the class names are the same (you will get error message if not).</p> <p class="svelte-1v0yar6">First row can contain variable names (<strong>header</strong>) and first column can contain labels for the objects/observations (<strong>row labels</strong>) — just set the corresponding options after selecting the file. In this case it is assumed that column with the class names is located next to the column with row labels. Here is an example:</p> <div class="svelte-1v0yar6"><table class="svelte-1v0yar6"><thead class="svelte-1v0yar6"><tr class="svelte-1v0yar6"><td class="svelte-1v0yar6">Name</td><td class="svelte-1v0yar6">Class</td><td class="svelte-1v0yar6">x1</td><td class="svelte-1v0yar6">x2</td><td class="svelte-1v0yar6">x3</td></tr></thead><tbody class="svelte-1v0yar6"><tr><td class="svelte-1v0yar6">O1</td><td class="svelte-1v0yar6">A</td><td class="svelte-1v0yar6">3.8</td><td class="svelte-1v0yar6">1.3</td><td class="svelte-1v0yar6">13.6</td></tr><tr><td class="svelte-1v0yar6">O2</td><td class="svelte-1v0yar6">A</td><td class="svelte-1v0yar6">11.1</td><td class="svelte-1v0yar6">12.3</td><td class="svelte-1v0yar6">3.3</td></tr><tr><td class="svelte-1v0yar6">O3</td><td class="svelte-1v0yar6">A</td><td class="svelte-1v0yar6">1.2</td><td class="svelte-1v0yar6">2.3</td><td class="svelte-1v0yar6">4.2</td></tr></tbody></table></div> <p class="svelte-1v0yar6"></p>`,1),W0=K(`<p class="svelte-1v0yar6"><strong>Step 2</strong></p> <p class="svelte-1v0yar6">Next step is to create a global PCA model for the calibration set, which will be the basis for the SIMCA model. Use more components/latent variables (PCs) than you expect to be optimal. You will have possibility to set
               optimal number later.</p>`,1),U0=K('<p class="svelte-1v0yar6"><strong>Step 3</strong></p> <p class="svelte-1v0yar6">Now set necessary parameters for Procrustes cross-validation and click button to compute the PV-set, which will help you to optimize SIMCA model parameters. The parameters are the same as for conventional cross-validation: type of splits and number of segments. It is recommended to use fewer number of segments (e.g. 3, 4 or 5).</p> <p class="svelte-1v0yar6">After this step SIMCA model will be created automatically and you will be able to tune its parameters.</p>',1),H0=K("<!> <!>",1),G0=K('<div class="help-text svelte-1v0yar6"><!></div>'),X0=K('<!> <div class="app-container svelte-1v0yar6"><div class="app-controls svelte-1v0yar6"><div class="data-loader svelte-1v0yar6"><!></div> <!> <!> <!> <!> <div class="simca-settings svelte-1v0yar6"><!> <!></div> <!></div> <div class="app-content svelte-1v0yar6"><!></div></div>',1);function K0(l,e){ge(e,!0);const t=w(()=>e.session.train);let s=ne(-1),a=ne(!1);function o(G){if(G<0||G>r(t).calres.pca.nrows-1)return;const $=r(t).calres.pca.objindices[G];$>=0&&!r(t).outliers.includes($)&&(r(t).outliers.push($),r(t).model=null,r(t).simca=null,r(t).pvres.simca=null,r(t).pvres.pca=null,r(t).calres.simca=null,r(t).calres.pca=null,r(t).calsetp=null,r(t).prepmodel=null,r(t).pvset=null)}function c(){r(t).outliers=[],r(t).model=null,r(t).pvres.simca=null,r(t).pvres.pca=null,r(t).calres.simca=null,r(t).calres.pca=null,r(t).calsetp=null,r(t).prepmodel=null,r(t).pvset=null}function d(){r(t).outliers.pop(),r(t).model=null,r(t).pvres.simca=null,r(t).pvres.pca=null,r(t).calres.simca=null,r(t).calres.pca=null,r(t).calsetp=null,r(t).prepmodel=null,r(t).pvset=null}function u(G){G<0||(V(s,G,!0),V(a,!0))}function f(){V(a,!1),V(s,-1)}let v=w(()=>r(t).calres.pca?{members:Nr(0,r(t).calres.pca.nrows-1),strangers:[]}:null);Il(()=>{r(t).calset===null?(r(t).model=null,r(t).calsetp=null,r(t).className=null,r(t).outliers=[],r(t).pvset=null,r(t).prepmodel=null,r(t).prepobj=[],r(t).prepType=null):r(t).calset&&!r(t).className&&(r(t).className=r(t).calset.classNames[0]),r(t).model===null&&(r(t).calres.simca=null,r(t).simca=null,r(t).calres.pca=null,r(t).pvset=null),r(t).pvset===null&&(r(t).pvres.simca=null,r(t).pvres.pca=null)}),ce(()=>{r(t).calset===null&&(r(t).calsetp=null)}),ce(()=>{r(t).calsetp===null&&(r(t).simca=null,r(t).pvset=null,r(t).model=null)}),ce(()=>{r(t).model===null&&(r(t).pvres={pca:null,scima:null},r(t).calres={pca:null,simca:null},r(t).pvset=null)}),ce(()=>{r(t).pvset===null&&(r(t).pvres.simca=null,r(t).pvres.pca=null)}),ce(()=>{r(t).calres.pca&&r(t).simca&&r(t).simca.eCrit&&r(t).simca.oCrit&&r(v)&&(r(t).calres.simca=es(r(t).calres.pca,Wt(()=>r(t).simca.limType),r(t).simca.eCrit,r(t).simca.oCrit,r(v)))}),ce(()=>{r(t).pvres.pca&&r(t).simca&&r(v)&&(r(t).pvres.simca=es(r(t).pvres.pca,Wt(()=>r(t).simca.limType),r(t).simca.eCrit,r(t).simca.oCrit,r(v)))}),ce(()=>{const G=Wt(()=>JSON.stringify(e.session,sl));r(t).simca?e.backupSession(G,r(t).model,r(t).calset,r(t).pvset,r(t).simca.ncomp,r(t).pvres.simca):e.backupSession(G,r(t).model,r(t).calset,r(t).pvset,r(t).simca,r(t).pvres.simca)});var m=X0(),g=J(m);{var h=G=>{{let $=w(()=>({cal:r(t).calres.pca,pv:r(t).pvres.pca}));xa(G,{get model_getter(){return rt},get res_getter(){return tr},get model(){return r(t).model},get res(){return r($)},closeModal:f,get ncomp(){return r(t).simca.ncomp},get selected(){return r(s)}})}};W(g,G=>{r(a)&&G(h)})}var p=z(g,2),_=j(p),b=j(_),y=j(b);Sa(y,{className:"Class",classMandatory:!0,classUnique:!0,get dataset(){return r(t).calset},set dataset(G){r(t).calset=G}});var C=z(b,2);{var E=G=>{var $=F0(),le=j($);ia(le,{get outliers(){return r(t).outliers},get dataset(){return r(t).calset},resetOutliers:c,undoOutliers:d}),T(G,$)};W(C,G=>{r(t).outliers&&r(t).outliers.length>0&&G(E)})}var k=z(C,2);{var S=G=>{vm(G,{get WASM(){return e.WASM},get rawdata(){return r(t).calset},get outliers(){return r(t).outliers},get prepType(){return r(t).prepType},set prepType($){r(t).prepType=$},get prepobj(){return r(t).prepobj},set prepobj($){r(t).prepobj=$},get prepdata(){return r(t).calsetp},set prepdata($){r(t).calsetp=$},get prepmeta(){return r(t).prepmeta},set prepmeta($){r(t).prepmeta=$},get prepmodel(){return r(t).prepmodel},set prepmodel($){r(t).prepmodel=$}})};W(k,G=>{r(t).calset&&G(S)})}var A=z(k,2);{var M=G=>{var $=O0(),le=j($);Rm(le,{get WASM(){return e.WASM},get dataset(){return r(t).calsetp},get outliers(){return r(t).outliers},get model(){return r(t).model},set model(te){r(t).model=te},get resobj(){return r(t).calres.pca},set resobj(te){r(t).calres.pca=te}}),T(G,$)};W(A,G=>{r(t).calsetp&&G(M)})}var N=z(A,2);{var P=G=>{var $=D0(),le=j($);Bm(le,{get WASM(){return e.WASM},get calset(){return r(t).calsetp},get outliers(){return r(t).outliers},get model(){return r(t).model},get calres(){return r(t).calres.pca},get pvset(){return r(t).pvset},set pvset(te){r(t).pvset=te},get pvres(){return r(t).pvres.pca},set pvres(te){r(t).pvres.pca=te}}),T(G,$)};W(N,G=>{r(t).model&&G(P)})}var I=z(N,2),R=j(I);{var q=G=>{Aa(G,{get model(){return r(t).model},get className(){return r(t).className},get simca(){return r(t).simca},set simca($){r(t).simca=$}})};W(R,G=>{r(t).model&&r(t).pvres.pca&&r(t).calres.pca&&G(q)})}var U=z(R,2);{var D=G=>{oe(G,{label:"Download",children:($,le)=>{var te=B0(),se=j(te);lt(se,{onclick:()=>ts(r(t).model,r(t).simca,r(t).calres,r(t).calset,"train",r(t).outliers),text:"Res (cal)"});var _e=z(se,2);lt(_e,{onclick:()=>ts(r(t).model,r(t).simca,r(t).pvres,r(t).pvset,"PV",r(t).outliers),text:"Res (pv)"});var Se=z(_e,2);lt(Se,{onclick:()=>oa(r(t).model,r(t).simca,r(t).prepmodel),text:"Model"}),T($,te)},$$slots:{default:!0}})};W(U,G=>{r(t).pvres.simca&&r(t).calres.simca&&G(D)})}var L=z(I,2);{var F=G=>{var $=V0(),le=J($),te=j(le);Ca(te,{get model(){return r(t).model},get simca(){return r(t).simca}});var se=z(le,2),_e=j(se);Gm(_e,{get calres(){return r(t).calres.simca},get pvres(){return r(t).pvres.simca},get ncomp(){return r(t).simca.ncomp}}),T(G,$)};W(L,G=>{r(t).pvres.simca&&r(t).calres.simca&&G(F)})}var B=z(_,2),O=j(B);{var X=G=>{var $=G0(),le=j($);{var te=_e=>{var Se=Y0();T(_e,Se)},se=_e=>{var Se=H0(),xe=J(Se);{var de=ee=>{var ie=W0();T(ee,ie)};W(xe,ee=>{r(t).model||ee(de)})}var ye=z(xe,2);{var me=ee=>{var ie=U0();T(ee,ie)};W(ye,ee=>{r(t).model&&!r(t).pvset&&ee(me)})}T(_e,Se)};W(le,_e=>{r(t).calset?_e(se,!1):_e(te)})}T(G,$)},Z=G=>{var $=he(),le=J($);{var te=se=>{var _e=he(),Se=J(_e);Rn(Se,()=>r(t).pvset.pca,xe=>{q0(xe,$t({markOutlier:o,showContributions:u},()=>r(t)))}),T(se,_e)};W(le,se=>{r(t).pvres.simca!==null&&se(te)},!0)}T(G,$)};W(O,G=>{!r(t).pvres.simca||!r(t).calres.simca?G(X):G(Z,!1)})}T(l,m),pe()}var J0=K("<!> <!>",1),Q0=K('<br/><span style="color:#a0a0a0;">Preprocessing:</span> <!>',1),Z0=K('<p class="model-info svelte-14tszjv"><span>Model file:</span> <span class="file-name svelte-14tszjv"> </span><br/> <span style="color:#a0a0a0;">PCA model:</span> <!></p> <!>',1),$0=K("<p><!></p>"),eh=K("<!> <!>",1);function dc(l,e){ge(e,!0);let t=Y(e,"model",15),s=Y(e,"simca",15),a=ne(""),o=ne("neutral"),c=ne("");function d(y){try{const C=JSON.parse(y,la);if(!Object.keys(C).includes("pca","simca")||C.pca.class[0]!=="pcamodel")throw Error("The JSON file you selected does not contain SIMCA mdel.");if(!Object.keys(C.pca).includes("hash"))throw Error('you try to load model incompatible with this app version, create a new model or use <a href="/ddsimca-old/">old version</a> of the app.');Array.isArray(C.pca.v)&&(C.pca.v=Float64Array.from(C.pca.v)),C.pca.fileName=r(v),t(C.pca),s(C.simca),V(o,"success"),V(c,"")}catch(C){t(null),V(o,"error"),V(c,C,!0)}}function u(y){const C=new FileReader;C.onload=()=>{d(C.result)},C.readAsText(r(a))}function f(){V(a,""),t(null),V(o,"neutral"),V(c,"")}ce(()=>{r(a)===null?(t(null),V(o,"neutral"),V(c,"")):(V(o,"neutral"),V(c,""))});let v=w(()=>r(a)?r(a).name.replace(/\.[^/.]+$/,""):"");var m=eh(),g=J(m);{var h=y=>{var C=J0(),E=J(C);Rn(E,()=>r(a),A=>{oe(A,{children:(M,N)=>{$l(M,{id:"modelFile",acceptType:".json",message:"Select file with model",get file(){return r(a)},set file(P){V(a,P,!0)}})},$$slots:{default:!0}})});var k=z(E,2);{var S=A=>{oe(A,{label:" ",children:(M,N)=>{lt(M,{onclick:u,text:"Load"})},$$slots:{default:!0}})};W(k,A=>{r(a)&&A(S)})}T(y,C)},p=y=>{oe(y,{name:"info",children:(C,E)=>{var k=Z0(),S=J(k),A=z(j(S),2),M=j(A),N=z(A,4),P=z(N);{var I=q=>{var U=Q0(),D=z(J(U),3);Ea(D,{get prepmodel(){return t().prep}}),T(q,U)};W(P,q=>{t().prep&&q(I)})}var R=z(S,2);Mr(R,{onclick:f}),ae(()=>{H(A,"title",t().fileName),ve(M,t().fileName),ve(N,` ${t().ncomp??""} PCs${t().center?", centered":""}${t().scale?", scaled":""} `)}),T(C,k)},$$slots:{default:!0}})};W(g,y=>{t()?y(p,!1):y(h)})}var _=z(g,2);{var b=y=>{oe(y,{status:"error",children:(C,E)=>{var k=$0(),S=j(k);Tt(S,()=>r(c)),T(C,k)},$$slots:{default:!0}})};W(_,y=>{(r(o)==="error"||r(c))&&y(b)})}T(l,m),pe()}var th=K('<tr class="svelte-1i1bo7x"><td class="label svelte-1i1bo7x">Out</td><td class="svelte-1i1bo7x"> </td></tr> <tr class="svelte-1i1bo7x"><td class="label svelte-1i1bo7x">Sensitivity</td><td class="svelte-1i1bo7x"> </td></tr>',1),rh=K('<tr class="svelte-1i1bo7x"><td class="label svelte-1i1bo7x">In</td><td class="svelte-1i1bo7x"> </td></tr> <tr class="svelte-1i1bo7x"><td class="label svelte-1i1bo7x">Specificity</td><td class="svelte-1i1bo7x"> </td></tr> <tr class="svelte-1i1bo7x"><td class="label svelte-1i1bo7x">Selectivity</td><td class="svelte-1i1bo7x"> </td></tr>',1),nh=K('<tr class="svelte-1i1bo7x"><td class="label svelte-1i1bo7x">Efficiency</td><td class="svelte-1i1bo7x"> </td></tr>'),lh=K('<table class="svelte-1i1bo7x"><thead><tr class="svelte-1i1bo7x"><th class="svelte-1i1bo7x"></th><th class="svelte-1i1bo7x">Target</th></tr></thead><tbody><tr class="svelte-1i1bo7x"><td class="label svelte-1i1bo7x">Members</td><td class="svelte-1i1bo7x"> </td></tr><!><tr class="section svelte-1i1bo7x"><td class="label svelte-1i1bo7x">Strangers</td><td class="svelte-1i1bo7x"> </td></tr><!><!></tbody></table>');function sh(l,e){ge(e,!0);var t=he(),s=J(t);{var a=o=>{var c=lh(),d=z(j(c)),u=j(d),f=z(j(u)),v=j(f),m=z(u);{var g=k=>{var S=th(),A=J(S),M=z(j(A)),N=j(M),P=z(A,2),I=z(j(P)),R=j(I);ae(q=>{ve(N,e.res.v[e.ncomp-1].rolsNum.outlier+e.res.v[e.ncomp-1].rolsNum.extreme),ve(R,q)},[()=>e.res.stat.sensitivity[e.ncomp-1].toFixed(3)]),T(k,S)};W(m,k=>{e.res.nMembers>0&&k(g)})}var h=z(m),p=z(j(h)),_=j(p),b=z(h);{var y=k=>{var S=rh(),A=J(S),M=z(j(A)),N=j(M),P=z(A,2),I=z(j(P)),R=j(I),q=z(P,2),U=z(j(q)),D=j(U);ae((L,F)=>{ve(N,e.res.v[e.ncomp-1].decsNum.in-e.res.v[e.ncomp-1].rolsNum.regular),ve(R,L),ve(D,F)},[()=>e.res.stat.specificity[e.ncomp-1].toFixed(3),()=>e.res.stat.selectivity[e.ncomp-1].toFixed(3)]),T(k,S)};W(b,k=>{e.res.nStrangers>0&&k(y)})}var C=z(b);{var E=k=>{var S=nh(),A=z(j(S)),M=j(A);ae(N=>ve(M,N),[()=>e.res.stat.efficiency[e.ncomp-1].toFixed(3)]),T(k,S)};W(C,k=>{e.res.nStrangers>0&&e.res.nMembers>0&&k(E)})}ae(()=>{ve(v,e.res.nMembers),ve(_,e.res.nStrangers)}),T(o,c)};W(s,o=>{e.res&&o(a)})}T(l,t),pe()}var ah=K("<!> <!> <!>",1),oh=K("<!> <!> <!>",1);function vc(l,e){ge(e,!0);const t="#e0e0e0",s="Number of aliens (expected)",a="Number of aliens (observed)",o="plot-aliens";function c(N){const P=Me.zeros(N+1),I=Me.zeros(N+1),R=Me.zeros(N+1),q=Me.zeros(N+1);for(let U=1;U<N;U++){const D=U/N,L=2*Math.sqrt(U*(1-D));P.v[U]=U,R.v[U]=U,I.v[U]=U-L,q.v[U]=U+L}return P.v[N]=N,R.v[N]=N,I.v[N]=N,q.v[N]=N,{xStart:P,xEnd:R,yStart:I,yEnd:q}}function d(N,P,I){const R=N.v[I-1],q=R.rolsNum.alien,U=Me.zeros(q);for(let D=1;D<=q;D++){const L=D/q,F=Ul(L),B=R.m*Math.pow(R.Sz*F+R.Mz,1/R.hz);let O=0;for(let X of N.ind.strangers)R.rols[X]==="alien"&&R.f[X]<B&&(O+=1);U.v[D-1]=O}return U}let u=w(()=>e.props&&e.props.classres?e.props.classres:null),f=w(()=>e.props&&e.props.simca?e.props.simca:null),v=w(()=>e.props&&e.props.ncomp?e.props.ncomp:null),m=w(()=>e.params.resID!=="both"?[e.params.resID]:Object.keys(r(u))),g=w(()=>e.params.legendPosition?e.params.legendPosition:"bottomright"),h=w(()=>r(m)?r(m).map(N=>({id:N,label:N,point:{marker:1,lineColor:At[N],faceColor:Qr[N],marker:Gt[N],markerSize:.85,lineWidth:1.5}})):null),p=w(()=>r(u)&&r(m)?r(m).reduce((N,P)=>(N[P]=Me.seq(1,r(u)[P].v[r(v)-1].rolsNum.alien),N),{}):null),_=w(()=>r(u)&&r(m)&&r(v)?r(m).reduce((N,P)=>(N[P]=d(r(u)[P],r(f),r(v)),N),{}):null),b=w(()=>r(m)?r(m).reduce((N,P)=>Math.max(N,r(p)[P].length),0):1),y=w(()=>r(b)>1?c(r(b)):null),C=w(()=>r(p)?[-1,r(b)+2]:[0,1]),E=w(()=>r(p)?[-1,r(b)+2]:[0,1]),k=w(()=>r(v)?`Aliens (A = ${r(v)})`:"Aliens");var S=he(),A=J(S);{var M=N=>{Pr(N,{get title(){return r(k)},xLabel:s,yLabel:a,get limX(){return r(C)},get limY(){return r(E)},fileName:o,whole:!0,children:(P,I)=>{var R=oh(),q=J(R);{var U=B=>{var O=ah(),X=J(O);pr(X,$t(()=>r(y),{lineColor:t}));var Z=z(X,2);Ht(Z,{get xValues(){return r(y).xStart},get yValues(){return r(y).yStart},lineColor:t});var G=z(Z,2);Ht(G,{get xValues(){return r(y).xEnd},get yValues(){return r(y).yEnd},lineColor:t}),T(B,O)};W(q,B=>{r(y)&&B(U)})}var D=z(q,2);Ye(D,17,()=>r(m),Ge,(B,O)=>{ur(B,{get xValues(){return r(p)[r(O)]},get yValues(){return r(_)[r(O)]},plotType:"p",showLabels:!1,get faceColor(){return Qr[r(O)]},get mainColor(){return At[r(O)]},get marker(){return Gt[r(O)]},lineWidth:1.5})});var L=z(D,2);{var F=B=>{On(B,{get items(){return r(h)},get position(){return r(g)}})};W(L,B=>{r(h)&&r(h).length>0&&B(F)})}T(P,R)},$$slots:{default:!0}})};W(A,N=>{r(u)&&N(M)})}T(l,S),pe()}var ih=K("<!> <!> <!> <!>",1);function mc(l,e){ge(e,!0);const t="1 – selectivity, β",s="Expected sensitivity, 1 – ɑ",a="plot-selectivity-integral",o=[-.05,1.05],c=[-.05,1.05],d=w(()=>e.props&&e.props.classres?e.props.classres:null),u=w(()=>e.props&&e.props.simca?e.props.simca:null),f=w(()=>r(d)?Object.keys(r(d))[0]:null),v=141;function m(P){const I=Me.zeros(v),R=Me.zeros(v);I.v[0]=1,R.v[0]=1;let q=1,U=0;for(let D=.001;D<.1;D=D+.002){const L=P(D);I.v[q]=L,R.v[q]=1-D,U=U+L*.002,q=q+1}for(let D=.1;D<.9;D=D+.02){const L=P(D);I.v[q]=L,R.v[q]=1-D,U=U+L*.02,q=q+1}for(let D=.9;D<1;D=D+.002){const L=P(D);I.v[q]=L,R.v[q]=1-D,U=U+L*.002,q=q+1}return I.v[q]=0,R.v[q]=0,{x:I,y:R,auc:1-U}}let g=ne(void 0),h=ne(void 0),p=ne(void 0);ce(()=>{(r(h)!==r(u).ncomp||r(p)!==r(u).limType)&&(V(h,r(u).ncomp,!0),V(p,r(u).limType,!0),V(g,r(d)[r(f)].v[r(u).ncomp-1],!0))});const _=w(()=>r(g)?1/(r(g).k+r(g).s):null),b=w(()=>r(g)?1/r(g).Sz:null);function y(P){if(!r(g))return null;const R=ir(1-P,r(g).k)/r(g).f0;return Wl((Math.pow(R*r(_),r(g).hz)-r(g).Mz)*r(b))}const C=w(()=>r(u).alpha/100),E=w(()=>y(r(C))),k=w(()=>m(y));let S=w(()=>r(u).ncomp?`Selecitivity (A = ${r(u).ncomp}, AUC = ${r(k).auc.toFixed(4)})`:"Selectivity");var A=he(),M=J(A);{var N=P=>{Pr(P,{get title(){return r(S)},xLabel:t,yLabel:s,get limX(){return o},get limY(){return c},fileName:a,children:(I,R)=>{var q=ih(),U=J(q);pr(U,{xStart:[0],xEnd:[1],yStart:[0],yEnd:[1],lineColor:"#a0a0a0",lineType:3});var D=z(U,2);ur(D,{get xValues(){return r(k).x},get yValues(){return r(k).y},plotType:"l",showLabels:!1,get mainColor(){return At.test},lineWidth:1.5});var L=z(D,2);{let B=w(()=>[o[0]]),O=w(()=>[o[1]]),X=w(()=>[1-r(C)]),Z=w(()=>[1-r(C)]);pr(L,{get xStart(){return r(B)},get xEnd(){return r(O)},get yStart(){return r(X)},get yEnd(){return r(Z)},lineColor:"#a0a0a0"})}var F=z(L,2);{let B=w(()=>[r(E)]),O=w(()=>[1-r(C)]);Zi(F,{get xValues(){return r(B)},get yValues(){return r(O)},get lineColor(){return At.test},lineWidth:2,get faceColor(){return At.test}})}T(I,q)},$$slots:{default:!0}})};W(M,P=>{r(k)&&P(N)})}T(l,A),pe()}var ch=K("<!> <!>",1);function uh(l,e){ge(e,!0);const t=(E,k=xt)=>{oe(E,{label:"Selected",children:(S,A)=>{lt(S,{onclick:()=>e.markOutlier(k()),text:"remove"})},$$slots:{default:!0}})},s=(E,k=xt)=>{oe(E,{label:"Selected",children:(S,A)=>{var M=ch(),N=J(M);lt(N,{onclick:()=>e.showContributions(k()),text:"plot"});var P=z(N,2);lt(P,{onclick:()=>e.markOutlier(k()),text:"remove"}),T(S,M)},$$slots:{default:!0}})},a={test:e.testres.pca},o={test:e.testres.simca},c={test:e.testset},d=w(()=>({test:e.testres.simca})),u={regular:Jr.regular,extreme:Jr.extreme,outlier:Jr.outlier},f={alien:Jr.alien,external:Jr.external},v=w(()=>{const E=e.testres.simca.v[e.simca.ncomp-1];return{members:{classColmap:u,labels:[`regular: ${E.rolsNum.regular}`,`extreme: ${E.rolsNum.extreme}`,`outliers: ${E.rolsNum.outlier}`],values:E.rols,ind:e.testres.simca.ind.members},strangers:{classColmap:f,labels:[`aliens: ${E.rolsNum.alien}`,`external: ${E.rolsNum.external}`],values:E.rols,ind:e.testres.simca.ind.strangers}}}),m=w(()=>e.testres.simca.nMembers>0&&e.testres.simca.nStrangers>0?{acceptance:{label:"Acceptance",scope:"objects",component:cl,buttons:s},distances:{label:"Distances",scope:"objects",component:ul,buttons:s},extremes:{label:"Extremes",scope:"stats",component:Ma},aliens:{label:"Aliens",scope:"stats",component:vc},foms:{label:"FoMs",scope:"stats",component:as},sel:{label:"Selectivity",scope:"stats",component:mc},scores:{label:"Scores",scope:"objects",component:fl,buttons:t}}:e.testres.simca.nMembers>0?{acceptance:{label:"Acceptance",scope:"objects",component:cl,buttons:s},distances:{label:"Distances",scope:"objects",component:ul,buttons:s},extremes:{label:"Extremes",scope:"stats",component:Ma},foms:{label:"FoMs",scope:"stats",component:as},scores:{label:"Scores",scope:"objects",component:fl,buttons:t}}:{acceptance:{label:"Acceptance",scope:"objects",component:cl,buttons:s},distances:{label:"Distances",scope:"objects",component:ul,buttons:s},aliens:{label:"Aliens",scope:"stats",component:vc},foms:{label:"FoMs",scope:"stats",component:as},sel:{label:"Selectivity",scope:"stats",component:mc},scores:{label:"Scores",scope:"objects",component:fl,buttons:t}}),g=Re({acceptance:Ta(o),distances:Pa(a),extremes:fc(["test"]),aliens:R0(["test"]),foms:uc(o),sel:L0(["test"]),scores:za(a)});let h=ne(Re({acceptance:Rt(g.acceptance),distances:Rt(g.distances),extremes:Rt(g.extremes),aliens:Rt(g.aliens),foms:Rt(g.foms),sel:Rt(g.sel),scores:Rt(g.scores)}));ce(()=>{const E={};e.testres.simca.nMembers>0&&(E.sens=bi(e.testres.simca.nMembers,e.simca.alpha)),r(h).foms.ci=E}),ce(()=>{r(h).acceptance.subset&&e.resetSelection()}),ce(()=>{r(h).acceptance.ncomp=e.simca.ncomp,r(h).acceptance.title=`Acceptance (A = ${e.simca.ncomp})`,r(h).acceptance.limType=e.simca.limType,r(h).acceptance.alpha=e.simca.alpha,r(h).acceptance.gamma=e.simca.gamma}),ce(()=>{r(v)&&r(h).acceptance.subset&&(r(h).acceptance.colorByObj=r(h).acceptance.subset!=="all"?r(v)[r(h).acceptance.subset]:null)}),ce(()=>{r(h).acceptance.colorBy=r(h).acceptance.subset!=="all"?"roles":"classes"}),ce(()=>{r(h).scores.plotType!=="p"?(g.scores.comp1.hidden=!0,g.scores.showEllipse.hidden=!0,r(h).scores.showEllipse=!1):(g.scores.comp1.hidden=!1,g.scores.showEllipse.hidden=!1),r(h).scores.plotType==="l"||r(h).scores.plotType==="b"?(g.scores.colorBy.hidden=!0,r(h).scores.colorBy="none"):g.scores.colorBy.hidden=!1,r(h).scores.colorBy==="variable"?g.scores.colorByVar.hidden=!1:g.scores.colorByVar.hidden=!0,r(h).scores.colorBy==="groups"&&r(h).scores.plotType==="p"?g.scores.confEllipse.hidden=!1:(g.scores.confEllipse.hidden=!0,r(h).scores.confEllipse="none")});const p=w(()=>({res:a,classres:r(d),model:e.model,simca:e.simca,data:c,ncomp:e.simca.ncomp})),_={markOutlier:e.markOutlier,showContributions:e.showContributions};var b=he(),y=J(b);{var C=E=>{Na(E,{get plots(){return r(m)},get controls(){return g},get props(){return r(p)},get callbacks(){return _},get params(){return r(h)},set params(k){V(h,k,!0)}})};W(y,E=>{e.simca&&e.testres&&E(C)})}T(l,b),pe()}var fh=K('<div class="data-loader svelte-1qdsey6"><!></div>'),dh=K('<div class="outliers-pane svelte-1qdsey6"><!></div>'),vh=K('<div class="buttons"><!> <!></div>'),mh=K('<div class="model-stats svelte-1qdsey6"><!></div> <div class="result-stats svelte-1qdsey6"><!></div>',1),hh=K('<p class="svelte-1qdsey6"><strong>Step 1</strong></p> <p class="svelte-1qdsey6">Load previously trained DD-SIMCA model from file.</p>',1),gh=K(`<p class="svelte-1qdsey6"><strong>Step 2</strong></p> <p class="svelte-1qdsey6">Load test set set from CSV file. The requirements to the file are the same as for the training set (column with
               class labels is mandatory), but test set may contain class labels both for target class (members) as well as for
               alternative classes (strangers).</p>`,1),ph=K(`<div class="help-text svelte-1qdsey6"><p class="svelte-1qdsey6">In this tab you can apply previously trained DD-SIMCA model to a dataset consisting of target class members (at least
            the app will assume this, you can of course provide any dataset). You can use it for testing performance
            of the model, or tune its parameters, if necessary.</p> <!></div>`),bh=K('<!> <div class="app-container svelte-1qdsey6"><div class="app-controls svelte-1qdsey6"><div class="model-loader svelte-1qdsey6"><!></div> <!> <!> <div class="simca-settings svelte-1qdsey6"><!> <!></div> <!></div> <div class="app-content svelte-1qdsey6"><!></div></div>',1);function _h(l,e){ge(e,!0);const t=w(()=>e.session.test);let s=ne(-1),a=ne(!1);function o(B){if(B<0||B>r(t).testres.pca.nrows-1)return;const O=r(t).testres.pca.objindices[B];O>=0&&!r(t).outliers.includes(O)&&(r(t).outliers.push(O),r(t).testres.simca=null,r(t).testres.pca=null)}function c(B){B<0||(V(s,B,!0),V(a,!0))}function d(){V(a,!1),V(s,-1)}function u(){r(t).outliers=[],r(t).testres.simca=null,r(t).testres.pca=null}function f(){r(t).outliers.pop(),r(t).testres.simca=null,r(t).testres.pca=null}function v(){V(s,-1)}Il(()=>{r(t).testset===null&&(r(t).outliers=[],r(t).testres.simca=null,r(t).testres.pca=null),r(t).model===null&&(r(t).testres.simca=null,r(t).testres.pca=null,r(t).testset=null,r(t).outliers=[],r(t).simca=null)}),ce(()=>{r(t).model===null&&(r(t).outliers=[],r(t).testres.simca=null,r(t).testres.pca=null,r(t).testset=null)}),ce(()=>{r(t).testset===null&&(r(t).outliers=[],r(t).testres.simca=null,r(t).testres.pca=null,r(t).ind=null)}),ce(()=>{if(!r(t).testres.pca||!r(t).simca||r(t).testres.pca.classes.length<1)return;const B=r(t).testres.pca.classes,O=[],X=[];for(let Z=0;Z<B.length;Z++)B[Z]===r(t).simca.className?O.push(Z):X.push(Z);r(t).ind={members:O,strangers:X}}),ce(()=>{r(t).testres.pca&&r(t).simca&&r(t).ind&&(r(t).testres.simca=es(r(t).testres.pca,Wt(()=>r(t).simca.limType),r(t).simca.eCrit,r(t).simca.oCrit,r(t).ind))}),ce(()=>{const B=Wt(()=>JSON.stringify(e.session,sl));r(t).simca?e.backupSession(B,r(t).model,r(t).testset,r(t).simca.ncomp,r(t).testres.simca):e.backupSession(B,r(t).model,r(t).testset,r(t).simca,r(t).testres.simca)});var m=bh(),g=J(m);{var h=B=>{{let O=w(()=>({test:r(t).testres.pca}));xa(B,{get model_getter(){return rt},get res_getter(){return tr},get model(){return r(t).model},get res(){return r(O)},closeModal:d,get ncomp(){return r(t).simca.ncomp},get selected(){return r(s)}})}};W(g,B=>{r(a)&&r(t).simca&&r(t).model&&r(t).testres&&B(h)})}var p=z(g,2),_=j(p),b=j(_),y=j(b);dc(y,{get model(){return r(t).model},set model(B){r(t).model=B},get simca(){return r(t).simca},set simca(B){r(t).simca=B}});var C=z(b,2);{var E=B=>{var O=fh(),X=j(O);Sa(X,{get outliers(){return r(t).outliers},get WASM(){return e.WASM},get model(){return r(t).model},className:"Class",classMandatory:!0,get dataset(){return r(t).testset},set dataset(Z){r(t).testset=Z},get resobj(){return r(t).testres.pca},set resobj(Z){r(t).testres.pca=Z}}),T(B,O)};W(C,B=>{r(t).model&&B(E)})}var k=z(C,2);{var S=B=>{var O=dh(),X=j(O);ia(X,{get outliers(){return r(t).outliers},get dataset(){return r(t).testset},resetOutliers:u,undoOutliers:f}),T(B,O)};W(k,B=>{r(t).outliers&&r(t).outliers.length>0&&B(S)})}var A=z(k,2),M=j(A);{var N=B=>{Aa(B,{get model(){return r(t).model},get className(){return r(t).className},get simca(){return r(t).simca},set simca(O){r(t).simca=O}})};W(M,B=>{r(t).model&&r(t).testres.pca&&B(N)})}var P=z(M,2);{var I=B=>{oe(B,{label:"Download",children:(O,X)=>{var Z=vh(),G=j(Z);lt(G,{onclick:()=>ts(r(t).model,r(t).simca,r(t).testres,r(t).testset,"test",r(t).outliers),text:"Res (test)"});var $=z(G,2);lt($,{onclick:()=>oa(r(t).model,r(t).simca),text:"Model"}),T(O,Z)},$$slots:{default:!0}})};W(P,B=>{r(t).testres.simca&&B(I)})}var R=z(A,2);{var q=B=>{var O=mh(),X=J(O),Z=j(X);Ca(Z,{get model(){return r(t).model},get simca(){return r(t).simca}});var G=z(X,2),$=j(G);sh($,{get res(){return r(t).testres.simca},get ncomp(){return r(t).simca.ncomp}}),T(B,O)};W(R,B=>{r(t).model&&r(t).simca&&r(t).testres.simca&&B(q)})}var U=z(_,2),D=j(U);{var L=B=>{var O=ph(),X=z(j(O),2);{var Z=$=>{var le=hh();T($,le)},G=$=>{var le=he(),te=J(le);{var se=_e=>{var Se=gh();T(_e,Se)};W(te,_e=>{r(t).testset||_e(se)})}T($,le)};W(X,$=>{r(t).model?$(G,!1):$(Z)})}T(B,O)},F=B=>{var O=he(),X=J(O);{var Z=G=>{var $=he(),le=J($);Rn(le,()=>r(t).testres.pca,te=>{uh(te,$t({markOutlier:o,showContributions:c,resetSelection:v},()=>r(t)))}),T(G,$)};W(X,G=>{r(t).model&&r(t).simca&&r(t).testres&&G(Z)})}T(B,O)};W(D,B=>{r(t).testres.simca?B(F,!1):B(L)})}T(l,m),pe()}var wh=K('<table class="svelte-kg0b31"><thead><tr class="svelte-kg0b31"><th class="svelte-kg0b31"></th><th class="svelte-kg0b31">New</th></tr></thead><tbody><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Objects</td><td class="svelte-kg0b31"> </td></tr><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">In</td><td class="svelte-kg0b31"> </td></tr><tr class="svelte-kg0b31"><td class="label svelte-kg0b31">Out</td><td class="svelte-kg0b31"> </td></tr></tbody></table>');function yh(l,e){ge(e,!0);var t=he(),s=J(t);{var a=o=>{var c=wh(),d=z(j(c)),u=j(d),f=z(j(u)),v=j(f),m=z(u),g=z(j(m)),h=j(g),p=z(m),_=z(j(p)),b=j(_);ae(()=>{ve(v,e.res.v[0].decs.length),ve(h,e.res.v[e.ncomp-1].decsNum.in),ve(b,e.res.v[e.ncomp-1].decsNum.out)}),T(o,c)};W(s,o=>{e.res&&o(a)})}T(l,t),pe()}var xh=K("<!> <!>",1);function kh(l,e){ge(e,!0);const t=(g,h=xt)=>{oe(g,{label:"Selected",children:(p,_)=>{lt(p,{onclick:()=>e.markOutlier(h()),text:"remove"})},$$slots:{default:!0}})},s=(g,h=xt)=>{oe(g,{label:"Selected",children:(p,_)=>{var b=xh(),y=J(b);lt(y,{onclick:()=>e.showContributions(h()),text:"plot"});var C=z(y,2);lt(C,{onclick:()=>e.markOutlier(h()),text:"remove"}),T(p,b)},$$slots:{default:!0}})},a={new:e.newres.pca},o={new:e.newset},c=w(()=>({new:e.newres.simca})),d=w(()=>({acceptance:{label:"Acceptance",scope:"objects",component:cl,buttons:s},distances:{label:"Distances",scope:"objects",component:ul,buttons:s},scores:{label:"Scores",scope:"objects",component:fl,buttons:t}})),u=Re({acceptance:Ta(a),distances:Pa(a),scores:za(a)});let f=ne(Re({acceptance:Rt(u.acceptance),distances:Rt(u.distances),scores:Rt(u.scores)}));ce(()=>{r(f).acceptance.ncomp=e.simca.ncomp,r(f).acceptance.title=`Acceptance (A = ${e.simca.ncomp})`,r(f).acceptance.limType=e.simca.limType,r(f).acceptance.alpha=e.simca.alpha,r(f).acceptance.gamma=e.simca.gamma}),ce(()=>{r(f).acceptance.colorByObj={values:r(c).new.v[e.simca.ncomp-1].rols,classColmap:{alien:At.new,external:At.new},labels:["alien","external"],filled:r(c).new.v[e.simca.ncomp-1].rols.map(g=>g==="external"),showBar:!1}}),ce(()=>{r(f).scores.plotType!=="p"?(u.scores.comp1.hidden=!0,u.scores.showEllipse.hidden=!0,r(f).scores.showEllipse=!1):(u.scores.comp1.hidden=!1,u.scores.showEllipse.hidden=!1),r(f).scores.plotType==="l"||r(f).scores.plotType==="b"?(u.scores.colorBy.hidden=!0,r(f).scores.colorBy="none"):u.scores.colorBy.hidden=!1,r(f).scores.colorBy==="variable"?u.scores.colorByVar.hidden=!1:u.scores.colorByVar.hidden=!0,r(f).scores.colorBy==="groups"&&r(f).scores.plotType==="p"?u.scores.confEllipse.hidden=!1:(u.scores.confEllipse.hidden=!0,r(f).scores.confEllipse="none")});const v=w(()=>({res:a,classres:r(c),model:e.model,simca:e.simca,data:o,ncomp:e.simca.ncomp})),m={markOutlier:e.markOutlier,showContributions:e.showContributions};Na(l,{get plots(){return r(d)},get controls(){return u},get props(){return r(v)},get callbacks(){return m},get params(){return r(f)},set params(g){V(f,g,!0)}}),pe()}var Eh=K('<div class="data-loader svelte-1qdsey6"><!></div>'),Sh=K('<div class="outliers-pane svelte-1qdsey6"><!></div>'),Ch=K('<div class="buttons"><!> <!></div>'),Ah=K('<div class="model-stats svelte-1qdsey6"><!></div> <div class="result-stats svelte-1qdsey6"><!></div>',1),Nh=K('<p class="svelte-1qdsey6"><strong>Step 1</strong></p> <p class="svelte-1qdsey6">Load previously trained DD-SIMCA model from file.</p>',1),Mh=K(`<p class="svelte-1qdsey6"><strong>Step 2</strong></p> <p class="svelte-1qdsey6">Load data set from CSV file. The requirements to the file are the same as for the
               training set but no columns with reference classes is expected. If you have reference classes, use <em>Test</em> tab.</p>`,1),Th=K(`<div class="help-text svelte-1qdsey6"><p class="svelte-1qdsey6">In this tab you can apply previously trained DD-SIMCA model to a new dataset with objects whose class is unknown (hence the app
            does not expect column with target classes).</p> <!></div>`),Ph=K('<!> <div class="app-container svelte-1qdsey6"><div class="app-controls svelte-1qdsey6"><div class="model-loader svelte-1qdsey6"><!></div> <!> <!> <div class="simca-settings svelte-1qdsey6"><!> <!></div> <!></div> <div class="app-content svelte-1qdsey6"><!></div></div>',1);function zh(l,e){ge(e,!0);const t=w(()=>e.session.new);let s=ne(-1),a=ne(!1);function o(F){if(F<0||F>r(t).newres.pca.nrows-1)return;const B=r(t).newres.pca.objindices[F];B>=0&&!r(t).outliers.includes(B)&&(r(t).outliers.push(B),r(t).newres.simca=null,r(t).newres.pca=null)}function c(){r(t).outliers=[],r(t).newres.simca=null,r(t).newres.pca=null}function d(){r(t).outliers.pop(),r(t).newres.simca=null,r(t).newres.pca=null}function u(F){F<0||(V(s,F,!0),V(a,!0))}function f(){V(a,!1),V(s,-1)}Il(()=>{r(t).newset===null&&(r(t).outliers=[],r(t).newres.simca=null,r(t).newres.pca=null),r(t).model===null&&(r(t).outliers=[],r(t).simca=null,r(t).newres.simca=null,r(t).newres.pca=null,r(t).newset=null)}),ce(()=>{r(t).model===null&&(r(t).outliers=[],r(t).newres.simca=null,r(t).newres.pca=null,r(t).newset=null)}),ce(()=>{r(t).newset===null&&(r(t).outliers=[],r(t).newres.simca=null,r(t).newres.pca=null)}),ce(()=>{r(t).newres.pca&&r(t).simca&&(r(t).newres.simca=es(r(t).newres.pca,Wt(()=>r(t).simca.limType),r(t).simca.eCrit,r(t).simca.oCrit))}),ce(()=>{const F=Wt(()=>JSON.stringify(e.session,sl));e.backupSession(F,r(t).model,r(t).newset,r(t).newres.simca,r(t).simca.ncomp)});var v=Ph(),m=J(v);{var g=F=>{{let B=w(()=>({new:r(t).newres.pca}));xa(F,{get model_getter(){return rt},get res_getter(){return tr},get model(){return r(t).model},get res(){return r(B)},closeModal:f,get ncomp(){return r(t).simca.ncomp},get selected(){return r(s)}})}};W(m,F=>{r(a)&&F(g)})}var h=z(m,2),p=j(h),_=j(p),b=j(_);dc(b,{get model(){return r(t).model},set model(F){r(t).model=F},get simca(){return r(t).simca},set simca(F){r(t).simca=F}});var y=z(_,2);{var C=F=>{var B=Eh(),O=j(B);Sa(O,{get outliers(){return r(t).outliers},get WASM(){return e.WASM},get model(){return r(t).model},className:"Class",csvOnly:!1,get dataset(){return r(t).newset},set dataset(X){r(t).newset=X},get resobj(){return r(t).newres.pca},set resobj(X){r(t).newres.pca=X}}),T(F,B)};W(y,F=>{r(t).model&&F(C)})}var E=z(y,2);{var k=F=>{var B=Sh(),O=j(B);ia(O,{get outliers(){return r(t).outliers},get dataset(){return r(t).newset},undoOutliers:d,resetOutliers:c}),T(F,B)};W(E,F=>{r(t).outliers&&r(t).outliers.length>0&&F(k)})}var S=z(E,2),A=j(S);{var M=F=>{Aa(F,{get model(){return r(t).model},get className(){return r(t).className},isAlt:!0,get simca(){return r(t).simca},set simca(B){r(t).simca=B}})};W(A,F=>{r(t).model&&r(t).newres.pca&&F(M)})}var N=z(A,2);{var P=F=>{oe(F,{label:"Download",children:(B,O)=>{var X=Ch(),Z=j(X);lt(Z,{onclick:()=>ts(r(t).model,r(t).simca,r(t).newres,r(t).newset,"new",r(t).outliers),text:"Res"});var G=z(Z,2);lt(G,{onclick:()=>oa(r(t).model,r(t).simca),text:"Model"}),T(B,X)},$$slots:{default:!0}})};W(N,F=>{r(t).newres.simca&&F(P)})}var I=z(S,2);{var R=F=>{var B=Ah(),O=J(B),X=j(O);Ca(X,{get model(){return r(t).model},get simca(){return r(t).simca},isAlt:!0});var Z=z(O,2),G=j(Z);yh(G,{get res(){return r(t).newres.simca},get ncomp(){return r(t).simca.ncomp}}),T(F,B)};W(I,F=>{r(t).newres.simca&&F(R)})}var q=z(p,2),U=j(q);{var D=F=>{var B=Th(),O=z(j(B),2);{var X=G=>{var $=Nh();T(G,$)},Z=G=>{var $=he(),le=J($);{var te=se=>{var _e=Mh();T(se,_e)};W(le,se=>{r(t).newset||se(te)})}T(G,$)};W(O,G=>{r(t).model?G(Z,!1):G(X)})}T(F,B)},L=F=>{var B=he(),O=J(B);Rn(O,()=>r(t).newres.pca,X=>{kh(X,$t({markOutlier:o,showContributions:u},()=>r(t)))}),T(F,B)};W(U,F=>{r(t).newres.simca?F(L,!1):F(D)})}T(l,v),pe()}function hc(l,e){V(e,!0)}function Lh(l,e,t){const s=sa(new Date),a=e.appID+"-session-"+s+".json";r(t).date=s;const o=JSON.stringify(r(t),sl),c=new Blob([o],{type:"text/json"}),d=window.URL.createObjectURL(c),u=document.createElement("a");u.setAttribute("href",d),u.setAttribute("download",a),u.click()}function Rh(l,e){confirm("Are you sure? All current results and models will be lost in all tabs.")&&e()}var Ih=K('<sup style="color:red">β</sup>'),jh=K('<li><button class="svelte-1cyr8za"> </button></li>'),qh=K("<div><!></div>"),Fh=K('<div class="info-container svelte-1cyr8za"><!></div>'),Oh=K('<div class="page svelte-1cyr8za"><header class="page-header svelte-1cyr8za"><div class="header-group svelte-1cyr8za"><img class="logo svelte-1cyr8za" src="logo.svg"/> <h1 class="svelte-1cyr8za"> <!></h1> <p class="svelte-1cyr8za"> </p></div> <ul class="nav svelte-1cyr8za"></ul></header> <main class="svelte-1cyr8za"></main> <footer class="svelte-1cyr8za"><div><span class="session-message svelte-1cyr8za"> </span> <label title="load session from file" class="upload-button svelte-1cyr8za"><input type="file" class="svelte-1cyr8za"/> <svg xmlns="http://www.w3.org/2000/svg" version="2.0" width="20px" height="20px" viewBox="0 0 100 100" class="svelte-1cyr8za"><line x1="50" y1="25" x2="50" y2="75"></line><line x1="30" y1="40" x2="50" y2="25"></line><line x1="70" y1="40" x2="50" y2="25"></line></svg></label> <button title="download session as a file" class="download-button svelte-1cyr8za"><svg xmlns="http://www.w3.org/2000/svg" version="2.0" width="20px" height="20px" viewBox="0 0 100 100" class="svelte-1cyr8za"><line x1="50" y1="25" x2="50" y2="75"></line><line x1="30" y1="60" x2="50" y2="75"></line><line x1="70" y1="60" x2="50" y2="75"></line></svg></button> <button title="reset all sessions" class="clear-button svelte-1cyr8za"><svg xmlns="http://www.w3.org/2000/svg" version="2.0" width="20px" height="20px" viewBox="0 0 100 100" class="svelte-1cyr8za"><line x1="25" y1="25" x2="75" y2="75"></line><line x1="25" y1="75" x2="75" y2="25"></line></svg></button></div> <div class="info svelte-1cyr8za"><button title="Show information about the app" class="button-info svelte-1cyr8za">info</button> <!></div></footer> <!></div>');function Dh(l,e){ge(e,!0);let t=Y(e,"tabs",19,()=>[]),s=Y(e,"isBeta",3,!1);const a="mdatools-"+e.appID;let o=ne(!1),c=ne(void 0),d=ne("Current session "),u=ne(!1);function f(k){V(d,k,!0),V(u,!0),setTimeout(()=>{V(d,"Current session "),V(u,!1)},1e3)}function v(){V(o,!1)}function m(k){r(c).tab=k}function g(){const k=indexedDB.open(a,1);k.onsuccess=S=>{const M=S.target.result.transaction(e.appID,"readwrite");M.objectStore(e.appID).delete("session"),M.oncomplete=()=>{V(c,e.initSession(),!0),f("Session was reinitialzed.")},M.onerror=()=>console.error("Failed to session from DB.")}}function h(k,S){window.localStorage.removeItem(e.appID+"-blocked");const A=indexedDB.open(a,1);A.onsuccess=M=>{const I=M.target.result.transaction(e.appID,"readwrite").objectStore(e.appID);I.put(k,"session"),I.put(sa(new Date),"session-update")}}function p(){new Promise((k,S)=>{const A=indexedDB.open(a,1);A.onsuccess=M=>{const R=M.target.result.transaction(e.appID,"readonly").objectStore(e.appID).get("session");R.onsuccess=()=>k(R.result),R.onerror=()=>S(R.error)}}).then(k=>{_(k),V(d,"Last session is restored "),V(u,!0),setTimeout(()=>{V(d,"Current session "),V(u,!1)},1500)}).catch(k=>{console.error(k),V(c,e.initSession(),!0)})}function _(k){if(!k||k==="undefined"){V(c,e.initSession(),!0);return}const S=JSON.parse(k,la);V(c,e.checkSession(S)?S:e.initSession(e.appID),!0)}function b(k){e.resetSession(r(c));const S=new FileReader;S.onload=()=>{_(S.result),k.target.value=""},S.readAsText(k.target.files[0])}nf(()=>{const k=e.appID,S=indexedDB.open(a,1);S.onupgradeneeded=A=>{const M=A.target.result;M.objectStoreNames.contains(k)||M.createObjectStore(k)},S.onsuccess=A=>{p()}});var y=he(),C=J(y);{var E=k=>{var S=Oh(),A=j(S),M=j(A),N=j(M),P=z(N,2),I=j(P),R=z(I);{var q=me=>{var ee=Ih();T(me,ee)};W(R,me=>{s()&&me(q)})}var U=z(P,2),D=j(U),L=z(M,2);Ye(L,21,t,Ge,(me,ee,ie)=>{var ue=jh();let be;var fe=j(ue);fe.__click=()=>m(ie),fe.__keydown=()=>m(ie);var ke=j(fe);ae(De=>{be=pt(ue,1,"nav-item svelte-1cyr8za",null,be,De),ve(ke,r(ee).name)},[()=>({selected:r(c).tab===ie})]),T(me,ue)});var F=z(A,2);Ye(F,21,t,Ge,(me,ee,ie)=>{var ue=qh();let be;var fe=j(ue);tl(fe,()=>r(ee).component,(ke,De)=>{De(ke,{get WASM(){return e.WASM},get session(){return r(c)},backupSession:h})}),ae(ke=>be=pt(ue,1,"tab-content svelte-1cyr8za",null,be,ke),[()=>({hidden:r(c).tab!==ie})]),T(me,ue)});var B=z(F,2),O=j(B);let X;var Z=j(O),G=j(Z),$=z(Z,2),le=j($);le.__change=b;var te=z($,2);te.__click=[Lh,e,c];var se=z(te,2);se.__click=[Rh,g];var _e=z(O,2),Se=j(_e);Se.__click=[hc,o],Se.__keydown=[hc,o];var xe=z(Se,2);Rr(xe,()=>e.footer);var de=z(B,2);{var ye=me=>{_a(me,{closeModal:v,children:(ee,ie)=>{var ue=Fh(),be=j(ue);Rr(be,()=>e.info),T(ee,ue)},$$slots:{default:!0}})};W(de,me=>{r(o)&&me(ye)})}ae(me=>{H(N,"alt",e.appShortTitle),ve(I,e.appTitle),ve(D,e.appSlogan),X=pt(O,1,"session svelte-1cyr8za",null,X,me),ve(G,r(d))},[()=>({"no-buttons":r(u)})]),T(k,S)};W(C,k=>{r(c)&&k(E)})}T(l,y),pe()}vt(["click","keydown","change"]);const $h="modulepreload",eg=function(l){return"/"+l},tg={},Bh=function(e,t,s){let a=Promise.resolve();function o(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return a.then(c=>{for(const d of c||[])d.status==="rejected"&&o(d.reason);return e().catch(o)})};async function Vh(l={}){var bc;var e,t=l,s=typeof window=="object",a=typeof WorkerGlobalScope<"u",o=typeof process=="object"&&((bc=process.versions)==null?void 0:bc.node)&&process.type!="renderer";if(o){const{createRequire:Q}=await Bh(()=>Promise.resolve().then(()=>Hh),void 0);var c=Q(Qe&&Qe.tagName.toUpperCase()==="SCRIPT"&&Qe.src||new URL("ddsimca.js",document.baseURI).href)}var d=(Q,re)=>{throw re},u=Qe&&Qe.tagName.toUpperCase()==="SCRIPT"&&Qe.src||new URL("ddsimca.js",document.baseURI).href,f="";function v(Q){return t.locateFile?t.locateFile(Q,f):f+Q}var m,g;if(o){var h=c("fs");u.startsWith("file:")&&(f=c("path").dirname(c("url").fileURLToPath(u))+"/"),g=Q=>{Q=E(Q)?new URL(Q):Q;var re=h.readFileSync(Q);return re},m=async(Q,re=!0)=>{Q=E(Q)?new URL(Q):Q;var we=h.readFileSync(Q,re?void 0:"utf8");return we},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),d=(Q,re)=>{throw process.exitCode=Q,re}}else if(s||a){try{f=new URL(".",u).href}catch{}a&&(g=Q=>{var re=new XMLHttpRequest;return re.open("GET",Q,!1),re.responseType="arraybuffer",re.send(null),new Uint8Array(re.response)}),m=async Q=>{if(E(Q))return new Promise((we,tt)=>{var Je=new XMLHttpRequest;Je.open("GET",Q,!0),Je.responseType="arraybuffer",Je.onload=()=>{if(Je.status==200||Je.status==0&&Je.response){we(Je.response);return}tt(Je.status)},Je.onerror=tt,Je.send(null)});var re=await fetch(Q,{credentials:"same-origin"});if(re.ok)return re.arrayBuffer();throw new Error(re.status+" : "+re.url)}}var p=console.log.bind(console),_=console.error.bind(console),b,y=!1,C,E=Q=>Q.startsWith("file://"),k,S,A,M,N,P,I=!1;function R(){var Q=A.buffer;M=new Int8Array(Q),N=new Uint8Array(Q),t.HEAP32=new Int32Array(Q),P=new Uint32Array(Q),t.HEAPF64=new Float64Array(Q),new BigInt64Array(Q),new BigUint64Array(Q)}function q(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)ie(t.preRun.shift());de(ee)}function U(){I=!0,_l.k()}function D(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)me(t.postRun.shift());de(ye)}var L=0,F=null;function B(Q){var re;L++,(re=t.monitorRunDependencies)==null||re.call(t,L)}function O(Q){var we;if(L--,(we=t.monitorRunDependencies)==null||we.call(t,L),L==0&&F){var re=F;F=null,re()}}function X(Q){var we;(we=t.onAbort)==null||we.call(t,Q),Q="Aborted("+Q+")",_(Q),y=!0,Q+=". Build with -sASSERTIONS for more info.";var re=new WebAssembly.RuntimeError(Q);throw S==null||S(re),re}var Z;function G(){return t.locateFile?v("pca_wasm.wasm"):new URL("/ddsimca/ddsimca.wasm",Qe&&Qe.tagName.toUpperCase()==="SCRIPT"&&Qe.src||new URL("ddsimca.js",document.baseURI).href).href}function $(Q){if(Q==Z&&b)return new Uint8Array(b);if(g)return g(Q);throw"both async and sync fetching of the wasm failed"}async function le(Q){if(!b)try{var re=await m(Q);return new Uint8Array(re)}catch{}return $(Q)}async function te(Q,re){try{var we=await le(Q),tt=await WebAssembly.instantiate(we,re);return tt}catch(Je){_(`failed to asynchronously prepare wasm: ${Je}`),X(Je)}}async function se(Q,re,we){if(!Q&&typeof WebAssembly.instantiateStreaming=="function"&&!E(re)&&!o)try{var tt=fetch(re,{credentials:"same-origin"}),Je=await WebAssembly.instantiateStreaming(tt,we);return Je}catch(ct){_(`wasm streaming compile failed: ${ct}`),_("falling back to ArrayBuffer instantiation")}return te(re,we)}function _e(){return{a:Xh}}async function Se(){function Q(ct,ut){return _l=ct.exports,A=_l.j,R(),Gh(_l),O(),_l}B();function re(ct){return Q(ct.instance)}var we=_e();if(t.instantiateWasm)return new Promise((ct,ut)=>{t.instantiateWasm(we,(dt,wr)=>{ct(Q(dt))})});Z??(Z=G());var tt=await se(b,Z,we),Je=re(tt);return Je}class xe{constructor(re){yr(this,"name","ExitStatus");this.message=`Program terminated with exit(${re})`,this.status=re}}var de=Q=>{for(;Q.length>0;)Q.shift()(t)},ye=[],me=Q=>ye.push(Q),ee=[],ie=Q=>ee.push(Q),ue=!0,be=Q=>Ct(Q),fe=()=>pc(),ke=()=>X(""),De=0,Ue=()=>{ue=!1,De=0},He={},Ke=Q=>{if(Q instanceof xe||Q=="unwind")return C;d(1,Q)},gt=()=>ue||De>0,et=Q=>{var re;C=Q,gt()||((re=t.onExit)==null||re.call(t,Q),y=!0),d(Q,new xe(Q))},qe=(Q,re)=>{C=Q,et(Q)},Fe=qe,Ee=()=>{if(!gt())try{Fe(C)}catch(Q){Ke(Q)}},ze=Q=>{if(!y)try{Q(),Ee()}catch(re){Ke(re)}},Pe=()=>performance.now(),Mt=(Q,re)=>{if(He[Q]&&(clearTimeout(He[Q].id),delete He[Q]),!re)return 0;var we=setTimeout(()=>{delete He[Q],ze(()=>zr(Q,Pe()))},re);return He[Q]={id:we,timeout_ms:re},0},pl=()=>Date.now(),bl=()=>2147483648,Le=(Q,re)=>Math.ceil(Q/re)*re,Te=Q=>{var re=A.buffer.byteLength,we=(Q-re+65535)/65536|0;try{return A.grow(we),R(),1}catch{}},Ne=Q=>{var re=N.length;Q>>>=0;var we=bl();if(Q>we)return!1;for(var tt=1;tt<=4;tt*=2){var Je=re*(1+.2/tt);Je=Math.min(Je,Q+100663296);var ct=Math.min(we,Le(Math.max(Q,Je),65536)),ut=Te(ct);if(ut)return!0}return!1},Ie=Q=>52;function Et(Q,re,we,tt){return 70}var _r=[null,[],[]],Vt=typeof TextDecoder<"u"?new TextDecoder:void 0,Xt=(Q,re,we,tt)=>{for(var Je=re+we;Q[re]&&!(re>=Je);)++re;return re},st=(Q,re=0,we,tt)=>{var Je=Xt(Q,re,we);if(Je-re>16&&Q.buffer&&Vt)return Vt.decode(Q.subarray(re,Je));for(var ct="";re<Je;){var ut=Q[re++];if(!(ut&128)){ct+=String.fromCharCode(ut);continue}var dt=Q[re++]&63;if((ut&224)==192){ct+=String.fromCharCode((ut&31)<<6|dt);continue}var wr=Q[re++]&63;if((ut&240)==224?ut=(ut&15)<<12|dt<<6|wr:ut=(ut&7)<<18|dt<<12|wr<<6|Q[re++]&63,ut<65536)ct+=String.fromCharCode(ut);else{var En=ut-65536;ct+=String.fromCharCode(55296|En>>10,56320|En&1023)}}return ct},Ze=(Q,re)=>{var we=_r[Q];re===0||re===10?((Q===1?p:_)(st(we)),we.length=0):we.push(re)},jt=(Q,re,we)=>Q?st(N,Q,re):"",St=(Q,re,we,tt)=>{for(var Je=0,ct=0;ct<we;ct++){var ut=P[re>>2],dt=P[re+4>>2];re+=8;for(var wr=0;wr<dt;wr++)Ze(Q,N[ut+wr]);Je+=dt}return P[tt>>2]=Je,0},wt=Q=>{var re=t["_"+Q];return re},ft=(Q,re)=>{M.set(Q,re)},fr=Q=>{for(var re=0,we=0;we<Q.length;++we){var tt=Q.charCodeAt(we);tt<=127?re++:tt<=2047?re+=2:tt>=55296&&tt<=57343?(re+=4,++we):re+=3}return re},kn=(Q,re,we,tt)=>{if(!(tt>0))return 0;for(var Je=we,ct=we+tt-1,ut=0;ut<Q.length;++ut){var dt=Q.codePointAt(ut);if(dt<=127){if(we>=ct)break;re[we++]=dt}else if(dt<=2047){if(we+1>=ct)break;re[we++]=192|dt>>6,re[we++]=128|dt&63}else if(dt<=65535){if(we+2>=ct)break;re[we++]=224|dt>>12,re[we++]=128|dt>>6&63,re[we++]=128|dt&63}else{if(we+3>=ct)break;re[we++]=240|dt>>18,re[we++]=128|dt>>12&63,re[we++]=128|dt>>6&63,re[we++]=128|dt&63,ut++}}return re[we]=0,we-Je},nt=(Q,re,we)=>kn(Q,N,re,we),Ae=Q=>us(Q),qt=Q=>{var re=fr(Q)+1,we=Ae(re);return nt(Q,we,re),we},La=(Q,re,we,tt,Je)=>{var ct={string:nr=>{var wl=0;return nr!=null&&nr!==0&&(wl=qt(nr)),wl},array:nr=>{var wl=Ae(nr.length);return ft(nr,wl),wl}};function ut(nr){return re==="string"?jt(nr):re==="boolean"?!!nr:nr}var dt=wt(Q),wr=[],En=0;if(tt)for(var Sn=0;Sn<tt.length;Sn++){var _c=ct[we[Sn]];_c?(En===0&&(En=fe()),wr[Sn]=_c(tt[Sn])):wr[Sn]=tt[Sn]}var Ia=dt(...wr);function Jh(nr){return En!==0&&be(En),ut(nr)}return Ia=Jh(Ia),Ia};t.noExitRuntime&&(ue=t.noExitRuntime),t.print&&(p=t.print),t.printErr&&(_=t.printErr),t.wasmBinary&&(b=t.wasmBinary),t.arguments&&t.arguments,t.thisProgram&&t.thisProgram,t.ccall=La;var zr,Ct,us,pc;function Gh(Q){t._pcafit_wasm=Q.l,t._malloc=Q.m,t._free=Q.n,t._pcapredict_wasm=Q.o,t._pcvpca_wasm=Q.p,t._prepfit_wasm=Q.q,t._prepapply_wasm=Q.r,zr=Q.s,Ct=Q.t,us=Q.u,pc=Q.v}var Xh={c:ke,b:Ue,d:Mt,i:pl,e:Ne,h:Ie,f:Et,g:St,a:et},_l=await Se();function Ra(){if(L>0){F=Ra;return}if(q(),L>0){F=Ra;return}function Q(){var re;t.calledRun=!0,!y&&(U(),k==null||k(t),(re=t.onRuntimeInitialized)==null||re.call(t),D())}t.setStatus?(t.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>t.setStatus(""),1),Q()},1)):Q()}function Kh(){if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.shift()()}return Kh(),Ra(),I?e=t:e=new Promise((Q,re)=>{k=Q,S=re}),e}var Yh=K('<p>Current release: <span>2.2.0</span> &nbsp;Feedback: <a class="paper-link" href="mailto:help@mda.tools?subject=DDSIMCA app">help@mda.tools</a> &nbsp;Learn: <a class="paper-link" href="https://doi.org/10.1002/cem.3556" download="">tutorial</a> | <a class="paper-link" href="/ddsimca/Oregano.zip" download="">dataset</a> | <a href="https://www.youtube.com/playlist?list=PLep7KM9cEyFmoOR8sWDt7vJdnOCHvPEo2">video lessons</a></p>'),Wh=K(`<h2>Data Driven SIMCA</h2> <p>Authors: <em>Sergey Kucheryavskiy, Oxana Rodionova, Alexey Pomerantsev</em></p> <p>Interactive web-application for creating and using DD-SIMCA one class classifier
      directly in your browser. The app does not send any information to a server,
      all calculations are done locally on your device.</p> <p>Check our open access <a href="https://doi.org/10.1002/cem.3556">tutorial paper</a> and YouTube <a href="https://www.youtube.com/playlist?list=PLep7KM9cEyFmoOR8sWDt7vJdnOCHvPEo2">video-lessons</a></p> <p>Related theory: <a href="https://doi.org/10.1002/cem.2506">10.1002/cem.2506</a>, <a href="https://doi.org/10.1002/cem.2610">10.1002/cem.2610</a>, <a href="https://doi.org/10.1002/cem.3250">10.1002/cem.3250</a>, <a href="https://doi.org/10.1016/j.aca.2024.343352">10.1016/j.aca.2024.343352</a>.</p> <h3>v. 2.2.0</h3> <p class="release-info">released 8/08/2025</p> <ul><li>The app was redesigned to make it more simple and straightforward to use.</li> <li>Built in preprocessing functionality.</li> <li>Added ability to read SPC files in Predict tab.</li> <li>Improvements to CSV files with results (including additional FoMs).</li> <li>Numerous small improvements and bug fixes.</li></ul>`,1);function Uh(l,e){ge(e,!1);function t(c){c.train.dataset=null,c.test.model=null,c.new.model=null,c.tab=0}function s(c){const d=Object.keys(c);if(!["date","tab","train","test","new"].every(m=>d.includes(m)))return!1;/*!!!!change because in this case different tabs have different fields!!!*/const u=Object.keys(c.train);if(!["model","simca","calset","pvset","calres","pvres","outliers","prepType","prepmodel","prepmeta","prepobj"].every(m=>u.includes(m)))return!1;const f=Object.keys(c.test);if(!["model","simca","testset","testres","outliers"].every(m=>f.includes(m)))return!1;const v=Object.keys(c.new);return!!["model","simca","newset","newres","outliers"].every(m=>v.includes(m))}function a(){return{date:sa(new Date),tab:0,train:{model:0,simca:0,calset:0,calsetp:0,pvset:0,calres:{pca:0,simca:0},pvres:{pca:0,simca:0},outliers:[],prepType:null,prepmodel:0,prepmeta:0,prepobj:[]},test:{model:0,simca:0,testset:0,testres:{pca:0,simca:0},outliers:[],ind:null},new:{model:0,simca:0,newset:0,newres:{pca:0,simca:0},outliers:[]}}}const o=[{name:"Train",label:"train",component:K0},{name:"Test",label:"test",component:_h},{name:"Predict",label:"new",component:zh}];$u(),Dh(l,{appID:"ddsimca",appTitle:"Data Driven SIMCA",appShortTitle:"DD-SIMCA",appSlogan:"One class classifier",get WASM(){return Vh},get tabs(){return o},initSession:a,checkSession:s,resetSession:t,footer:u=>{var f=Yh();T(u,f)},info:u=>{var f=Wh();T(u,f)},$$slots:{footer:!0,info:!0}}),pe()}Iu(Uh,{target:document.body});const Hh=Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"}))})();
//# sourceMappingURL=ddsimca.js.map
