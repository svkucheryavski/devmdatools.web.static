var o1=Object.defineProperty;var Vi=Je=>{throw TypeError(Je)};var i1=(Je,Ue,mt)=>Ue in Je?o1(Je,Ue,{enumerable:!0,configurable:!0,writable:!0,value:mt}):Je[Ue]=mt;var xr=(Je,Ue,mt)=>i1(Je,typeof Ue!="symbol"?Ue+"":Ue,mt),ia=(Je,Ue,mt)=>Ue.has(Je)||Vi("Cannot "+mt);var Le=(Je,Ue,mt)=>(ia(Je,Ue,"read from private field"),mt?mt.call(Je):Ue.get(Je)),Nt=(Je,Ue,mt)=>Ue.has(Je)?Vi("Cannot add the same private member more than once"):Ue instanceof WeakSet?Ue.add(Je):Ue.set(Je,mt),Yt=(Je,Ue,mt,Hr)=>(ia(Je,Ue,"write to private field"),Hr?Hr.call(Je,mt):Ue.set(Je,mt),mt),jn=(Je,Ue,mt)=>(ia(Je,Ue,"access private method"),mt);(function(){"use strict";var el,Mn,Rn,Dr,tl,rl,mn,In,Wr,Cr,gn,Tr,Oi,Bi,ca,Ur,Fn,nl,Fl,qi,Ri;var Je=document.createElement("style");Je.textContent=`button.svelte-ymtj5z{display:inline-block;font-size:.9em;padding:0 .5em;line-height:1.5em;border-radius:.25em;box-shadow:none;margin:0;text-align:center;border:1px solid}.button.svelte-ymtj5z:focus-visible{outline:solid 2px;outline-offset:2px}button.svelte-bx9fh5{display:inline-block;font-size:1em;width:1.3em;height:1.3em;border:none;border-radius:50%;box-shadow:none;margin:0 .25em;text-align:center;padding:0;background-size:45% 45%;background-position:50%;background-repeat:no-repeat}button.svelte-bx9fh5:last-of-type{margin-right:0}.button.svelte-bx9fh5:focus-visible{outline:solid 2px;outline-offset:2px}.control-element.svelte-1986c5z{font-size:.85em;background:var(--container-bg-color, #fff);color:var(--text-color-dark, #606570);padding:.5em .5em .5em 1em;border-radius:0;display:flex;justify-items:flex-start;justify-content:flex-start;align-items:center;margin-bottom:.5px}.control-element.svelte-1986c5z:hover{background:var(--container-bg-color, #fafdff)}.control-element.svelte-1986c5z:first-child{margin-top:.25rem;border-top-left-radius:.25rem;border-top-right-radius:.25rem}.control-element.svelte-1986c5z:last-child{margin-bottom:.25rem;border-bottom-left-radius:.25rem;border-bottom-right-radius:.25rem}.hidden.svelte-1986c5z{display:none}.control-element.error.svelte-1986c5z{background:var(--warning-color, crimson);color:var(--warning-text-color, #fefefe)}.label.svelte-1986c5z{padding-right:.75em;flex-grow:0;flex-shrink:1;color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z>.wrapper{flex:1 1 auto;position:relative;box-sizing:border-box;display:inline-block;margin:0;padding:0;width:auto;align-items:flex-start;justify-content:center;justify-items:flex-start}.control-element.svelte-1986c5z>h2{text-align:left;flex-grow:1;padding:0 .25em 0 0;margin:0;font-size:1.1em}.control-element.svelte-1986c5z>p{text-align:left;flex-grow:1;padding:0 .25em 0 0;margin:0;font-size:max(12px,.9em)}.control-element.error p{color:var(--warning-text-color, #fefafa)}.control-element.error a{color:var(--warning-link-color, #ffeeaa)}.control-element.error a:hover{color:var(--warning-link-hover-color, #ffee80)}.control-element.svelte-1986c5z>.title{font-size:1.05em;font-weight:700;color:var(--text-color-dark, #606570);flex-grow:1;padding:.3em 0;margin:0}.control-element.svelte-1986c5z>.range-slider-container{outline-color:var(--outline-color, #ccc);background:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z>.range-slider-container:focus-visible{outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .range-slider{color:var(--text-color-light, #fafafa);background-color:var(--main-color1, #6eb8ff);border-right-color:var(--main-color2, #528abe)}.control-element.svelte-1986c5z .range-value{color:var(--text-color-light, #fafafa)}.control-element.svelte-1986c5z .range-value_left,.control-element.svelte-1986c5z .range-value_right{color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z .button{border-color:transparent;background-color:var(--bg-color-dark, #606570);color:var(--text-color-light, #fafafa);outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .button:hover{border-color:var(--main-color1, #6eb8ff);background-color:var(--main-color1-light, #6eb8ff20);color:var(--main-color2, #5086b9)}.control-element.svelte-1986c5z .button-cancel{background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" version="2.0" viewBox="0 0 100 100" style="stroke:%23fafafa;stroke-width:1em;" ><line x1="0" y1="0" x2="100" y2="100"/><line x1="0" y1="100" x2="100" y2="0"/></svg>')}.control-element.svelte-1986c5z .button-cancel:hover{background-color:var(--warning-color, #dc143c)}.control-element.svelte-1986c5z .button-undo{background-image:url('data:image/svg+xml;utf8,<svg width="99px" height="99px" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g stroke-linecap="round" stroke-linejoin="round" ><path d="M6 7L7 6L4.70711 3.70711L5.19868 3.21553C5.97697 2.43724 7.03256 2 8.13323 2C11.361 2 14 4.68015 14 7.93274C14 11.2589 11.3013 14 8 14C6.46292 14 4.92913 13.4144 3.75736 12.2426L2.34315 13.6569C3.90505 15.2188 5.95417 16 8 16C12.4307 16 16 12.3385 16 7.93274C16 3.60052 12.4903 0 8.13323 0C6.50213 0 4.93783 0.647954 3.78447 1.80132L3.29289 2.29289L1 0L0 1V7H6Z" fill="%23fafafa"></path> </g></svg>')}.control-element.svelte-1986c5z .button-undo:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-up{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="55" y1="110" x2="55" y2="10"/><line x1="20" y1="50" x2="55" y2="10"/><line x1="90" y1="50" x2="55" y2="10"/></svg>')}.control-element.svelte-1986c5z .button-up:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-down{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="55" y1="0" x2="55" y2="100"/><line x1="20" y1="60" x2="55" y2="100"/><line x1="90" y1="60" x2="55" y2="100"/></svg>')}.control-element.svelte-1986c5z .button-down:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-download{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="50" y1="0" x2="50" y2="100"/><line x1="10" y1="60" x2="50" y2="100"/><line x1="90" y1="60" x2="50" y2="100"/></svg>')}.control-element.svelte-1986c5z .button-download:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-add{background-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 110 110" style="stroke:%23fafafa;stroke-width:1.1em;" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><line x1="55" y1="0" x2="55" y2="110"/><line x1="0" y1="55" x2="110" y2="55"/></svg>')}.control-element.svelte-1986c5z .button-add:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .button-settings{background-size:75%;background-image:url('data:image/svg+xml;utf8,<svg width="16" height="16" viewBox="0 0 16 16"  style="stroke:none;stroke-width:1px;" fill="%23fafafa" stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg"><path d="M12.2418 6.58543L6.27026 12.5584C5.94986 12.8788 5.54841 13.1061 5.10883 13.216L2.81783 13.7887C2.45164 13.8803 2.11994 13.5486 2.21149 13.1824L2.78424 10.8914C2.89413 10.4518 3.12143 10.0504 3.44183 9.72996L9.41337 3.75701L12.2418 6.58543ZM13.6567 2.3435C14.4378 3.12455 14.4378 4.39088 13.6567 5.17193L12.9489 5.87833L10.1205 3.0499L10.8283 2.3435C11.6093 1.56245 12.8757 1.56245 13.6567 2.3435Z"/></svg>')}.control-element.svelte-1986c5z .button-settings:hover{background-color:var(--main-color1,#6eb8ff)}.control-element.svelte-1986c5z .selector:focus-visible{outline:2px solid;outline-offset:2px;outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .selector>.option{color:var(--text-color-dark, #606570);background-color:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z .plot-selector>.option>svg{stroke:var(--main-color1, #606570)}.control-element.svelte-1986c5z .plot-selector>.option.selected>svg{stroke:var(--text-color-light, #fefefe)}.control-element.svelte-1986c5z .selector>.option.selected{background-color:var(--main-color1, #6eb8ff);color:var(--text-color-light, #fefefe)}.control-element.svelte-1986c5z .selector>.option:not(.selected):hover{border:1px solid var(--main-color1, #6eb8ff);background-color:var(--main-color1-light, #6eb8ff20);color:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .selector>.option:not(.selected):hover>svg{stroke:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .file-selector:before{color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z .file-selector.selected:before{color:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .file-selector:focus-visible{outline-color:var(--outline-color, #ccc)}.control-element.svelte-1986c5z .file-selector:focus-visible:before{outline-color:var(--outline-color, #ccc);color:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .file-selector:hover:before{color:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .textinput>input{background-color:var(--main-color1, #6eb8ff);color:var(--text-color-light, #fefefe)}.control-element.svelte-1986c5z .textinput>input:placeholder-shown{color:var(--text-color-dark, #a0a0a0);background-color:var(--bg-color-light, #f0f0f0);border-color:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z .textinput>input::placeholder{color:#a0a0a0}.control-element.svelte-1986c5z .textinput>input:active::placeholder,.control-element.svelte-1986c5z .textinput>input:focus::placeholder{color:transparent}.control-element.svelte-1986c5z .textinput>input:focus,.control-element.svelte-1986c5z .textinput>input:active{border-color:var(--main-color1, #6eb8ff);background-color:var(--main-color1-light, #6eb8ff20);color:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .textinput.error>input,.control-element.svelte-1986c5z .textinput.error>input:focus,.control-element.svelte-1986c5z .textinput.error>input:active{color:var(--warning-color, crimson);background-color:var(--warning-color-light, #ffd5ce);border-color:var(--warning-color, crimson)}.control-element.svelte-1986c5z .textinput.error>.error-message{color:var(--warning-color, crimson);background-color:var(--warning-color-light, #ffd5ce)}.control-element.svelte-1986c5z .spinner:after{border-color:var(--main-color1, #6eb8ff) transparent var(--main-color1, #6eb8ff) transparent}.control-element.svelte-1986c5z .number-container{background-color:var(--bg-color-light, #f0f0f0)}.control-element.svelte-1986c5z .number-container>.value{color:var(--text-color-dark, #606570)}.control-element.svelte-1986c5z .number-container>.button-small>svg>polygon{fill:var(--main-color2, #4777a4)}.control-element.svelte-1986c5z .number-container>.button-small:hover>svg>polygon{fill:var(--main-color1, #6eb8ff)}.control-element.svelte-1986c5z .number-container:focus-visible{outline-color:var(--outline-color, #ccc)}.range-slider-container.svelte-vhx0r0{position:relative;box-sizing:border-box;flex:1 1 auto;height:1.5em;margin:0;padding:0;width:auto;border-radius:2px;cursor:default;display:flex;align-items:center;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider-container.svelte-vhx0r0:focus-visible{outline:solid 2px #ccc;outline-offset:2px}.range-slider.svelte-vhx0r0{position:relative;display:flex;justify-content:right;align-items:center;box-sizing:border-box;border-radius:2px;border-right:solid 5px;text-align:right;margin:0;padding:0;height:100%;cursor:default;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider_right.svelte-vhx0r0{justify-content:left}.range-value.svelte-vhx0r0{display:inline-block;margin:0;padding:0;cursor:default;font-size:.85em;position:relative;user-select:none;-webkit-user-select:none;-moz-user-select:none;right:.25em}.range-value_right.svelte-vhx0r0{left:calc(100% + 5px + .25em)}.range-slider-container.svelte-xdlm7u{position:relative;box-sizing:border-box;display:inline-block;flex:1 1 auto;height:1.5em;margin:0;padding:0;width:auto;border-radius:2px;cursor:default;display:flex;align-items:center;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider-container.svelte-xdlm7u:focus-visible{outline:solid 2px;outline-offset:2px}.range-slider.svelte-xdlm7u{position:relative;display:flex;justify-content:center;align-items:center;box-sizing:border-box;border-radius:2px;text-align:center;margin:0;padding:0;height:100%;cursor:default;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-slider_left.svelte-xdlm7u{justify-content:left}.range-slider_right.svelte-xdlm7u{justify-content:right}.range-value.svelte-xdlm7u{display:inline-block;margin:0;padding:0;cursor:default;font-size:.85em;user-select:none;-webkit-user-select:none;-moz-user-select:none}.range-value_left.svelte-xdlm7u{position:relative;left:calc(100% + .25em)}.range-value_right.svelte-xdlm7u{position:relative;right:calc(100% + .25em)}input.svelte-1i17tox{display:none}.selector.svelte-1i17tox{position:relative;box-sizing:border-box;flex:1 1 auto;font-size:1em;line-height:1.5em;margin:0;padding:0;width:auto;border-radius:2px;user-select:none;-webkit-user-select:none;-moz-user-select:none;display:flex}.selector.svelte-1i17tox:focus-visible{outline:solid 2px;outline-offset:2px}.option.svelte-1i17tox{cursor:default;padding:.25em .5em;margin:0 .3em 0 0;border:1px solid transparent;border-radius:.3em;font-size:.85em}.option.svelte-1i17tox:not(.selected):hover{border:1px solid}.file-selector.svelte-1k0x7uv>input:where(.svelte-1k0x7uv){display:none}.file-selector.svelte-1k0x7uv{display:flex;align-items:baseline;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;flex:1 1;min-width:0;border-radius:2px;cursor:default}.file-selector.svelte-1k0x7uv:focus-visible{outline:solid 2px;outline-offset:2px}.file-selector.svelte-1k0x7uv:before{display:inline-block;content:"⇪";font-size:1.1em;margin:0 .5em 0 0;padding:0}.file-selector.selected.svelte-1k0x7uv:before{content:"☷";font-size:1.3em;letter-spacing:-.2em;font-weight:700}.textinput.svelte-1qtiwcs{box-sizing:border-box;flex:1 1 auto;font-size:1em;line-height:1.5em;margin:0;padding:.15em 0;width:auto;border-radius:2px;user-select:none;-webkit-user-select:none;-moz-user-select:none;display:flex;position:relative}.textinput.svelte-1qtiwcs>input:where(.svelte-1qtiwcs){flex:1 1 auto;font-size:.9em;width:100%;cursor:default;padding:.25em .5em;border:1px solid;border-radius:.3em;outline:none}.textinput.svelte-1qtiwcs>input:where(.svelte-1qtiwcs):focus,.textinput.svelte-1qtiwcs>input:where(.svelte-1qtiwcs):active{border:1px solid}.error-message.svelte-1qtiwcs{position:absolute;left:0;bottom:calc(100% + 2px);border-radius:.3em;line-height:1em;font-size:.75em;padding:.5em}.spinner.svelte-n48urb{display:inline-block;height:1.5em;line-height:1.5em;width:1.5em;margin:0 .5em}.spinner.svelte-n48urb:after{content:" ";display:block;width:.8em;height:.8em;margin:.1em;border-radius:50%;border:.2em solid;animation:svelte-n48urb-spinner 1.2s linear infinite}@keyframes svelte-n48urb-spinner{0%{transform:rotate(0)}to{transform:rotate(360deg)}}input.svelte-yf64an{display:none}.selector.svelte-yf64an{position:relative;box-sizing:border-box;flex:1 1 auto;font-size:1em;margin:0;padding:0;width:auto;border-radius:2px;user-select:none;-webkit-user-select:none;-moz-user-select:none;display:flex}.option.svelte-yf64an{cursor:default;padding:0;padding-inline:0;padding-block:0;margin:0 .2em 0 0;border:1px solid transparent;border-radius:.3em;font-size:.85em;height:auto;display:flex;justify-content:center}.option.svelte-yf64an:not(.selected):hover{border:1px solid}.outliers.svelte-1ggez3e{line-height:1.5em;text-align:left;padding:.5em 0;flex:0 0 80%}.outliers.svelte-1ggez3e>.item:where(.svelte-1ggez3e){color:#dc143c;background:#dc143c20;display:inline-block;white-space:nowrap;vertical-align:middle;max-width:10ch;overflow:hidden;text-overflow:ellipsis;padding:.1em .5em;margin:.2em .1em;border-radius:.2em}.exclvars.svelte-181kelh{line-height:1.5em;text-align:left;padding:.5em 0;flex:0 0 80%}.show-download-links-none.svelte-1jtdxd0>.download-links:where(.svelte-1jtdxd0){display:none}.show-download-links-hover.svelte-1jtdxd0:hover>.download-links:where(.svelte-1jtdxd0){bottom:0}.show-download-links-fixed.svelte-1jtdxd0>.download-links:where(.svelte-1jtdxd0){bottom:0}.download-links.svelte-1jtdxd0{position:absolute;font-size:.8em;bottom:-50%;right:0;z-index:10;padding:.5em 1em;background:#fefefe;border-radius:.5em;transition:bottom .35s ease;box-shadow:0 0 .75em #00000060;margin:.6em;box-sizing:border-box;display:flex;align-items:center;justify-content:center}.download-links.svelte-1jtdxd0>button:where(.svelte-1jtdxd0){box-sizing:border-box;color:#606060;border:none;box-shadow:none;background:#fafafa;border-radius:.35em;padding:.25em .5em}.download-links.svelte-1jtdxd0>button:where(.svelte-1jtdxd0):hover{background:#433;color:#fafafa}.download-links.svelte-1jtdxd0>button.error{background:#e43}.download-links.svelte-1jtdxd0>button.copied{background:#48e}.plot-container.svelte-1jtdxd0{font-family:Arial,Helvetica,sans-serif;box-sizing:border-box;position:relative;min-width:100px;min-height:50px;width:100%;height:100%;padding:0;margin:0;overflow:hidden;background:#fff}.plot-error.svelte-1jtdxd0{display:flex;justify-content:center;align-items:center}.message-error.svelte-1jtdxd0{font-size:1.2em;color:#dc143c;padding:1em;box-sizing:border-box;text-align:center}.plot.svelte-1jtdxd0{display:block;box-sizing:border-box;position:absolute;padding:0;margin:0;left:0;top:0;bottom:0;right:0;width:100%;height:100%}.axes-content.svelte-1jtdxd0{padding:0;margin:0;height:100%;width:100%;max-height:100%;max-width:100%;min-height:100%;min-width:100%}.drop.svelte-q7wo60{position:fixed;z-index:9999;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:#000000a0}.modal.svelte-q7wo60{border-radius:.5rem;background-color:#fff;display:grid;grid-template-areas:"header" "body";grid-template-rows:30px 1fr;width:auto;height:auto;border-radius:.25rem}.body.svelte-q7wo60{grid-area:body;box-sizing:border-box;padding:0 1em .5em;width:100%;height:100%}.header.svelte-q7wo60{grid-area:header}.close-button.svelte-q7wo60{cursor:pointer;border:none;box-shadow:none;background:transparent;font-size:inherit;font-weight:700;color:#f8ebc5;border-radius:50%;width:20px;height:20px;background-color:#9ea0a2;float:right;text-align:center;padding:0;line-height:20px;font-size:12px;margin:5px}.close-button.svelte-q7wo60:hover{background-color:#4e5052}.isdark.svelte-q7wo60,.isdark.svelte-q7wo60 .header:where(.svelte-q7wo60),.isdark.svelte-q7wo60 .body:where(.svelte-q7wo60){background-color:#606060}.isdark.svelte-q7wo60 .close-button:where(.svelte-q7wo60){color:#433201;background-color:#c2be9b}.isdark.svelte-q7wo60 .close-button:where(.svelte-q7wo60):hover{background-color:#f0f674}.wrapper.svelte-ha02r1{width:95vw;height:90vh;display:grid;grid-template-areas:"plot" "message" "controls";grid-template-rows:1fr 15px min-content}.plot-container.svelte-ha02r1{grid-area:plot}.plot-controls.svelte-ha02r1{grid-area:controls;display:flex;width:100%;justify-content:center;border-radius:.5rem}.plot-controls.svelte-ha02r1>.control-element{background:transparent}.msg-select.svelte-ha02r1{grid-area:message;height:15px;font-size:12px;color:#aaa;text-align:center}.info-details.svelte-1l1cvmx{position:relative;border-bottom:dashed 1px #606060;cursor:help}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx){position:absolute;z-index:1;background:#505050;visibility:hidden;width:300px;top:100%;left:50%;margin-left:-100px;color:beige;box-shadow:0 0 5px #00000060;padding:.5em 1em;border-radius:.25em}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx) ul{padding:0;margin:0;list-style:none}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx) ul>li{padding:.25em 0}.info-details.svelte-1l1cvmx>span:where(.svelte-1l1cvmx) ul>li>span{margin-left:1em;padding:.15em .5em;background-color:#707070;border-radius:3px}.info-details.svelte-1l1cvmx:hover>span:where(.svelte-1l1cvmx){visibility:visible}.info{position:relative}.info-text.svelte-1dxrrpt{line-height:1.5em}.info-text.svelte-1dxrrpt>span{vertical-align:top;color:#a0a0a0}.info-text.svelte-1dxrrpt>.file-name:where(.svelte-1dxrrpt){display:inline-block;padding:0;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:25ch;color:#222}.prep-info{position:relative}span.svelte-2gffce{cursor:default;display:inline-block;border-radius:3px;border:solid 1px #a0a0a0;color:gray;background-color:#fafafa;padding:.2em .5em;margin:0 .5em}span.svelte-2gffce:hover{border:solid 1px #6eb8ff;color:#5086b9;background-color:#6eb8ff20}button.button-down{box-sizing:border-box;margin:0 .3em 0 0}botton.button-up{box-sizing:border-box;margin:0}.method-open.svelte-2gffce{position:absolute;height:100vh;top:0;left:inherit;width:340px;padding:200px 1em 1em;margin-left:-18px;background:#000000a0;z-index:999;box-sizing:border-box}.selected-methods-list.svelte-15cx0gr{background:#fefafaa0;border-radius:5px}.selected-methods-list.svelte-15cx0gr>.control-element:last-child .button-down,.selected-methods-list.svelte-15cx0gr>.control-element:nth-child(2) .button-up{cursor:text;background-color:transparent;color:transparent}.selected-methods-list.svelte-15cx0gr:not(.editable)>.control-element .button-settings{display:block}.methods-list.svelte-15cx0gr{margin-top:1em;font-size:.9em}.methods-list.svelte-15cx0gr>div{background:#ebf0f0}.final.svelte-15cx0gr .button-up,.final.svelte-15cx0gr .button-down,.final.svelte-15cx0gr .button-cancel{visibility:hidden}.plot-panel.svelte-x8qn01{width:100%;height:100%;box-sizing:border-box;padding:0;display:grid;grid-template-rows:1fr;grid-template-columns:1fr minmax(270px,30%)}.plot-area.svelte-x8qn01{padding:1em;margin-top:.25rem;border-radius:.25em;background:#fefefe}.plot-controls-area.svelte-x8qn01{padding:0 .25em 0 .5em}.plot.svelte-x8qn01{width:100%;height:calc(100% - 15px)}@media (min-width:1100px){.plot-panel.svelte-x8qn01{grid-template-columns:1fr minmax(285px,30%)}}@media (min-width:1300px){.plot-panel.svelte-x8qn01{grid-template-columns:1fr max(300px,30%)}}@media (min-width:1600px){.plot-panel.svelte-x8qn01{grid-template-columns:1fr 400px}}.widget-container.svelte-1soqt9v{font-family:Helvetica,Arial,sans-serif;font-size:1rem;color:#404040;box-sizing:border-box;margin:0 auto;padding:.35em .25em;width:100%;height:100%;display:grid;grid-template-areas:"controls content";grid-template-rows:100%;grid-template-columns:min(310px,30%) 1fr;background-color:#606060;width:98vw;height:95vh}.app-controls.svelte-1soqt9v{box-sizing:border-box;padding:.25em .5em}.app-content.svelte-1soqt9v{box-sizing:border-box;padding:.25em;height:100%}.app-controls.svelte-1soqt9v>div:where(.svelte-1soqt9v){border-radius:.25rem}@media (min-width:1300px){.widget-container.svelte-1soqt9v{grid-template-columns:min(340px,30%) 1fr}}@media (min-width:1100px){.widget-container.svelte-1soqt9v{grid-template-columns:min(320px,30%) 1fr}}.prep-container>button{margin-left:.25em}table.svelte-8wnifa{width:100%;border-collapse:collapse}tr.svelte-8wnifa{width:100%}th.svelte-8wnifa{border-bottom:1px solid #a0a0a0}th.svelte-8wnifa,td.svelte-8wnifa{text-align:right;padding:.2em .5em .2em .1em;color:#404040;margin:0}td.svelte-8wnifa:first-of-type{width:25%}p.svelte-16w7odi{line-height:1.5em}span.svelte-16w7odi{color:#a0a0a0}.dataset-info.svelte-gdjwex{line-height:1.5em}.dataset-info.svelte-gdjwex>span{vertical-align:middle;color:#a0a0a0}.dataset-info.svelte-gdjwex>.file-name:where(.svelte-gdjwex),.dataset-info.svelte-gdjwex>.file-size:where(.svelte-gdjwex){display:inline-block;padding:0;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:25ch;color:#222}.selected-buttons.svelte-8mh2yv>.control-element{background:#fff0c8}.selected-buttons.svelte-8mh2yv>.control-element button:last-of-type{color:#fff;border-color:#dc143c;background:#dc143c;margin-left:5px}.selected-buttons.svelte-8mh2yv>.control-element button:last-of-type:hover{background:#dc143c20;border-color:#dc143c80;color:#dc143c}.plot-panel.svelte-8mh2yv{width:100%;height:100%;box-sizing:border-box;padding:0;display:grid;grid-template-rows:1fr;grid-template-columns:1fr minmax(270px,30%)}.plot-area.svelte-8mh2yv{padding:1em;margin-top:.25rem;border-radius:.25em;background:#fefefe}.plot-controls-area.svelte-8mh2yv{padding:0 .25em 0 .5em}.plot-selector.svelte-8mh2yv{cursor:pointer;color:#606060;background:#fffef480;box-sizing:border-box;padding:.5em 1em;margin:.25em 0;border-radius:.25rem;box-shadow:none;border:none;width:100%;text-align:left;font-size:1rem}.plot-selector.svelte-8mh2yv:hover{background:#e0e0e0;color:#403020}div.plot-container.off-screen{position:absolute;top:0;left:50%;width:650px;height:600px;background:#fff;z-index:999}.plot.svelte-8mh2yv{width:100%;height:calc(100% - 15px)}.plot-select-msg.svelte-8mh2yv{height:15px;font-size:12px;color:#aaa;text-align:center}@media (min-width:1100px){.plot-panel.svelte-8mh2yv{grid-template-columns:1fr minmax(285px,30%)}}@media (min-width:1300px){.plot-panel.svelte-8mh2yv{grid-template-columns:1fr max(300px,30%)}}@media (min-width:1600px){.plot-panel.svelte-8mh2yv{grid-template-columns:1fr 400px}}div.svelte-17oamay{width:100%;height:100%}div.svelte-17oamay .plot .axes{cursor:crosshair}div.svelte-17oamay .plot .axes-content rect{pointer-events:none}.plot-controls-area>.plot-selector-fom,.plot-controls-area>.plot-selector-loadings{margin-top:1em}.info-text.svelte-3v2vv7{line-height:1.5em}.info-text.svelte-3v2vv7>span{vertical-align:top;color:#a0a0a0}.info-text.svelte-3v2vv7>.file-name:where(.svelte-3v2vv7){display:inline-block;padding:0;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:25ch;color:#222}.app-container.svelte-b7gdku{font-family:Helvetica,Arial,sans-serif;font-size:1rem;color:#404040;box-sizing:border-box;margin:0 auto;padding:.35em .25em;width:100%;height:100%;display:grid;grid-template-areas:"controls content";grid-template-rows:100%;grid-template-columns:min(310px,30%) 1fr}.app-controls.svelte-b7gdku{box-sizing:border-box;padding:.25em .5em}.app-content.svelte-b7gdku{box-sizing:border-box;padding:.25em;height:100%}.app-controls.svelte-b7gdku>div:where(.svelte-b7gdku){border-radius:.25rem}.app-controls.svelte-b7gdku>.result-stats:where(.svelte-b7gdku){background:#e8e8e8}.help-text.svelte-b7gdku{margin-top:.25rem}.help-text.svelte-b7gdku>p:where(.svelte-b7gdku),.help-text.svelte-b7gdku>div:where(.svelte-b7gdku){background:#fafafa;padding:0 1.5em .5em;color:#606060;line-height:1.5em;margin:0 1em 0 0}.help-text.svelte-b7gdku table:where(.svelte-b7gdku){border-collapse:collapse}.help-text.svelte-b7gdku table:where(.svelte-b7gdku) td:where(.svelte-b7gdku){padding:.25em .5em;background:#e0f0fa;text-align:right;border:1px solid white}.help-text.svelte-b7gdku table:where(.svelte-b7gdku) thead:where(.svelte-b7gdku) tr:where(.svelte-b7gdku) td:where(.svelte-b7gdku){font-weight:700;background:#f8f4e0}.help-text.svelte-b7gdku table:where(.svelte-b7gdku) td:where(.svelte-b7gdku):first-child{font-weight:700;background:#f8f4e0;padding-right:1em}.help-text.svelte-b7gdku table:where(.svelte-b7gdku) tbody:where(.svelte-b7gdku) td:where(.svelte-b7gdku):nth-child(2){background:#e0e8f0;padding-right:1em}.help-text.svelte-b7gdku>p:where(.svelte-b7gdku):first-child{border-top-left-radius:.25rem;border-top-right-radius:.25rem;padding-top:1.5em}.help-text.svelte-b7gdku>p:where(.svelte-b7gdku):last-child{border-bottom-left-radius:.25rem;border-bottom-right-radius:.25rem;padding-bottom:1.5em}.result-stats.svelte-b7gdku{padding:.5rem 1rem;margin-top:.25rem;font-size:.85em}@media (min-width:1300px){.app-container.svelte-b7gdku{grid-template-columns:min(340px,30%) 1fr}}@media (min-width:1100px){.app-container.svelte-b7gdku{grid-template-columns:min(330px,30%) 1fr}}.app-container.svelte-1ssp7bh{font-family:Helvetica,Arial,sans-serif;font-size:1rem;color:#404040;box-sizing:border-box;margin:0 auto;padding:.35em .25em;width:100%;height:100%;display:grid;grid-template-areas:"controls content";grid-template-rows:100%;grid-template-columns:min(310px,30%) 1fr}.app-controls.svelte-1ssp7bh{box-sizing:border-box;padding:.25em .5em}.app-content.svelte-1ssp7bh{box-sizing:border-box;padding:.25em;height:100%}.app-controls.svelte-1ssp7bh>div:where(.svelte-1ssp7bh){border-radius:.25rem}.help-text.svelte-1ssp7bh{margin-top:.25rem}.help-text.svelte-1ssp7bh>p:where(.svelte-1ssp7bh),.help-text.svelte-1ssp7bh>div:where(.svelte-1ssp7bh){background:#fafafa;padding:0 1.5em .5em;color:#606060;line-height:1.5em;margin:0 1em 0 0}.help-text.svelte-1ssp7bh table:where(.svelte-1ssp7bh){border-collapse:collapse}.help-text.svelte-1ssp7bh table:where(.svelte-1ssp7bh) td:where(.svelte-1ssp7bh){padding:.25em .5em;background:#e0f0fa;text-align:right;border:1px solid white}.help-text.svelte-1ssp7bh table:where(.svelte-1ssp7bh) thead:where(.svelte-1ssp7bh) tr:where(.svelte-1ssp7bh) td:where(.svelte-1ssp7bh){font-weight:700;background:#f8f4e0}.help-text.svelte-1ssp7bh table:where(.svelte-1ssp7bh) td:where(.svelte-1ssp7bh):first-child{font-weight:700;background:#f8f4e0;padding-right:1em}.help-text.svelte-1ssp7bh>p:where(.svelte-1ssp7bh):first-child{border-top-left-radius:.25rem;border-top-right-radius:.25rem;padding-top:1.5em}.help-text.svelte-1ssp7bh>p:where(.svelte-1ssp7bh):last-child{border-bottom-left-radius:.25rem;border-bottom-right-radius:.25rem;padding-bottom:1.5em}@media (min-width:1300px){.app-container.svelte-1ssp7bh{grid-template-columns:min(340px,30%) 1fr}}@media (min-width:1100px){.app-container.svelte-1ssp7bh{grid-template-columns:min(330px,30%) 1fr}}.page.svelte-1cyr8za{width:100%;height:100%;margin:0 auto;padding:0;min-width:1020px;min-height:590px;max-width:1900px;display:flex;flex-direction:column}header.svelte-1cyr8za{display:flex;justify-content:flex-start;flex-direction:row;background:#f8f6f4}.header-group.svelte-1cyr8za{width:min-content;min-width:400px;margin:0 0 0 .25rem;display:grid;align-items:center;grid-template-columns:min-content 1fr;grid-template-rows:min-content min-content min-content min-content;grid-template-areas:"logo ." "logo title" "logo subtitle" "logo ."}.logo.svelte-1cyr8za{width:3.5rem;margin:.25rem;padding:.5rem;grid-area:logo}.header-group.svelte-1cyr8za>h1:where(.svelte-1cyr8za){margin:0;padding:0;text-align:left;font-size:1.6rem;color:#4e5052;white-space:nowrap;grid-area:title}.header-group.svelte-1cyr8za>p:where(.svelte-1cyr8za){margin:0;padding:0;text-align:left;font-size:1.1rem;color:#7e8082;grid-area:subtitle}main.svelte-1cyr8za{flex-basis:auto;flex-grow:1;flex-shrink:1;box-sizing:border-box;padding:.2rem 0}main.svelte-1cyr8za>div:where(.svelte-1cyr8za){height:100%}footer.svelte-1cyr8za{display:grid;grid-template-columns:20% 60% 20%;grid-template-areas:"session info .";align-items:center;justify-content:center;font-size:.9rem;flex-basis:min-content;flex-grow:0;flex-shrink:0;background:#4e5052;color:silver;padding:.5em}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za){grid-area:session;padding-left:.5em;display:flex;align-items:center}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) input:where(.svelte-1cyr8za){display:none}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .session-message:where(.svelte-1cyr8za){color:silver;padding-right:.5em}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .session-message:where(.svelte-1cyr8za){color:#fafafa}footer.svelte-1cyr8za .session.no-buttons:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session.no-buttons:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session.no-buttons:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za){display:none}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za){font-size:.9rem;background:#5e6062;color:silver;box-shadow:none;padding:0;margin:0 0 0 .2em;border-radius:3px;border:none;height:20px;box-sizing:border-box;display:inline-block}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za){stroke-width:.75em;stroke-linecap:round;stroke-linejoin:round;stroke:silver}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .clear-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .upload-button:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .download-button:where(.svelte-1cyr8za){background:#35332d}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .clear-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .upload-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za),footer.svelte-1cyr8za .session:where(.svelte-1cyr8za):hover .download-button:where(.svelte-1cyr8za) svg:where(.svelte-1cyr8za){stroke:#fafafa}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za){margin-left:.5em}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .upload-button:where(.svelte-1cyr8za):hover,footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .download-button:where(.svelte-1cyr8za):hover{background-color:#6eb8ff}footer.svelte-1cyr8za .session:where(.svelte-1cyr8za) .clear-button:where(.svelte-1cyr8za):hover{background-color:#dc143c}footer.svelte-1cyr8za .info:where(.svelte-1cyr8za){grid-area:info;display:flex;justify-content:center;align-items:center}footer.svelte-1cyr8za .info:where(.svelte-1cyr8za) .button-info:where(.svelte-1cyr8za){cursor:default;border:none;box-shadow:none;background:transparent;font-weight:700;color:#4e5052;border-radius:.2em;padding:.25em .5em;text-align:center;line-height:1em;margin-left:.25em;margin-right:.5em;background-color:#f8ebc5}footer.svelte-1cyr8za .info:where(.svelte-1cyr8za) .button-info:where(.svelte-1cyr8za):hover{background-color:#f7db89}footer.svelte-1cyr8za p{margin:0 .5em;text-align:center;padding:.15em}footer.svelte-1cyr8za span,footer.svelte-1cyr8za a{color:#f8ebc5}.hidden.svelte-1cyr8za{display:none}.nav.svelte-1cyr8za,.nav.svelte-1cyr8za :where(.svelte-1cyr8za){-webkit-user-select:none;user-select:none;-moz-user-select:none}.nav.svelte-1cyr8za{display:flex;flex-direction:row;justify-content:flex-end;list-style:none;margin:0 100px 0 auto;padding:0;align-self:flex-end}.nav-item.svelte-1cyr8za{list-style:none;margin:0;border-bottom:5px solid transparent}.nav-item.svelte-1cyr8za>button:where(.svelte-1cyr8za){cursor:pointer;padding:.5em 1em;border:none;box-shadow:none;background:transparent;font-size:inherit}.nav-item.svelte-1cyr8za>button:where(.svelte-1cyr8za)>span{color:#888}.nav-item.svelte-1cyr8za:hover{border-bottom:5px solid #80888f50}.nav-item.svelte-1cyr8za:hover>button:where(.svelte-1cyr8za){border-top-left-radius:5px;border-top-right-radius:5px;background:#00000010}.nav-item.selected.svelte-1cyr8za{border-bottom:5px solid #80888f}.nav-item.selected.svelte-1cyr8za>button:where(.svelte-1cyr8za){font-weight:700;cursor:default}.nav-item.selected.svelte-1cyr8za:hover{border-bottom:5px solid #80888f}@media (min-width: 1600px){.page.svelte-1cyr8za>header:where(.svelte-1cyr8za){border-bottom-right-radius:.25rem;border-bottom-left-radius:.25rem}.page.svelte-1cyr8za>footer:where(.svelte-1cyr8za){border-top-right-radius:.25rem;border-top-left-radius:.25rem}}.info-container.svelte-1cyr8za{width:900px}.info-container.svelte-1cyr8za>p{font-size:1.15em;line-height:1.35em;padding:0 1em .5em;margin:0}.info-container.svelte-1cyr8za>.release-info{font-size:1em;color:gray;line-height:1.25em;padding:0 1.2em .5em;margin:0}.info-container.svelte-1cyr8za>h2{font-size:1.5em;line-height:1.25em;padding:0em 1rem .5em;margin:0}.info-container.svelte-1cyr8za>h3{font-size:1.15em;line-height:1.25em;padding:1rem 1em .25em;margin:0}.info-container.svelte-1cyr8za>ul{margin:0}.info-container.svelte-1cyr8za>ul>li{font-size:1.15em;line-height:1.25em;padding:0 .5em .5em 0;margin:0}.info-container.svelte-1cyr8za>ul>li>span{font-size:.9em;color:gray;line-height:1.25em;padding:0 .25em;margin:0}.info-container.svelte-1cyr8za a{color:#ae8032}.info-container.svelte-1cyr8za a:hover{color:#eb9707}.info-container.svelte-1cyr8za:last-child{padding-bottom:1rem}
/*$vite$:1*/`,document.head.appendChild(Je);var Ue=typeof document<"u"?document.currentScript:null;const mt=!1;var Hr=Array.isArray,Yi=Array.prototype.indexOf,Ol=Array.from,Bl=Object.defineProperty,Lr=Object.getOwnPropertyDescriptor,ua=Object.getOwnPropertyDescriptors,fa=Object.prototype,Di=Array.prototype,al=Object.getPrototypeOf,da=Object.isExtensible;function wn(n){return typeof n=="function"}const xt=()=>{};function Wi(n){return typeof(n==null?void 0:n.then)=="function"}function Ui(n){return n()}function ol(n){for(var e=0;e<n.length;e++)n[e]()}function Hi(){var n,e,t=new Promise((l,s)=>{n=l,e=s});return{promise:t,resolve:n,reject:e}}function ql(n,e){if(Array.isArray(n))return n;if(e===void 0||!(Symbol.iterator in n))return Array.from(n);const t=[];for(const l of n)if(t.push(l),t.length===e)break;return t}const Dt=2,Yl=4,il=8,yn=16,kr=32,xn=64,va=128,Qt=256,cl=512,At=1024,Ot=2048,Xr=4096,lr=8192,Gr=16384,ul=32768,kn=65536,ha=1<<17,Xi=1<<18,Dl=1<<19,Wl=1<<20,Ul=1<<21,Hl=1<<22,Kr=1<<23,Nr=Symbol("$state"),ma=Symbol("legacy props"),Gi=Symbol(""),Xl=new class extends Error{constructor(){super(...arguments);xr(this,"name","StaleReactionError");xr(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Ki(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function ga(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Ji(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Qi(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Zi(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function $i(n){throw new Error("https://svelte.dev/e/effect_orphan")}function ec(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function tc(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function rc(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function nc(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function lc(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const fl=1,dl=2,pa=4,sc=8,ac=16,oc=1,ic=2,cc=4,uc=8,fc=16,dc=1,vc=2,hc=4,ba=1,mc=2,gt=Symbol(),gc="http://www.w3.org/1999/xhtml";let pc=!1;function _a(n){return n===this.v}function wa(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function bc(n,e){return n!==e}function ya(n){return!wa(n,this.v)}let En=!1,_c=!1;function wc(){En=!0}const yc=[];function xc(n,e=!1){return vl(n,new Map,"",yc)}function vl(n,e,t,l,s=null){if(typeof n=="object"&&n!==null){var a=e.get(n);if(a!==void 0)return a;if(n instanceof Map)return new Map(n);if(n instanceof Set)return new Set(n);if(Hr(n)){var o=Array(n.length);e.set(n,o),s!==null&&e.set(s,o);for(var c=0;c<n.length;c+=1){var f=n[c];c in n&&(o[c]=vl(f,e,t,l))}return o}if(al(n)===fa){o={},e.set(n,o),s!==null&&e.set(s,o);for(var u in n)o[u]=vl(n[u],e,t,l);return o}if(n instanceof Date)return structuredClone(n);if(typeof n.toJSON=="function")return vl(n.toJSON(),e,t,l,n)}if(n instanceof EventTarget)return n;try{return structuredClone(n)}catch{return n}}let Qe=null;function Sn(n){Qe=n}function Rt(n){return xa().get(n)}function kc(n,e){return xa().set(n,e),e}function me(n,e=!1,t){Qe={p:Qe,c:null,e:null,s:n,x:null,l:En&&!e?{s:null,u:null,$:[]}:null}}function ge(n){var e=Qe,t=e.e;if(t!==null){e.e=null;for(var l of t)Fa(l)}return Qe=e.p,{}}function zr(){return!En||Qe!==null&&Qe.l===null}function xa(n){return Qe===null&&ga(),Qe.c??(Qe.c=new Map(Ec(Qe)||void 0))}function Ec(n){let e=n.p;for(;e!==null;){const t=e.c;if(t!==null)return t;e=e.p}return null}const Sc=new WeakMap;function Ac(n){var e=je;if(e===null)return Ve.f|=Kr,n;if((e.f&ul)===0){if((e.f&va)===0)throw!e.parent&&n instanceof Error&&ka(n),n;e.b.error(n)}else Gl(n,e)}function Gl(n,e){for(;e!==null;){if((e.f&va)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n instanceof Error&&ka(n),n}function ka(n){const e=Sc.get(n);e&&(Bl(n,"message",{value:e.message}),Bl(n,"stack",{value:e.stack}))}let Vn=[],Kl=[];function Ea(){var n=Vn;Vn=[],ol(n)}function Cc(){var n=Kl;Kl=[],ol(n)}function On(n){Vn.length===0&&queueMicrotask(Ea),Vn.push(n)}function Tc(){Vn.length>0&&Ea(),Kl.length>0&&Cc()}function Pc(){for(var n=je.b;n!==null&&!n.has_pending_snippet();)n=n.parent;return n===null&&Ki(),n}function Bn(n){var e=Dt|Ot,t=Ve!==null&&(Ve.f&Dt)!==0?Ve:null;return je===null||t!==null&&(t.f&Qt)!==0?e|=Qt:je.f|=Dl,{ctx:Qe,deps:null,effects:null,equals:_a,f:e,fn:n,reactions:null,rv:0,v:gt,wv:0,parent:t??je,ac:null}}function Lc(n,e){let t=je;t===null&&Ji();var l=t.b,s=void 0,a=Qr(gt),o=null,c=!Ve;return Yc(()=>{try{var f=n()}catch(m){f=Promise.reject(m)}var u=()=>f;s=(o==null?void 0:o.then(u,u))??Promise.resolve(f),o=s;var d=ut,v=l.pending;c&&(l.update_pending_count(1),v||d.increment());const h=(m,p=void 0)=>{o=null,v||d.activate(),p?p!==Xl&&(a.f|=Kr,Ir(a,p)):((a.f&Kr)!==0&&(a.f^=Kr),Ir(a,m)),c&&(l.update_pending_count(-1),v||d.decrement()),Ca()};if(s.then(h,m=>h(null,m||"unknown")),d)return()=>{queueMicrotask(()=>d.neuter())}}),new Promise(f=>{function u(d){function v(){d===s?f(a):u(s)}d.then(v,v)}u(s)})}function g(n){const e=Bn(n);return Ha(e),e}function Jl(n){const e=Bn(n);return e.equals=ya,e}function Sa(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)hr(e[t])}}function Nc(n){for(var e=n.parent;e!==null;){if((e.f&Dt)===0)return e;e=e.parent}return null}function Ql(n){var e,t=je;gr(Nc(n));try{Sa(n),e=Ja(n)}finally{gr(t)}return e}function Aa(n){var e=Ql(n);if(n.equals(e)||(n.v=e,n.wv=Ga()),!Zr)if(Mr!==null)Mr.set(n,n.v);else{var t=(Vr||(n.f&Qt)!==0)&&n.deps!==null?Xr:At;Ct(n,t)}}function zc(n,e,t){const l=zr()?Bn:Jl;if(e.length===0){t(n.map(l));return}var s=ut,a=je,o=Mc(),c=Pc();Promise.all(e.map(f=>Lc(f))).then(f=>{s==null||s.activate(),o();try{t([...n.map(l),...f])}catch(u){(a.f&Gr)===0&&Gl(u,a)}s==null||s.deactivate(),Ca()}).catch(f=>{c.error(f)})}function Mc(){var n=je,e=Ve,t=Qe;return function(){gr(n),Zt(e),Sn(t)}}function Ca(){gr(null),Zt(null),Sn(null)}const hl=new Set;let ut=null,Mr=null,Ta=new Set,ml=[];function Pa(){const n=ml.shift();ml.length>0&&queueMicrotask(Pa),n()}let An=[],gl=null,Zl=!1;const Il=class Il{constructor(){Nt(this,Tr);Nt(this,el,new Map);Nt(this,Mn,new Map);Nt(this,Rn,new Set);Nt(this,Dr,0);Nt(this,tl,null);Nt(this,rl,!1);Nt(this,mn,[]);Nt(this,In,[]);Nt(this,Wr,[]);Nt(this,Cr,[]);Nt(this,gn,[]);xr(this,"skipped_effects",new Set)}capture(e,t){Le(this,Mn).has(e)||Le(this,Mn).set(e,t),Le(this,el).set(e,e.v)}activate(){ut=this}deactivate(){ut=null;for(const e of Ta)if(Ta.delete(e),e(),ut!==null)break}neuter(){Yt(this,rl,!0)}flush(){An.length>0?this.flush_effects():jn(this,Tr,ca).call(this),ut===this&&(Le(this,Dr)===0&&hl.delete(this),this.deactivate())}flush_effects(){var e=Tn;Zl=!0;try{var t=0;for(Wa(!0);An.length>0;){if(t++>1e3){var l,s;Ic()}jn(this,Tr,Oi).call(this,An),Jr.clear()}}finally{Zl=!1,Wa(e),gl=null}}increment(){Yt(this,Dr,Le(this,Dr)+1)}decrement(){if(Yt(this,Dr,Le(this,Dr)-1),Le(this,Dr)===0){for(const e of Le(this,Wr))Ct(e,Ot),Rr(e);for(const e of Le(this,Cr))Ct(e,Ot),Rr(e);for(const e of Le(this,gn))Ct(e,Ot),Rr(e);Yt(this,Wr,[]),Yt(this,Cr,[]),this.flush()}else this.deactivate()}add_callback(e){Le(this,Rn).add(e)}settled(){return(Le(this,tl)??Yt(this,tl,Hi())).promise}static ensure(e=!0){if(ut===null){const t=ut=new Il;hl.add(ut),e&&Il.enqueue(()=>{ut===t&&t.flush()})}return ut}static enqueue(e){ml.length===0&&queueMicrotask(Pa),ml.unshift(e)}};el=new WeakMap,Mn=new WeakMap,Rn=new WeakMap,Dr=new WeakMap,tl=new WeakMap,rl=new WeakMap,mn=new WeakMap,In=new WeakMap,Wr=new WeakMap,Cr=new WeakMap,gn=new WeakMap,Tr=new WeakSet,Oi=function(e){var a;An=[];var t=null;if(hl.size>1){t=new Map,Mr=new Map;for(const[o,c]of Le(this,el))t.set(o,{v:o.v,wv:o.wv}),o.v=c;for(const o of hl)if(o!==this)for(const[c,f]of Le(o,Mn))t.has(c)||(t.set(c,{v:c.v,wv:c.wv}),c.v=f)}for(const o of e)jn(this,Tr,Bi).call(this,o);if(Le(this,mn).length===0&&Le(this,Dr)===0){var l=Le(this,Wr),s=Le(this,Cr);Yt(this,Wr,[]),Yt(this,Cr,[]),Yt(this,gn,[]),jn(this,Tr,ca).call(this),La(l),La(s),(a=Le(this,tl))==null||a.resolve()}else{for(const o of Le(this,Wr))Ct(o,At);for(const o of Le(this,Cr))Ct(o,At);for(const o of Le(this,gn))Ct(o,At)}if(t){for(const[o,{v:c,wv:f}]of t)o.wv<=f&&(o.v=c);Mr=null}for(const o of Le(this,mn))Wn(o);for(const o of Le(this,In))Wn(o);Yt(this,mn,[]),Yt(this,In,[])},Bi=function(e){var d;e.f^=At;for(var t=e.first;t!==null;){var l=t.f,s=(l&(kr|xn))!==0,a=s&&(l&At)!==0,o=a||(l&lr)!==0||this.skipped_effects.has(t);if(!o&&t.fn!==null){if(s)t.f^=At;else if((l&Yl)!==0)Le(this,Cr).push(t);else if(wl(t))if((l&Hl)!==0){var c=(d=t.b)!=null&&d.pending?Le(this,In):Le(this,mn);c.push(t)}else(t.f&yn)!==0&&Le(this,gn).push(t),Wn(t);var f=t.first;if(f!==null){t=f;continue}}var u=t.parent;for(t=t.next;t===null&&u!==null;)t=u.next,u=u.parent}},ca=function(){if(!Le(this,rl))for(const e of Le(this,Rn))e();Le(this,Rn).clear()};let qn=Il;function Rc(n){var e;const t=qn.ensure(!1);for(;;){if(Tc(),An.length===0)return t===ut&&t.flush(),gl=null,e;t.flush_effects()}}function Ic(){try{ec()}catch(n){Gl(n,gl)}}function La(n){var e=n.length;if(e!==0){for(var t=0;t<e;t++){var l=n[t];if((l.f&(Gr|lr))===0&&wl(l)){var s=_l;if(Wn(l),l.deps===null&&l.first===null&&l.nodes_start===null&&(l.teardown===null&&l.ac===null?qa(l):l.fn=null),_l>s&&(l.f&Wl)!==0)break}}for(;t<e;t+=1)Rr(n[t])}}function Rr(n){for(var e=gl=n;e.parent!==null;){e=e.parent;var t=e.f;if(Zl&&e===je&&(t&yn)!==0)return;if((t&(xn|kr))!==0){if((t&At)===0)return;e.f^=At}}An.push(e)}const Jr=new Map;function Qr(n,e){var t={f:0,v:n,reactions:null,equals:_a,rv:0,wv:0};return t}function re(n,e){const t=Qr(n);return Ha(t),t}function $l(n,e=!1,t=!0){var s;const l=Qr(n);return e||(l.equals=ya),En&&t&&Qe!==null&&Qe.l!==null&&((s=Qe.l).s??(s.s=[])).push(l),l}function j(n,e,t=!1){Ve!==null&&(!mr||(Ve.f&ha)!==0)&&zr()&&(Ve.f&(Dt|yn|Hl|ha))!==0&&!(It!=null&&It.includes(n))&&lc();let l=t?Te(e):e;return Ir(n,l)}function Ir(n,e){if(!n.equals(e)){var t=n.v;Zr?Jr.set(n,e):Jr.set(n,t),n.v=e,qn.ensure().capture(n,t),(n.f&Dt)!==0&&((n.f&Ot)!==0&&Ql(n),Ct(n,(n.f&Qt)===0?At:Xr)),n.wv=Ga(),Na(n,Ot),zr()&&je!==null&&(je.f&At)!==0&&(je.f&(kr|xn))===0&&($t===null?Wc([n]):$t.push(n))}return e}function es(n){j(n,n.v+1)}function Na(n,e){var t=n.reactions;if(t!==null)for(var l=zr(),s=t.length,a=0;a<s;a++){var o=t[a],c=o.f;!l&&o===je||((c&Ot)===0&&Ct(o,e),(c&Dt)!==0?Na(o,Xr):(c&Ot)===0&&Rr(o))}}function Te(n){if(typeof n!="object"||n===null||Nr in n)return n;const e=al(n);if(e!==fa&&e!==Di)return n;var t=new Map,l=Hr(n),s=re(0),a=$r,o=c=>{if($r===a)return c();var f=Ve,u=$r;Zt(null),Xa(a);var d=c();return Zt(f),Xa(u),d};return l&&t.set("length",re(n.length)),new Proxy(n,{defineProperty(c,f,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&rc();var d=t.get(f);return d===void 0?d=o(()=>{var v=re(u.value);return t.set(f,v),v}):j(d,u.value,!0),!0},deleteProperty(c,f){var u=t.get(f);if(u===void 0){if(f in c){const d=o(()=>re(gt));t.set(f,d),es(s)}}else j(u,gt),es(s);return!0},get(c,f,u){var m;if(f===Nr)return n;var d=t.get(f),v=f in c;if(d===void 0&&(!v||(m=Lr(c,f))!=null&&m.writable)&&(d=o(()=>{var p=Te(v?c[f]:gt),w=re(p);return w}),t.set(f,d)),d!==void 0){var h=r(d);return h===gt?void 0:h}return Reflect.get(c,f,u)},getOwnPropertyDescriptor(c,f){var u=Reflect.getOwnPropertyDescriptor(c,f);if(u&&"value"in u){var d=t.get(f);d&&(u.value=r(d))}else if(u===void 0){var v=t.get(f),h=v==null?void 0:v.v;if(v!==void 0&&h!==gt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return u},has(c,f){var h;if(f===Nr)return!0;var u=t.get(f),d=u!==void 0&&u.v!==gt||Reflect.has(c,f);if(u!==void 0||je!==null&&(!d||(h=Lr(c,f))!=null&&h.writable)){u===void 0&&(u=o(()=>{var m=d?Te(c[f]):gt,p=re(m);return p}),t.set(f,u));var v=r(u);if(v===gt)return!1}return d},set(c,f,u,d){var y;var v=t.get(f),h=f in c;if(l&&f==="length")for(var m=u;m<v.v;m+=1){var p=t.get(m+"");p!==void 0?j(p,gt):m in c&&(p=o(()=>re(gt)),t.set(m+"",p))}if(v===void 0)(!h||(y=Lr(c,f))!=null&&y.writable)&&(v=o(()=>re(void 0)),j(v,Te(u)),t.set(f,v));else{h=v.v!==gt;var w=o(()=>Te(u));j(v,w)}var b=Reflect.getOwnPropertyDescriptor(c,f);if(b!=null&&b.set&&b.set.call(d,u),!h){if(l&&typeof f=="string"){var _=t.get("length"),S=Number(f);Number.isInteger(S)&&S>=_.v&&j(_,S+1)}es(s)}return!0},ownKeys(c){r(s);var f=Reflect.ownKeys(c).filter(v=>{var h=t.get(v);return h===void 0||h.v!==gt});for(var[u,d]of t)d.v!==gt&&!(u in c)&&f.push(u);return f},setPrototypeOf(){nc()}})}var ts,za,Ma,Ra;function Fc(){if(ts===void 0){ts=window,za=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;Ma=Lr(e,"firstChild").get,Ra=Lr(e,"nextSibling").get,da(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),da(t)&&(t.__t=void 0)}}function Fr(n=""){return document.createTextNode(n)}function Wt(n){return Ma.call(n)}function pl(n){return Ra.call(n)}function W(n,e){return Wt(n)}function X(n,e){{var t=Wt(n);return t instanceof Comment&&t.data===""?pl(t):t}}function z(n,e=1,t=!1){let l=n;for(;e--;)l=pl(l);return l}function jc(n){n.textContent=""}function bl(){return!1}function Ia(n){je===null&&Ve===null&&$i(),Ve!==null&&(Ve.f&Qt)!==0&&je===null&&Zi(),Zr&&Qi()}function Vc(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function dr(n,e,t,l=!0){var s=je;s!==null&&(s.f&lr)!==0&&(n|=lr);var a={ctx:Qe,deps:null,nodes_start:null,nodes_end:null,f:n|Ot,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{Wn(a),a.f|=ul}catch(f){throw hr(a),f}else e!==null&&Rr(a);var o=t&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&Dl)===0;if(!o&&l&&(s!==null&&Vc(a,s),Ve!==null&&(Ve.f&Dt)!==0)){var c=Ve;(c.effects??(c.effects=[])).push(a)}return a}function Oc(n){const e=dr(il,null,!1);return Ct(e,At),e.teardown=n,e}function _e(n){Ia();var e=je.f,t=!Ve&&(e&kr)!==0&&(e&ul)===0;if(t){var l=Qe;(l.e??(l.e=[])).push(n)}else return Fa(n)}function Fa(n){return dr(Yl|Wl,n,!1)}function Bc(n){return Ia(),dr(il|Wl,n,!0)}function qc(n){qn.ensure();const e=dr(xn,n,!0);return(t={})=>new Promise(l=>{t.outro?jr(e,()=>{hr(e),l(void 0)}):(hr(e),l(void 0))})}function rs(n){return dr(Yl,n,!1)}function Yc(n){return dr(Hl|Dl,n,!0)}function ja(n,e=0){return dr(il|e,n,!0)}function ne(n,e=[],t=[]){zc(e,t,l=>{dr(il,()=>n(...l.map(r)),!0)})}function Cn(n,e=0){var t=dr(yn|e,n,!0);return t}function vr(n,e=!0){return dr(kr,n,!0,e)}function Va(n){var e=n.teardown;if(e!==null){const t=Zr,l=Ve;Ua(!0),Zt(null);try{e.call(null)}finally{Ua(t),Zt(l)}}}function Oa(n,e=!1){var s;var t=n.first;for(n.first=n.last=null;t!==null;){(s=t.ac)==null||s.abort(Xl);var l=t.next;(t.f&xn)!==0?t.parent=null:hr(t,e),t=l}}function Dc(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&kr)===0&&hr(e),e=t}}function hr(n,e=!0){var t=!1;(e||(n.f&Xi)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(Ba(n.nodes_start,n.nodes_end),t=!0),Oa(n,e&&!t),yl(n,0),Ct(n,Gr);var l=n.transitions;if(l!==null)for(const a of l)a.stop();Va(n);var s=n.parent;s!==null&&s.first!==null&&qa(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function Ba(n,e){for(;n!==null;){var t=n===e?null:pl(n);n.remove(),n=t}}function qa(n){var e=n.parent,t=n.prev,l=n.next;t!==null&&(t.next=l),l!==null&&(l.prev=t),e!==null&&(e.first===n&&(e.first=l),e.last===n&&(e.last=t))}function jr(n,e){var t=[];ns(n,t,!0),Ya(t,()=>{hr(n),e&&e()})}function Ya(n,e){var t=n.length;if(t>0){var l=()=>--t||e();for(var s of n)s.out(l)}else e()}function ns(n,e,t){if((n.f&lr)===0){if(n.f^=lr,n.transitions!==null)for(const o of n.transitions)(o.is_global||t)&&e.push(o);for(var l=n.first;l!==null;){var s=l.next,a=(l.f&kn)!==0||(l.f&kr)!==0;ns(l,e,a?t:!1),l=s}}}function Yn(n){Da(n,!0)}function Da(n,e){if((n.f&lr)!==0){n.f^=lr,(n.f&At)===0&&(Ct(n,Ot),Rr(n));for(var t=n.first;t!==null;){var l=t.next,s=(t.f&kn)!==0||(t.f&kr)!==0;Da(t,s?e:!1),t=l}if(n.transitions!==null)for(const a of n.transitions)(a.is_global||e)&&a.in()}}let Tn=!1;function Wa(n){Tn=n}let Zr=!1;function Ua(n){Zr=n}let Ve=null,mr=!1;function Zt(n){Ve=n}let je=null;function gr(n){je=n}let It=null;function Ha(n){Ve!==null&&(It===null?It=[n]:It.push(n))}let Ft=null,Ut=0,$t=null;function Wc(n){$t=n}let _l=1,Dn=0,$r=Dn;function Xa(n){$r=n}let Vr=!1;function Ga(){return++_l}function wl(n){var v;var e=n.f;if((e&Ot)!==0)return!0;if((e&Xr)!==0){var t=n.deps,l=(e&Qt)!==0;if(t!==null){var s,a,o=(e&cl)!==0,c=l&&je!==null&&!Vr,f=t.length;if((o||c)&&(je===null||(je.f&Gr)===0)){var u=n,d=u.parent;for(s=0;s<f;s++)a=t[s],(o||!((v=a==null?void 0:a.reactions)!=null&&v.includes(u)))&&(a.reactions??(a.reactions=[])).push(u);o&&(u.f^=cl),c&&d!==null&&(d.f&Qt)===0&&(u.f^=Qt)}for(s=0;s<f;s++)if(a=t[s],wl(a)&&Aa(a),a.wv>n.wv)return!0}(!l||je!==null&&!Vr)&&Ct(n,At)}return!1}function Ka(n,e,t=!0){var l=n.reactions;if(l!==null&&!(It!=null&&It.includes(n)))for(var s=0;s<l.length;s++){var a=l[s];(a.f&Dt)!==0?Ka(a,e,!1):e===a&&(t?Ct(a,Ot):(a.f&At)!==0&&Ct(a,Xr),Rr(a))}}function Ja(n){var p;var e=Ft,t=Ut,l=$t,s=Ve,a=Vr,o=It,c=Qe,f=mr,u=$r,d=n.f;Ft=null,Ut=0,$t=null,Vr=(d&Qt)!==0&&(mr||!Tn||Ve===null),Ve=(d&(kr|xn))===0?n:null,It=null,Sn(n.ctx),mr=!1,$r=++Dn,n.ac!==null&&(n.ac.abort(Xl),n.ac=null);try{n.f|=Ul;var v=(0,n.fn)(),h=n.deps;if(Ft!==null){var m;if(yl(n,Ut),h!==null&&Ut>0)for(h.length=Ut+Ft.length,m=0;m<Ft.length;m++)h[Ut+m]=Ft[m];else n.deps=h=Ft;if(!Vr||(d&Dt)!==0&&n.reactions!==null)for(m=Ut;m<h.length;m++)((p=h[m]).reactions??(p.reactions=[])).push(n)}else h!==null&&Ut<h.length&&(yl(n,Ut),h.length=Ut);if(zr()&&$t!==null&&!mr&&h!==null&&(n.f&(Dt|Xr|Ot))===0)for(m=0;m<$t.length;m++)Ka($t[m],n);return s!==null&&s!==n&&(Dn++,$t!==null&&(l===null?l=$t:l.push(...$t))),(n.f&Kr)!==0&&(n.f^=Kr),v}catch(w){return Ac(w)}finally{n.f^=Ul,Ft=e,Ut=t,$t=l,Ve=s,Vr=a,It=o,Sn(c),mr=f,$r=u}}function Uc(n,e){let t=e.reactions;if(t!==null){var l=Yi.call(t,n);if(l!==-1){var s=t.length-1;s===0?t=e.reactions=null:(t[l]=t[s],t.pop())}}t===null&&(e.f&Dt)!==0&&(Ft===null||!Ft.includes(e))&&(Ct(e,Xr),(e.f&(Qt|cl))===0&&(e.f^=cl),Sa(e),yl(e,0))}function yl(n,e){var t=n.deps;if(t!==null)for(var l=e;l<t.length;l++)Uc(n,t[l])}function Wn(n){var e=n.f;if((e&Gr)===0){Ct(n,At);var t=je,l=Tn;je=n,Tn=!0;try{(e&yn)!==0?Dc(n):Oa(n),Va(n);var s=Ja(n);n.teardown=typeof s=="function"?s:null,n.wv=_l;var a;mt&&_c&&(n.f&Ot)!==0&&n.deps}finally{Tn=l,je=t}}}function r(n){var e=n.f,t=(e&Dt)!==0;if(Ve!==null&&!mr){var l=je!==null&&(je.f&Gr)!==0;if(!l&&!(It!=null&&It.includes(n))){var s=Ve.deps;if((Ve.f&Ul)!==0)n.rv<Dn&&(n.rv=Dn,Ft===null&&s!==null&&s[Ut]===n?Ut++:Ft===null?Ft=[n]:(!Vr||!Ft.includes(n))&&Ft.push(n));else{(Ve.deps??(Ve.deps=[])).push(n);var a=n.reactions;a===null?n.reactions=[Ve]:a.includes(Ve)||a.push(Ve)}}}else if(t&&n.deps===null&&n.effects===null){var o=n,c=o.parent;c!==null&&(c.f&Qt)===0&&(o.f^=Qt)}if(Zr){if(Jr.has(n))return Jr.get(n);if(t){o=n;var f=o.v;return((o.f&At)===0&&o.reactions!==null||Qa(o))&&(f=Ql(o)),Jr.set(o,f),f}}else if(t){if(o=n,Mr!=null&&Mr.has(o))return Mr.get(o);wl(o)&&Aa(o)}if((n.f&Kr)!==0)throw n.v;return n.v}function Qa(n){if(n.v===gt)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(Jr.has(e)||(e.f&Dt)!==0&&Qa(e))return!0;return!1}function pr(n){var e=mr;try{return mr=!0,n()}finally{mr=e}}const Hc=-7169;function Ct(n,e){n.f=n.f&Hc|e}function Xc(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(Nr in n)ls(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&Nr in t&&ls(t)}}}function ls(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let l in n)try{ls(n[l],e)}catch{}const t=al(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const l=ua(t);for(let s in l){const a=l[s].get;if(a)try{a.call(n)}catch{}}}}}const Gc=["touchstart","touchmove"];function Kc(n){return Gc.includes(n)}let Za=!1;function Jc(){Za||(Za=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{var e;if(!n.defaultPrevented)for(const t of n.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function xl(n){var e=Ve,t=je;Zt(null),gr(null);try{return n()}finally{Zt(e),gr(t)}}function Qc(n,e,t,l=t){n.addEventListener(e,()=>xl(t));const s=n.__on_r;s?n.__on_r=()=>{s(),l(!0)}:n.__on_r=()=>l(!0),Jc()}const $a=new Set,ss=new Set;function Zc(n,e,t,l={}){function s(a){if(l.capture||Un.call(e,a),!a.cancelBubble)return xl(()=>t==null?void 0:t.call(this,a))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?On(()=>{e.addEventListener(n,s,l)}):e.addEventListener(n,s,l),s}function en(n,e,t,l,s){var a={capture:l,passive:s},o=Zc(n,e,t,a);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Oc(()=>{e.removeEventListener(n,o,a)})}function st(n){for(var e=0;e<n.length;e++)$a.add(n[e]);for(var t of ss)t(n)}function Un(n){var S;var e=this,t=e.ownerDocument,l=n.type,s=((S=n.composedPath)==null?void 0:S.call(n))||[],a=s[0]||n.target,o=0,c=n.__root;if(c){var f=s.indexOf(c);if(f!==-1&&(e===document||e===window)){n.__root=e;return}var u=s.indexOf(e);if(u===-1)return;f<=u&&(o=f)}if(a=s[o]||n.target,a!==e){Bl(n,"currentTarget",{configurable:!0,get(){return a||t}});var d=Ve,v=je;Zt(null),gr(null);try{for(var h,m=[];a!==null;){var p=a.assignedSlot||a.parentNode||a.host||null;try{var w=a["__"+l];if(w!=null&&(!a.disabled||n.target===a))if(Hr(w)){var[b,..._]=w;b.apply(a,[n,..._])}else w.call(a,n)}catch(y){h?m.push(y):h=y}if(n.cancelBubble||p===e||p===null)break;a=p}if(h){for(let y of m)queueMicrotask(()=>{throw y});throw h}}finally{n.__root=e,delete n.currentTarget,Zt(d),gr(v)}}}function as(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function tn(n,e){var t=je;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function U(n,e){var t=(e&ba)!==0,l=(e&mc)!==0,s,a=!n.startsWith("<!>");return()=>{s===void 0&&(s=as(a?n:"<!>"+n),t||(s=Wt(s)));var o=l||za?document.importNode(s,!0):s.cloneNode(!0);if(t){var c=Wt(o),f=o.lastChild;tn(c,f)}else tn(o,o);return o}}function $c(n,e,t="svg"){var l=!n.startsWith("<!>"),s=(e&ba)!==0,a=`<${t}>${l?n:"<!>"+n}</${t}>`,o;return()=>{if(!o){var c=as(a),f=Wt(c);if(s)for(o=document.createDocumentFragment();Wt(f);)o.appendChild(Wt(f));else o=Wt(f)}var u=o.cloneNode(!0);if(s){var d=Wt(u),v=u.lastChild;tn(d,v)}else tn(u,u);return u}}function ke(n,e){return $c(n,e,"svg")}function eu(n=""){{var e=Fr(n+"");return tn(e,e),e}}function de(){var n=document.createDocumentFragment(),e=document.createComment(""),t=Fr();return n.append(e,t),tn(e,t),n}function E(n,e){n!==null&&n.before(e)}let os=!0;function xe(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??(n.__t=n.nodeValue))&&(n.__t=t,n.nodeValue=t+"")}function tu(n,e){return ru(n,e)}const Pn=new Map;function ru(n,{target:e,anchor:t,props:l={},events:s,context:a,intro:o=!0}){Fc();var c=new Set,f=v=>{for(var h=0;h<v.length;h++){var m=v[h];if(!c.has(m)){c.add(m);var p=Kc(m);e.addEventListener(m,Un,{passive:p});var w=Pn.get(m);w===void 0?(document.addEventListener(m,Un,{passive:p}),Pn.set(m,1)):Pn.set(m,w+1)}}};f(Ol($a)),ss.add(f);var u=void 0,d=qc(()=>{var v=t??e.appendChild(Fr());return vr(()=>{if(a){me({});var h=Qe;h.c=a}s&&(l.$$events=s),os=o,u=n(v,l)||{},os=!0,a&&ge()}),()=>{var p;for(var h of c){e.removeEventListener(h,Un);var m=Pn.get(h);--m===0?(document.removeEventListener(h,Un),Pn.delete(h)):Pn.set(h,m)}ss.delete(f),v!==t&&((p=v.parentNode)==null||p.removeChild(v))}});return nu.set(u,d),u}let nu=new WeakMap;const is=0,kl=1,cs=2;function us(n,e,t,l,s){var a=n,o=zr(),c=Qe,f=gt,u,d,v,h=o?Qr(void 0):$l(void 0,!1,!1),m=o?Qr(void 0):$l(void 0,!1,!1),p=!1;function w(_,S){p=!0,S&&(gr(b),Zt(b),Sn(c));try{_===is&&t&&(u?Yn(u):u=vr(()=>t(a))),_===cs&&s&&(v?Yn(v):v=vr(()=>s(a,m))),_!==is&&u&&jr(u,()=>u=null),_!==kl&&d&&jr(d,()=>d=null),_!==cs&&v&&jr(v,()=>v=null)}finally{S&&(Sn(null),Zt(null),gr(null),Rc())}}var b=Cn(()=>{if(f!==(f=e())){if(Wi(f)){var _=f;p=!1,_.then(S=>{_===f&&(Ir(h,S),w(kl,!0))},S=>{if(_===f&&(Ir(m,S),w(cs,!0),!s))throw m.v}),On(()=>{p||w(is,!0)})}else Ir(h,f),w(kl,!1);return()=>f=gt}})}function q(n,e,t=!1){var l=n,s=null,a=null,o=gt,c=t?kn:0,f=!1;const u=(m,p=!0)=>{f=!0,h(p,m)};var d=null;function v(){d!==null&&(d.lastChild.remove(),l.before(d),d=null);var m=o?s:a,p=o?a:s;m&&Yn(m),p&&jr(p,()=>{o?a=null:s=null})}const h=(m,p)=>{if(o!==(o=m)){var w=bl(),b=l;if(w&&(d=document.createDocumentFragment(),d.append(b=Fr())),o?s??(s=p&&vr(()=>p(b))):a??(a=p&&vr(()=>p(b))),w){var _=ut,S=o?s:a,y=o?a:s;S&&_.skipped_effects.delete(S),y&&_.skipped_effects.add(y),_.add_callback(v)}else v()}};Cn(()=>{f=!1,e(u),f||h(null,null)},c)}function Ln(n,e,t){var l=n,s=gt,a,o,c=null,f=zr()?bc:wa;function u(){a&&jr(a),c!==null&&(c.lastChild.remove(),l.before(c),c=null),a=o}Cn(()=>{if(f(s,s=e())){var d=l,v=bl();v&&(c=document.createDocumentFragment(),c.append(d=Fr())),o=vr(()=>t(d)),v?ut.add_callback(u):u()}})}function Ie(n,e){return e}function lu(n,e,t){for(var l=n.items,s=[],a=e.length,o=0;o<a;o++)ns(e[o].e,s,!0);var c=a>0&&s.length===0&&t!==null;if(c){var f=t.parentNode;jc(f),f.append(t),l.clear(),br(n,e[0].prev,e[a-1].next)}Ya(s,()=>{for(var u=0;u<a;u++){var d=e[u];c||(l.delete(d.k),br(n,d.prev,d.next)),hr(d.e,!c)}})}function Ne(n,e,t,l,s,a=null){var o=n,c={flags:e,items:new Map,first:null},f=(e&pa)!==0;if(f){var u=n;o=u.appendChild(Fr())}var d=null,v=!1,h=new Map,m=Jl(()=>{var _=t();return Hr(_)?_:_==null?[]:Ol(_)}),p,w;function b(){su(w,p,c,h,o,s,e,l,t),a!==null&&(p.length===0?d?Yn(d):d=vr(()=>a(o)):d!==null&&jr(d,()=>{d=null}))}Cn(()=>{w??(w=je),p=r(m);var _=p.length;if(!(v&&_===0)){v=_===0;var S,y,A,L;if(bl()){var k=new Set,C=ut;for(y=0;y<_;y+=1){A=p[y],L=l(A,y);var N=c.items.get(L)??h.get(L);N?(e&(fl|dl))!==0&&eo(N,A,y,e):(S=to(null,c,null,null,A,L,y,s,e,t,!0),h.set(L,S)),k.add(L)}for(const[F,M]of c.items)k.has(F)||C.skipped_effects.add(M.e);C.add_callback(b)}else b();r(m)}})}function su(n,e,t,l,s,a,o,c,f){var H,J,$,ae;var u=(o&sc)!==0,d=(o&(fl|dl))!==0,v=e.length,h=t.items,m=t.first,p=m,w,b=null,_,S=[],y=[],A,L,k,C;if(u)for(C=0;C<v;C+=1)A=e[C],L=c(A,C),k=h.get(L),k!==void 0&&((H=k.a)==null||H.measure(),(_??(_=new Set)).add(k));for(C=0;C<v;C+=1){if(A=e[C],L=c(A,C),k=h.get(L),k===void 0){var N=l.get(L);if(N!==void 0){l.delete(L),h.set(L,N);var F=b?b.next:p;br(t,b,N),br(t,N,F),fs(N,F,s),b=N}else{var M=p?p.e.nodes_start:s;b=to(M,t,b,b===null?t.first:b.next,A,L,C,a,o,f)}h.set(L,b),S=[],y=[],p=b.next;continue}if(d&&eo(k,A,C,o),(k.e.f&lr)!==0&&(Yn(k.e),u&&((J=k.a)==null||J.unfix(),(_??(_=new Set)).delete(k))),k!==p){if(w!==void 0&&w.has(k)){if(S.length<y.length){var T=y[0],R;b=T.prev;var D=S[0],V=S[S.length-1];for(R=0;R<S.length;R+=1)fs(S[R],T,s);for(R=0;R<y.length;R+=1)w.delete(y[R]);br(t,D.prev,V.next),br(t,b,D),br(t,V,T),p=T,b=V,C-=1,S=[],y=[]}else w.delete(k),fs(k,p,s),br(t,k.prev,k.next),br(t,k,b===null?t.first:b.next),br(t,b,k),b=k;continue}for(S=[],y=[];p!==null&&p.k!==L;)(p.e.f&lr)===0&&(w??(w=new Set)).add(p),y.push(p),p=p.next;if(p===null)continue;k=p}S.push(k),b=k,p=k.next}if(p!==null||w!==void 0){for(var P=w===void 0?[]:Ol(w);p!==null;)(p.e.f&lr)===0&&P.push(p),p=p.next;var Y=P.length;if(Y>0){var Z=(o&pa)!==0&&v===0?s:null;if(u){for(C=0;C<Y;C+=1)($=P[C].a)==null||$.measure();for(C=0;C<Y;C+=1)(ae=P[C].a)==null||ae.fix()}lu(t,P,Z)}}u&&On(()=>{var Q;if(_!==void 0)for(k of _)(Q=k.a)==null||Q.apply()}),n.first=t.first&&t.first.e,n.last=b&&b.e;for(var I of l.values())hr(I.e);l.clear()}function eo(n,e,t,l){(l&fl)!==0&&Ir(n.v,e),(l&dl)!==0?Ir(n.i,t):n.i=t}function to(n,e,t,l,s,a,o,c,f,u,d){var v=(f&fl)!==0,h=(f&ac)===0,m=v?h?$l(s,!1,!1):Qr(s):s,p=(f&dl)===0?o:Qr(o),w={i:p,v:m,k:a,a:null,e:null,prev:t,next:l};try{if(n===null){var b=document.createDocumentFragment();b.append(n=Fr())}return w.e=vr(()=>c(n,m,p,u),pc),w.e.prev=t&&t.e,w.e.next=l&&l.e,t===null?d||(e.first=w):(t.next=w,t.e.next=w.e),l!==null&&(l.prev=w,l.e.prev=w.e),w}finally{}}function fs(n,e,t){for(var l=n.next?n.next.e.nodes_start:t,s=e?e.e.nodes_start:t,a=n.e.nodes_start;a!==null&&a!==l;){var o=pl(a);s.before(a),a=o}}function br(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function kt(n,e,t=!1,l=!1,s=!1){var a=n,o="";ne(()=>{var c=je;if(o!==(o=e()??"")&&(c.nodes_start!==null&&(Ba(c.nodes_start,c.nodes_end),c.nodes_start=c.nodes_end=null),o!=="")){var f=o+"";t?f=`<svg>${f}</svg>`:l&&(f=`<math>${f}</math>`);var u=as(f);if((t||l)&&(u=Wt(u)),tn(Wt(u),u.lastChild),t||l)for(;Wt(u);)a.before(Wt(u));else a.before(u)}})}function Er(n,e,...t){var l=n,s=xt,a;Cn(()=>{s!==(s=e())&&(a&&(hr(a),a=null),a=vr(()=>s(l,...t)))},kn)}function Hn(n,e,t){var l=n,s,a,o=null,c=null;function f(){a&&(jr(a),a=null),o&&(o.lastChild.remove(),l.before(o),o=null),a=c,c=null}Cn(()=>{if(s!==(s=e())){var u=bl();if(s){var d=l;u&&(o=document.createDocumentFragment(),o.append(d=Fr())),c=vr(()=>t(d,s))}u?ut.add_callback(f):f()}},kn)}function ro(n){var e,t,l="";if(typeof n=="string"||typeof n=="number")l+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=ro(n[e]))&&(l&&(l+=" "),l+=t)}else for(t in n)n[t]&&(l&&(l+=" "),l+=t);return l}function au(){for(var n,e,t=0,l="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=ro(n))&&(l&&(l+=" "),l+=e);return l}function ou(n){return typeof n=="object"?au(n):n??""}const no=[...`
\r\f \v\uFEFF`];function iu(n,e,t){var l=n==null?"":""+n;if(e&&(l=l?l+" "+e:e),t){for(var s in t)if(t[s])l=l?l+" "+s:s;else if(l.length)for(var a=s.length,o=0;(o=l.indexOf(s,o))>=0;){var c=o+a;(o===0||no.includes(l[o-1]))&&(c===l.length||no.includes(l[c]))?l=(o===0?"":l.substring(0,o))+l.substring(c+1):o=c}}return l===""?null:l}function cu(n,e){return n==null?null:String(n)}function ft(n,e,t,l,s,a){var o=n.__className;if(o!==t||o===void 0){var c=iu(t,l,a);c==null?n.removeAttribute("class"):e?n.className=c:n.setAttribute("class",c),n.__className=t}else if(a&&s!==a)for(var f in a){var u=!!a[f];(s==null||u!==!!s[f])&&n.classList.toggle(f,u)}return a}function ot(n,e,t,l){var s=n.__style;if(s!==e){var a=cu(e);a==null?n.removeAttribute("style"):n.style.cssText=a,n.__style=e}return l}const uu=Symbol("is custom element"),fu=Symbol("is html");function O(n,e,t,l){var s=du(n);s[e]!==(s[e]=t)&&(e==="loading"&&(n[Gi]=t),t==null?n.removeAttribute(e):typeof t!="string"&&vu(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function du(n){return n.__attributes??(n.__attributes={[uu]:n.nodeName.includes("-"),[fu]:n.namespaceURI===gc})}var lo=new Map;function vu(n){var e=lo.get(n.nodeName);if(e)return e;lo.set(n.nodeName,e=[]);for(var t,l=n,s=Element.prototype;s!==l;){t=ua(l);for(var a in t)t[a].set&&e.push(a);l=al(l)}return e}const hu=()=>performance.now(),Sr={tick:n=>requestAnimationFrame(n),now:()=>hu(),tasks:new Set};function so(){const n=Sr.now();Sr.tasks.forEach(e=>{e.c(n)||(Sr.tasks.delete(e),e.f())}),Sr.tasks.size!==0&&Sr.tick(so)}function mu(n){let e;return Sr.tasks.size===0&&Sr.tick(so),{promise:new Promise(t=>{Sr.tasks.add(e={c:n,f:t})}),abort(){Sr.tasks.delete(e)}}}function El(n,e){xl(()=>{n.dispatchEvent(new CustomEvent(e))})}function gu(n){if(n==="float")return"cssFloat";if(n==="offset")return"cssOffset";if(n.startsWith("--"))return n;const e=n.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function ao(n){const e={},t=n.split(";");for(const l of t){const[s,a]=l.split(":");if(!s||a===void 0)break;const o=gu(s.trim());e[o]=a.trim()}return e}const pu=n=>n;function oo(n,e,t,l){var s=(n&dc)!==0,a=(n&vc)!==0,o=s&&a,c=(n&hc)!==0,f=o?"both":s?"in":"out",u,d=e.inert,v=e.style.overflow,h,m;function p(){return xl(()=>u??(u=t()(e,(l==null?void 0:l())??{},{direction:f})))}var w={is_global:c,in(){var y;if(e.inert=d,!s){m==null||m.abort(),(y=m==null?void 0:m.reset)==null||y.call(m);return}a||h==null||h.abort(),El(e,"introstart"),h=ds(e,p(),m,1,()=>{El(e,"introend"),h==null||h.abort(),h=u=void 0,e.style.overflow=v})},out(y){if(!a){y==null||y(),u=void 0;return}e.inert=!0,El(e,"outrostart"),m=ds(e,p(),h,0,()=>{El(e,"outroend"),y==null||y()})},stop:()=>{h==null||h.abort(),m==null||m.abort()}},b=je;if((b.transitions??(b.transitions=[])).push(w),s&&os){var _=c;if(!_){for(var S=b.parent;S&&(S.f&kn)!==0;)for(;(S=S.parent)&&(S.f&yn)===0;);_=!S||(S.f&ul)!==0}_&&rs(()=>{pr(()=>w.in())})}}function ds(n,e,t,l,s){var a=l===1;if(wn(e)){var o,c=!1;return On(()=>{if(!c){var b=e({direction:a?"in":"out"});o=ds(n,b,t,l,s)}}),{abort:()=>{c=!0,o==null||o.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(t==null||t.deactivate(),!(e!=null&&e.duration))return s(),{abort:xt,deactivate:xt,reset:xt,t:()=>l};const{delay:f=0,css:u,tick:d,easing:v=pu}=e;var h=[];if(a&&t===void 0&&(d&&d(0,1),u)){var m=ao(u(0,1));h.push(m,m)}var p=()=>1-l,w=n.animate(h,{duration:f,fill:"forwards"});return w.onfinish=()=>{w.cancel();var b=(t==null?void 0:t.t())??1-l;t==null||t.abort();var _=l-b,S=e.duration*Math.abs(_),y=[];if(S>0){var A=!1;if(u)for(var L=Math.ceil(S/16.666666666666668),k=0;k<=L;k+=1){var C=b+_*v(k/L),N=ao(u(C,1-C));y.push(N),A||(A=N.overflow==="hidden")}A&&(n.style.overflow="hidden"),p=()=>{var F=w.currentTime;return b+_*v(F/S)},d&&mu(()=>{if(w.playState!=="running")return!1;var F=p();return d(F,1-F),!0})}w=n.animate(y,{duration:S,fill:"forwards"}),w.onfinish=()=>{p=()=>l,d==null||d(l,1-l),s()}},{abort:()=>{w&&(w.cancel(),w.effect=null,w.onfinish=xt)},deactivate:()=>{s=xt},reset:()=>{l===0&&(d==null||d(1,0))},t:()=>p()}}function vs(n,e,t=e){var l=zr(),s=new WeakSet;Qc(n,"input",a=>{var o=a?n.defaultValue:n.value;if(o=hs(n)?ms(o):o,t(o),ut!==null&&s.add(ut),l&&o!==(o=e())){var c=n.selectionStart,f=n.selectionEnd;n.value=o??"",f!==null&&(n.selectionStart=c,n.selectionEnd=Math.min(f,n.value.length))}}),pr(e)==null&&n.value&&(t(hs(n)?ms(n.value):n.value),ut!==null&&s.add(ut)),ja(()=>{var a=e();n===document.activeElement&&s.has(ut)||hs(n)&&a===ms(n.value)||n.type==="date"&&!a&&!n.value||a!==n.value&&(n.value=a??"")})}function hs(n){var e=n.type;return e==="number"||e==="range"}function ms(n){return n===""?null:+n}const jl=class jl{constructor(e){Nt(this,Fl);Nt(this,Ur,new WeakMap);Nt(this,Fn);Nt(this,nl);Yt(this,nl,e)}observe(e,t){var l=Le(this,Ur).get(e)||new Set;return l.add(t),Le(this,Ur).set(e,l),jn(this,Fl,qi).call(this).observe(e,Le(this,nl)),()=>{var s=Le(this,Ur).get(e);s.delete(t),s.size===0&&(Le(this,Ur).delete(e),Le(this,Fn).unobserve(e))}}};Ur=new WeakMap,Fn=new WeakMap,nl=new WeakMap,Fl=new WeakSet,qi=function(){return Le(this,Fn)??Yt(this,Fn,new ResizeObserver(e=>{for(var t of e){jl.entries.set(t.target,t);for(var l of Le(this,Ur).get(t.target)||[])l(t)}}))},xr(jl,"entries",new WeakMap);let gs=jl;var bu=new gs({box:"border-box"});function io(n,e,t){var l=bu.observe(n,()=>t(n[e]));rs(()=>(pr(()=>t(n[e])),l))}function co(n,e){return n===e||(n==null?void 0:n[Nr])===e}function rn(n={},e,t,l){return rs(()=>{var s,a;return ja(()=>{s=a,a=[],pr(()=>{n!==t(...a)&&(e(n,...a),s&&co(t(...s),n)&&e(null,...s))})}),()=>{On(()=>{a&&co(t(...a),n)&&e(null,...a)})}}),n}function _u(n=!1){const e=Qe,t=e.l.u;if(!t)return;let l=()=>Xc(e.s);if(n){let s=0,a={};const o=Bn(()=>{let c=!1;const f=e.s;for(const u in f)f[u]!==a[u]&&(a[u]=f[u],c=!0);return c&&s++,s});l=()=>r(o)}t.b.length&&Bc(()=>{uo(e,l),ol(t.b)}),_e(()=>{const s=pr(()=>t.m.map(Ui));return()=>{for(const a of s)typeof a=="function"&&a()}}),t.a.length&&_e(()=>{uo(e,l),ol(t.a)})}function uo(n,e){if(n.l.s)for(const t of n.l.s)r(t);e()}let Sl=!1;function wu(n){var e=Sl;try{return Sl=!1,[n(),Sl]}finally{Sl=e}}const yu={get(n,e){if(!n.exclude.includes(e))return n.props[e]},set(n,e){return!1},getOwnPropertyDescriptor(n,e){if(!n.exclude.includes(e)&&e in n.props)return{enumerable:!0,configurable:!0,value:n.props[e]}},has(n,e){return n.exclude.includes(e)?!1:e in n.props},ownKeys(n){return Reflect.ownKeys(n.props).filter(e=>!n.exclude.includes(e))}};function nn(n,e,t){return new Proxy({props:n,exclude:e},yu)}const xu={get(n,e){let t=n.props.length;for(;t--;){let l=n.props[t];if(wn(l)&&(l=l()),typeof l=="object"&&l!==null&&e in l)return l[e]}},set(n,e,t){let l=n.props.length;for(;l--;){let s=n.props[l];wn(s)&&(s=s());const a=Lr(s,e);if(a&&a.set)return a.set(t),!0}return!1},getOwnPropertyDescriptor(n,e){let t=n.props.length;for(;t--;){let l=n.props[t];if(wn(l)&&(l=l()),typeof l=="object"&&l!==null&&e in l){const s=Lr(l,e);return s&&!s.configurable&&(s.configurable=!0),s}}},has(n,e){if(e===Nr||e===ma)return!1;for(let t of n.props)if(wn(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(n){const e=[];for(let t of n.props)if(wn(t)&&(t=t()),!!t){for(const l in t)e.includes(l)||e.push(l);for(const l of Object.getOwnPropertySymbols(t))e.includes(l)||e.push(l)}return e}};function Or(...n){return new Proxy({props:n},xu)}function B(n,e,t,l){var y;var s=!En||(t&ic)!==0,a=(t&uc)!==0,o=(t&fc)!==0,c=l,f=!0,u=()=>(f&&(f=!1,c=o?pr(l):l),c),d;if(a){var v=Nr in n||ma in n;d=((y=Lr(n,e))==null?void 0:y.set)??(v&&e in n?A=>n[e]=A:void 0)}var h,m=!1;a?[h,m]=wu(()=>n[e]):h=n[e],h===void 0&&l!==void 0&&(h=u(),d&&(s&&tc(),d(h)));var p;if(s?p=()=>{var A=n[e];return A===void 0?u():(f=!0,A)}:p=()=>{var A=n[e];return A!==void 0&&(c=void 0),A===void 0?c:A},s&&(t&cc)===0)return p;if(d){var w=n.$$legacy;return function(A,L){return arguments.length>0?((!s||!L||w||m)&&d(L?p():A),A):p()}}var b=!1,_=((t&oc)!==0?Bn:Jl)(()=>(b=!1,p()));a&&r(_);var S=je;return function(A,L){if(arguments.length>0){const k=L?r(_):s&&a?Te(A):A;return j(_,k),b=!0,c!==void 0&&(c=k),A}return Zr&&b||(S.f&Gr)!==0?_.v:r(_)}}function ku(n){Qe===null&&ga(),En&&Qe.l!==null?Eu(Qe).m.push(n):_e(()=>{const e=pr(n);if(typeof e=="function")return e})}function Eu(n){var e=n.l;return e.u??(e.u={a:[],b:[],m:[]})}const Su="5";typeof window<"u"&&((Ri=window.__svelte??(window.__svelte={})).v??(Ri.v=new Set)).add(Su),wc();function fo(n,e){if(Fe(n))return fo(n.v,Fe(e)?e.v:e);const t=e.length;e[t-1]=e[t-1]*1.0001;let l=new ze.valuesConstructor(t-1);for(let s=0;s<n.length;s++)for(let a=0;a<t-1;a++)n[s]>=e[a]&&n[s]<e[a+1]&&(l[a]+=1);return new ze(l)}function vo(n){if(Fe(n))return vo(n.v);const e=new ze.valuesConstructor(n.length-1);for(let t=0;t<e.length;t++)e[t]=.5*(n[t]+n[t+1]);return new ze(e)}function Al(n,e){Fe(n)&&Al(n.v,e);const t=ln(n);if(t[0]===t[1])throw new Error('split: values in a vector "x" should vary.');const l=(t[1]-t[0])/e;return ze.seq(t[0],t[1],l)}function ho(n){if(Fe(n))return ho(n.v);const e=new ze.valuesConstructor(n.length-1);for(let t=0;t<n.length-1;t++)e[t]=n[t+1]-n[t];return new ze(e)}function Au(n){const e=n<10?.375:.5,t=new ze.valuesConstructor(n);for(let l=0;l<n;l++)t[l]=(l+1-e)/(n+(1-e)-e);return new ze(t)}function mo(n,e,t=!1,l=void 0,s=void 0){if(Fe(n))return mo(n.v,e.v,t,l,s);const a=n.length;if(e.length!==a)throw Error("Vectors 'x' and 'y' must have the same length.");if(a<2)throw Error("Vectors 'x' and 'y' must have at least two values.");l===void 0&&(l=sn(n)),s===void 0&&(s=sn(e));let o=0;for(let c=0;c<a;c++)o=o+(n[c]-l)*(e[c]-s);return o/(t?a:a-1)}function Ar(n,e){if(Fe(n))return Ar(n.v,e);e===void 0&&(e=.1);const t=ln(n),l=(t[1]-t[0])*e;return[t[0]-l,t[1]+l]}function ln(n){if(Fe(n))return ln(n.v);let e=n[0],t=n[0];for(let l=1;l<n.length;l++)n[l]<e&&(e=n[l]),n[l]>t&&(t=n[l]);return[e,t]}function go(n,e){return Fe(n)?go(n.v,e):Math.sqrt(ps(n,e))}function ps(n,e){if(e===void 0&&(e=!1),Fe(n))return ps(n.v);const t=sn(n);let l=0;for(let s=0;s<n.length;s++){const a=n[s]-t;l=l+a*a}return l/(e?n.length:n.length-1)}function sn(n){return Fe(n)?sn(n.v):po(n)/n.length}function po(n){if(Fe(n))return po(n.v);let e=0;for(let t=0;t<n.length;t++)e=e+n[t];return e}function bs(n){if(Fe(n))return bs(n.v);let e=1;for(let t=0;t<n.length;t++)e=e*n[t];return e}function Ht(n){return Fe(n)||sr(n)?n.v[_s(n.v)-1]:n[_s(n)-1]}function _s(n){if(Fe(n)||sr(n))return _s(n.v);let e=1,t=n[0];for(let l=2;l<=n.length;l++)n[l-1]<t&&(e=l,t=n[l-1]);return e}function er(n){return Fe(n)||sr(n)?n.v[ws(n.v)-1]:n[ws(n)-1]}function ws(n){if(Fe(n)||sr(n))return ws(n.v);let e=1,t=n[0];for(let l=2;l<=n.length;l++)n[l-1]>t&&(e=l,t=n[l-1]);return e}const ys=30,Cu=1e-7,Tu=1e-7,Pu=100;function Lu(n,e,t,l,s){s===void 0&&(s=Pu);let a=t,o=l,c=(o-a)/s;for(let f=0;f<s;f++){let u,d;for(let m=0;m<s;m++){u=a+m*c,d=a+(m+1)*c;const p=e(u),w=e(d);if(p<=n&&w>=n)break}const v=(u+d)/2,h=e(v);if(Math.abs(h-n)<Cu||(a=u,o=d,c=(o-a)/s,c/o<Tu))return v}return(a+o)/2}function bo(n,e=0,t=1){let l=ze.zeros(n);for(let s=0;s<n;s++)l.v[s]=e+Math.random()*(t-e);return l}function _o(n,e=0,t=1){let l=ze.zeros(n);for(let s=0;s<n;s++){const a=Math.sqrt(-2*Math.log(Math.random())),o=2*Math.PI*Math.random();l.v[s]=a*Math.sin(o)*t+e}return l}function wo(n,e=0,t=1){if(Fe(n))return n.apply(s=>wo(s,e,t));const l=1/(Math.sqrt(2)*t);return .5*(1+zu((n-e)*l))}function Cl(n,e=0,t=1){if(Fe(n))return n.apply(D=>Cl(D,e,t));if(e!==0||t!==1)return Cl(n)*t+e;if(n<0||n>1)throw Error('Parameter "p" must be between 0 and 1.');if(n<1e-10)return-1/0;if(n>.9999999999)return 1/0;const l=.425,s=5,a=.180625,o=1.6,c=3.3871327179,f=5.0434271938*10,u=1.5929113202*100,d=5.910937472*10,v=1.7895169469*10,h=7.8757757664*10,m=6.71875636*10,p=1.4234372777,w=2.75681539,b=1.3067284816,_=1.7023821103*.1,S=7.370016425*.1,y=1.2021132975*.1,A=6.657905115,L=3.081226386,k=4.2868294337*.1,C=1.7337203997*.01,N=2.4197894225*.1,F=1.2258202635*.01,M=n-.5;let T;if(Math.abs(M)<=l)return T=a-M*M,M*(((d*T+u)*T+f)*T+c)/(((m*T+h)*T+v)*T+1);T=M<0?n:1-n,T=Math.sqrt(-Math.log(T));let R;return T<=s?(T=T-o,R=(((_*T+b)*T+w)*T+p)/((y*T+S)*T+1)):(T=T-s,R=((C*T+k)*T+L+A)/((F*T+N)*T+1)),M<0?-R:R}function yo(n,e){if(Array.isArray(n))return yo(Ye(n),e);const t=5/6-1/(9*e)-7/(648*e*e)+25/(2187*e*e*e),l=1/(18*e)+1/(162*e*e)-37/(1164*e*e*e),s=Math.sqrt(l);function a(f){if(f===0)return 0;if(e===0||e>100&&f>e*2||e>50&&f>e*3||e>10&&f>e*5||e>5&&f>e*8||f>e*30)return 1;const u=f/e,d=Math.pow(u,1/6)-.5*Math.pow(u,1/3)+1/3*Math.pow(u,1/2);return wo(d,t,s)}function o(f){return f===0?0:e===0||e>100&&f>e*2||e>50&&f>e*3||e>10&&f>e*5||e>5&&f>e*8||f>e*30?1:Nu(f/2,e/2)/Xn(e/2)}const c=e>ys?a:o;return Fe(n)?n.apply(c):c(n)}function xo(n,e){if(Array.isArray(n))return xo(Ye(n),e);const t=5/6-1/(9*e)-7/(648*e*e)+25/(2187*e*e*e),l=1/(18*e)+1/(162*e*e)-37/(1164*e*e*e),s=Math.sqrt(l);function a(f){if(f===0)return 0;if(f===1)return Inf;if(e===0)return 0;const u=Cl(f,t,s),d=Math.pow(Math.sqrt(36*u*u-30*u+13)/4+(3*u-3/2)/2+1/8,1/3);return Math.pow(d-3/(4*d)+.5,6)*e}function o(f){return f===0?0:f===1?Inf:e===0?0:Lu(f,d=>yo(d,e),0,ys*10)}const c=e>ys?a:o;return Fe(n)?n.apply(c):c(n)}function Xn(n){if(Fe(n))return n.apply(Xn);if(n<=0)throw new Error("gamma: the function only works with arguments > 0.");const e=[676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(n<.5)return Math.PI/(Math.sin(Math.PI*n)+Xn(1-n));n=n-1;let t=.9999999999998099;for(let s=0;s<e.length;s++)t=t+e[s]/(n+s+1);const l=n+e.length-.5;return Math.sqrt(2*Math.PI)*Math.pow(l,n+.5)*Math.exp(-l)*t}function Nu(n,e){let s=0;for(let a=0;a<1e4;a++){const o=Math.pow(n,a)/Xn(e+a+1);if(isNaN(o)||o<1e-18)break;s+=o}return Math.pow(n,e)*Xn(e)*Math.exp(-n)*s}function zu(n){const e=n>=0?1:-1;n=Math.abs(n);const t=.254829592,l=-.284496736,s=1.421413741,a=-1.453152027,o=1.061405429,f=1/(1+.3275911*n),u=1-((((o*f+a)*f+s)*f+l)*f+t)*f*Math.exp(-n*n);return e*u}function ko(n){const e=n.nrows,t=n.ncols;if(e<t){const o=ko(n.subset([],dt.seq(1,e)));return{Q:o.Q,R:Ru(o.Q,n)}}let l=$e.eye(e),s=n.t();for(let o=1;o<=t;o++)for(let c=e;c>=o+1;c--){const f=s.v.subarray((c-2)*t,c*t),u=l.v.subarray((c-2)*e,c*e),d=f.slice(),v=u.slice(),[h,m,p]=Mu(d[o-1],d[o-1+t]);for(let w=0;w<t;w++)f[w]=d[w]*h+d[w+t]*m,f[w+t]=d[w]*-m+d[w+t]*h,u[w]=v[w]*h+v[w+e]*m,u[w+e]=v[w]*-m+v[w+e]*h;for(let w=t;w<e;w++)u[w]=v[w]*h+v[w+e]*m,u[w+e]=v[w]*-m+v[w+e]*h}const a=dt.seq(1,t);return{Q:e===t?l:l.subset([],a),R:e===t?s.t():s.subset([],a).t()}}function Mu(n,e){if(n==0)return[0,1,e];if(Math.abs(n)>Math.abs(e)){const a=e/n,o=Math.sqrt(1+a*a),c=1/o;return[c,a*c,n*o]}const t=n/e,l=Math.sqrt(1+t*t),s=1/l;return[t*s,s,e*l]}function Eo(n){return typeof n=="number"}function So(n,e){e===void 0&&(e=n);const t=n.nrows,l=n.ncols,s=e.nrows;e.ncols;const a=t,o=s,c=l,f=new Float64Array(a*o);for(let u=0;u<c;u++){const d=n.v.subarray(u*t,(u+1)*t),v=e.v.subarray(u*s,(u+1)*s);for(let h=0;h<o;h++){const m=f.subarray(h*a,(h+1)*a);for(let p=0;p<a;p++)m[p]+=d[p]*v[h]}}return new $e(f,a,o)}function Ru(n,e){if(e===void 0&&(e=n),!tr(n)||!tr(e))throw Error("crossprod: both X and Y must be instance of Matrix class.");const t=n.nrows,l=n.ncols,s=e.nrows,a=e.ncols,o=l,c=a,f=t,u=new Float64Array(o*c);for(let d=0;d<c;d++){const v=e.v.subarray(d*s,(d+1)*s),h=u.subarray(d*o,(d+1)*o);for(let m=0;m<o;m++){const p=n.v.subarray(m*t,(m+1)*t);let w=0;for(let b=0;b<f;b++)w+=p[b]*v[b];h[m]=w}}return new $e(u,o,c)}function Ao(n,e,t){if(t===void 0){if(e!==n.v.length)throw Error("reshape: provided dimension does not match number of values in the object.");return new ze(n.v)}if(n.v.length!==e*t)throw Error("reshape: provided dimension does not match number of values in the object.");return new $e(n.v,e,t)}function tr(n){return n&&n.constructor===$e}function Iu(n,e,t){return new $e(new Float64Array(n),e,t)}const Me=class Me{constructor(e,t,l){if(!ArrayBuffer.isView(e)||e.constructor!==Me.valuesConstructor)throw Error('Matrix: parameter "values" must be Float64Array.');if(t===0||l===0)throw Error("Matrix: can not create matrix with zero rows or columns.");if(e.length!==t*l)throw Error('Matrix: number elements in "values" is not equal to "nrows" x "ncols".');this.v=e,this.nrows=t,this.ncols=l}inv(){if(this.nrows!==this.ncols)throw Error("inv: only squared matrices can be inverted.");const e=this.ncols;if(this.isuppertriangular()){if(this.islowertriangular())return Me.diagm(this.diag().apply(f=>Math.abs(f)>Number.EPSILON?1/f:x));const l=Me.eye(e),s=Me.eye(e),a=this.t(),o=a.v[(e-1)*e+(e-1)],c=e-1;for(let f=0;f<e;f++)s.v[c*e+f]=l.v[c*e+f]/o;for(let f=e-2;f>=0;f--){let u=l.getcolumn(f+1);const d=a.getcolref(f+1);for(let v=f+1;v<e;v++){const h=s.getcolumn(v+1);u=u.subtract(h.mult(d[v]))}s.v.set(u.divide(d[f]).v,f*e)}return s.t()}if(this.islowertriangular()){const l=this.diag();if(bs(l)<Number.EPSILON)throw Error("inv: the matrix is not invertible.");const s=Me.eye(e),a=Me.eye(e),o=this.t(),c=0,f=o.v[0];for(let u=0;u<e;u++)a.v[c*e+u]=s.v[c*e+u]/f;for(let u=1;u<e;u++){let d=s.getcolumn(u+1);const v=o.getcolref(u+1);for(let h=0;h<u;h++){const m=a.getcolumn(h+1);d=d.subtract(m.mult(v[h]))}a.v.set(d.divide(v[u]).v,u*e)}return a.t()}const t=ko(this);if(!t.R.isuppertriangular())throw Error("inv: QR decomposition of the matrix returned incorrect result.");return t.R.inv().dot(t.Q.t())}islowertriangular(){if(this.nrows!==this.ncols)return!1;for(let e=1;e<this.ncols;e++)for(let t=0;t<e;t++)if(Math.abs(this.v[e*this.nrows+t])>Me.TOLERANCE)return!1;return!0}isuppertriangular(){if(this.nrows!==this.ncols)return!1;for(let e=0;e<this.ncols;e++)for(let t=e+1;t<this.nrows;t++)if(Math.abs(this.v[e*this.nrows+t])>Me.TOLERANCE)return!1;return!0}diag(){const e=Math.min(this.nrows,this.ncols),t=new Float64Array(e);for(let l=0;l<e;l++)t[l]=this.getcolref(l+1)[l];return new ze(t)}t(){const e=this.nrows,t=this.ncols,l=new Me.valuesConstructor(this.v.length);if(this.ncols<this.nrows){for(let s=0;s<this.ncols;s++){const a=this.v.subarray(s*this.nrows,(s+1)*this.nrows);for(let o=0;o<this.nrows;o++)l[o*t+s]=a[o]}return new Me(l,t,e)}for(let s=0;s<this.nrows;s++){const a=l.subarray(s*t,(s+1)*t);for(let o=0;o<this.ncols;o++)a[o]=this.v[o*this.nrows+s]}return new Me(l,t,e)}dot(e){if(Fe(e))return new Me(Es(this.v,e.v,this.nrows,this.ncols,e.length,1),this.nrows,1);if(tr(e))return new Me(Es(this.v,e.v,this.nrows,this.ncols,e.nrows,e.ncols),this.nrows,e.ncols);throw Error("dot: argument 'X' must be a matrix or a vector.")}op(e,t,l){if(tr(e))return new Me(xs(this.v,e.v,t),this.nrows,this.ncols);if(Eo(e))return new Me(ks(this.v,e,t),this.nrows,this.ncols);if(!Fe(e))throw new Error('op: argument "x" must be a matrix, a vector or a number.');if(l===void 0&&(l=e.length===this.ncols?2:1),l===2&&e.length===this.ncols){const s=new Me.valuesConstructor(this.v.length);for(let a=0;a<this.ncols;a++)s.set(ks(this.getcolref(a+1),e.v[a],t),a*this.nrows);return new Me(s,this.nrows,this.ncols)}if(l===1&&e.length===this.nrows){const s=new Me.valuesConstructor(this.v.length);for(let a=0;a<this.ncols;a++)s.set(xs(this.getcolref(a+1),e.v,t),a*this.nrows);return new Me(s,this.nrows,this.ncols)}throw new Error('op: length of vector "X" does not match number of rows nor number of columns of the maytrix.')}add(e){return this.op(e,(t,l)=>t+l)}subtract(e){return this.op(e,(t,l)=>t-l)}mult(e){return this.op(e,(t,l)=>t*l)}divide(e){return this.op(e,(t,l)=>t/l)}apply(e,t){if(t===void 0&&(t=2),t==2){const l=this.ncols,s=new Me.valuesConstructor(l);for(let a=0;a<l;a++)s[a]=e(this.getcolref(a+1));return new ze(s)}if(t==1)return this.t().apply(e,2);if(t==0){const l=this.v.length,s=new Me.valuesConstructor(l);for(let a=0;a<l;a++)s[a]=e(this.v[a]);return new Me(s,this.nrows,this.ncols)}}replace(e,t,l){typeof t=="number"&&(t=[t]),t.length===0&&(t=dt.seq(1,this.nrows)),sr(t)||(t=ar(t)),typeof l=="number"&&(l=[l]),l.length===0&&(l=dt.seq(1,this.ncols)),sr(l)||(l=ar(l));const s=t.length,a=l.length;if(Ht(t)<1||er(t)>this.nrows)throw Error("Matrix.replace: row indices do not match the dimension of matrix.");if(Ht(l)<1||er(l)>this.ncols)throw Error("Matrix.replace: column indices do not match the dimension of matrix.");if(e.nrows!==s||e.ncols!==a)throw Error('Matrix.replace: dimension of "X" does not match the indices.');for(let o=0;o<l.length;o++){const c=e.getcolref(o+1),f=(l.v[o]-1)*this.nrows;for(let u=0;u<t.length;u++){const d=t.v[u];this.v[f+d-1]=c[u]}}return this}copy(){return new Me(this.v.slice(),this.nrows,this.ncols)}getrow(e){if(e<1||e>this.nrows)throw Error("getrow: wrong row index.");const t=new ze.valuesConstructor(this.ncols);for(let l=0;l<this.ncols;l++)t[l]=this.getcolref(l+1)[e-1];return new ze(t)}getcolumn(e){if(e<1||e>this.ncols)throw Error("getcolumn: wrong column index.");return new ze(this.v.slice((e-1)*this.nrows,e*this.nrows))}getcolref(e){return this.v.subarray((e-1)*this.nrows,e*this.nrows)}subset(e,t){if(typeof e=="number"&&(e=ar([e])),typeof t=="number"&&(t=ar([t])),Array.isArray(e)&&(e=e.length===0?null:ar(e)),Array.isArray(t)&&(t=t.length===0?null:ar(t)),e!==null&&!sr(e))throw Error('subset: parameter "rind" can be a number, null or instance of Index.');if(t!==null&&!sr(t))throw Error('subset: parameter "cind" can be a number, null or instance of Index.');if(e!==null&&(Ht(e)<1||er(e)>this.nrows))throw Error('subset: parameter "rind" does not match size of the matrix.');if(t!==null&&(Ht(t)<1||er(t)>this.ncols))throw Error('subset: parameter "cind" does not match size of the matrix.');if(e===null){const c=t.length,f=this.nrows,u=new Me.valuesConstructor(f*c);for(let d=0;d<t.length;d++)u.set(this.v.slice((t.v[d]-1)*this.nrows,t.v[d]*this.nrows),d*this.nrows);return new Me(u,f,c)}if(t==null)return this.t().subset(t,e).t();const l=e.length,s=t.length,a=new Me.valuesConstructor(l*s);let o=new Me.valuesConstructor(l);for(let c=0;c<s;c++){const f=this.v.subarray((t.v[c]-1)*this.nrows,t.v[c]*this.nrows);for(let u=0;u<l;u++)o[u]=f[e.v[u]-1];a.set(o,c*l)}return new Me(a,l,s)}toString(e){function t(o,c){return" ".repeat(c-o.length)+o}e===void 0&&(e=2),this.ncols;const l=Math.round(Math.abs(Math.log10(er(this.v))))+e+3;let s="";const a=this.t();for(let o=1;o<=a.ncols;o++)s+=Array.from(a.getcolref(o)).map(c=>t(c.toFixed(e),l)).join(" ")+`
`;return s}toCSV(e,t,l,s){e===void 0&&(e=","),t===void 0&&(t=e===";"?",":".");const a=s!=null&&s.length>0,o=l!=null&&l.length>0;if(a&&s.length!==this.nrows)throw Error("Matrix.toCSV: number of elements in labels array must match number of rows in the matrix.");if(o&&l.length!==this.ncols+(a?1:0))throw Error("Matrix.toCSV: number of elements in header must match number of columns in the matrix.");const c=this.t();let f=o?l.join(e)+`
`:"";for(let u=1;u<=c.ncols;u++)f=f+(a?s[u-1]+e:"")+c.getcolref(u).join(e)+`
`;return f=f.replace(/\./g,t),f}static randn(e,t,l,s){return Ao(_o(e*t,l,s),e,t)}static rand(e,t,l,s){return Ao(bo(e*t,l,s),e,t)}static eye(e,t){t===void 0&&(t=e);const l=new Float64Array(e*t);for(let s=0;s<Math.min(e,t);s++)l[s*e+s]=1;return new Me(l,e,t)}static diagm(e){if(!Fe(e))throw Error('diagm: the argument "x" must be a Vector.');const t=e.length,l=new Float64Array(t*t);for(let s=0;s<t;s++)l[s*t+s]=e.v[s];return new Me(l,t,t)}static zeros(e,t){return t===void 0&&(t=e),new Me(new Float64Array(e*t),e,t)}static ones(e,t){return Me.fill(1,e,t)}static fill(e,t,l){l===void 0&&(l=t);const s=new Float64Array(t*l);for(let a=0;a<s.length;a++)s[a]=e;return new Me(s,t,l)}static outer(e,t,l){if(Array.isArray(e)&&(e=Ye(e)),Array.isArray(t)&&(t=Ye(t)),!Fe(e))throw Error('Matrix.outer: parameter "x" must be a vector or an array with numbers.');if(!Fe(t))throw Error('Matrix.outer: parameter "y" must be a vector or an array with numbers.');const s=Me.zeros(e.length,t.length);for(let a=0;a<t.length;a++){const o=t.v[a],c=s.getcolref(a+1);for(let f=0;f<e.length;f++)c[f]=l(e.v[f],o)}return s}static parseCSV(e,t,l,s){function a(b){return b.some(_=>Number.isNaN(Number.parseFloat(_.trim())))}t===void 0&&(t=",");const o=t===";"?",":".";e=e.replace(/^\uFEFF/gm,"").replace(/^\u00EF?\u00BB\u00BF/gm,""),e=e.replace(/\r/gm,"");let c=e.split(/\n/),f=[],u=0;const d=c[0].split(t);(l||l===void 0&&a(d))&&(f=d,u=1),c=c.filter(b=>b.trim().length>1);let v=[],h=0;s&&(h=1);const m=c.length-u,p=d.length-h;if(m<1)throw Error("Data file should contain at least 1 row with values.");if(p<1)throw Error("Data file should contain at least 1 column with values.");const w=Me.zeros(p,m);for(let b=u;b<m+u;b++){const _=c[b].split(t);let S;if(s?(v[b-u]=_[0],S=_.slice(1).map(y=>Number.parseFloat(y.trim().replace(o,".")))):S=_.map(y=>Number.parseFloat(y.trim().replace(o,"."))),S.some(y=>Number.isNaN(y)))throw Error("Some of the values can not be converted to numbers, check your CSV file and try again.");if(S.length!=p)throw Error("Wrong number of values in row #"+b);w.v.set(new Float64Array(S),(b-u)*p)}return{values:w.t(),header:f,labels:v,sep:t,dec:o}}};xr(Me,"valuesConstructor",Float64Array),xr(Me,"TOLERANCE",Math.pow(10,-9));let $e=Me;function Fe(n){return n&&n.constructor===ze}function Ye(n){return new ze(new Float64Array(n))}const it=class it{constructor(e){if(!ArrayBuffer.isView(e)||e.constructor!==Float64Array)throw Error('Vector: parameter "values" must be Float64Array.');this.v=e,this.length=e.length}which(e){const t=new dt.valuesConstructor(this.length);let l=0;for(let s=0;s<this.length;s++)e(this.v[s],s)&&(t[l]=s+1,l=l+1);return new dt(t.subarray(0,l))}filter(e){const t=new it.valuesConstructor(this.length);let l=0;for(let s=0;s<this.length;s++)e(this.v[s],s)&&(t[l]=this.v[s],l=l+1);return new it(t.subarray(0,l))}shuffle(){return new it(Lo(this.v))}sort(e){return new it(No(this.v,e))}sortind(e){return new dt(zo(this.v,e))}rep(e){return To(this,e)}repeach(e){return Po(this,e)}replace(e,t){typeof t=="number"&&(t=[t]),t.length===0&&(t=dt.seq(1,this.length)),sr(t)||(t=ar(t));const l=t.length;if(Ht(t)<1||er(t)>this.length)throw Error("Vector.replace: indices do not match the lenght of the vector.");if(e.length!==l)throw Error('Vector.replace: length of "x" does not match the indices.');for(let s=0;s<t.length;s++){const a=t.v[s];this.v[a-1]=e.v[s]}return this}subset(e){if(typeof e=="number"&&(e=ar([e])),Array.isArray(e)&&(e=typeof e[0]=="boolean"?dt.bool2ind(e):ar(e)),!sr(e))throw Error('subset: parameter "ind" must be number, array of instance of class Index.');const t=e.length,l=it.zeros(t);for(let s=0;s<t;s++){if(e.v[s]<1)throw Error("subset: indices must start with 1 (not 0).");if(e.v[s]>this.length)throw Error("subset: index exceeds the length of the vector.");l.v[s]=this.v[e.v[s]-1]}return l}slice(e,t){if(e===null&&(e=1),t==null&&(t=this.length),e<1)throw Error("slice: indices must start with 1 (not 0).");if(t>this.length)throw Error("slice: index exceeds the length of the vector.");if(t<e)throw Error('slice: "end" must not be smaller than "start".');return new it(this.v.slice(e-1,t))}copy(){return new it(this.v.slice())}dot(e){return e===void 0&&(e=this),Es(this.v,e.v,1,this.length,e.length,1)[0]}op(e,t){if(Fe(e))return new it(xs(this.v,e.v,t));if(Eo(e))return new it(ks(this.v,e,t));throw new Error('op: argument "x" must be a vector or a number.')}add(e){return this.op(e,(t,l)=>t+l)}subtract(e){return this.op(e,(t,l)=>t-l)}mult(e){return this.op(e,(t,l)=>t*l)}divide(e){return this.op(e,(t,l)=>t/l)}apply(e){const t=this.v.length,l=it.zeros(t);for(let s=0;s<t;s++)l.v[s]=e(this.v[s]);return l}static c(...e){if(e.length===1)return e[0];const t=e.reduce((a,o)=>a+(typeof o=="number"?1:o.length),0),l=new it.valuesConstructor(t);let s=0;for(const a of e)typeof a=="number"?(l[s]=a,s+=1):(l.set(Fe(a)?a.v:new it.valuesConstructor(a),s),s+=typeof a=="number"?1:a.length);return new it(l)}static seq(e,t,l){return Co(e,t,l,it)}static randn(e,t,l){return _o(e,t,l)}static rand(e,t,l){return bo(e,t,l)}static zeros(e){return new it(new it.valuesConstructor(e))}static ones(e){return it.fill(1,e)}static fill(e,t){const l=new it.valuesConstructor(t);for(let s=0;s<l.length;s++)l[s]=e;return new it(l)}};xr(it,"valuesConstructor",Float64Array);let ze=it;function sr(n){return n.constructor===dt}function ar(n){return new dt(new Int32Array(n))}const wt=class wt{constructor(e){if(!ArrayBuffer.isView(e)||e.constructor!==Int32Array)throw Error('Index: parameter "values" must be Int32Array.');this.v=e,this.length=e.length}which(e){const t=new wt.valuesConstructor(this.length);let l=0;for(let s=0;s<this.length;s++)e(this.v[s],s)&&(t[l]=s+1,l=l+1);return new wt(t.subarray(0,l))}filter(e){const t=new wt.valuesConstructor(this.length);let l=0;for(let s=0;s<this.length;s++)e(this.v[s],s)&&(t[l]=this.v[s],l=l+1);return new wt(t.subarray(0,l))}shuffle(){return new wt(Lo(this.v))}sort(e){return new wt(No(this.v,e))}sortind(e){return new wt(zo(this.v,e))}rep(e){return To(this,e)}repeach(e){return Po(this,e)}subset(e){if(typeof e=="number"&&(e=ar([e])),Array.isArray(e)&&(e=ar(e)),!sr(e))throw Error('subset: parameter "ind" must be number, array of instance of class Index.');const t=e.length,l=new wt.valuesConstructor(t);for(let s=0;s<t;s++){if(e.v[s]<1)throw Error("subset: indices must start with 1 (not 0).");if(e.v[s]>this.length)throw Error("subset: index exceeds the length of the vector.");l[s]=this.v[e.v[s]-1]}return new wt(l)}slice(e,t){if(e===null&&(e=1),t==null&&(t=this.length),e<1)throw Error("slice: indices must start with 1 (not 0).");if(t>this.length)throw Error("slice: index exceeds the length of the vector.");if(t<e)throw Error('slice: "end" must not be smaller than "start".');return new wt(this.v.slice(e-1,t))}static seq(e,t,l){return Co(e,t,l,wt)}static ones(e){return wt.fill(1,e)}static fill(e,t){const l=new wt.valuesConstructor(t);for(let s=0;s<l.length;s++)l[s]=e;return new wt(l)}static bool2ind(e){let t=0;const l=new wt.valuesConstructor(e.length);for(let s=0;s<e.length;s++)e[s]&&(l[t]=s+1,t=t+1);return new wt(l.subarray(0,t))}};xr(wt,"valuesConstructor",Int32Array);let dt=wt;function Co(n,e,t,l){t===void 0&&(t=n<=e?1:-1);const s=Math.floor((e-n)/t)+1;if(s<1)throw Error("seq: wrong combination of parameters.");const a=new l.valuesConstructor(s);for(let o=0;o<s;o++)a[o]=n+o*t;return new l(a)}function To(n,e){const t=n.length*e,l=new n.constructor.valuesConstructor(t);for(let s=1;s<=e;s++)for(let a=0;a<n.length;a++)l[(s-1)*n.length+a]=n.v[a];return new n.constructor(l)}function Po(n,e){if(e<1||Math.round(e)!==e)throw Error('rep: parameter "n" must be an integer number > 1.');const t=n.length*e,l=new n.constructor.valuesConstructor(t);for(let s=0;s<n.length;s++)for(let a=0;a<e;a++)l[s*e+a]=n.v[s];return new n.constructor(l)}function xs(n,e,t){if(n.length!==e.length)throw new Error("_opvv: arrays sizes do not match.");if(n.constructor!==e.constructor)throw new Error("_opvv: array types do not match.");const l=new n.constructor(n.length);for(let s=0;s<n.length;s++)l[s]=t(n[s],e[s]);return l}function ks(n,e,t){const l=new n.constructor(n.length);for(let s=0;s<n.length;s++)l[s]=t(n[s],e);return l}function Es(n,e,t,l,s,a){if(l!==s)throw Error("_dot: matrix dimensions do not much.");const o=t,c=a,f=l,u=new n.constructor(o*c);for(let d=0;d<c;d++){const v=e.subarray(d*s,(d+1)*s),h=u.subarray(d*o,(d+1)*o);for(let m=0;m<f;m++){const p=v[m],w=n.subarray(m*t,(m+1)*t);for(let b=0;b<o;b++)h[b]+=w[b]*p}}return u}function Lo(n){let e=n.slice(),t=e.length,l,s;for(;t;)s=Math.floor(Math.random()*t--),l=e[t],e[t]=e[s],e[s]=l;return e}function No(n,e=!1){return e?n.slice().sort((t,l)=>l-t):n.slice().sort((t,l)=>t-l)}function zo(n,e=!1){const t=dt.seq(1,n.length).v;return e?t.sort((l,s)=>n[s-1]-n[l-1]):t.sort((l,s)=>n[l-1]-n[s-1])}function Fu(n,e,t){if(!n||!n.class||!n.class.includes("pcamodel"))throw new Error('pcamodel_get: parameter "m" must be JSON with PCA model.');const l=n.ncols,s=n.ncomp;let a,o;switch(e){case"mX":a=2,o=l;break;case"sX":a=2+l,o=l;break;case"loadings":case"xloadings":a=2+2*l+(t-1)*l,o=l;break;case"P":a=2+2*l,o=t*l;break;case"eigenvals":case"xeigenvals":a=2+2*l+l*s,o=s;break;case"cq0":a=2+2*l+l*s+s,o=s;break;case"cNq":a=2+2*l+l*s+2*s,o=s;break;case"rq0":a=2+2*l+l*s+3*s,o=s;break;case"rNq":a=2+2*l+l*s+4*s,o=s;break;case"ch0":a=2+2*l+l*s+5*s,o=s;break;case"cNh":a=2+2*l+l*s+6*s,o=s;break;case"rh0":a=2+2*l+l*s+7*s,o=s;break;case"rNh":a=2+2*l+l*s+8*s,o=s;break;case"cr0":a=2+2*l+l*s+9*s,o=s;break;case"cNr":a=2+2*l+l*s+10*s,o=s;break;case"rr0":a=2+2*l+l*s+11*s,o=s;break;case"rNr":a=2+2*l+l*s+12*s,o=s;break;case"cg0":a=2+2*l+l*s+13*s,o=s;break;case"cNg":a=2+2*l+l*s+14*s,o=s;break;case"rg0":a=2+2*l+l*s+15*s,o=s;break;case"rNg":a=2+2*l+l*s+16*s,o=s;break;default:throw Error("pcamodel_get: wrong outcome name.")}return n.v.subarray(a,a+o)}function Mo(n,e,t){if(!n||!n.class||!n.class.includes("pcares"))throw new Error('pcares_get: parameter "r" must be JSON with PCA results.');const l=n.ncols,s=n.nrows,a=n.ncomp;let o,c;switch(e){case"scores":case"xscores":o=(t-1)*s,c=s;break;case"hdist":o=s*a+(t-1)*s,c=s;break;case"qdist":o=2*s*a+(t-1)*s,c=s;break;case"xcumexpvar":case"cumexpvar":o=3*s*a,c=a;break;case"fdistc":o=3*s*a+a+(t-1)*s,c=s;break;case"fdistr":o=4*s*a+a+(t-1)*s,c=s;break;case"gdist":o=5*s*a+a+(t-1)*l,c=l;break;case"rdist":o=5*s*a+a+l*a+(t-1)*l,c=l;break;case"idistc":o=5*s*a+a+2*l*a+(t-1)*l,c=l;break;case"idistr":o=5*s*a+a+3*l*a+(t-1)*l,c=l;break;default:throw new Error("pcares_get: wrong outcome name.")}return n.v.subarray(o,o+c)}function ju(n,e,t,l){return n*t+n*t+n*t+t+n*e*t+n*t+n*t+t+e*t+e*t+e*t+e*t+n*l}function Ro(n,e,t){return 3+2*(n+e)+n*t+1*t+4*t+4*t+4*t+n*t+e*t+1*t}function Tl(n,e,t){if(!Array.isArray(n))return!1;if(n.length===0)return!0;for(let l=0;l<n.length;l++){const s=n[l];if(s<e||s>t)return!1}return!0}function zt(n,e,t){if(!n||!n.class||!n.class.includes("plsmodel"))throw new Error('plsmodel_get: parameter "m" must be JSON with PLS model.');const l=n.npred,s=n.nresp,a=n.ncomp;let o,c=Ro(l,s,a)-l*a-s*a-2*s;switch(e){case"mY":c=3,o=s;break;case"mX":c=3+s,o=l;break;case"sY":c=3+s+l,o=s;break;case"sX":c=3+s+l+s,o=l;break;case"P":c=3+2*(s+l),o=a*l;break;case"loadings":case"xloadings":c=3+2*(s+l)+(t-1)*l,o=l;break;case"eigenvals":case"xeigenvals":c=3+2*(s+l)+a*l,o=a;break;case"cq0":c=3+2*(s+l)+a*l+a,o=a;break;case"cNq":c=3+2*(s+l)+a*l+2*a,o=a;break;case"rq0":c=3+2*(s+l)+a*l+3*a,o=a;break;case"rNq":c=3+2*(s+l)+a*l+4*a,o=a;break;case"ch0":c=3+2*(s+l)+a*l+5*a,o=a;break;case"cNh":c=3+2*(s+l)+a*l+6*a,o=a;break;case"rh0":c=3+2*(s+l)+a*l+7*a,o=a;break;case"rNh":c=3+2*(s+l)+a*l+8*a,o=a;break;case"cz0":c=3+2*(s+l)+a*l+9*a,o=a;break;case"cNz":c=3+2*(s+l)+a*l+10*a,o=a;break;case"rz0":c=3+2*(s+l)+a*l+11*a,o=a;break;case"rNz":c=3+2*(s+l)+a*l+12*a,o=a;break;case"weights":c=3+2*(s+l)+a*l+13*a+(t-1)*l,o=l;break;case"yloadings":c=3+2*(s+l)+a*l+13*a+a*l+(t-1)*s,o=s;break;case"yeigenvals":c=3+2*(s+l)+a*l+13*a+a*l+a*s,o=a;break;default:throw Error("plsmodel_get: wrong outcome name.")}return n.v.subarray(c,c+o)}function Et(n,e,t,l){if(!n||!n.class||!n.class.includes("plsres"))throw new Error('plsres_get: parameter "r" must be JSON with PLS results.');l||(l=1);const s=n.nrows,a=n.ncomp,o=n.nresp,c=n.npred,f=n.nresp_model;let u,d=3*s*a+a;switch(e){case"Yp":d=d+(t-1)*f*s+(l-1)*s,u=s;break;case"yscores":d=d+a*f*s+(t-1)*s,u=s;break;case"zdist":d=d+a*f*s+a*s+(t-1)*s,u=s;break;case"ycumexpvar":d=d+a*f*s+a*s+a*s,u=a;break;case"rmse":d=d+a*f*s+a*s+a*s+a,u=f*a;break;case"r2":d=d+a*f*s+a*s+a*s+a+o*a,u=f*a;break;case"bias":d=d+a*f*s+a*s+a*s+a+2*o*a,u=f*a;break;case"slope":d=d+a*f*s+a*s+a*s+a+3*o*a,u=f*a;break;case"E":d=d+a*f*s+a*s+a*s+a+4*o*a,u=s*c;break;case"T":d=0,u=s*a;break;default:return Mo(n,e,t)}return n.v.subarray(d,d+u)}function Vu(n,e,t,l,s,a,o,c){if(!tr(e))throw new Error("pls_fit: D must be a matrix.");if(t<1||e.ncols<2+t)throw new Error("pls_fit: training set should have at least 2 predictors and 1 response.");o||(o=[]);const f=o&&Array.isArray(o)?o.length:0;if(!Tl(o,0,e.nrows-1))throw new Error('pls_fit: some indices in "outliers" array are outside the expected range.');c||(c=[]);const u=c&&Array.isArray(c)?c.length:0;if(!Tl(c,0,e.ncols-t-1))throw new Error('pls_fit: some indices in "exclvars" array are outside the expected range.');const d=e.nrows-f,v=e.ncols-t-u;if(d<3||v<2)throw new Error("pls_fit: X must have at least 3 rows and 2 predictors.");if(s===void 0&&(s=!0),a===void 0&&(a=!1),l===void 0&&(l=Math.min(d-1,v)),l<1||l>Math.min(d-1,v))throw new Error('pls_fit: the value of "ncomp" does not match the dimension of D.');const h=n._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);n.HEAPF64.set(e.v,h/e.v.BYTES_PER_ELEMENT);let m=null;if(f>0){const R=new Int32Array(o);m=n._malloc(R.length*R.BYTES_PER_ELEMENT),n.HEAP32.set(R,m/R.BYTES_PER_ELEMENT)}let p=null;if(u>0){const R=new Int32Array(c);p=n._malloc(R.length*R.BYTES_PER_ELEMENT),n.HEAP32.set(R,p/R.BYTES_PER_ELEMENT)}const w=Ro(v,t,l),b=Float64Array,_=n._malloc(w*b.BYTES_PER_ELEMENT),S=v*t*l,y=Float64Array,A=n._malloc(S*b.BYTES_PER_ELEMENT),L=n._malloc(S*b.BYTES_PER_ELEMENT),k=n._malloc(S*b.BYTES_PER_ELEMENT);if(n.ccall("plsfit_wasm",["number"],["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"],[h,e.nrows,e.ncols-t,t,l,s,a,_,m,f,p,u,L,A,k])!==1)throw new Error("pls_fit: unexpected error.");const N=n.HEAPF64.slice(_/b.BYTES_PER_ELEMENT,_/b.BYTES_PER_ELEMENT+w),F=n.HEAPF64.slice(L/y.BYTES_PER_ELEMENT,L/y.BYTES_PER_ELEMENT+S),M=n.HEAPF64.slice(A/y.BYTES_PER_ELEMENT,A/y.BYTES_PER_ELEMENT+S),T=n.HEAPF64.slice(k/y.BYTES_PER_ELEMENT,k/y.BYTES_PER_ELEMENT+S);return n._free(h),n._free(_),n._free(L),n._free(A),n._free(k),m&&n._free(m),p&&n._free(p),{class:["plsmodel","pcamodel"],v:N,ncomp:l,nrows:d,npred:v,nresp:t,exclvars:c,center:s,scale:a,coeffs:F,vip:M,sr:T}}function Ou(n,e,t,l,s){if(!e||!e.class||!e.class.includes("plsmodel"))throw new Error('pls_predict: parameter "m" must be JSON with PLS results.');if(!tr(t))throw new Error("pls_predict: D must be a matrix.");s||(s=[]);const a=s&&Array.isArray(s)?s.length:0;if(!Tl(s,0,t.nrows-1))throw new Error('pls_predict: some indices in "outliers" array are outside the expected range.');let o=e.exclvars.length;e.exclvars;const c=t.nrows-a;t.ncols-l===e.npred&&(o=0);const f=t.ncols-o-l;if(c<1)throw new Error("pls_predict: D must have at least 1 row.");if(f!==e.npred)throw new Error("pls_predict: D must have the same number of predictors (without excluded ones) as the training set.");const u=n._malloc(t.v.length*t.v.BYTES_PER_ELEMENT);n.HEAPF64.set(t.v,u/t.v.BYTES_PER_ELEMENT);let d=null;if(a>0){const V=new Int32Array(s);d=n._malloc(V.length*V.BYTES_PER_ELEMENT),n.HEAP32.set(V,d/V.BYTES_PER_ELEMENT)}let v=null;if(o>0){const V=new Int32Array(e.exclvars);v=n._malloc(V.length*V.BYTES_PER_ELEMENT),n.HEAP32.set(V,v/V.BYTES_PER_ELEMENT)}const h=n._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);n.HEAPF64.set(e.v,h/e.v.BYTES_PER_ELEMENT);const m=ju(c,e.nresp,e.ncomp,e.npred),p=Float64Array,w=n._malloc(m*p.BYTES_PER_ELEMENT);if(n.ccall("plspredict_wasm",["number"],["number","number","number","number","number","number","number","number","number","number","number"],[u,t.nrows,t.ncols-l,l,h,w,d,a,v,o])!==1)throw new Error("pls_predict: unexpected error.");const _=n.HEAPF64.slice(w/p.BYTES_PER_ELEMENT,w/p.BYTES_PER_ELEMENT+m);n._free(u),n._free(h),n._free(w),d&&n._free(d),v&&n._free(v);const S={class:["plsres","pcares"],v:_,ncomp:e.ncomp,nrows:c,npred:f,nresp:l,nresp_model:e.nresp,outliers:s,exclvars:e.exclvars,center:e.center,scale:e.scale},y=new Array(e.ncomp),A=new Array(e.ncomp),L=new Array(e.ncomp),k=new Array(e.ncomp),C=new Array(e.ncomp),N=new Array(e.ncomp),F=new Array(e.ncomp),M=new Array(e.ncomp),T=new Array(e.ncomp),R=Et(S,"xcumexpvar"),D=Et(S,"ycumexpvar");if(l>0){y[0]=1,C[0]=R[0],k[0]=1-R[0],A[0]=R[0],L[0]=1-R[0],T[0]=D[0],M[0]=1-D[0],N[0]=D[0],F[0]=1-D[0];for(let I=1;I<e.ncomp;I++)y[I]=I+1,C[I]=R[I],k[I]=1-R[I],A[I]=R[I]-R[I-1],L[I]=1-A[I],T[I]=D[I],M[I]=1-D[I],N[I]=D[I]-D[I-1],F[I]=1-N[I];const V=new $e(Et(S,"rmse"),e.nresp,e.ncomp),P=new $e(Et(S,"r2"),e.nresp,e.ncomp),Y=new $e(Et(S,"slope"),e.nresp,e.ncomp),Z=new $e(Et(S,"bias"),e.nresp,e.ncomp);S.stat={components:y,xresvar:L,xexpvar:A,xcumexpvar:C,xcumresvar:k,yresvar:F,yexpvar:N,ycumexpvar:T,ycumresvar:M,rmse:V.t(),r2:P.t(),slope:Y.t(),bias:Z.t()}}else S.stat=null;return S}function Bu(n,e,t,l,s,a,o,c,f){if(!e||!e.class||!e.class.includes("plsmodel"))throw new Error('pcvpls: parameter "m" must be JSON with PLS model.');if(!tr(t))throw new Error("pcvpls: D must be a matrix.");if(l<1)throw new Error("pcvpls: D must have at least one response.");f||(f=[]);const u=f&&Array.isArray(f)?f.length:0;if(!Tl(f,0,t.nrows-1))throw new Error('pca_predict: some indices in "outliers" array are outside the expected range.');const d=e.exclvars.length,v=t.nrows-u,h=t.ncols-l-d;if(v<3)throw new Error("plspcv: D must have at least 3 rows.");if(h<2)throw new Error("plspcv: D must have at least 2 predictors.");if(!Number.isInteger(o)||![0,1,2].includes(o))throw new Error('plspcv: parameter "cv_type" must be one of 0 ("loo"), 1 ("ven"), 2 ("rand).');if(!Number.isInteger(c)||![0,1].includes(c))throw new Error('plspcv: parameter "cv_scope" must be 0 ("global") or 1 ("local").');if(o>0&&(!Number.isInteger(a)||a<2))throw new Error('plspcv: parameter "cv_nseg" must be a number ≥ 2.');if(o>0&&a>v)throw new Error('plspcv: the value of "cv_nseg" is too large for the given X.');if(o===0&&(a=v),!Number.isInteger(s)||s<1)throw new Error('plspcv: the value of "ncomp" must be a number >= 1.');const m=Math.min(o===0?v-2:v-Math.ceil(v/a)-1,h,e.ncomp);if(s>m)throw new Error('pcapcv: the value of "ncomp" is too large.');const p=n._malloc(t.v.length*t.v.BYTES_PER_ELEMENT);n.HEAPF64.set(t.v,p/t.v.BYTES_PER_ELEMENT);let w=null;if(u>0){const T=new Int32Array(f);w=n._malloc(T.length*T.BYTES_PER_ELEMENT),n.HEAP32.set(T,w/T.BYTES_PER_ELEMENT)}let b=null;if(d>0){const T=new Int32Array(e.exclvars);b=n._malloc(T.length*T.BYTES_PER_ELEMENT),n.HEAP32.set(T,b/T.BYTES_PER_ELEMENT)}const _=n._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);n.HEAPF64.set(e.v,_/e.v.BYTES_PER_ELEMENT);const S=t.v.constructor,y=v*(l+h),A=n._malloc(y*S.BYTES_PER_ELEMENT),L=a*s,k=t.v.constructor,C=n._malloc(L*k.BYTES_PER_ELEMENT);if(n.ccall("pcvpls_wasm",["number"],["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"],[p,t.nrows,t.ncols-l,l,s,e.center,e.scale,o,a,c,_,A,C,w,u,b,d])!==1)throw new Error("plspcv: unexpected error.");const F=n.HEAPF64.slice(A/S.BYTES_PER_ELEMENT,A/S.BYTES_PER_ELEMENT+y),M=n.HEAPF64.slice(C/k.BYTES_PER_ELEMENT,C/k.BYTES_PER_ELEMENT+L);return n._free(p),n._free(_),n._free(A),n._free(C),w&&n._free(w),b&&n._free(b),[new $e(F,v,l+h),new $e(M,a,s)]}function qu(n,e){if(e[0]===0){const t=e[1]+2;return 2+t+n*t+2*n+t}return 3+n}const Br=[{id:"norm",title:"Normalization",mpl:2,get_mpl_new:(n,e)=>2,mp:[0,0]},{id:"savgol",title:"Savitzky-Golay",mpl:3,get_mpl_new:(n,e)=>e[0]*e[0],mp:[3,1,0]},{id:"scale",title:"Scaling",mpl:2,get_mpl_new:(n,e)=>2*n,mp:[1,0]},{id:"baseline",title:"Baseline",mpl:3,get_mpl_new:qu,mp:[0,0,0]},{id:"trim",title:"Trim tails",mpl:2,get_mpl_new:(n,e)=>2,mp:[0,0]},{id:"spikes",title:"Spike removal",mpl:2,get_mpl_new:(n,e)=>2+3*n+e[0],mp:[5,5]}];function Yu(n){let e="<ul>";for(let t=0;t<n.ml.length;t++){const l=Br[n.ml[t]].title;e=e+"<li>"+l+" <span>"+n.info[t]+"</span></li>"}return e=e+"</ul>",e}function Io(n,e,t){const l=Br.findIndex(v=>v.id==="trim");let s=0,a=n.ncols-e,o=0;for(let v=0;v<t.ml.length;v++){if(t.ml[v]!==l){o+=t.mpl_new[v];continue}s=Math.max(s,t.mp_new[o]),a=Math.min(a,t.mp_new[o+1]),o+=t.mpl_new[v]}const c=n.nrows,u=a-s+e,d=$e.zeros(c,u);return o=0,e>0&&(d.v.set(n.v.slice(0,e*c),o),o+=e*c),d.v.set(n.v.slice((e+s)*c,(e+a)*c),o),[s,a,d]}function Du(n,e){if(!n||!e||typeof e!="object"||Object.keys(e).length===0)return n;const t=Br.findIndex(c=>c.id==="trim");if(e.ml.findIndex(c=>c===t)<0)return n;const[s,a,o]=Io(n.values,n.nresp,e);return n.values=o,n.varlabels=n.nresp>0?n.varlabels.slice(0,n.nresp).concat(n.varlabels.slice(n.nresp+s,n.nresp+a)):n.varlabels.slice(s,a),n.varindices=n.nresp>0?an(0,n.nresp-1).concat(an(0,a-s-1)):an(0,a-s-1),n.varvalues=n.nresp>0?n.varvalues.slice(0,n.nresp).concat(n.varvalues.slice(n.nresp+s,n.nresp+a)):n.varvalues.slice(s,a),n}function Fo(n,e,t,l,s=!0,a=[]){if(!tr(e))throw new Error("prep: D must be a matrix.");if(!Array.isArray(l)||l.length<1)throw new Error("prep_fit: list with methods is not correct.");let o,c;s?(o=e.ncols,c=e.nrows-t):(o=e.nrows,c=e.ncols-t);const f=l.length;if(f<1)throw new Error("prep_fit: no preprocessing methods are provided.");const u=new Int32Array(f),d=new Int32Array(f),v=new Int32Array(f);let h=0,m=0;for(let R=0;R<l.length;R++){const D=l[R].id,V=l[R].params,P=Br.findIndex(Z=>Z.id==D);if(P<0)throw new Error("prep_fit: wrong method name: "+D+".");const Y=Br[P];if(V.length!==Y.mpl)throw new Error("prep_fit: wrong number of parameters for method: "+D+".");u[R]=P,d[R]=Y.mpl,v[R]=Y.get_mpl_new(c,V),h=h+d[R],m=m+v[R]}const p=new Float64Array(h);let w=0;for(let R=0;R<l.length;R++){const D=l[R].id,V=l[R].params;Br.findIndex(P=>P.id==D),p.set(V,w),w=w+d[R]}const b=n._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);n.HEAPF64.set(e.v,b/e.v.BYTES_PER_ELEMENT);const _=n._malloc(u.length*u.BYTES_PER_ELEMENT);n.HEAP32.set(u,_/u.BYTES_PER_ELEMENT);const S=n._malloc(d.length*d.BYTES_PER_ELEMENT);n.HEAP32.set(d,S/d.BYTES_PER_ELEMENT);const y=n._malloc(v.length*v.BYTES_PER_ELEMENT);n.HEAP32.set(v,y/v.BYTES_PER_ELEMENT);const A=n._malloc(p.length*p.BYTES_PER_ELEMENT);n.HEAPF64.set(p,A/p.BYTES_PER_ELEMENT);const L=n._malloc(m*p.BYTES_PER_ELEMENT),k=new Int32Array(a),C=k.length,N=n._malloc(C*k.BYTES_PER_ELEMENT);if(n.HEAP32.set(k,N/k.BYTES_PER_ELEMENT),n.ccall("prepfit_wasm",["number"],["number","number","number","number","number","number","number","number","number","number","number","number","numbers"],[b,o,c,t,f,_,S,A,y,L,s,N,C])!==1)throw new Error("prep_fit: unexpected error.");const M=n.HEAPF64.slice(L/p.BYTES_PER_ELEMENT,L/p.BYTES_PER_ELEMENT+m);return n._free(b),n._free(_),n._free(A),n._free(S),n._free(N),n._free(L),n._free(y),{ml:u,mpl:d,mp:p,mpl_new:v,mp_new:M,npred:c,class:["prepmodel"]}}function Ss(n,e,t,l,s=!0,a=!1){if(!tr(e))throw new Error("prep_apply: D must be a matrix.");let o,c;if(s?(o=e.ncols,c=e.nrows-t):(o=e.nrows,c=e.ncols-t),c!==l.npred)throw new Error("prep_apply: D has wrong number of predictors (expected "+l.npred+" got "+c+").");const f=l.ml,u=l.mpl_new,d=l.mp_new,v=u.reduce((L,k)=>L+k,0);if(!f||f.length<1||!u||u.length!==f.length||d.length!==v)throw new Error("prep_apply: wrong structure of the model object.");const h=f.length,m=n._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);n.HEAPF64.set(e.v,m/e.v.BYTES_PER_ELEMENT);const p=n._malloc(f.length*f.BYTES_PER_ELEMENT);n.HEAP32.set(f,p/f.BYTES_PER_ELEMENT);const w=n._malloc(u.length*u.BYTES_PER_ELEMENT);n.HEAP32.set(u,w/u.BYTES_PER_ELEMENT);const b=n._malloc(d.length*d.BYTES_PER_ELEMENT);n.HEAPF64.set(d,b/d.BYTES_PER_ELEMENT);const _=n._malloc(e.v.length*e.v.BYTES_PER_ELEMENT);if(n.ccall("prepapply_wasm",["number"],["number","number","number","number","number","number","number","number","number","number"],[m,o,c,t,h,p,w,b,_,s])!==1)throw new Error("prep_apply: unexpected error.");const y=n.HEAPF64.slice(_/e.v.BYTES_PER_ELEMENT,_/e.v.BYTES_PER_ELEMENT+e.v.length);n._free(m),n._free(p),n._free(w),n._free(b),n._free(_);const A=new $e(y,e.nrows,e.ncols);if(a){const[L,k,C]=Io(A,t,l);return C}return A}function an(n,e,t=1){const l=Math.round((e-n+1)/t),s=Array(l);for(let a=0;a<l;a++)s[a]=n+a*t;return s}function Wu(n,e){let t,l,s;if(e.length>0){const a=n.values.nrows,o=n.objindices,c=a-e.length;t=Array(c),l=Array(c),s=Array(c);let f=0;for(let u=0;u<a;u++)e.includes(u)||(t[f]=o[u],l[f]=n.classes[u],s[f]=n.objlabels[u],f=f+1)}else t=n.objindices,s=n.objlabels,l=n.classes;return[t,s,l]}function jo(){const n=new Date;return`${n.getFullYear()}${(n.getMonth()+1).toString().padStart(2,"0")}${n.getDate().toString().padStart(2,"0")}${n.getHours().toString().padStart(2,"0")}${n.getMinutes().toString().padStart(2,"0")}${n.getSeconds().toString().padStart(2,"0")}${n.getMilliseconds().toString().padStart(3,"0")}`}function As(n,e,t,l,s=!1){const[a,o,c]=Wu(t,l),f=s&&e.prep&&e.prep.ml&&e.prep.ml.length>0?Ss(n,t.values,t.nresp,e.prep,!1,!0):t.values,u=Ou(n,e,f,t.nresp,l);return u.hash=jo(),u.objindices=a,u.objlabels=o,u.varlabels=e.varlabels,t.nresp>0?u.Yref=l&&l.length>0?t.values.subset(a.map(d=>d+1),dt.seq(1,t.nresp)):t.values.subset(null,dt.seq(1,t.nresp)):u.Yref=null,u}function Uu(n,e="."){return Array.isArray(n)&&n.length>0?e==="."?n.map(t=>Number.parseFloat(t.trim())):n.map(t=>Number.parseFloat(t.trim().replace(e,"."))):e==="."?Number.parseFloat(n.trim()):Number.parseFloat(n.trim().replace(e,"."))}function Gn(n){return n.some(e=>Number.isNaN(e))}function on(n){return n.replace("	","").trim().replace(/^(['"])(.*)\1$/,"$2")}function Vo(n){let e=n.replace(/^\uFEFF/gm,"").replace(/^\u00EF?\u00BB\u00BF/gm,"");return e=e.replace(/\r/gm,""),e.split(/\n/).filter(t=>t.trim().length>1)}function Hu(n,e,t,l,s,a,o,c=0){if(e===void 0&&(e=","),!(e===","||e===";"))throw new Error("Values separator can be either comma or semicolon.");const f=e===";"?",":".";let u=Vo(n);if(u.length<1)throw new Error("Could not find non-empty rows with values, check your CSV file and try again.");u=u.filter(P=>P.replaceAll(e,"").trim().length>0);const d=u[0].split(e);if(d.length<2)throw new Error("Found only one column, looks like your delimiter is not correct.");let v=0,h;const m=t!=="no";(m||m===void 0&&Gn(firstRow))&&(h=d,v=1);const p=u.length-v;if(p<1)throw new Error("Data file should contain at least 1 row with values.");let w,b,_,S=Array(p);l?(w=m?on(h[0]):"",_=Array(p),b=1):(w="",_=[],b=0);let y,A=[],L;s?(y=m?on(h[b]):"",L=Array(p),b=b+1):(y="",L=[]);const k=d.length-b;if(k<1)throw new Error("Data file should contain at least 1 column with values.");const C=$e.zeros(k,p);for(let P=v;P<p+v;P++){const Y=P-v;S[Y]=Y;let Z=u[P].split(e);if(l&&(_[Y]=Z[0],Z.shift()),s){const H=Z[0];L[Y]=H,Z.shift(),(A.length===0||A.indexOf(H)<0)&&A.push(H)}const I=f==="."?Z.map((H,J)=>Number.parseFloat(H.trim())):Z.map((H,J)=>Number.parseFloat(H.trim().replace(f,".")));if(I.some(H=>Number.isNaN(H)))throw new Error("Some of the values can not be converted to numbers, check your CSV file and try again.");if(I.length!=k)throw new Error("Wrong number of values in row #"+P);C.v.set(new Float64Array(I),(P-v)*k)}if(!l||_.length!==p){_=Array(p);for(let P=0;P<p;P++)_[P]="O"+(P+1)}_=_.map(P=>on(P)),L=L.map(P=>on(P)),A=A.map(P=>on(P));let N,F=Array(k),M=Array(k);if(h&&h.length===k+b){N=h.map(P=>on(P)).slice(b);for(let P=0;P<k;P++)F[P]=P>=c?P-c:P,M[P]=P>=c?P-c+1:P+1}else{N=Array(k);for(let P=0;P<k;P++)F[P]=P>=c?P-c:P,N[P]=P>=c?"V"+(P-c+1):"Y"+(P+1),M[P]=P>=c?P-c+1:P+1}let T;if(t==="values"){if(T=f==="."?N.map((P,Y)=>Y<c?Y:Number.parseFloat(P.trim())):N.map((P,Y)=>Y<c?Y:Number.parseFloat(P.trim().replace(f,"."))),T.some(P=>Number.isNaN(P)))throw new Error("Some of the header values can not be converted to numbers, check your CSV file and try again.")}else T=M;Array.isArray(T)||(T=[]),a||(a=""),o||(o=""),a=T.length>0&&a.length>0?a:"Variables",o=T.length>0&&o.length>0?o:"";const R=a+(o.length>0?", "+o:""),D=T[1]<T[0];return{values:C.t(),nresp:c,header:t,hasLabels:l,hasClassNames:s,labelsVarname:w,classLabelsVarname:y,objlabels:_,objindices:S,varlabels:N,varvalues:T,varindices:F,varrev:D,classes:L,classNames:A,sep:e,dec:f,varvaluesName:a,varvaluesUnits:o,varAxisTitle:R}}function Xu(n){if(Gn(n[0].slice(2)))return!0;const e=n[0].length,t=[];for(let l=2;l<e;l++){let s=[];for(let u=1;u<n.length;u++)s.push(n[u][l]);const a=n[0][l],o=sn(s),c=go(s),f=Math.abs((a-o)/c);t.push(f)}return t.every(l=>l>5)}function Gu(n){const t=n[0].split(","),l=n[1].split(","),s=t.length,a=l.length,o=";",c=n[0].split(o),f=n[1].split(o),u=c.length,d=f.length;let v,h;if(s>1&&a>1&&s===a&&s>u)h=",",v=s;else if(u>1&&d>1&&u===d)h=o,v=u;else throw new Error("Values in the CSV file should be separated by coma or by semicolon.");return[h,h===","?".":",",v]}function Ku(n,e=0){const t=Vo(n),l=t.length;if(l<3)throw new Error("It looks like the dataset has less then three rows, minimum three is needed, check your CSV file and try again.");const[s,a,o]=Gu(t),c=Math.min(o,5),f=Math.min(l,5);let u=t[0].split(s).length,d=t.slice(0,f).map(F=>F.split(s).slice(0,c));d=d.map(F=>F.map(M=>on(M)));const v=d.map(F=>Uu(F.slice(),a));for(let F=1;F<f;F++)if(Gn(v[F].slice(2)))throw new Error("Some of the data values expected to be numeric are not, check your CSV file.");const h=Xu(v);let m=0;const p=h?1:0,w=p+1,b=d[p][0],_=d[w][0],S=v[p][0],y=v[w][0],A=v[p][1],L=v[w][1];let k=!1,C=!1;if(Number.isNaN(S)&&Number.isNaN(y)&&b!==_?(k=!0,m=m+1):Number.isNaN(A)&&Number.isNaN(L)&&b!==_&&(k=!0,C=!0,m=m+2),!C){const F=k?1:0,M=v[p][F],T=v[w][F];C=Gn([M,T]),m=m+C}let N="no";if(h){m>0?d[0].slice(m+e):d[e];const F=m>0?v[0].slice(m+e):v[e];N=Gn(F)?"labels":"values"}return[s,k,C,N,u]}function Ju(n){const e=n.values.t(),t=n.sep,l=n.dec;let s=null;n.header!=="no"&&(s=n.header==="values"?n.nresp&&n.nresp>0?n.varlabels.slice(0,n.nresp).concat(n.varvalues.slice(n.nresp)):n.varvalues.slice():n.varlabels.slice()),s&&n.hasClassNames&&(s=[n.classLabelsVarname,...s]),s&&n.hasLabels&&(s=[n.labelsVarname,...s]);const a=n.classes&&n.classes.length===e.ncols,o=n.objlabels&&n.objlabels.length===e.ncols;let c=s?s.join(t):"";for(let f=0;f<e.ncols;f++){let u=e.getcolref(f+1).join(t);l!=="."&&(u=u.replace(".",l)),a&&(u=n.classes[f]+n.sep+u),o&&(u=n.objlabels[f]+n.sep+u),c=c+`
`+u}return c=c+`
`,l!=="."&&(c=c.replace(/\./g,l)),c}function Qu(n,e){const t=Ju(n),l=new Blob([t],{type:"text/csv"}),s=window.URL.createObjectURL(l),a=document.createElement("a");a.setAttribute("href",s),a.setAttribute("download",`${e}.csv`),a.click()}function Kn(n,e){return tr(e)?{__type:"matrix",nrows:e.nrows,ncols:e.ncols,v:Array.from(e.v)}:Fe(e)?{__type:"vector",length:e.length,v:Array.from(e.v)}:ArrayBuffer.isView(e)?{__type:e.constructor.name,data:Array.from(e)}:e}function Cs(n,e){if(e&&typeof e=="object"&&e.__type){if(e.__type==="matrix")return Iu(e.v,e.nrows,e.ncols);if(e.__type==="vector")return Ye(e.v);const t=globalThis[e.__type];if(typeof t=="function")return new t(e.data)}return e}function Ts(n){const e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),l=String(n.getDate()).padStart(2,"0"),s=String(n.getHours()).padStart(2,"0"),a=String(n.getMinutes()).padStart(2,"0"),o=String(n.getSeconds()).padStart(2,"0");return`${e}${t}${l}${s}${a}${o}`}function Oo(n){return Array.from({length:8},(e,t)=>n>>7-t&1).reverse()}function Pl(n,e,t){let l="";for(let s=0;s<e;s++){const a=n.getUint8(t++);if(a===0)break;l+=String.fromCharCode(a)}return l}function Zu(n){const e=["A.U.","cm^–1","µm","nm","s","min","Hz","KHz","MHz","M/z","ppm","days","years","cm^–1","eV","","","","","F","C","K","","msec","µsec","nsec","GHz","cm","m","mm","h",""],t=["Arbitrary","Wavenumber","Micrometers","Nanometers","Seconds","Minutes","Hertz","Kilohertz","Megahertz","Mass","Parts per million","Days","Years","Raman shift","Electron Volts","X,Y,Z text labels in fcatxt (old 4Dh version only)","Diode Number","Channel","Degrees","Temperature","Temperature","Temperature","Data Points","Milliseconds","Microseconds","Nanoseconds","Gigahertz","Centimeters","Meters","Millimeters","Hours","Double interferogram (no display labels)"],l=["Arbitrary Intensity","Interferogram","Absorbance","Kubelka-Munk","Counts","Volts","Degrees","Milliamps","Millimeters","Millivolts","Log (1/R)","Percent","Intensity","Relative Intensity","Energy",null,"Decibel",null,null,"Temperature (F)","Temperature (C)","Temperature (K)","Index of Refraction [N]","Extinction Coeff. [K]","Real","Imaginary","Complex"],s=["Transmission","Reflectance","Arbitrary or Single Beam with Valley Peaks","Emission"];let a=0;const o=n.getUint8(a);a+=1;const c=n.getUint8(a);if(a+=1,c===77)throw new Error("SPC file has old format which is not supported.");const f=c===75,u=n.getUint8(a);a+=1;const d=n.getInt8(a);a+=1;const v=n.getUint32(a,f);a+=4;const h=n.getFloat64(a,f);a+=8;const m=n.getFloat64(a,f);a+=8;const p=n.getUint32(a,f);a+=4;const w=n.getUint8(a);a+=1;const b=n.getUint8(a);a+=1;const _=n.getUint8(a);a+=1;const S=n.getUint8(a);a+=1;const y=n.getUint32(a,f);a+=4;const A=Pl(n,9,a);a+=9;const L=Pl(n,9,a);a+=9;const k=n.getUint16(a,f);a+=2;const C=Array.from({length:8},()=>{const ae=n.getFloat32(a,f);return a+=4,ae}),N=Pl(n,130,a);a+=130;const F=Pl(n,30,a);a+=30;const M=n.getUint32(a,f);a+=4;const[T,R,D,V,P,Y,Z,I]=Oo(o),H=w===255?t[31]:t[w],J=w===255?e[31]:e[w],$=b<=26?l[b]:b>=128&&b<=131?s[b]:"Unknown";return{ftflgsv:o,ftflgs:{TSPREC:T,TCGRAM:R,TMULTI:D,TRANDM:V,TORDRD:P,TALABS:Y,TXYXYS:Z,TXVALS:I},fexper:u,fexp:d,fnpts:v,ffirst:h,flast:m,fnsub:p,fxtype:w,fytype:b,fztype:_,fpost:S,fdate:y,fres:A,fsource:L,fpeakpt:k,fspare:C,fcmnt:N,fcatxt:F,flogoff:M,xaxisName:H,xaxisUnit:J,yaxisName:$}}function $u(n,e){const t=Oo(n.getUint8(e));e+=1;const l=n.getInt8(e);e+=1;const s=n.getUint16(e,!0);e+=2;const a=n.getFloat32(e,!0);e+=4;const o=n.getFloat32(e,!0);e+=4;const c=n.getFloat32(e,!0);e+=4;const f=n.getInt32(e,!0);e+=4;const u=n.getInt32(e,!0);e+=4;const d=n.getFloat32(e,!0);return e+=4,{flags:t,exp:l,index:s,time:a,next:o,noise:c,nPoints:f,nScans:u,wAxis:d}}async function Bo(n){if(n.name.slice(-3).toLowerCase()!=="spc")throw new Error(`One of the selected files is not SPC (${n.name}).`);const t=n.name.slice(0,-4),l=await n.arrayBuffer(),s=new DataView(l);let a=0;const o=Zu(s);a+=512;const c=o.fnpts;if(c<2)throw new Error(`Error reading SPC file (${n.name}).`);let f=new Array(c);if(o.ftflgs.TXVALS)for(let v=0;v<c;v++){const h=s.getFloat32(a,!0);a=a+4,f[v]=h}else{(o.flast-o.ffirst)/(c-1);for(let v=0;v<c;v++)f[v]=o.ffirst+v*o.flast}const u=new Float64Array(c*o.fnsub);for(let v=0;v<o.fnsub;v++){$u(s,a),a=a+32;for(let h=0;h<c;h++){const m=s.getFloat32(a,!0);a=a+4,u[v*c+h]=m}}const d=[];return o.fnsub>1?an(1,o.fnsub).forEach(h=>{d.push(t+"_"+h)}):d.push(t),{hdr:o,xvalues:f,yvalues:u,objlabels:d}}async function ef(n){if(!(n instanceof FileList||Array.isArray(n)))throw new Error("readSPCFiles: expected FileList or array of files.");const e=n.length,t=[];let l=[],s=[];const a=await Bo(n[0]),o=a.xvalues.length;if(t.push(a.yvalues),l=l.concat(a.objlabels),s.push(a.hdr.fnsub),e>1)for(let p=1;p<e;p++){const w=await Bo(n[p]);if(w.xvalues.length!==o)throw new Error("Number of spectral values in SPC files is different.");t.push(w.yvalues),l=l.concat(w.objlabels),s.push(w.hdr.fnsub)}const c=s.reduce((p,w)=>p+w,0),f=new Float64Array(c*o);let u=0;for(let p=0;p<t.length;p++)f.set(t[p].slice(),u),u+=s[p]*o;const d=new $e(f,o,c),v=an(0,o-1),h=an(0,c-1),m=v.map(p=>"X"+p);return{values:d.t(),nresp:0,header:"values",hasLabels:!0,hasClassNames:!1,labelsVarname:"",classLabelsVarname:"",classes:[],classNames:[],objlabels:l,objindices:h,varlabels:m,varvalues:a.xvalues,varindices:v,varev:a.xvalues[1]<a.xvalues[0],sep:",",dec:".",varvaluesName:a.hdr.xaxisName,varvaluesUnits:a.hdr.xaxisUnit,varAxisTitle:"",fileName:`${e} SPC files`}}var tf=U('<button tabindex="0" class="button svelte-ymtj5z"> </button>');function et(n,e){let t=B(e,"text",3,"button");var l=tf();l.__click=function(...a){var o;(o=e.onclick)==null||o.apply(this,a)};var s=W(l);ne(()=>xe(s,t())),E(n,l)}st(["click"]);var rf=U('<button tabindex="0"></button>');function cn(n,e){B(e,"disable",3,!1);var t=rf();t.__click=function(...l){var s;(s=e.onclick)==null||s.apply(this,l)},ne(()=>{O(t,"title",e.title),O(t,"aria-label",e.title),O(t,"alt",e.title),ft(t,1,`button ${e.className??""}`,"svelte-bx9fh5")}),E(n,t)}st(["click"]);function or(n,e){let t=B(e,"title",3,"Reset");cn(n,{get title(){return t()},get onclick(){return e.onclick},className:"button-cancel"})}function nf(n,e){let t=B(e,"title",3,"Undo");cn(n,{get title(){return t()},get onclick(){return e.onclick},className:"button-undo"})}function lf(n,e){let t=B(e,"title",3,"Download");cn(n,{get title(){return t()},get onclick(){return e.onclick},className:"button-download"})}function sf(n,e){let t=B(e,"title",3,"Add");cn(n,{get title(){return t()},get onclick(){return e.onclick},className:"button-add"})}function qo(n,e){let t=B(e,"title",3,"Settings");cn(n,{get title(){return t()},get onclick(){return e.onclick},className:"button-settings"})}function af(n,e){let t=B(e,"title",3,"Move up");cn(n,{get title(){return t()},get onclick(){return e.onclick},className:"button-up"})}function of(n,e){let t=B(e,"title",3,"Move down");cn(n,{get title(){return t()},get onclick(){return e.onclick},className:"button-down"})}function bt(n){const e={};for(const t of Object.keys(n))e[t]=n[t].default;return e}var cf=U('<span class="label svelte-1986c5z"> </span>'),uf=U("<div><!> <!></div>");function ie(n,e){let t=B(e,"label",3,null),l=B(e,"name",3,""),s=B(e,"status",3,""),a=B(e,"colors",3,""),o=B(e,"labelWidth",3,12);var c=uf(),f=W(c);{var u=v=>{var h=cf(),m=W(h);ne(()=>{ot(h,`flex-basis:${o()??""}ch;`),xe(m,t())}),E(v,h)};q(f,v=>{t()&&v(u)})}var d=z(f,2);Er(d,()=>e.children??xt),ne(()=>{ft(c,1,`control-element ${l()??""} ${s()??""}`,"svelte-1986c5z"),ot(c,a())}),E(n,c)}const Yo=(n,e,t,l)=>{const s=e(n);s<0||s>1||j(t,s*100>r(l)-5&&s*100<r(l)+5,!0)},Do=(n,e,t,l,s,a)=>{j(e,!1);const o=t(n);o<0||o>1||(l(s(o)),a()&&a()(l()))},Wo=(n,e,t,l,s,a)=>{if(!r(e))return;const o=t(n);o<0||o>1||(l(s(o)),a()&&a()(l()))},ff=(n,e,t,l,s,a)=>{if(n.key==="ArrowLeft"){e(e()-t()<l()?l():e()-t()),s()&&s()(e());return}if(n.key==="ArrowRight"){e(e()+t()>a()?a():e()+t()),s()&&s()(e());return}};var df=U('<div role="slider" class="range-slider-container svelte-vhx0r0" tabindex="0"><div><span> </span></div></div>');function un(n,e){me(e,!0);let t=B(e,"min",7,0),l=B(e,"max",3,100),s=B(e,"value",31,()=>Te(t())),a=B(e,"decNum",3,1),o=B(e,"step",19,()=>+((l()-t())/100).toFixed(4)),c=B(e,"onchange",3,null);_e(()=>{s()<t()&&(s(t()),c()&&c()(s())),s()>l()&&(s(l()),c()&&c()(s())),t()>l()&&t(l())});let f=re(void 0),u=re(void 0),d=re(!1);const v=k=>{const C=t()+k*(l()-t());return+(Math.round(C/o())*o()).toFixed(4)},h=k=>{const C=r(f).getBoundingClientRect(),N=r(u).getBoundingClientRect(),F=C.x,M=N.x+N.width;return(k.clientX-F)/(M-F)},m=k=>{j(d,!1)},p=k=>{let C=s()+o()*k.deltaY*.5;C<t()&&(C=t()),C>l()&&(C=l()),s(+(Math.round(C/o())*o()).toFixed(4)),k.preventDefault(),c()&&c()(s())},w=g(()=>t()===l()?100:(s()-t())/(l()-t())*100);var b=df();b.__keydown=[ff,s,o,t,c,l],b.__mousemove=[Wo,d,h,s,v,c],b.__mousedown=[Yo,h,d,w],b.__mouseup=[Do,d,h,s,v,c],b.__touchmove=[Wo,d,h,s,v,c],b.__touchstart=[Yo,h,d,w],b.__touchend=[Do,d,h,s,v,c];var _=W(b);let S;var y=W(_);let A;var L=W(y);rn(_,k=>j(f,k),()=>r(f)),rn(b,k=>j(u,k),()=>r(u)),ne((k,C,N)=>{O(b,"aria-valuenow",s()),O(b,"aria-valuemin",t()),O(b,"aria-valuemax",l()),S=ft(_,1,"range-slider svelte-vhx0r0",null,S,k),ot(_,`width:${r(w)??""}%`),A=ft(y,1,"range-value svelte-vhx0r0",null,A,C),xe(L,N)},[()=>({"range-slider_right":r(w)<50}),()=>({"range-value_right":r(w)<50}),()=>s().toFixed(a())]),en("mousewheel",b,p),en("mouseleave",b,m),en("touchcancel",b,m),E(n,b),ge()}st(["keydown","mousemove","mousedown","mouseup","touchmove","touchstart","touchend"]);const Uo=(n,e,t,l,s)=>{const a=e(n);a<0||a>1||j(t,a>r(l)&&a<r(s)+r(l),!0)},Ho=(n,e,t,l,s)=>{j(e,!1);const a=t(n);if(a<0||a>1)return;const o=l(a);s()!==o&&s(o)},Xo=(n,e,t,l,s)=>{if(!r(e))return;const a=t(n);if(a<0||a>1)return;const o=l(a);o!=s()&&s(o)},vf=(n,e,t,l,s)=>{if(n.key==="ArrowLeft"){e(e()-t()<l()?l():e()-t());return}if(n.key==="ArrowRight"){e(e()+t()>s()?s():e()+t());return}};var hf=U('<div role="slider" class="range-slider-container range-slider-container_discrete svelte-xdlm7u" tabindex="0"><div><span> </span></div></div>');function Bt(n,e){me(e,!0);let t=B(e,"min",3,0),l=B(e,"max",3,10),s=B(e,"value",31,()=>Te(t())),a=B(e,"step",3,1);s()<t()&&(console.log('RangeDiscrete: the "value" is outside of the provided range.'),s(t())),s()>l()&&(console.log('RangeDiscrete: the "value" is outside of the provided range.'),s(l())),t()>l()&&console.error("The min and max values must be distinct.");let o=re(void 0),c=re(void 0),f=re(!1);const u=g(()=>t()===l()?0:(s()-t())/(l()-t()+a())),d=g(()=>a()/(l()-t()+a())),v=g(()=>l()<100?`background: repeating-linear-gradient(to right, var(--bg-color-light, #f4f4f4), var(--bg-color-light, #f4f4f4), var(--bg-color-light, #f4f4f4) ${r(d)*100}%, var(--bg-color-light2, #e8e8e8) ${r(d)*100}%, var(--bg-color-light2, #e8e8e8) ${200*r(d)}%)`:"background: #f0f0f0"),h=k=>{if(k<0||k>1)return s();let C=s();return Math.round(r(d)/k),k<r(u)&&r(u)>0&&(C=s()-a()*Math.ceil((r(u)-k)/r(d))),k>r(u)+r(d)&&r(u)+r(d)<1&&(C=s()+a()*Math.ceil((k-(r(u)+r(d)))/r(d))),C<t()&&(C=t()),C>l()&&(C=l()),C},m=k=>{const C=r(c).getBoundingClientRect(),N=C.x,F=C.x+C.width;return(k.clientX-N)/(F-N)},p=k=>{j(f,!1)},w=k=>{let C=s()+Math.round(k.deltaY*.5)*a();C<t()&&(C=t()),C>l()&&(C=l()),s(C),k.preventDefault()};var b=hf();b.__keydown=[vf,s,a,t,l],b.__mousemove=[Xo,f,m,h,s],b.__mousedown=[Uo,m,f,u,d],b.__mouseup=[Ho,f,m,h,s],b.__touchmove=[Xo,f,m,h,s],b.__touchstart=[Uo,m,f,u,d],b.__touchend=[Ho,f,m,h,s];var _=W(b);let S;var y=W(_);let A;var L=W(y);rn(_,k=>j(o,k),()=>r(o)),rn(b,k=>j(c,k),()=>r(c)),ne((k,C,N)=>{O(b,"aria-valuenow",s()),O(b,"aria-valuemin",t()),O(b,"aria-valuemax",l()),ot(b,r(v)),S=ft(_,1,"range-slider svelte-xdlm7u",null,S,k),ot(_,`width: max(2px, ${r(d)*100}%);left:${r(u)*100}%;`),A=ft(y,1,"range-value svelte-xdlm7u",null,A,C),xe(L,N)},[()=>({"range-slider_left":r(d)<.1&&r(u)<.5,"range-slider_right":r(d)<.1&&r(u)>=.5}),()=>({"range-value_right":r(d)<.1&&r(u)>.5,"range-value_left":r(d)<.1&&r(u)<=.5}),()=>s().toFixed(0)]),en("mousewheel",b,w),en("mouseleave",b,p),en("touchcancel",b,p),E(n,b),ge()}st(["keydown","mousemove","mousedown","mouseup","touchmove","touchstart","touchend"]);const mf=(n,e,t)=>{if(n.key==="ArrowLeft"){const l=e.options.findIndex(s=>s===t());l>0&&t(e.options[l-1]);return}if(n.key==="ArrowRight"){const l=e.options.findIndex(s=>s===t());l<e.options.length-1&&t(e.options[l+1]);return}};var gf=(n,e,t)=>e(t),pf=U('<button tabindex="-1"><!></button>'),bf=U('<div role="radiogroup" tabindex="0"></div> <input class="svelte-1i17tox"/>',1);function Oe(n,e){me(e,!0);let t=B(e,"value",31,()=>Te(e.options[0])),l=B(e,"className",3,"");var s=bf(),a=X(s);a.__keydown=[mf,e,t],Ne(a,20,()=>e.options,c=>c,(c,f)=>{var u=pf();u.__click=[gf,t,f];let d;var v=W(u);kt(v,()=>f),ne((h,m)=>d=ft(u,1,`option option_${h??""}`,"svelte-1i17tox",d,m),[()=>f.toString().replace(".","_"),()=>({selected:f==t()})]),E(c,u)});var o=z(a,2);ne(()=>ft(a,1,`selector ${l()??""}`,"svelte-1i17tox")),vs(o,t),E(n,s),ge()}st(["keydown","click"]);function Xt(n,e){me(e,!0);let t=B(e,"options",19,()=>["no","yes"]),l=B(e,"value",15,!1),s=re(!0);const a=g(()=>t().length!=2?(console.error('Switch: parameter "option" must gave two values.'),null):t());_e(()=>j(s,l()?t()[1]:t()[0],!0)),_e(()=>l(r(s)===t()[1]));var o=de(),c=X(o);{var f=u=>{Oe(u,{get options(){return r(a)},get value(){return r(s)},set value(d){j(s,d,!0)}})};q(c,u=>{r(a)&&u(f)})}E(n,o),ge()}function Go(n,e,t){r(e)&&r(e).files.length>0?t(r(e).files.length===1?r(e).files[0]:r(e).files):t(null)}function Ko(n,e){(n.type==="click"||n.type==="keydown"&&(n.code==="Space"||n.code==="Enter"))&&r(e).click()}var _f=U('<input type="file" multiple class="svelte-1k0x7uv"/>'),wf=U('<input type="file" class="svelte-1k0x7uv"/>'),yf=U('<div tabindex="0" role="radiogroup"> <!></div> <!>',1);function Ll(n,e){me(e,!0);let t=B(e,"file",15),l=B(e,"message",3,"Select CSV file with dataset"),s=B(e,"acceptType",3,".csv"),a=B(e,"multiple",3,!1),o=re(void 0);function c(_){r(o).value=null,t(null)}var f=yf(),u=X(f);u.__keydown=[Ko,o],u.__click=[Ko,o];let d;var v=W(u),h=z(v);{var m=_=>{var S=_f();S.__change=[Go,o,t],rn(S,y=>j(o,y),()=>r(o)),ne(()=>O(S,"accept",s())),E(_,S)},p=_=>{var S=wf();S.__change=[Go,o,t],rn(S,y=>j(o,y),()=>r(o)),ne(()=>O(S,"accept",s())),E(_,S)};q(h,_=>{a()?_(m):_(p,!1)})}var w=z(u,2);{var b=_=>{or(_,{onclick:c})};q(w,_=>{t()&&_(b)})}ne(_=>{d=ft(u,1,"file-selector svelte-1k0x7uv",null,d,_),xe(v,`${(t()?t().name:l())??""} `)},[()=>({selected:t()})]),E(n,f),ge()}st(["keydown","click","change"]);function xf(n,e,t,l){e()&&j(t,e()(l()),!0)}var kf=U('<div class="error-message svelte-1qtiwcs"> </div>'),Ef=U('<div><input type="text" class="svelte-1qtiwcs"/> <!></div>');function Jo(n,e){me(e,!0);let t=B(e,"value",15,""),l=B(e,"className",3,""),s=B(e,"placeholder",3,""),a=B(e,"maxLength",3,25),o=B(e,"validator",3,null),c=re("");var f=Ef();let u;var d=W(f);d.__input=[xf,o,c,t];var v=z(d,2);{var h=m=>{var p=kf(),w=W(p);ne(()=>xe(w,r(c))),E(m,p)};q(v,m=>{r(c)&&r(c).length>0&&m(h)})}ne(m=>{u=ft(f,1,`textinput ${l()??""}`,"svelte-1qtiwcs",u,m),O(d,"placeholder",s()),O(d,"maxlength",a())},[()=>({error:r(c)&&r(c).length>0})]),vs(d,t),E(n,f),ge()}st(["input"]);var Sf=U('<div class="spinner svelte-n48urb"></div>');function Ps(n){var e=Sf();E(n,e)}const Af=(n,e,t)=>{if(n.key==="ArrowLeft"){const l=e().findIndex(s=>s===t());l>0&&t(e()[l-1]);return}if(n.key==="ArrowRight"){const l=e().findIndex(s=>s===t());l<e().length-1&&t(e()[l+1]);return}};var Cf=(n,e,t)=>e(t),Tf=U('<button tabindex="-1"><!></button>'),Pf=U('<div role="radiogroup" tabindex="0" class="selector plot-selector svelte-yf64an"></div> <input class="svelte-yf64an"/>',1);function Ls(n,e){me(e,!0);let t=B(e,"options",19,()=>["p","l","b","h","qq"]),l=B(e,"value",31,()=>Te(t()[0]));const s='<svg width="3em" height="1.5em" viewBox="0 0 32 20" fill="transparent" xmlns="http://www.w3.org/2000/svg">',a={bp:'<rect x="8" y="5" width="16" height="10" stroke-width="2"/><line x1="15" y1="14" x2="15" y2="4" stroke-width="2"/><line x1="30" y1="10" x2="25" y2="10" stroke-width="2"/><line x1="8" y1="10" x2="2" y2="10" stroke-width="2"/>',hm:'<rect x="5" y="4" width="23" height="12"stroke-width="2"/><line x1="13" y1="16" x2="13" y2="3" stroke-width="2"/><line x1="21" y1="16" x2="21" y2="3" stroke-width="2"/><line x1="28" y1="10" x2="5" y2="10" stroke-width="2"/>',l:'<path d="M4.23178 14.3598L15.5 5" stroke-width="2"/><line x1="14.4846" y1="5.17692" x2="26.4846" y2="10.1769" stroke-width="2"/>',p:'<circle cx="6.5" cy="12.5" r="1" stroke-width="4"/><circle cx="15.2" cy="5.8" r="1" stroke-width="4"/><circle cx="25" cy="10" r="1" stroke-width="4"/>',h:'<line x1="9" y1="15" x2="9" y2="9" stroke-width="6"/><line x1="17" y1="15" x2="17" y2="3" stroke-width="6"/><line x1="25" y1="15" x2="25" y2="7" stroke-width="6"/>',qq:'<circle cx="6.5" cy="15.0" r="1" stroke-width="4"/><circle cx="15.2" cy="10" r="1" stroke-width="4"/><circle cx="25" cy="5.8" r="1" stroke-width="4"/>'};a.b=a.l+a.p;const o={bp:"boxplot",hm:"heatmap",l:"line",p:"scatter",b:"line + scatter",h:"bar",qq:"qq-plot"};var c=Pf(),f=X(c);f.__keydown=[Af,t,l],Ne(f,20,t,d=>d,(d,v)=>{var h=Tf();h.__click=[Cf,l,v];let m;var p=W(h);kt(p,()=>s+a[v]+"</svg"),ne(w=>{m=ft(h,1,"option svelte-yf64an",null,m,w),O(h,"title",o[v])},[()=>({selected:v==l()})]),E(d,h)});var u=z(f,2);vs(u,l),E(n,c),ge()}st(["keydown","click"]),st(["keydown","click"]);var Lf=U("<h2> </h2>"),Nf=U("<!> <!>",1),zf=U('<div class="widget"><!></div>');function Mf(n,e){me(e,!0);let t=B(e,"title",3,""),l=B(e,"value",15),s=B(e,"labelWidth",3,13);function a(u){const d={};for(const v of Object.keys(u))d[v]=u[v].default;return d}_e(()=>{!l()&&e.options&&l(a(e.options))});var o=zf(),c=W(o);{var f=u=>{var d=Nf(),v=X(d);{var h=p=>{ie(p,{children:(w,b)=>{var _=Lf(),S=W(_);ne(()=>xe(S,t())),E(w,_)},$$slots:{default:!0}})};q(v,p=>{t()&&p(h)})}var m=z(v,2);Ne(m,17,()=>Object.keys(e.options),Ie,(p,w)=>{var b=de();const _=g(()=>e.options[r(w)]);var S=X(b);{var y=A=>{ie(A,{get name(){return r(_).name},get label(){return r(_).label},get labelWidth(){return s()},children:(L,k)=>{var C=de(),N=X(C);Hn(N,()=>r(_).el,(F,M)=>{M(F,Or(()=>r(_).props,{get value(){return l()[r(w)]},set value(T){l(l()[r(w)]=T,!0)}}))}),E(L,C)},$$slots:{default:!0}})};q(S,A=>{r(_).hidden||A(y)})}E(p,b)}),E(u,d)};q(c,u=>{l()&&u(f)})}E(n,o),ge()}function Nl(n,e,t,l){let s=n.outliers,a=n.exclvars;(!s||!Array.isArray(s))&&(s=[]);const o=e.sep,c=e.values.nrows,f=s.length,u=c-f,d=n.nresp,v=n.nresp_model,h=n.ncomp,m=Array(h).fill(""),p=Array(h).fill(0).map((k,C)=>"LV"+(C+1));function w(k,C){const N=e.objlabels;_+=`
`,_+=[k+": ",...m].join(o)+o+`
`,_+=["object",...p].join(o)+o+`
`;const F=n.v.subarray(C,C+h*u);let M=0;for(let T=0;T<c;T++){if(f>0&&s.includes(T)){_+=[N[T],...Array(h).fill("-")].join(o)+o+`
`;continue}const R=Array(h);for(let D=0;D<h;D++)R[D]=F[D*u+M];_+=[N[T],...R].join(o)+o+`
`,M=M+1}_+=`
`}function b(k){const C=e.objlabels,N=3*h*u+h,F=h*u*v,M=n.v.subarray(N,N+F);let T=0;for(let R=0;R<c;R++){if(f>0&&s.includes(R)){_+=[C[R],...Array(h).fill("-")].join(o)+o+`
`;continue}const D=Array(h);for(let V=0;V<h;V++)D[V]=M[V*(u*v)+(k-1)*u+T];_+=[C[R],...D].join(o)+o+`
`,T=T+1}_+=`
`}let _="";if(_+=["Number of LVs:",h,...m].join(o)+`
`,_+=["Optinal number of LVs:",l,...m].join(o)+`
`,_+=["Center:",n.center,...m].join(o)+`
`,_+=["Scale:",n.scale,...m].join(o)+`
`,s.length>0&&(_+=["Removed outliers:",s.length,...m].join(o)+`
`),a.length>0&&(_+=["Excluded variables:",a.length,...m].join(o)+`
`),_+=`
`,d>0){_+=["Variances:","",...m].join(o)+`
`,_+=["",...p].join(o)+o+`
`,_+=["xexpvar:",...n.stat.xexpvar].join(o)+o+`
`,_+=["xcumexpvar",...n.stat.xcumexpvar].join(o)+o+`
`,_+=["yexpvar:",...n.stat.yexpvar].join(o)+o+`
`,_+=["ycumexpvar:",...n.stat.ycumexpvar].join(o)+o+`
`,_+=`
`,_+=`
`;for(let k=1;k<=d;k++)_+=["Response variable:"+o+n.varlabels[k-1],...m].join(o)+`

`,_+=["FoMs:",...p].join(o)+o+`
`,n.stat&&(_+=["RMSE",...n.stat.rmse.getcolref(k)].join(o)+o+`
`,_+=["R2",...n.stat.r2.getcolref(k)].join(o)+o+`
`,_+=["Slope",...n.stat.slope.getcolref(k)].join(o)+o+`
`,_+=["Bias",...n.stat.bias.getcolref(k)].join(o)+o+`
`,_+=`
`),_+=["Predictions:",...p].join(o)+o+`
`,b(k)}else for(let k=1;k<=v;k++)_+=["Response variable:"+o+n.varlabels[k-1],...m].join(o)+`

`,_+=["Predictions:",...p].join(o)+o+`
`,b(k);w("X-scores",0),w("Score distances, h",h*u),w("Orthogonal distances, q",h*u*2),n.stat&&(w("Y-scores",3*h*u+h+u*h*d),w("Orthogonal distances, z",4*h*u+h+u*h*d)),e.dec!=="."&&(_=_.replace(/\./g,e.dec)),_=["Data filename:",e.fileName,...m].join(e.sep)+`
`+_;let S=["PLS results ("+t+")","https://mda.tools/pls/",...m].join(e.sep)+`

`;const y=new Blob([S+_],{type:"text/csv"}),A=window.URL.createObjectURL(y),L=document.createElement("a");L.setAttribute("href",A),L.setAttribute("download",`pls-results-${t}.csv`),L.click()}function Qo(n,e,t){n.ncomp_selected=e,n.prep=t;const l=new Blob([JSON.stringify(n,Kn)],{type:"application/json"}),s=window.URL.createObjectURL(l),a=document.createElement("a");a.setAttribute("href",s),a.setAttribute("download","pls-model.json"),a.click()}var Rf=U('<span class="item svelte-1ggez3e"> </span>'),If=U('<p class="outliers svelte-1ggez3e"><span style="color:#a0a0a0;">Removed:</span> <!></p> <!> <!>',1);function Ns(n,e){me(e,!0);var t=de(),l=X(t);{var s=a=>{ie(a,{children:(o,c)=>{var f=If(),u=X(f),d=z(W(u),2);Ne(d,17,()=>e.outliers,Ie,(p,w)=>{var b=Rf(),_=W(b);ne(()=>xe(_,e.dataset.objlabels[r(w)])),E(p,b)});var v=z(u,2);{var h=p=>{nf(p,{get onclick(){return e.undoOutliers}})};q(v,p=>{e.outliers.length>1&&p(h)})}var m=z(v,2);or(m,{get onclick(){return e.resetOutliers}}),E(o,f)},$$slots:{default:!0}})};q(l,a=>{e.dataset&&e.outliers&&e.outliers.length>0&&a(s)})}E(n,t),ge()}var Ff=U('<p class="exclvars svelte-181kelh"><span style="color:#a0a0a0;">Excluded</span> <span style="color:#504040;"> </span> <span style="color:#a0a0a0;">variables</span></p> <!>',1);function jf(n,e){me(e,!0);var t=de(),l=X(t);{var s=a=>{ie(a,{children:(o,c)=>{var f=Ff(),u=X(f),d=z(W(u),2),v=W(d),h=z(u,2);or(h,{get onclick(){return e.resetExclvars}}),ne(()=>xe(v,e.exclvars.length)),E(o,f)},$$slots:{default:!0}})};q(l,a=>{e.exclvars&&e.exclvars.length>0&&a(s)})}E(n,t),ge()}const Vf={small:30,medium:40,large:50,xlarge:60},Of={small:5,medium:8,large:12,xlarge:15},Bf={small:6,medium:10,large:14,xlarge:18},zs={small:4,medium:6,large:8,xlarge:10},qf={small:12,medium:15,large:19,xlarge:21},Ms={small:11,medium:15,large:17,xlarge:19},Jn={small:["0","3,3","1,1","3,1,1,1"],medium:["0","5,5","2,2","5,2,2,2"],large:["0","7,7","3,3","7,3,2,3"],xlarge:["0","9,9","4,4","9,3,3,3"]},Qn=["●","◼","▲","▼","⬥","＋","✳","✕"],Yf=.8,Zo=.5,Df={small:5,medium:8,large:12,xlarge:15},Wf=12,_t={MIDDLEGRAY:"#dadada",DARKGRAY:"#606060",LEGEND:"#303030",PRIMARY:"#2679B2",PRIMARY_TEXT:"#333",CLEGEND_LABELS:"#808080"};function $o(n){let e=Array(n);for(let t=0;t<n;t++)e[t]=t+1;return e}function ei(n,e){return Array.isArray(n)&&n.length===e&&!n.some(t=>t===void 0)&&!n.some(t=>isNaN(t))}function ti(n,e){if(n!=null&&(Array.isArray(n)&&(n=Ye(n)),!(!Fe(n)||n.length<1)))return n.apply(t=>js((t-e[1])*e[0]+e[2])).v}function at(n,e){return ti(n,e.coords)}function Zn(n,e){return ti(n,e.objects)}function ri(n,e){if(n!=null&&(Array.isArray(n)&&(n=Ye(n)),!(!Fe(n)||n.length<1)))return n.apply(t=>(t-e[2])/e[0]+e[1]).v}function ni(n,e){return ri(n,e.coords)}function li(n,e){return ri(n,e.objects)}function Rs(n){return n===0?"":`<tspan>&times;10</tspan><tspan font-size="0.75em" dy="-0.5em">${n.toString()}</tspan>`}function fn(n){if(n===Math.round(n))return n;if(Math.abs(n)>10**6)return Math.round(n);if(Math.abs(n)<10**-6)return n;let e=n.toPrecision(10);return e=e.replace(/\.?0+$/,""),parseFloat(e)}function Is(n){if(n===void 0)return[0,void 0];if(n.length<1)return[0,void 0];if(n.length===1)return[0,[n[0].toString()]];let e=fn(Math.abs(Ht(ho(n)))),t=0;if(e>=1)return e<100?[0,Array.from(n).map(a=>a.toFixed(0))]:(t=Math.ceil(fn(Math.log10(e)))-2,[t,Array.from(n).map(a=>(a/Math.pow(10,t)).toFixed(0))]);let l=Math.ceil(-fn(Math.log10(e)));return l<=2?[0,Array.from(n).map(s=>s.toFixed(l))]:(t=l-2,l=2,fn(Math.abs(er(n)))<=10?[-t,Array.from(n).map(s=>(s*Math.pow(10,t)).toFixed(l))]:[-t,Array.from(n).map(s=>(s/Math.pow(10,t)).toString())])}function Tt(n,e,t){return Array.isArray(n)&&(n=Ye(n)),Fe(n)?n.length<1?(console.error(e+": vector with coordinates is empty."),null):t&&n.length!==t?(console.error(e+": vector does not have the expected length of "+t+"."),null):n:(console.error(e+": coordinates must be provided as array or instance of Vector class."),null)}function Fs(n,e,t,l){if(!n||!e||n.length!==e.length)return console.error("val2p: provided coordinate values are not correct."),null;const s=t.coords,a=l.coords;let o="";for(let c=0;c<n.length;c++){const f=js((n.v[c]-s[1])*s[0]+s[2]),u=js((e.v[c]-a[1])*a[0]+a[2]);o+=f+","+u+" "}return o}function si(n,e){return n?Array.isArray(n)?!e||e.length<1?[null,"tick labels must be accompanied with tick values."]:e.v.length!==n.length?[null,"number of tick labels and values should be the same."]:[n.map(t=>qr(t)),""]:[null,"tick labels must be provided as array."]:[null,""]}function ai(n,e){if(Array.isArray(n)&&(n=Ye(n)),!Fe(n))return[null,"tick values must be provided as an array or as a vector."];if(n.v.some(o=>isNaN(o)))return[null,"tick values must be numeric"];const t=new Set(n.v);if(n.length!==t.size)return[null,"ticks values must be unique."];const l=e[0]<e[1]?e[0]:e[1],s=e[0]<e[1]?e[1]:e[0],a=n.filter(o=>o>=l&o<=s);return a.length!==n.length?[null,"some of ticks values are outside axis limits."]:[a,""]}function oi(n,e,t,l,s,a){s==null&&(s=!1),a===void 0&&(a=1e-4);const o=e[0]<e[1]?e:[e[1],e[0]];if(n)return n;if(typeof o!="object"||o[0]===void 0||o[1]===void 0){console.error("getAxisTicks: provided axis limits are not valid.");return}const c=Math.abs(o[1]-o[0])*a,f=o[1]-o[0]-2*c,u=Math.floor(Math.log10(f)),d=1/Math.pow(10,u-1),v=Math.round(f*d)/d;let h=Uf(v/t);s&&(Math.abs(o[1]-o[0])<=1?console.error('getAxisTicks: parameter "whole" will be ignored as axis limits are too narrow to fit whole ticks.'):(h<1&&(h=1),h=Math.round(h)));let m=Math.ceil((o[0]+c)/h)*h,p=Math.floor((o[1]-c)/h)*h;Math.abs(o[0]-m)<h/10&&(m=m+h),Math.abs(o[1]-p)<h/10&&(p=p-h),t=Math.ceil(fn((p-m)/h))+1,n=ze.zeros(t);for(let w=0;w<t;w++)n.v[w]=m+h*w;if(Math.abs(h)<1){const w=Math.pow(10,1+Math.round(-Math.log10(h)));n=n.apply(b=>Math.round((b+Number.EPSILON)*w)/w)}return n.filter(w=>w>=o[0]&w<=o[1])}function Uf(n,e){const t=Math.floor(Math.log10(n)),l=n/Math.pow(10,t);let s;return l<=1?s=1:l<=2?s=2:l<=5?s=5:s=10,s*Math.pow(10,t)}function js(n){return Math.round(n*10)/10}function Hf(n,e){return e<300.2||n<400.2?"small":e<400.2||n<700.2?"medium":e<650.2||n<850.2?"large":"xlarge"}function ii(n,e){return n<400.2?"small":n<700.2?"medium":n<900.2?"large":"xlarge"}function Xf(){const n=new Int32Array(256);for(let e=0;e<256;e++){let t=e;for(let l=0;l<8;l++)t=t&1?3988292384^t>>>1:t>>>1;n[e]=t}return n}function Gf(n){let e=-1,t=Xf();for(let l=0;l<n.length;l++)e=t[(e^n[l])&255]^e>>>8;return e^-1}function Kf(n,e){const t=new Uint8Array(13);e*=39.3701,t[0]=112,t[1]=72,t[2]=89,t[3]=115,t[4]=e>>>24,t[5]=e>>>16,t[6]=e>>>8,t[7]=e&255,t[8]=t[4],t[9]=t[5],t[10]=t[6],t[11]=t[7],t[12]=1;const l=Gf(t),s=new Uint8Array(4);s[0]=l>>>24,s[1]=l>>>16,s[2]=l>>>8,s[3]=l&255;const a=new Uint8Array(4);a[0]=0,a[1]=0,a[2]=0,a[3]=9;const o=new Uint8Array(54);return o.set(n,0),o.set(a,33),o.set(t,37),o.set(s,50),o}function Jf(n,e){const t=n.split(","),l=t[0],s=t[1],a=33/3*4,o=s.substring(0,a),c=s.substring(a),f=atob(o),u=new Uint8Array(f.length);for(let h=0;h<u.length;h++)u[h]=f.charCodeAt(h);const d=Kf(u,e),v=btoa(String.fromCharCode(...d));return[l,",",v,c].join("")}function Qf(n,e,t,l,s){if(t||(t=10),l||(l=10),s||(s=300),t<1||t>30)return console.error('Parameter "width" must be between 1 and 30 (cm).'),null;if(l<1||l>30)return console.error('Parameter "height" must be between 1 and 30 (cm).'),null;if(s<50||s>1200)return console.error('Parameter "res" must be between 50 and 1200 (ppi).'),null;if(!n||!(n instanceof SVGElement))return console.error('Parameter "svg" is not an instance of SVGElement.'),null;(!e||e.trim()==="")&&(e="plot");const a=t/2.54*s,o=l/2.54*s;setTimeout(()=>{const c=n.clientHeight,f=n.clientWidth;let u=Math.max(a/f,o/c),d=1;u<1&&(d=u,u=1);const v=document.createElement("canvas"),h=v.getContext("2d");v.width=f*(d<1?d:u),v.height=c*(d<1?d:u),n.setAttribute("width",f*u),n.setAttribute("height",c*u),h.fillStyle="white",h.fillRect(0,0,v.width,v.height),h.scale(u,u);const m=new XMLSerializer().serializeToString(n),p=new Blob([m],{type:"image/svg+xml;charset=utf-8"}),w=URL.createObjectURL(p),b=new Image;b.onload=function(){d<0&&(b.width=b.width*d,b.height=b.height*d),h.drawImage(b,0,0,v.width,v.height);const _=v.toDataURL("image/png"),S=Jf(_,s),y=document.createElement("a");y.href=S,y.download=`${e}.png`,y.click()},b.src=w},20)}function Zf(n,e){if(!n||!(n instanceof SVGElement))return console.error('Variable "svg" is not an instance of SVGElement.'),null;(!e||e.trim()==="")&&(e="plot");const t=n.clientHeight,l=n.clientWidth;n.setAttribute("width",l+"px"),n.setAttribute("height",t+"px"),n.setAttribute("viewBox",`0 0 ${l} ${t}`);const s=new Blob([n.outerHTML],{type:"image/svg+xml"}),a=window.URL.createObjectURL(s),o=document.createElement("a");o.setAttribute("href",a),o.setAttribute("download",`${e}.svg`),o.click()}function $f(n,e,t,l){const s=n.textContent;navigator.clipboard.write([new ClipboardItem({"image/png":ed(e,t,l)})]).then(()=>{n.classList.add("copied"),n.textContent="✓ done",setTimeout(()=>{n.classList.remove("copied"),n.textContent=s},500)},a=>{console.error(a),n.classList.add("error"),n.textContent="x copy",setTimeout(()=>{n.classList.remove("error"),n.textContent=s},500)}).catch(a=>console.error(a))}async function ed(n,e,t){const l=n.clientHeight,s=n.clientWidth,a=Math.max(e/s,t/l),o=document.createElement("canvas"),c=o.getContext("2d");return o.width=s*a,o.height=l*a,c.scale(a,a),n.setAttribute("width",o.width),n.setAttribute("height",o.height),await new Promise((u,d)=>{const v=new XMLSerializer().serializeToString(n),h=new Blob([v],{type:"image/svg+xml;charset=utf-8"}),m=window.URL||window.webkitURL||window,p=m.createObjectURL(h),w=new Image;w.onload=function(){c.drawImage(w,0,0,o.width,o.height),m.revokeObjectURL(p),o.toBlob(function(b){b?u(b):d(new Error("Failed to create blob"))},"image/png")},w.onerror=function(b){d(b)},w.src=p})}function Vs(n,e){return n>16&&(n=16),[["#2679B2"],["#2679B2","#D22C2F"],["#2679B2","#92B42A","#D22C2F"],["#2679B2","#2E9658","#F2B825","#D22C2F"],["#2679B2","#22988A","#92B42A","#F79426","#D22C2F"],["#2679B2","#1C9AA8","#379531","#EED524","#FB7F28","#D22C2F"],["#2679B2","#1D94A9","#2E9658","#92B42A","#F2B825","#F47129","#D22C2F"],["#2679B2","#1E90AA","#279775","#519E2F","#D3CB25","#F5A326","#EF672A","#D22C2F"],["#2679B2","#1F8DAB","#22988A","#33953F","#92B42A","#EFCA24","#F79426","#EB5F2A","#D22C2F"],["#2679B2","#208BAC","#1E999A","#2E9658","#5FA32E","#C5C626","#F2B825","#F98827","#E85A2B","#D22C2F"],["#2679B2","#2089AD","#1C9AA8","#29976C","#379531","#92B42A","#EED524","#F4AA26","#FB7F28","#E6552B","#D22C2F"],["#2679B2","#2188AD","#1C97A8","#25987C","#329546","#68A62D","#BCC327","#F0C524","#F69E26","#F77728","#E4512B","#D22C2F"],["#2679B2","#2186AD","#1D94A9","#22988A","#2E9658","#469A2F","#92B42A","#DECF25","#F2B825","#F79426","#F47129","#E34E2C","#D22C2F"],["#2679B2","#2285AE","#1E92AA","#209995","#2A9767","#34953A","#6FA82D","#B5C128","#EFCE24","#F3AD25","#F98C27","#F16B29","#E14B2C","#D22C2F"],["#2679B2","#2284AE","#1E90AA","#1D999F","#279775","#31964A","#519E2F","#92B42A","#D3CB25","#F0C224","#F5A326","#FA8527","#EF672A","#E0492C","#D22C2F"],["#2679B2","#2283AE","#1F8FAB","#1C9AA8","#249880","#2E9658","#379531","#73AA2C","#B0BF28","#EDD424","#F2B825","#F69B26","#FB7F28","#ED632A","#DF472C","#D22C2F"]][n-1]}function td(n,e,t,l,s){let a=s.ticks,o=s.tickLabels,c=0;const f=oi(a,n,Of[t.x],!0,s.whole),u=f.length,d=li([zs[t.plot]],l)[0],v=ze.fill(e[0],u),h=v.add(d),m=ze.fill(e[1],u);if(o||(a?(c=0,o=a.v.map(N=>fn(N).toString())):[c,o]=Is(f.v)),!o||o.length!==f.length)return console.error('XAxis: "tickLabels" must be a array of the same size as ticks.'),null;const p=[[f,v],[f,m]],w=[[Ye([n[0]]),Ye([e[0]])],[Ye([n[1]]),Ye([e[0]])]],b=[[f,h],[f,v]],_=(n[1]-n[0])*.01,S=[[null,null],[[n[1]-(c>9?1:0)*_],[v.v[u-1]]]],y=Rs(c),A=o.length,L=Math.abs(n[1]>n[0]?n[1]-f.v[A-1]:n[1]-f.v[0]),k=Math.abs(n[1]-n[0]),C=Math.abs(f.v[1]-f.v[0]);if(y.length>0&&L<k*.1&&L<C*.5){const N=n[1]>n[0]?A-1:0;o[N]=" "}return{grid:p,axisLine:w,tickCoords:b,tfCoords:S,ticks:a,tickLabels:o,tickFactor:c,tfLabel:y}}function rd(n,e,t,l,s){let a=s.ticks,o=s.tickLabels,c=0;const f=oi(s.ticks,e,Bf[t.y],!0,s.whole),u=f.length,d=li([zs[t.plot]],l)[0],v=ze.fill(n[0],u),h=v.add(d),m=ze.fill(n[1],u);if(o||(a?(c=0,o=a.v.map(C=>fn(C).toString())):[c,o]=Is(f.v)),o.length!==f.length)return console.error('YAxis: "tickLabels" must be a array of the same size as ticks.'),null;const p=[[v,f],[m,f]],w=[[Ye([n[0]]),Ye([e[0]])],[Ye([n[0]]),Ye([e[1]])]],b=[[v,f],[h,f]],_=[[[],[]],[[h.v[u-1]+(Math.abs(c)>9?3:2)*d],[e[1]]]],S=Rs(c),y=o.length,A=Math.abs(e[1]>e[0]?e[1]-f.v[y-1]:e[1]-f.v[0]),L=Math.abs(e[1]-e[0]),k=Math.abs(f.v[1]-f.v[0]);if(S.length>0&&A<L*.1&&A<k*.5){const C=e[1]>e[0]?y-1:0;o[C]=" "}return{grid:p,axisLine:w,tickCoords:b,tfCoords:_,ticks:a,tickLabels:o,tickFactor:c,tfLabel:S}}function nd(n){if(!n.breaks)return console.error("ColormapLegend: breaks values must be provided."),null;const e=Fe(n.breaks)?n.breaks.v:n.breaks;if(e.length<2)return console.error("ColormapLegend: incorrect breaks values."),null;if(!n.colmap)return console.error('ColormapLegend: values for "colmap" parameter must be provided.'),null;if(!Array.isArray(n.colmap))return console.error('ColormapLegend: parameter "colmap" must be array with colors.'),null;if(n.colmap.length!==e.length-1)return console.error('ColormapLegend: number of color values in "colmap" does not match number of intervals defined by breaks.'),null;const t=n.colmap;let l,s;if(n.labels?(l=n.labels,s=0):[s,l]=Is(e),!(l.length===e.length-1||l.length===e.length))return console.error('ColormapLegend: number of values in "labels" should be equal to or by one less than number of values in "breaks".'),null;const a=l.length===t.length;return{colmap:t,breaks:e,labels:l,isCentered:a,labelsFactor:s,fontSize:n.fontSize,labelColor:n.labelColor}}function ld(n,e,t,l){const s=n.colmap.length,a=e*Yf,o=a/s,c=t[1]+(e-a)*.5,f=Df[l.y],u=t[2]+f*Zo,d=u+f*(1+Zo),v=n.isCentered?o/2:0;return{start:c,top:u,height:f,width:o,dxl:v,ltop:d}}function dn(n,e,t){if(!n||!e||!t||typeof t!="function")return;const l=n.target;if(l.tagName===e){const s=Array.prototype.indexOf.call(l.parentNode.children,l);if(s<0)return;t(s),n.stopPropagation()}}function sd(n,e){const l=document.createElement("canvas").getContext("2d");return l.font=e,l.measureText(n.replace(/<(.|\n)*?>/g,"")).width}function ad(n,e){const t="Arial",l=e/8,s=e*1.5,a=Array(n.length),o=Array(n.length);let c=0,f=0,u=0;for(let v=0;v<n.length;v++){const h=sd("  "+n[v].label+"  ",e+"px "+t);u=h>u?h:u;const m=e*n[v].labelHeight+2*l;a[v]=m,o[v]=c,c=c+m,f=f+m}const d=s+2*l+u;return[o,a,s,l,f,d]}function od(n,e,t,l,s){const[a,o,c,f,u,d]=ad(n.items,l*n.fontSize),v=n.position.includes("left")?e[0]+s:n.position.includes("right")?e[1]-d-s:(e[1]+e[0]-d)*.5,h=n.position.includes("top")?t[1]+s:n.position.includes("bottom")?t[0]-u-s:(t[1]+t[0]-u)*.5;return{lgl:v,lgt:h,lgw:d,lgh:u,ely:a,elh:o,elw:c,elp:f}}function qr(n){if(!n||n.length<1)return n;function e(a){return'<tspan font-size="0.75em" dy="-0.5em">'+a+'</tspan><tspan dy="0.4em"> </tspan>'}function t(a){return'<tspan font-size="0.75em" dy="0.5em">'+a+'</tspan><tspan dy="-0.4em"> </tspan>'}let l=0,s="";for(;l<n.length;){const a=n[l];if((a==="^"||a==="_")&&l<n.length-1){const o=a==="^";if(l++,n[l]==="("){let c=l+1;for(;c<n.length&&n[c]!==")";)c++;const f=n.slice(l+1,c);s+=o?e(f):t(f),l=c+1}else if(n[l]==="-"||n[l]==="–"){const c=n.slice(l,l+2);s+=o?e(c):t(c),l=l+2}else s+=o?e(n[l]):t(n[l]),l++}else s+=a,l++}return s}var id=ke('<line vector-effect="non-scaling-stroke"></line>'),cd=ke("<g></g>");function Os(n,e){me(e,!0);let t=B(e,"lineCoords",19,()=>[]),l=B(e,"lineColor",19,()=>_t.DARKGRAY),s=B(e,"lineType",3,1),a=B(e,"lineWidth",3,1),o=B(e,"className",3,"");const c=Rt("axes");let f=g(()=>at(t()[0][0],c.tX())),u=g(()=>at(t()[1][0],c.tX())),d=g(()=>at(t()[0][1],c.tY())),v=g(()=>at(t()[1][1],c.tY())),h=g(()=>`stroke:${l()};stroke-width: ${a()}px;stroke-dasharray:${Jn[c.scales().plot][s()-1]}`);var m=de(),p=X(m);{var w=b=>{var _=cd();Ne(_,21,()=>r(f),Ie,(S,y,A)=>{var L=id();ne(()=>{O(L,"x1",r(f)[A]),O(L,"x2",r(u)[A]),O(L,"y1",r(d)[A]),O(L,"y2",r(v)[A]),ot(L,r(h))}),E(S,L)}),ne(()=>ft(_,0,ou(o()))),E(b,_)};q(p,b=>{r(f)&&r(d)&&r(u)&&b(w)})}E(n,m),ge()}var ud=ke('<text text-anchor="middle"><!></text>'),fd=ke("<text><!></text>"),dd=ke("<text><!></text>"),vd=ke('<g class="tick-labels"><!></g>');function ci(n,e){me(e,!0);let t=B(e,"pos",3,1),l=B(e,"las",3,1),s=g(()=>["middle","middle","start","middle","end"][t()]),a=g(()=>`fill:${e.textColor};`);const o=Rt("axes");let c=g(()=>at(e.tickCoords[1][0],o.tX())),f=g(()=>at(e.tickCoords[1][1],o.tY())),u=g(()=>Ms[o.scales().plot]),d=g(()=>[0,0,r(u),0,-r(u)][t()]),v=g(()=>[0,r(u),0,-r(u),0][t()]);var h=vd(),m=W(h);{var p=b=>{var _=de(),S=X(_);Ne(S,17,()=>r(c),Ie,(y,A,L)=>{var k=ud();O(k,"data-id",L),O(k,"dx",0);var C=W(k);kt(C,()=>e.tickLabels[L],!0),ne(()=>{O(k,"x",r(c)[L]),O(k,"y",r(f)[L]),O(k,"dy",r(d)*1.25),O(k,"transform",`rotate(-90, ${r(c)[L]}, ${r(f)[L]})`)}),E(y,k)}),E(b,_)},w=b=>{var _=de(),S=X(_);{var y=L=>{var k=de(),C=X(k);Ne(C,17,()=>r(c),Ie,(N,F,M)=>{var T=fd();O(T,"data-id",M),O(T,"dy",0),O(T,"text-anchor","end");var R=W(T);kt(R,()=>e.tickLabels[M],!0),ne(()=>{O(T,"x",r(c)[M]),O(T,"y",r(f)[M]),O(T,"dx",-r(v)/2),O(T,"transform",`rotate(-90, ${r(c)[M]}, ${r(f)[M]})`)}),E(N,T)}),E(L,k)},A=L=>{var k=de(),C=X(k);Ne(C,17,()=>r(c),Ie,(N,F,M)=>{var T=dd();O(T,"data-id",M);var R=W(T);kt(R,()=>e.tickLabels[M],!0),ne(()=>{O(T,"x",r(c)[M]),O(T,"y",r(f)[M]),O(T,"dx",r(d)),O(T,"dy",r(v)),O(T,"text-anchor",r(s))}),E(N,T)}),E(L,k)};q(S,L=>{l()===2&&t()===1?L(y):L(A,!1)},!0)}E(b,_)};q(m,b=>{l()===2&&t()===4?b(p):b(w,!1)})}ne(()=>ot(h,r(a))),E(n,h),ge()}const hd=(n,e=xt,t=xt)=>{var l=yd();const s=g(()=>e().colmap.length);var a=X(l);Ne(a,17,()=>e().colmap,Ie,(d,v,h)=>{var m=bd();const p=g(()=>t().start+h*t().width);var w=X(m),b=z(w);O(b,"dy",0);var _=W(b);kt(_,()=>e().labels[h],!0),ne(()=>{O(w,"x",r(p)),O(w,"y",t().top),O(w,"width",t().width),O(w,"height",t().height),O(w,"fill",r(v)),O(b,"x",r(p)),O(b,"y",t().ltop),O(b,"dx",t().dxl),O(b,"fill",e().labelColor),O(b,"font-size",e().fontSize+"em")}),E(d,m)});var o=z(a);{var c=d=>{var v=_d();const h=g(()=>t().start+r(s)*t().width);O(v,"dx",0),O(v,"dy",0);var m=W(v);kt(m,()=>e().labels[r(s)],!0),ne(()=>{O(v,"x",r(h)),O(v,"y",t().ltop),O(v,"fill",e().labelColor),O(v,"font-size",`${e().fontSize??""}em`)}),E(d,v)};q(o,d=>{e().isCentered||d(c)})}var f=z(o);{var u=d=>{var v=wd();const h=g(()=>t().start+r(s)*t().width);var m=W(v);kt(m,()=>Rs(e().labelsFactor),!0),ne(()=>{O(v,"x",r(h)),O(v,"y",t().ltop),O(v,"fill",e().labelColor),O(v,"font-size",`${e().fontSize??""}em`)}),E(d,v)};q(f,d=>{e().labelsFactor!==0&&d(u)})}E(n,l)};function ui(n,e,t){n.preventDefault(),e(n,t())}function fi(n,e,t){n.preventDefault(),e(n,t())}function di(n,e,t){n.preventDefault(),e(n,t())}function zl(n,e,t){n.preventDefault(),e(n,t())}async function vi(n,e,t,l){$f(n.target,r(e),t(),l())}function hi(n,e,t){Zf(r(e),t())}function mi(n,e,t,l,s,a){Qf(r(e),t(),l(),s(),a())}var md=ke('<text fill="crimson" text-anchor="middle"> </text>'),gd=ke('<text dy="10px" fill="crimson" text-anchor="middle" dominant-baseline="hanging"> </text>'),pd=ke("<!><!><!><!><!>",1),bd=ke('<rect></rect><text dominant-baseline="hanging" text-anchor="middle"><!></text>',1),_d=ke('<text dominant-baseline="hanging" text-anchor="middle"><!></text>'),wd=ke('<text dx="1.2em" dy="-0.25em" dominant-baseline="hanging" text-anchor="right"><!></text>'),yd=ke("<!><!><!>",1),xd=ke("<line></line>"),kd=ke('<text dominant-baseline="middle" text-anchor="middle"> </text>'),Ed=ke('<svg><!><!><text class="legend-text" xml:space="preserve" dominant-baseline="middle" text-anchor="start"><!></text></svg>'),Sd=ke('<svg><rect height="100%" width="100%"></rect><!></svg>'),Ad=ke('<text dominant-baseline="middle" style="font-size:1.1em;"><!></text>'),Cd=ke('<text dominant-baseline="middle" style="font-size:1.1em;"><!></text>'),Td=ke('<text dominant-baseline="middle" style="font-size:1.2em;"><!></text>'),Pd=ke('<g class="plot-labels"><!><!><!></g>'),Ld=ke('<g class="axis x-axis"><!></g>'),Nd=ke('<g class="axis y-axis"><!></g>'),zd=ke('<rect fill="transparent" id="axes-box"></rect>'),Md=ke('<rect stroke="transparent" fill="transparent" id="axes-box"></rect>'),Rd=ke('<g class="colormap-legend" style="stroke:0;stroke-width:0px;"><!></g>'),Id=ke('<g class="group-legend" style="stroke:0;stroke-width:0px;"><!></g>'),Fd=ke('<!><!><g class="axes-box"><!></g><g class="axes-content svelte-1jtdxd0"><!></g><!><!>',1),jd=U('<p class="message-error svelte-1jtdxd0">Axes component was not properly initialized. <br/> Check that you defined axes limits and margins correctly.</p>'),Vd=U('<div class="download-links svelte-1jtdxd0"><button class="svelte-1jtdxd0">⇩ svg</button> <button class="svelte-1jtdxd0">⇩ png</button> <button class="svelte-1jtdxd0">⧉ copy</button></div>'),Od=U(`<div><svg class="plot svelte-1jtdxd0" xmlns="http://www.w3.org/2000/svg"><style>.plot {
            font-family: Arial, Helvetica, sans-serif;
         }

         .plot-labels text {
            font-weight:bold;
            text-anchor:middle;
            user-select: none;
         }

         .series-points text {
            /* dominant-baseline: central;
            alignment-baseline: central */
         }

         .tick-labels text,
         .tick-labels tspan,
         .series-textlabels text,
         .series-textlabels tspan,
         .series-text text,
         .series-text tspan {
            dominant-baseline: middle;
            cursor: default;
            user-select: none;
            -webkit-user-select: none;
         }


         .colormap-legend text,
         .colormap-legend tspan,
         .series-points text,
         .series-points tspan {
            cursor: default;
            user-select: none;
            -webkit-user-select: none;
         }

         .series-points1 text,
         .series-points1 tspan {
            dominant-baseline: middle;
            alignment-baseline: middle;
         }

         .series-points2 text,
         .series-points2 tspan {
            dominant-baseline: central;
            alignment-baseline: central;
         }

         .series-text text,
         .series-text tspan {
            dominant-baseline: middle;
            alignment-baseline: middle;
            text-anchor: middle;
            user-select: none;
            -webkit-user-select: none;
         }

         .tick-labels text,
         .tick-labels tspan {
            user-select: none;
            -webkit-user-select: none;
         }</style><!><svg preserveAspectRatio="none" class="axes"><defs><clipPath><rect></rect></clipPath></defs><!></svg></svg> <!></div>`);function Bs(n,e){me(e,!0);const t=(Ce,De=xt,qe=xt)=>{var vt=de(),Mt=X(vt);{var ur=qt=>{var Ke=de(),He=X(Ke);{var Pt=ht=>{var nt=md(),nr=W(nt);ne(()=>{O(nt,"x",r(ee)[0]-10),O(nt,"y",r(ae)),O(nt,"transform",`rotate(-90, ${r(ee)[0]-10}, ${r(ae)})`),xe(nr,qe().error)}),E(ht,nt)},yt=ht=>{var nt=gd(),nr=W(nt);ne(()=>{O(nt,"x",r(Q)),O(nt,"y",r(ue)[0]),xe(nr,qe().error)}),E(ht,nt)};q(He,ht=>{qe().pos===4?ht(Pt):ht(yt,!1)})}E(qt,Ke)},Vt=qt=>{var Ke=pd(),He=X(Ke);{var Pt=Ae=>{Os(Ae,{get lineCoords(){return De().grid},get lineColor(){return _t.MIDDLEGRAY},lineType:3})};q(He,Ae=>{qe().showGrid&&Ae(Pt)})}var yt=z(He);Os(yt,{get lineCoords(){return De().axisLine},get lineColor(){return _t.DARKGRAY},lineType:1});var ht=z(yt);Os(ht,{get lineCoords(){return De().tickCoords},get lineColor(){return _t.DARKGRAY},lineType:1});var nt=z(ht);{var nr=Ae=>{ci(Ae,{get las(){return qe().las},get pos(){return qe().pos},get tickCoords(){return De().tickCoords},get tickLabels(){return De().tickLabels},get tickColor(){return _t.DARKGRAY},get hideLast(){return qe().hideLast}})};q(nt,Ae=>{De().tickCoords.length===2&&De().tickLabels.length===De().tickCoords[1][0].length&&Ae(nr)})}var pn=z(nt);{var Ge=Ae=>{{let Lt=g(()=>[De().tfLabel]);ci(Ae,{get pos(){return qe().pos},get tickCoords(){return De().tfCoords},get tickLabels(){return r(Lt)},get textColor(){return _t.DARKGRAY}})}};q(pn,Ae=>{De().tickFactor!==0&&Ae(Ge)})}E(qt,Ke)};q(Mt,qt=>{qe().error?qt(ur):qt(Vt,!1)})}E(Ce,vt)},l=(Ce,De=xt,qe=xt)=>{var vt=Sd();const Mt=g(()=>qe().elw+2*qe().elp),ur=g(()=>qe().elp),Vt=g(()=>qe().elh),qt=g(()=>qe().ely);var Ke=W(vt),He=z(Ke);Ne(He,17,()=>De().items,Ie,(Pt,yt,ht)=>{var nt=Ed();O(nt,"x",0);var nr=W(nt);{var pn=yr=>{var pt=xd();ne(()=>{O(pt,"x1",r(ur)),O(pt,"x2",r(Mt)-r(ur)),O(pt,"y1",r(Vt)[ht]/2),O(pt,"y2",r(Vt)[ht]/2),O(pt,"stroke",r(yt).line.lineColor),O(pt,"stroke-width",r(yt).line.lineWidth),O(pt,"stroke-dasharray",r(T)[r(yt).line.lineType-1])}),E(yr,pt)};q(nr,yr=>{r(yt).line&&yr(pn)})}var Ge=z(nr);{var Ae=yr=>{var pt=kd(),Vl=W(pt);ne(()=>{O(pt,"x",r(Mt)/2),O(pt,"y",r(Vt)[ht]/2),O(pt,"fill",r(yt).point.faceColor),O(pt,"stroke-width",r(yt).point.lineWidth),O(pt,"stroke",r(yt).point.lineColor),O(pt,"font-size",r(F)),xe(Vl,Qn[r(yt).point.marker-1])}),E(yr,pt)};q(Ge,yr=>{r(yt).point&&yr(Ae)})}var Lt=z(Ge),sa=W(Lt);kt(sa,()=>r(yt).label,!0),ne(()=>{O(nt,"y",r(qt)[ht]),O(nt,"width",qe().lgw),O(nt,"height",r(Vt)[ht]),O(Lt,"x",r(Mt)+r(ur)),O(Lt,"y",r(Vt)[ht]/2),O(Lt,"fill",_t.LEGEND),O(Lt,"font-size",`${De().fontSize??""}em`)}),E(Pt,nt)}),ne(()=>{O(vt,"x",qe().lgl),O(vt,"y",qe().lgt),O(vt,"height",qe().lgh),O(vt,"width",qe().lgw),O(Ke,"fill",De().faceColor),O(Ke,"stroke",De().lineColor),O(Ke,"stroke-width",De().lineWidth)}),E(Ce,vt)};let s=B(e,"limX",19,()=>[0,1]),a=B(e,"limY",19,()=>[0,1]),o=B(e,"margins",19,()=>[1,1.1,.55,.6]),c=B(e,"downloadLinks",3,"none"),f=B(e,"fileName",3,"plot"),u=B(e,"pngWidth",3,8),d=B(e,"pngHeight",3,8),v=B(e,"pngRes",3,300),h=B(e,"clipboardWidth",3,1200),m=B(e,"clipboardHeight",3,800),p=B(e,"onclick",3,null),w=B(e,"onmousemove",3,null),b=B(e,"onmousedown",3,null),_=B(e,"onmouseup",3,null);function S(Ce,De){if(De&&Ce.target.id=="axes-box"){const qe=ni([Ce.offsetX-r(D)],r(J))[0],vt=ni([Ce.offsetY-r(V)],r($))[0];De(qe,vt)}}const y="plottingArea"+Math.round(Math.random()*1e4);let A=re(0),L=re(0),k=re(0);const C=g(()=>({plot:Hf(r(L),r(k)),x:ii(r(L)),y:ii(r(k))})),N=g(()=>o().map(Ce=>Ce*Vf[r(C).plot])),F=g(()=>qf[r(C).plot]),M=g(()=>zs[r(C).plot]),T=g(()=>Jn[r(C).plot]),R=g(()=>r(ye).show&&r(ye).label!==""?r(F)*1.5:0),D=g(()=>r(pe).show&&r(pe).label!==""?r(F)*1.5:0),V=g(()=>e.title&&e.title!==""?r(F)*1.5:0),P=g(()=>r(L)>r(D)?r(L)-r(D):0),Y=g(()=>r(k)>r(R)+r(V)?r(k)-r(R)-r(V):0),Z=g(()=>r(Y)-r(N)[0]-r(N)[2]),I=g(()=>r(P)-r(N)[1]-r(N)[3]),H=g(()=>ei(s(),2)&&ei(a(),2)&&r(P)>r(N)[1]+r(N)[3]&&r(Y)>r(N)[0]+r(N)[2]),J=g(()=>r(H)?{coords:[r(I)/(s()[1]-s()[0]),s()[0],r(N)[1]],objects:[r(I)/(s()[1]-s()[0]),0,0]}:{coords:[1,0,0],objects:[1,0,0]}),$=g(()=>r(H)?{coords:[-r(Z)/(a()[1]-a()[0]),a()[1],r(N)[2]],objects:[r(Z)/(a()[1]-a()[0]),0,0]}:{coords:[0,1,0],objects:[0,1,0]}),ae=g(()=>r(Z)*.5+r(V)+r(N)[2]),Q=g(()=>r(I)*.5+r(D)+r(N)[1]),ee=g(()=>r(H)?at(s(),r(J)):[0,1]),ue=g(()=>r(H)?at(a(),r($)):[1,0]),Ee=g(()=>qr(e.title)),he=g(()=>r(Ee)?r(Ee).length===e.title.left?1:1.4:0);let we=re(Te({show:!1})),ye=re(Te({show:!1,error:""})),pe=re(Te({show:!1,error:""})),ce=re(Te({show:!1,colmap:null,breaks:null})),K=re(Te({show:!1,items:null,position:null}));const se=g(()=>r(H)&&r(ce)&&r(ce).show?nd(r(ce)):null),le=g(()=>r(H)&&r(ye).show?td(s(),a(),r(C),r($),r(ye)):null),ve=g(()=>r(H)&&r(pe).show?rd(s(),a(),r(C),r(J),r(pe)):null),oe=g(()=>r(H)&&r(se)?ld(r(se),r(I),r(N),r(C)):null),fe=g(()=>r(H)&&r(K)&&r(K).show&&r(ee)?od(r(K),r(ee),r(ue),r(F),r(M)):null);kc("axes",{setBox:Ce=>j(we,Ce,!0),setXAxis:Ce=>j(ye,Ce,!0),setYAxis:Ce=>j(pe,Ce,!0),setColmapLegend:Ce=>j(ce,Ce,!0),setGroupLegend:Ce=>j(K,Ce,!0),scales:()=>r(C),tX:()=>r(J),tY:()=>r($),limX:()=>s(),limY:()=>a()});var Se=Od();let ct;var Pe=W(Se),Be=z(W(Pe));{var Re=Ce=>{var De=Pd(),qe=W(De);{var vt=Ke=>{var He=Ad();O(He,"dx",0),O(He,"dy",0);var Pt=W(He);kt(Pt,()=>r(ye).label,!0),ne(()=>{O(He,"x",r(Q)),O(He,"y",r(Y)+r(V))}),E(Ke,He)};q(qe,Ke=>{r(ye).show&&r(ye).label&&r(ye).label!==""&&Ke(vt)})}var Mt=z(qe);{var ur=Ke=>{var He=Cd();O(He,"dx",0),O(He,"dy",0);var Pt=W(He);kt(Pt,()=>r(pe).label,!0),ne(()=>{O(He,"x",r(F)/1.1*r(pe).labelHeight),O(He,"y",r(ae)),O(He,"transform",`rotate(-90, ${r(F)*r(pe).labelHeight/1.1}, ${r(ae)})`)}),E(Ke,He)};q(Mt,Ke=>{r(pe).show&&r(pe).label&&r(pe).label!==""&&Ke(ur)})}var Vt=z(Mt);{var qt=Ke=>{var He=Td();O(He,"dx",0),O(He,"dy",0);var Pt=W(He);kt(Pt,()=>r(Ee),!0),ne(()=>{O(He,"x",r(Q)),O(He,"y",r(F)*r(he))}),E(Ke,He)};q(Vt,Ke=>{r(Ee)&&r(Ee)!==""&&Ke(qt)})}E(Ce,De)};q(Be,Ce=>{r(H)&&Ce(Re)})}var Ze=z(Be),jt=W(Ze),rr=W(jt),St=W(rr),Gt=z(jt);{var Pr=Ce=>{var De=Fd(),qe=X(De);{var vt=Ge=>{var Ae=Ld(),Lt=W(Ae);t(Lt,()=>r(le),()=>r(ye)),E(Ge,Ae)};q(qe,Ge=>{r(ye).show&&r(le)&&Ge(vt)})}var Mt=z(qe);{var ur=Ge=>{var Ae=Nd(),Lt=W(Ae);t(Lt,()=>r(ve),()=>r(pe)),E(Ge,Ae)};q(Mt,Ge=>{r(pe).show&&r(ve)&&Ge(ur)})}var Vt=z(Mt),qt=W(Vt);{var Ke=Ge=>{var Ae=zd();Ae.__keydown=[zl,S,p],Ae.__click=[zl,S,p],Ae.__mousemove=[di,S,w],Ae.__mousedown=[ui,S,b],Ae.__mouseup=[fi,S,_],ne(()=>{O(Ae,"stroke",r(we).lineColor),O(Ae,"stroke-width",`${r(we).lineWidth??""}px`),O(Ae,"x",r(ee)[0]),O(Ae,"y",r(ue)[1]),O(Ae,"width",r(ee)[1]-r(ee)[0]),O(Ae,"height",r(ue)[0]-r(ue)[1])}),E(Ge,Ae)},He=Ge=>{var Ae=Md();Ae.__keydown=[zl,S,p],Ae.__click=[zl,S,p],Ae.__mousemove=[di,S,w],Ae.__mousedown=[ui,S,b],Ae.__mouseup=[fi,S,_],ne(()=>{O(Ae,"x",r(ee)[0]),O(Ae,"y",r(ue)[1]),O(Ae,"width",r(ee)[1]-r(ee)[0]),O(Ae,"height",r(ue)[0]-r(ue)[1])}),E(Ge,Ae)};q(qt,Ge=>{r(we).show?Ge(Ke):Ge(He,!1)})}var Pt=z(Vt),yt=W(Pt);Er(yt,()=>e.children??xt);var ht=z(Pt);{var nt=Ge=>{var Ae=Rd(),Lt=W(Ae);hd(Lt,()=>r(se),()=>r(oe)),E(Ge,Ae)};q(ht,Ge=>{r(oe)&&Ge(nt)})}var nr=z(ht);{var pn=Ge=>{var Ae=Id(),Lt=W(Ae);l(Lt,()=>r(K),()=>r(fe)),E(Ge,Ae)};q(nr,Ge=>{r(fe)&&Ge(pn)})}ne(()=>O(Pt,"clip-path",`url(#${y})`)),E(Ce,De)};q(Gt,Ce=>{r(H)&&Ce(Pr)})}rn(Pe,Ce=>j(A,Ce),()=>r(A));var Kt=z(Pe,2);{var na=Ce=>{var De=jd();E(Ce,De)},la=Ce=>{var De=Vd(),qe=W(De);qe.__click=[hi,A,f],qe.__keydown=[hi,A,f];var vt=z(qe,2);vt.__click=[mi,A,f,u,d,v],vt.__keydown=[mi,A,f,u,d,v];var Mt=z(vt,2);Mt.__click=[vi,A,h,m],Mt.__keydown=[vi,A,h,m],E(Ce,De)};q(Kt,Ce=>{r(H)?Ce(la,!1):Ce(na)})}ne(Ce=>{ct=ft(Se,1,`plot-container show-download-links-${c()??""}`,"svelte-1jtdxd0",ct,Ce),ot(Pe,`font-size:${r(F)??""}px`),O(Ze,"x",r(D)),O(Ze,"y",r(V)),O(Ze,"width",r(P)),O(Ze,"height",r(Y)),O(rr,"id",y),O(St,"x",r(ee)[0]),O(St,"y",r(ue)[1]),O(St,"width",r(ee)[1]-r(ee)[0]),O(St,"height",r(ue)[0]-r(ue)[1])},[()=>({"plot-error":!r(H)})]),io(Pe,"clientWidth",Ce=>j(L,Ce)),io(Pe,"clientHeight",Ce=>j(k,Ce)),E(n,Se),ge()}st(["keydown","click","mousemove","mousedown","mouseup"]);function qs(n,e){me(e,!0);let t=B(e,"tickLabels",7),l=B(e,"las",3,1),s=B(e,"whole",3,!1),a=B(e,"show",3,!0),o=B(e,"showGrid",3,!1);const c=Rt("axes");_e(()=>{const f=qr(e.label),u=f?f.length===e.label.length?1:1.4:0;let d,v="";e.ticks&&([d,v]=ai(e.ticks,c.limX())),!v&&t()&&(h=>{var m=ql(h,2);t(m[0]),v=m[1]})(si(t(),d)),c.setXAxis({show:a(),error:v,label:f,ticks:d,labelHeight:u,showGrid:o(),las:l(),whole:s(),tickLabels:t()})}),ge()}function Ys(n,e){me(e,!0);let t=B(e,"tickLabels",7),l=B(e,"las",3,1),s=B(e,"whole",3,!1),a=B(e,"show",3,!0),o=B(e,"showGrid",3,!1);const c=Rt("axes");_e(()=>{const f=qr(e.label),u=f?f.length===e.label.length?1:1.4:0;let d,v="";e.ticks&&([d,v]=ai(e.ticks,c.limY())),!v&&t()&&(h=>{var m=ql(h,2);t(m[0]),v=m[1]})(si(t(),d)),c.setYAxis({show:a(),error:v,label:f,ticks:d,labelHeight:u,showGrid:o(),las:l(),whole:s(),tickLabels:t(),pos:4})}),ge()}function Ds(n,e){me(e,!0);let t=B(e,"lineWidth",3,1),l=B(e,"lineColor",3,"#606060");const s=Rt("axes");_e(()=>{s.setBox({show:!0,lineWidth:t(),lineColor:l()})}),ge()}var Bd=(n,e)=>dn(n,"rect",e.onclick),qd=ke("<rect></rect>"),Yd=ke("<g></g>");function Nn(n,e){me(e,!0);let t=B(e,"faceColor",19,()=>_t.PRIMARY),l=B(e,"lineColor",19,t),s=B(e,"lineWidth",3,1),a=B(e,"className",3,"series-rect");const o=g(()=>Tt(e.left,"Rectangles (left)")),c=g(()=>r(o)?Tt(e.top,"Rectangles (top)",r(o).length):null),f=g(()=>r(c)?typeof e.width!="object"?ze.fill(e.width,r(o).length):e.width:null),u=g(()=>r(c)?typeof e.height!="object"?ze.fill(e.height,r(o).length):e.height:null),d=Rt("axes"),v=g(()=>r(o)?at(r(o),d.tX()):null),h=g(()=>r(c)?at(r(c),d.tY()):null),m=g(()=>r(f)?Zn(r(f),d.tX()):null),p=g(()=>r(u)?Zn(r(u),d.tY()):null),w=g(()=>`fill:${t()};stroke:${l()};stroke-width:${s()}px;`),b=g(()=>r(v)&&r(h)&&r(m)&&r(p)&&r(m).length===r(v).length&&r(p).length===r(v).length);var _=de(),S=X(_);{var y=A=>{var L=Yd();L.__click=[Bd,e],Ne(L,21,()=>e.left,Ie,(k,C,N)=>{var F=qd();ne(()=>{O(F,"x",r(v)[N]),O(F,"y",r(h)[N]),O(F,"width",r(m)[N]),O(F,"height",r(p)[N])}),E(k,F)}),ne(()=>{ft(L,0,`series ${a()??""}`),ot(L,r(w))}),E(A,L)};q(S,A=>{r(b)&&A(y)})}E(n,_),ge()}st(["click"]);var Dd=(n,e)=>dn(n,"line",e.onclick),Wd=ke("<line></line>"),Ud=ke('<g class="series series-segment"></g>');function vn(n,e){me(e,!0);let t=B(e,"lineColor",19,()=>_t.PRIMARY),l=B(e,"lineType",3,1),s=B(e,"lineWidth",3,1);const a=g(()=>Tt(e.xStart,"Segments")),o=g(()=>r(a)?Tt(e.yStart,"Segments",r(a).length):null),c=g(()=>r(o)?Tt(e.xEnd,"Segments",r(a).length):null),f=g(()=>r(c)?Tt(e.yEnd,"Segments",r(a).length):null),u=Rt("axes"),d=g(()=>r(a)?at(r(a),u.tX()):null),v=g(()=>r(c)?at(r(c),u.tX()):null),h=g(()=>r(o)?at(r(o),u.tY()):null),m=g(()=>r(f)?at(r(f),u.tY()):null),p=g(()=>`stroke:${t()};stroke-width: ${s()}px;stroke-dasharray:${Jn[u.scales().plot][l()-1]}`),w=g(()=>r(d)&&r(v)&&r(h)&&r(m));var b=de(),_=X(b);{var S=y=>{var A=Ud();A.__click=[Dd,e],Ne(A,21,()=>r(d),Ie,(L,k,C)=>{var N=Wd();ne(()=>{O(N,"x1",r(d)[C]),O(N,"x2",r(v)[C]),O(N,"y1",r(h)[C]),O(N,"y2",r(m)[C])}),E(L,N)}),ne(()=>ot(A,r(p))),E(y,A)};q(_,y=>{r(w)&&y(S)})}E(n,b),ge()}st(["click"]);var Hd=(n,e)=>dn(n,"text",e.onclick),Xd=ke("<text><!></text>"),Gd=ke("<text><!></text>"),Kd=ke("<text><!></text>"),Jd=ke('<g class="series series-textlabels"><!></g>');function hn(n,e){me(e,!0);let t=B(e,"pos",3,0),l=B(e,"faceColor",19,()=>_t.PRIMARY_TEXT),s=B(e,"lineColor",3,"transparent"),a=B(e,"lineWidth",3,0),o=B(e,"textSize",3,1),c=B(e,"rotateAngle",3,0);const f=["middle","middle","start","middle","end"],u=g(()=>Tt(e.xValues,"TextLabels")),d=g(()=>r(u)?Tt(e.yValues,"TextLabels",r(u).length):null),v=g(()=>r(d)?Array.isArray(e.labels)&&e.labels.length!==r(d).length?(console.error('TextLabels: number of elements in "labels" does not match number of coordinates'),null):e.labels:null),h=g(()=>r(v)?typeof e.labels=="string"&&typeof t()!="number"?(console.error('TextLabels: parameter "labels" is provided as single string, so "pos" must be a single number.'),null):t():null),m=Rt("axes"),p=g(()=>r(u)&&r(h)!==null?at(r(u),m.tX()):null),w=g(()=>r(d)&&r(p)?at(r(d),m.tY()):null),b=g(()=>Ms[m.scales().plot]),_=g(()=>[0,0,-r(b),0,r(b),r(b)]),S=g(()=>[0,r(b),0,-r(b),0,r(b)]),y=g(()=>`fill:${l()};stroke-width:${a()}px;stroke:${s()};font-size:${o()}em;`),A=g(()=>r(p)&&r(w)&&r(h)!==null&&r(v)&&r(p).length===r(w).length);var L=de(),k=X(L);{var C=N=>{var F=Jd();F.__click=[Hd,e];var M=W(F);{var T=D=>{var V=de(),P=X(V);Ne(P,17,()=>r(p),Ie,(Y,Z,I)=>{var H=Xd();O(H,"data-id",I);var J=W(H);kt(J,()=>e.labels,!0),ne(()=>{O(H,"x",r(p)[I]),O(H,"y",r(w)[I]),O(H,"dx",r(_)[t()]),O(H,"dy",r(S)[t()]),O(H,"transform",c()!==void 0?`rotate(${c()}, ${r(p)[I]+r(_)[t()]}, ${r(w)[I]+r(S)[t()]})`:""),O(H,"text-anchor",f[t()[I]])}),E(Y,H)}),E(D,V)},R=D=>{var V=de(),P=X(V);{var Y=I=>{var H=de(),J=X(H);Ne(J,17,()=>r(p),Ie,($,ae,Q)=>{var ee=Gd();O(ee,"data-id",Q);var ue=W(ee);kt(ue,()=>e.labels[Q],!0),ne(()=>{O(ee,"x",r(p)[Q]),O(ee,"y",r(w)[Q]),O(ee,"dx",r(_)[t()[Q]]),O(ee,"dy",r(S)[t()[Q]]),O(ee,"transform",c()!==void 0?`rotate(${c()}, ${r(p)[Q]+r(_)[t()]}, ${r(w)[Q]+r(S)[t()]})`:""),O(ee,"text-anchor",f[t()[Q]])}),E($,ee)}),E(I,H)},Z=I=>{var H=de(),J=X(H);Ne(J,17,()=>r(p),Ie,($,ae,Q)=>{var ee=Kd();O(ee,"data-id",Q);var ue=W(ee);kt(ue,()=>e.labels[Q],!0),ne(()=>{O(ee,"x",r(p)[Q]),O(ee,"y",r(w)[Q]),O(ee,"dx",r(_)[t()]),O(ee,"dy",r(S)[t()]),O(ee,"transform",c()!==void 0?`rotate(${c()}, ${r(p)[Q]+r(_)[t()]}, ${r(w)[Q]+r(S)[t()]})`:""),O(ee,"text-anchor",f[t()])}),E($,ee)}),E(I,H)};q(P,I=>{Array.isArray(t())||ArrayBuffer.isView(t())?I(Y):I(Z,!1)},!0)}E(D,V)};q(M,D=>{typeof e.labels=="string"?D(T):D(R,!1)})}ne(()=>ot(F,r(y))),E(N,F)};q(k,N=>{r(A)&&N(C)})}E(n,L),ge()}st(["click"]),st(["click"]);function Qd(n,e){me(e,!0);let t=B(e,"barWidth",3,.8),l=B(e,"faceColor",19,()=>_t.PRIMARY),s=B(e,"lineColor",19,()=>_t.PRIMARY),a=B(e,"lineWidth",3,1);const o=g(()=>t()<=0||t()>1?(console.error('Bars: parameter "barWidth" should be between 0 and 1.'),null):t()),c=g(()=>{if(!r(o))return null;const m=Tt(e.xValues,"BarSeries");if(!m)return null;const p=m.length;if(p<1)return null;let w;if(e.barWidthExact)w=e.barWidthExact;else{if(p==1)return console.error('Bars: if only one bar must be shown, value for property "barWidthExact" should be provided.'),null;{w=0;let y=0;for(let A=1;A<p;A++)y=Math.abs(m.v[A-1]-m.v[A]),y>w&&(w=y)}}w=w*t();const b=w/2,_=ze.zeros(p),S=ze.zeros(p);for(let y=0;y<p;y++)_.v[y]=m.v[y]-b,S.v[y]=w;return{left:_,width:S}}),f=g(()=>{if(!r(c))return null;const m=Tt(e.yValues,"BarSeries");if(!m)return null;const p=m.length;if(p!==r(c).left.length)return console.error('BarSeries: parameters "yValues" must be vector of the same length as "xValues".'),null;const w=ze.zeros(p),b=ze.zeros(p);for(let _=0;_<p;_++){const S=m.v[_];w.v[_]=S>0?S:0,b.v[_]=Math.abs(S)}return{top:w,height:b}}),u=g(()=>r(c)&&r(f));var d=de(),v=X(d);{var h=m=>{Nn(m,{className:"series series-bar",get left(){return r(c).left},get width(){return r(c).width},get top(){return r(f).top},get height(){return r(f).height},get lineWidth(){return a()},get lineColor(){return s()},get faceColor(){return l()},get onclick(){return e.onclick}})};q(v,m=>{r(u)&&m(h)})}E(n,d),ge()}var Zd=(n,e)=>dn(n,"text",e.onclick),$d=ke("<text> </text>"),ev=ke('<g text-anchor="middle"></g>');function Ws(n,e){me(e,!0);let t=B(e,"marker",3,1),l=B(e,"faceColor",3,"transparent"),s=B(e,"lineColor",19,()=>_t.PRIMARY),a=B(e,"lineWidth",3,1),o=B(e,"markerSize",3,1);const c=g(()=>typeof t()!="number"||t()<1||t()>Qn.length?(console.error('Points: parameter "marker" must be a number from 1 to '+Qn.length+"."),null):Qn[t()-1]),f=g(()=>Tt(e.xValues,"Points")),u=g(()=>r(f)?Tt(e.yValues,"Points",r(f).length):null),d=Rt("axes"),v=g(()=>r(f)?at(r(f),d.tX()):null),h=g(()=>r(v)&&r(u)?at(r(u),d.tY()):null),m=g(()=>["＋","✳","✕"].includes(r(c))?`fill:${s()&&s()!=="transparent"?s():l()};stroke-width:0px;font-size:${o()}em;`:`fill:${l()};stroke-width:${a()}px;stroke:${s()}; font-size:${o()}em;`),p=g(()=>["◼","⬥","＋","✳","✕"].includes(r(c))?"series-points2":"series-points1"),w=g(()=>r(v)&&r(h)&&r(v).length===r(h).length);var b=de(),_=X(b);{var S=y=>{var A=ev();A.__click=[Zd,e],Ne(A,21,()=>r(v),Ie,(L,k,C)=>{var N=$d(),F=W(N);ne(()=>{O(N,"x",r(v)[C]),O(N,"y",r(h)[C]),xe(F,r(c))}),E(L,N)}),ne(()=>{ft(A,0,`series series-points ${r(p)??""}`),ot(A,r(m))}),E(y,A)};q(_,y=>{r(w)&&y(S)})}E(n,b),ge()}st(["click"]);var tv=(n,e)=>dn(n,"polyline",e.onclick),rv=ke('<g class="series series-line"><polyline class="line"></polyline></g>');function _r(n,e){me(e,!0);let t=B(e,"lineColor",19,()=>_t.PRIMARY),l=B(e,"lineType",3,1),s=B(e,"lineWidth",3,1);const a=g(()=>Tt(e.xValues,"Lines")),o=g(()=>r(a)?Tt(e.yValues,"Lines",r(a).length):null),c=Rt("axes"),f=g(()=>r(a)&&r(o)?Fs(r(a),r(o),c.tX(),c.tY()):null),u=g(()=>`fill:transparent;stroke:${t()};stroke-width: ${s()}px; stroke-dasharray:${Jn[c.scales().plot][l()-1]}`);var d=de(),v=X(d);{var h=m=>{var p=rv();p.__click=[tv,e];var w=W(p);ne(()=>{ot(p,r(u)),O(w,"points",r(f))}),E(m,p)};q(v,m=>{r(f)&&m(h)})}E(n,d),ge()}st(["click"]);var nv=(n,e)=>dn(n,"polyline",e.onclick),lv=ke('<polyline class="line"></polyline>'),sv=ke('<g class="series series-multiline"></g>');function gi(n,e){me(e,!0);let t=B(e,"lineColor",19,()=>_t.PRIMARY),l=B(e,"lineType",3,1),s=B(e,"lineWidth",3,1);const a=g(()=>Tt(e.xValues,"Multilines")),o=g(()=>r(a)?tr(e.yValues)?(r(a).length!==e.yValues.nrows&&console.error('Multilines: parameter "xValues" must have the same number of values as number of rows in "yValues".'),e.yValues):(console.error('Multilines: parameter "yValues" must be a matrix.'),null):null),c=Rt("axes"),f=g(()=>{if(!r(a)||!r(o))return null;const m=new Array(r(o).ncols);for(let p=0;p<m.length;p++)m[p]=Fs(r(a),r(o).getcolumn(p+1),c.tX(),c.tY());return m}),u=g(()=>`fill:transparent;stroke:${t()};stroke-width: ${s()}px; stroke-dasharray:${Jn[c.scales().plot][l()-1]}`);var d=de(),v=X(d);{var h=m=>{var p=sv();p.__click=[nv,e],Ne(p,21,()=>r(f),Ie,(w,b)=>{var _=lv();ne(()=>O(_,"points",r(b))),E(w,_)}),ne(()=>ot(p,r(u))),E(m,p)};q(v,m=>{r(f)&&r(f).length>0&&m(h)})}E(n,d),ge()}st(["click"]);function av(...n){const e=n.length,t=n.map(o=>o.length);let l=bs(t),s=Array(e),a=1;for(let o=0;o<e;o++){const c=Fe(n[o])?n[o]:Ye(n[o]),f=c.length;l=l/f,s[o]=c.subset(dt.seq(1,f).repeach(a).rep(l)),a=a*f}return s}var ov=ke("<rect></rect>"),iv=ke('<g title="heatmap-group"><!></g>'),cv=ke('<g class="heatmap" style="stroke:0;stroke-width:0px;"></g>');function uv(n,e){me(e,!0);let t=B(e,"colmap",3,null),l=g(()=>tr(e.values)&&e.values.nrows>0&&e.values.ncols>0?e.values:null),s=g(()=>r(l)?e.breaks&&Array.isArray(e.breaks)?e.breaks:e.breaks&&Fe(e.breaks)?e.breaks.v:Al(r(l).v,Wf).v:null),a=g(()=>t()?Array.isArray(t())?t().length!==e.breaks.length-1?(console.error("Heatmap: number of color values in colormap does not match number of intervals defined by breaks."),null):t():(console.error('Heatmap: parameter "colmap" must be array with colors.'),null):Vs(r(s).length-1)),o=g(()=>r(l)?$o(r(l).ncols):null),c=g(()=>r(l)?$o(r(l).nrows):null),f=g(()=>r(o)&&r(c)?av(r(c),r(o)):null),u=g(()=>{if(!r(f)||!r(s)||!r(a))return null;const[y,A]=r(f),L=A.length,k=r(s).length,C=Array(k).fill().map(()=>[]),N=Array(k).fill().map(()=>[]),F=r(s).slice(),M=F[1]-F[0];F[0]=F[0]-.1*M,F[k-1]=F[k-1]+.1*M;for(let T=0;T<L;T++){const R=r(l).v[T];for(let D=0;D<k-1;D++)if(R>F[D]&&R<=F[D+1]){C[D].push(A.v[T]-.5),N[D].push(r(l).nrows-y.v[T]+1.5);break}}return{rl:C,rt:N}});const d=Rt("axes");let v=g(()=>r(u)?r(u).rl.map(y=>y.length>0?at(y,d.tX()):[]):null),h=g(()=>r(u)?r(u).rt.map(y=>y.length>0?at(y,d.tY()):[]):null),m=g(()=>Zn([1],d.tX())),p=g(()=>Zn([1],d.tY())),w=g(()=>r(v)&&r(h)&&r(v).length===r(h).length);var b=de(),_=X(b);{var S=y=>{var A=cv();Ne(A,21,()=>r(a),Ie,(L,k,C)=>{var N=iv(),F=W(N);{var M=T=>{var R=de(),D=X(R);Ne(D,17,()=>r(v)[C],Ie,(V,P,Y,Z)=>{var I=ov();ne(()=>{O(I,"x",r(v)[C][Y]),O(I,"y",r(h)[C][Y]),O(I,"width",r(m)),O(I,"height",r(p))}),E(V,I)}),E(T,R)};q(F,T=>{r(v)[C].length>0&&T(M)})}ne(()=>ot(N,`fill:${r(k)??""};`)),E(L,N)}),E(y,A)};q(_,y=>{r(w)&&y(S)})}E(n,b),ge()}function Ml(n,e){me(e,!0);let t=B(e,"show",3,!0),l=B(e,"position",3,"topleft"),s=B(e,"lineColor",19,()=>_t.LEGEND),a=B(e,"lineWidth",3,1),o=B(e,"faceColor",3,"#fff"),c=B(e,"fontSize",3,.85);function f(v){return typeof v!="string"?(console.error('Legend: value of "position" must be a string.'),null):["top","left","right","topleft","topright","bottom","bottomleft","bottomright"].includes(v)?v:(console.error('Legend: wrong value of "position" property'),null)}function u(v){if(!v||!Array.isArray(v)||v.length<1)return console.error('Legend: property "items" must be provided as array of JSONs.'),null;for(let h=0;h<v.length;h++){const m=v[h];if(!m.label)return console.error('Legend: all elements of "items" must include at least one field: "label".'),null;const p=qr(m.label),w=p.length===m.label?1:1.4;m.label=p,m.labelHeight=w,m.line&&(m.line.lineType||(m.line.lineType=1),m.line.lineType>0&&m.line.lineType<=4||console.error('Legend: parameter "lineType" for legend item '+(h+1)+" is incorrect."),m.line.lineColor=m.line.lineColor?m.line.lineColor:_t.PRIMARY,m.line.lineWidth=m.line.lineWidth?m.line.lineWidth:1),m.point&&(m.point.marker||(m.point.marker=1),m.point.marker>0&&m.point.marker<=Qn.length||console.error('Legend: parameter "marker" for legend item '+(h+1)+" is incorrect."),m.point.faceColor=m.point.faceColor?m.point.faceColor:"transparent",m.point.lineWidth=m.point.lineWidth?m.point.lineWidth:1,m.point.lineColor=m.point.lineColor?m.point.lineColor:_t.PRIMARY)}return v}const d=Rt("axes");_e(()=>{const v=u(e.items),h=f(l());d.setGroupLegend(v&&h?{show:t(),position:l(),items:e.items,lineColor:s(),faceColor:o(),lineWidth:a(),fontSize:c()}:{show:!1,position:null,items:null})}),ge()}function pi(n,e){me(e,!0);let t=B(e,"show",3,!0),l=B(e,"labels",3,null),s=B(e,"labelColor",19,()=>_t.CLEGEND_LABELS),a=B(e,"fontSize",3,.85);const o=Rt("axes");_e(()=>{o.setColmapLegend({show:t(),breaks:e.breaks,colmap:e.colmap,labels:l(),labelColor:s(),fontSize:a()})}),ge()}const fv=n=>n;function bi(n,{delay:e=0,duration:t=400,easing:l=fv}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:l,css:a=>`opacity: ${a*s}`}}var dv=U('<div><div class="modal svelte-q7wo60"><div class="header svelte-q7wo60"><button class="close-button svelte-q7wo60">✕</button></div> <div class="body svelte-q7wo60"><!></div></div></div>');function Us(n,e){me(e,!0);let t=B(e,"isDark",3,!1);function l(v){v.key==="Escape"&&e.closeModal()}var s=dv();en("keydown",ts,l);let a;var o=W(s),c=W(o),f=W(c);f.__click=function(...v){var h;(h=e.closeModal)==null||h.apply(this,v)};var u=z(c,2),d=W(u);Er(d,()=>e.children),ne(v=>a=ft(s,1,"drop svelte-q7wo60",null,a,v),[()=>({isdark:t()})]),oo(7,s,()=>bi),E(n,s),ge()}st(["click"]);const vv=[1,1.1,.45,.4],ir={cal:"#2679B2",pv:"#D22C2F",target:"#2679B2",test:"#2679B2",alt:"#2679B2",new:"#2679B2"},Yr={cal:"#f0f8ff",pv:"#fff8f0",target:"#f0f8ff",test:"#f0f8ff",alt:"#f0f8ff",new:"#f0f8ff"},Rl="#a0a0a0",_i="#909090",$n="#909090",wi=8,hv=8,mv=8,gv=600;function pv(n,e,t){const l=e.length,s=new Array(n.length),a=e[1]-e[0];for(let o=0;o<n.length;o++)for(let c=0;c<l-1;c++){const f=n[o]>=e[c],u=c===l-2?n[o]<e[c+1]+a:n[o]<e[c+1];if(f&&u){s[o]=t[c];break}}return s}function yi(n,e,t,l){if(!n||!e)return null;const s=n.length;let a=ze.zeros(s),o=Number.NEGATIVE_INFINITY,c=Number.POSITIVE_INFINITY;if(l==="log")for(let f=0;f<s;f++){const u=Math.log(1+n[f]/t);a.v[f]=u,o=Math.max(o,u),c=Math.min(c,u)}else for(let f=0;f<s;f++){const u=n[f]/t;a.v[f]=u,o=Math.max(o,u),c=Math.min(c,u)}return{values:a,min:c,max:o}}function xi(n,e){return{z:"Full y-distance",f:"Full x-distance",q:"Orthogonal distance",h:"Score distance"}[n]+", "+(e==="log"?"log(1 + "+n+"/"+n+"0)":n+"/"+n+"0")}function ki(n,e,t,l){const a=e+t,c=xo(n,a)/t,f=-e/t,u=-c/f,d=ze.seq(0,u*1,u/100),v=d.apply(h=>h*f+c);return{x:l==="log"?d.apply(h=>Math.log(1+h)):d,y:l==="log"?v.apply(h=>Math.log(1+h)):v}}function bv(n,e,t,l=4){const s=Math.abs(t-e);let a;return s<1?a=Math.min(Math.round(Math.abs(Math.log10(s))+1),l):s<10?a=2:s<100?a=1:a=0,Array.from(n).map(o=>o.toFixed(a).toString())}var _v=U("<!> <!> <!> <!>",1);function wr(n,e){let t=B(e,"whole",3,!1),l=nn(e,["$$slots","$$events","$$legacy","title","limX","limY","xLabel","yLabel","whole","fileName","children"]);Bs(n,Or({get title(){return e.title},get limX(){return e.limX},get limY(){return e.limY},get fileName(){return e.fileName},downloadLinks:"hover",get margins(){return vv},get pngWidth(){return hv},get pngHeight(){return mv},get pngRes(){return gv}},()=>l,{children:(s,a)=>{var o=_v(),c=X(o);Er(c,()=>e.children);var f=z(c,2);qs(f,{showGrid:!0,get label(){return e.xLabel},get whole(){return t()}});var u=z(f,2);Ys(u,{showGrid:!0,get label(){return e.yLabel}});var d=z(u,2);Ds(d,{}),E(s,o)},$$slots:{default:!0}}))}function wv(n,e){if(n.target.tagName!=="rect"){j(e,-1);return}const t=Array.from(n.target.parentNode.children).indexOf(n.target);if(t<0){j(e,-1);return}r(e)!==t&&j(e,t,!0)}var yv=U("<!> <!> <!>",1),xv=U("<!> <!> <!> <!> <!>",1),kv=U("<div><!></div>"),Ev=U('<div class="wrapper svelte-ha02r1"><div class="plot-container svelte-ha02r1" role="tooltip"><!></div> <div class="msg-select svelte-ha02r1">click inside the plot to see a variable label</div> <div class="plot-controls svelte-ha02r1"><div><!></div> <!></div></div>');function Hs(n,e){me(e,!0);let t=B(e,"outliers",19,()=>[]),l=B(e,"model_getter",3,Fu),s=B(e,"res_getter",3,Mo),a=re("residual"),o=re(-1);const c=g(()=>e.res?Object.keys(e.res):null);let f=re(Te(r(c)?r(c)[0]:null));const u=g(()=>r(h)&&r(o)>=0?r(h).values.v[r(o)]:null),d=g(()=>r(V)&&r(o)>=0?r(V).sel.v[r(o)]:null),v=g(()=>e.model&&r(o)>=0?e.model.varlabels[r(o)]:null),h=g(()=>{if(!e.model)return null;const J=e.model.nresp?e.model.nresp:0,$=Ye(e.model.varvalues.filter((we,ye)=>ye>=J)),ae=$.length,Q=($.v[1]-$.v[0])/2,ee=($.v[ae-1]-$.v[ae-2])/2,ue=[$.v[0],$.v[ae-1]],Ee=[ue[0]-Q,ue[1]+ee],he=(ue[1]-ue[0])/ae;return{values:$,lim:Ee,width:he,hwidth:he*.5}}),m=g(()=>r(h)?r(h).values.apply(J=>J-r(h).hwidth):null),p=g(()=>r(f)?e.res[r(f)]:null),w=g(()=>r(p)?new $e(s()(r(p),"T"),r(p).nrows,r(p).ncomp):null),b=g(()=>r(p)?new $e(s()(r(p),"E"),r(p).nrows,r(p).npred).t():null),_=g(()=>e.model?new $e(l()(e.model,"P"),e.model.npred,e.model.ncomp):null),S=g(()=>e.ncomp?dt.seq(1,e.ncomp):null),y=g(()=>e.ncomp<e.model.ncomp?dt.seq(e.ncomp+1,e.model.ncomp):null),A=g(()=>r(w)&&r(S)?r(w).subset(null,r(S)):null),L=g(()=>r(w)&&r(S)?r(_).subset(null,r(S)):null),k=g(()=>r(w)&&r(y)?r(w).subset(null,r(y)):null),C=g(()=>r(w)&&r(y)?r(_).subset(null,r(y)):null),N=g(()=>r(A)&&r(L)?So(r(L),r(A)):null),F=g(()=>r(k)&&r(C)?So(r(C),r(k)).add(r(b)):r(b)),M=g(()=>r(N)&&r(F)?r(N).add(r(F)):null);let T=g(()=>r(N)?r(N).getcolumn(e.selected+1):null),R=g(()=>r(F)?r(F).getcolumn(e.selected+1):null),D=g(()=>r(M)?r(M).getcolumn(e.selected+1):null),V=g(()=>{if(!r(T)||!r(R)||!r(D))return null;const J=r(a)==="explained"?{all:r(N),sel:r(T),label:"Explained part, TP^T"}:r(a)==="residual"?{all:r(F),sel:r(R),label:"Residuals, E"}:{all:r(M),sel:r(D),label:"Preprocessed data, X"},$=ln(J.all.v),ae=$[1]-$[0],Q=[$[0]-ae/50,$[1]+ae/12],ee=ze.fill($[1],J.sel.length);return J.lim=Q,J.top=ee,J.height=ae,J});const P=g(()=>r(p)&&e.selected>=0?`Object ${r(p).objlabels[e.selected].replace("_","-")}`:null),Y=g(()=>e.model?e.model.varvaluesName+(e.model.varvaluesUnits?", "+e.model.varvaluesUnits:""):null);var Z=de(),I=X(Z);{var H=J=>{Us(J,{get closeModal(){return e.closeModal},children:($,ae)=>{var Q=Ev(),ee=W(Q);ee.__click=[wv,o];var ue=W(ee);wr(ue,{get title(){return r(P)},get yLabel(){return r(V).label},get xLabel(){return r(Y)},get limY(){return r(V).lim},get limX(){return r(h).lim},fileName:"plot-contributions",children:(ce,K)=>{var se=xv(),le=X(se);gi(le,{get xValues(){return r(h).values},get yValues(){return r(V).all},lineColor:"#e0e0e0"});var ve=z(le,2);{var oe=Be=>{var Re=de(),Ze=X(Re);Ne(Ze,17,t,Ie,(jt,rr)=>{{let St=g(()=>r(V).all.getcolumn(r(rr)+1));_r(jt,{get xValues(){return r(h).values},get yValues(){return r(St)},lineColor:"#ffdd88"})}}),E(Be,Re)};q(ve,Be=>{t().length>0&&Be(oe)})}var fe=z(ve,2);_r(fe,{get xValues(){return r(h).values},get yValues(){return r(V).sel},lineColor:"crimson"});var Se=z(fe,2);Nn(Se,{get left(){return r(m)},get top(){return r(V).top},get height(){return r(V).height},get width(){return r(h).width},faceColor:"transparent",borderColor:"transparent"});var ct=z(Se,2);{var Pe=Be=>{var Re=yv(),Ze=X(Re);{let St=g(()=>[r(u)]),Gt=g(()=>[r(V).top.v[0]]),Pr=g(()=>[r(v)]);hn(Ze,{get xValues(){return r(St)},get yValues(){return r(Gt)},get labels(){return r(Pr)},pos:3,textSize:.85})}var jt=z(Ze,2);{let St=g(()=>[r(u)]),Gt=g(()=>[r(d)]);Ws(jt,{get xValues(){return r(St)},get yValues(){return r(Gt)},faceColor:"crimson",lineColor:"crimson"})}var rr=z(jt,2);{let St=g(()=>[r(m).v[r(o)]]),Gt=g(()=>[r(V).top.v[r(o)]]);Nn(rr,{get left(){return r(St)},get top(){return r(Gt)},get height(){return r(V).height},get width(){return r(h).width},faceColor:"#ff000015"})}E(Be,Re)};q(ct,Be=>{r(o)>=0&&Be(Pe)})}E(ce,se)},$$slots:{default:!0}});var Ee=z(ee,4),he=W(Ee),we=W(he);ie(we,{label:"Show",children:(ce,K)=>{Oe(ce,{id:"type",options:["full","explained","residual"],get value(){return r(a)},set value(se){j(a,se,!0)}})},$$slots:{default:!0}});var ye=z(he,2);{var pe=ce=>{var K=kv(),se=W(K);ie(se,{label:"For",children:(le,ve)=>{Oe(le,{id:"type",get options(){return r(c)},get value(){return r(f)},set value(oe){j(f,oe,!0)}})},$$slots:{default:!0}}),E(ce,K)};q(ye,ce=>{r(c).length>1&&ce(pe)})}E($,Q)},$$slots:{default:!0}})};q(I,J=>{r(h)&&r(V)&&J(H)})}E(n,Z),ge()}st(["click"]);function Sv(n,e){let t=0,l=0;n.nresp>0&&(t=new ze(n.values.v.slice(0,n.values.nrows)),l=1);const s=new $e(n.values.v.slice(l*n.values.nrows),n.values.nrows,n.values.ncols-l).t(),a=s.ncols<e?1:Math.round(s.ncols/e),o=dt.seq(1,s.ncols,a),c=s.subset(null,o),f=t?t.subset(o):null,u=n.classes?n.classes.filter((d,v)=>o.v.includes(v)):null;return{classNames:n.classNames,classes:u,resp:f,values:c,varvalues:n.varvalues.filter((d,v)=>v>=l),varindices:n.varindices.filter((d,v)=>v>=l),varaxisLabel:n.varvaluesUnits?n.varvaluesName+" "+n.varvaluesUnits:n.varvaluesName,varaxisUnits:n.varvaluesUnits}}function Xs(n,e){return{values:e||n.values.copy(),varvalues:n.varvalues,varindices:n.varindices,varaxisLabel:n.varaxisLabel}}function Av(n,e){if(!e||e.nrows!==n.values.nrows||e.ncols!==n.values.ncols)throw new Error("Object with values seems to be wrong for cloning.");const t=structuredClone(n);return t.values=e,t}var Cv=U(' <span class="svelte-1l1cvmx"><!></span>',1),Tv=U('<span class="info-details svelte-1l1cvmx"><!></span>');function Gs(n,e){me(e,!0);var t=Tv(),l=W(t);{var s=o=>{var c=Cv(),f=X(c),u=z(f),d=W(u);kt(d,()=>Yu(e.prepmodel)),ne(()=>xe(f,`${e.prepmodel.ml.length+" method"+(e.prepmodel.ml.length>1?"s":"")} `)),E(o,c)},a=o=>{var c=eu("skipped");E(o,c)};q(l,o=>{e.prepmodel.ml?o(s):o(a,!1)})}E(n,t),ge()}var Pv=U('<span>file:</span> <span class="file-name svelte-1dxrrpt"> </span><br/>',1),Lv=U('<p class="info-text svelte-1dxrrpt"><span style="display:inline-block;font-weight:bold;padding-bottom: 0.25em;">Preprocessing model</span><br/> <!> <span style="color:#a0a0a0;">variables</span>, <!></p> <!>',1);function Nv(n,e){me(e,!0);var t=de(),l=X(t);{var s=a=>{ie(a,{name:"info",children:(o,c)=>{var f=Lv(),u=X(f),d=z(W(u),3);{var v=b=>{var _=Pv(),S=z(X(_),2),y=W(S);ne(()=>{O(S,"title",e.model.fileName),xe(y,e.model.fileName)}),E(b,_)};q(d,b=>{e.model.fileName&&b(v)})}var h=z(d),m=z(h,3);Gs(m,{get prepmodel(){return e.model}});var p=z(u,2);{var w=b=>{or(b,{get onclick(){return e.reset}})};q(p,b=>{e.reset&&b(w)})}ne(()=>xe(h,` ${e.model.npred??""} `)),E(o,f)},$$slots:{default:!0}})};q(l,a=>{e.model&&a(s)})}E(n,t),ge()}var zv=U("<!> <!>",1),Mv=U("<p><!></p>"),Rv=U("<!> <!>",1);function Iv(n,e){me(e,!0);let t=B(e,"model",15),l=re(""),s=re("neutral"),a=re("");function o(b){try{const _=JSON.parse(b,Cs);if(Array.isArray(_.v)&&(_.v=Float64Array.from(_.v)),!Object.keys(_).includes("class")||_.class[0]!=="prepmodel")throw Error("The JSON file you selected does not contain preprocessing model.");_.fileName=r(u),t(_),j(s,"success"),j(a,"")}catch(_){console.log(_),t(null),j(s,"error"),j(a,_,!0)}}function c(b){const _=new FileReader;_.onload=()=>{o(_.result)},_.readAsText(r(l))}function f(){j(l,""),t(null),j(s,"neutral"),j(a,"")}_e(()=>{r(l)===null?(t(null),j(s,"neutral"),j(a,"")):(j(s,"neutral"),j(a,""))});let u=g(()=>r(l)?r(l).name.replace(/\.[^/.]+$/,""):"");var d=Rv(),v=X(d);{var h=b=>{var _=zv(),S=X(_);Ln(S,()=>r(l),L=>{ie(L,{name:"file-selector",children:(k,C)=>{Ll(k,{id:"modelFile",acceptType:".json",message:"Select file with model",get file(){return r(l)},set file(N){j(l,N,!0)}})},$$slots:{default:!0}})});var y=z(S,2);{var A=L=>{ie(L,{name:"load-button",label:" ",children:(k,C)=>{et(k,{onclick:c,text:"Load"})},$$slots:{default:!0}})};q(y,L=>{r(l)&&L(A)})}E(b,_)},m=b=>{Nv(b,{get model(){return t()},reset:f})};q(v,b=>{t()?b(m,!1):b(h)})}var p=z(v,2);{var w=b=>{ie(b,{name:"error",status:"error",children:(_,S)=>{var y=Mv(),A=W(y);kt(A,()=>r(a)),E(_,y)},$$slots:{default:!0}})};q(p,b=>{(r(s)==="error"||r(a))&&b(w)})}E(n,d),ge()}var Fv=U('<p class="title"> </p>'),jv=U('<div class="method-open svelte-2gffce"><!> <!> <!></div>'),Vv=(n,e)=>e.open(e.pos),Ov=U('<p> <span title="Edit" class="svelte-2gffce"> </span></p> <!> <!> <!>',1);function zn(n,e){me(e,!0);var t=de(),l=X(t);{var s=o=>{var c=jv(),f=W(c);ie(f,{children:(v,h)=>{var m=Fv(),p=W(m);ne(()=>xe(p,e.title)),E(v,m)},$$slots:{default:!0}});var u=z(f,2);Er(u,()=>e.children);var d=z(u,2);ie(d,{label:" ",children:(v,h)=>{et(v,{text:"Save",get onclick(){return e.apply}})},$$slots:{default:!0}}),oo(3,c,()=>bi,()=>({duration:10})),E(o,c)},a=o=>{ie(o,{children:(c,f)=>{var u=Ov(),d=X(u),v=W(d),h=z(v);h.__click=[Vv,e];var m=W(h),p=z(d,2);af(p,{onclick:()=>e.moveUp(e.pos)});var w=z(p,2);of(w,{onclick:()=>e.moveDown(e.pos)});var b=z(w,2);or(b,{onclick:()=>e.remove(e.pos)}),ne(()=>{xe(v,`${e.title??""} `),xe(m,e.settings)}),E(c,u)},$$slots:{default:!0}})};q(l,o=>{e.isOpen?o(s):o(a,!1)})}E(n,t),ge()}st(["click"]);var Bv=U("<!> <!>",1);function qv(n,e){me(e,!0);let t=B(e,"params",31,()=>Te([0,0])),l=B(e,"varind",15),s=B(e,"settings",15),a=B(e,"nvars",3,0),o=nn(e,["$$slots","$$events","$$legacy","params","varind","settings","isOpen","nvars"]);const c={snv:0,area:1,length:2,var:3},f=Object.keys(c);let u=re(Te(f[t()[0]])),d=re(t()[1]+1);const v="Normalization";_e(()=>{s(r(u)+(r(u)==="var"?" #"+r(d):""))}),_e(()=>{r(u)==="var"?l(l()[0]=t()[1]>0?t()[1]:1,!0):l(l()[0]=-1,!0)}),_e(()=>{r(u)==="var"&&e.isOpen?l(l()[0]=t()[1],!0):l(l()[0]=-1,!0)}),_e(()=>{r(u)&&t(t()[0]=c[r(u)],!0)}),_e(()=>{r(d)&&t(t()[1]=r(d)-1,!0)}),zn(n,Or({id:"norm",title:v,get settings(){return s()},get isOpen(){return e.isOpen}},()=>o,{children:(h,m)=>{var p=Bv(),w=X(p);ie(w,{label:"Type",children:(S,y)=>{Oe(S,{get options(){return f},get value(){return r(u)},set value(A){j(u,A,!0)}})},$$slots:{default:!0}});var b=z(w,2);{var _=S=>{ie(S,{label:"Variable index",children:(y,A)=>{Bt(y,{min:1,get max(){return a()},step:1,get value(){return r(d)},set value(L){j(d,L,!0)}})},$$slots:{default:!0}})};q(b,S=>{r(u)==="var"&&S(_)})}E(h,p)},$$slots:{default:!0}})),ge()}var Yv=U("<!> <!> <!>",1);function Dv(n,e){me(e,!0);let t=B(e,"params",31,()=>Te([3,1,0])),l=B(e,"settings",15),s=nn(e,["$$slots","$$events","$$legacy","params","settings","nvars"]);const a=g(()=>{if(!e.nvars)return 3;const u=Math.round(e.nvars*.25);return u>39?39:u%2<1?u+1:u}),o=g(()=>t()[1]<2?[0,1]:[0,1,2]),c=g(()=>t()[0]<5?[1,2]:[1,2,3]);_e(()=>{t()[0]<5&&t()[1]>2&&t(t()[1]=2,!0)}),_e(()=>{t()[2]>t()[1]&&t(t()[2]=t()[1],!0)}),_e(()=>{l(t()[0]+", "+t()[1]+", "+t()[2])}),zn(n,Or({id:"savgol",title:"Savitzkiy-Golay",get settings(){return l()}},()=>s,{children:(u,d)=>{var v=Yv(),h=X(v);ie(h,{label:"Width",children:(w,b)=>{Bt(w,{min:3,get max(){return r(a)},step:2,get value(){return t()[0]},set value(_){t(t()[0]=_,!0)}})},$$slots:{default:!0}});var m=z(h,2);ie(m,{label:"Polynomial",children:(w,b)=>{Oe(w,{get options(){return r(c)},get value(){return t()[1]},set value(_){t(t()[1]=_,!0)}})},$$slots:{default:!0}});var p=z(m,2);ie(p,{label:"Derivative",children:(w,b)=>{Oe(w,{get options(){return r(o)},get value(){return t()[2]},set value(_){t(t()[2]=_,!0)}})},$$slots:{default:!0}}),E(u,v)},$$slots:{default:!0}})),ge()}var Wv=U("<!> <!>",1);function Uv(n,e){me(e,!0);let t=B(e,"params",31,()=>Te([1,0]));B(e,"varind",27,()=>-1);let l=B(e,"settings",15);B(e,"nvars",3,0);let s=nn(e,["$$slots","$$events","$$legacy","params","varind","settings","nvars"]);const a={no:0,mean:1,median:2},o={no:0,sd:1,iqr:2,range:3,pareto:4},c=Object.keys(a),f=Object.keys(o);let u=re(Te(c[t()[0]])),d=re(Te(f[t()[1]]));const v="Scaling";_e(()=>{l(r(u)+"/"+r(d))}),_e(()=>{r(u)&&t(t()[0]=a[r(u)],!0)}),_e(()=>{r(d)&&t(t()[1]=o[r(d)],!0)}),zn(n,Or({id:"scale",title:v,get settings(){return l()}},()=>s,{children:(h,m)=>{var p=Wv(),w=X(p);ie(w,{label:"Center",children:(_,S)=>{Oe(_,{get options(){return c},get value(){return r(u)},set value(y){j(u,y,!0)}})},$$slots:{default:!0}});var b=z(w,2);ie(b,{label:"Scale",children:(_,S)=>{Oe(_,{get options(){return f},get value(){return r(d)},set value(y){j(d,y,!0)}})},$$slots:{default:!0}}),E(h,p)},$$slots:{default:!0}})),ge()}var Hv=U("<!> <!> <!>",1),Xv=U("<!> <!> <!>",1);function Gv(n,e){me(e,!0);let t=B(e,"params",31,()=>Te([0,1,.1]));B(e,"varind",27,()=>-1);let l=B(e,"settings",15,"");B(e,"nvars",3,0);let s=nn(e,["$$slots","$$events","$$legacy","params","varind","settings","nvars"]);const a="Baseline correction",o={emsc:0,als:1},c=Object.keys(o);function f(p){const w=Math.ceil(Math.log10(p));return Math.pow(10,w)}let u=re(Te(c[t()[0]])),d=re(Te(t()[2]>0?f(t()[2]).toString():"0.1")),v=g(()=>parseFloat(r(d))),h=g(()=>r(v)/10),m=g(()=>Math.ceil(-Math.log10(r(v)))+1);_e(()=>{if(r(u)!=="als")return;const p=parseFloat(r(d));(t()[2]<r(h)||t()[2]>p-r(h))&&t(t()[2]=r(h),!0)}),_e(()=>{l(r(u)+" ("+(r(u)=="emsc"?t()[1].toFixed(0):t()[1].toFixed(1)+","+t()[2].toFixed(3))+")")}),_e(()=>{r(u)&&t(t()[0]=o[r(u)],!0)}),zn(n,Or({id:"scale",title:a,get settings(){return l()}},()=>s,{children:(p,w)=>{var b=Xv(),_=X(b);ie(_,{label:"Type",children:(k,C)=>{Oe(k,{get options(){return c},get value(){return r(u)},set value(N){j(u,N,!0)}})},$$slots:{default:!0}});var S=z(_,2);{var y=k=>{var C=Hv(),N=X(C);ie(N,{label:"Lambda",children:(T,R)=>{un(T,{min:1,max:7,step:.1,get value(){return t()[1]},set value(D){t(t()[1]=D,!0)}})},$$slots:{default:!0}});var F=z(N,2);ie(F,{label:"Penalty range",children:(T,R)=>{Oe(T,{options:["1","0.1","0.01"],get value(){return r(d)},set value(D){j(d,D,!0)}})},$$slots:{default:!0}});var M=z(F,2);ie(M,{label:"Penalty",children:(T,R)=>{{let D=g(()=>r(v)-r(h));un(T,{get min(){return r(h)},get max(){return r(D)},get step(){return r(h)},get decNum(){return r(m)},get value(){return t()[2]},set value(V){t(t()[2]=V,!0)}})}},$$slots:{default:!0}}),E(k,C)};q(S,k=>{r(u)==="als"&&k(y)})}var A=z(S,2);{var L=k=>{ie(k,{label:"Polynomial",children:(C,N)=>{Bt(C,{min:0,max:5,step:1,decNum:0,get value(){return t()[1]},set value(F){t(t()[1]=F,!0)}})},$$slots:{default:!0}})};q(A,k=>{r(u)==="emsc"&&k(L)})}E(p,b)},$$slots:{default:!0}})),ge()}var Kv=U("<!> <!>",1);function Jv(n,e){me(e,!0);let t=B(e,"params",15),l=B(e,"varind",15),s=B(e,"settings",15),a=nn(e,["$$slots","$$events","$$legacy","params","varind","settings","isOpen","left","right","nvars"]);const o="Trim tails";let c=re(!1);const f=g(()=>e.nvars?Math.round(e.nvars*.1):1);_e(()=>{e.isOpen?((t()[0]===void 0||t()[0]===null||t()[0]<e.left||t()[0]>e.right-r(f))&&t(t()[0]=e.left,!0),(t()[1]===void 0||t()[1]===null||t()[1]>e.right||t()[1]<e.left+r(f))&&t(t()[1]=e.right,!0),l(l()[1]=t()[0],!0),l(l()[2]=t()[1],!0),j(c,!0)):(l(l()[1]=-1,!0),l(l()[2]=-1,!0),j(c,!1))}),_e(()=>{s("left: "+t()[0]+" right: "+t()[1])}),zn(n,Or({id:"norm",title:o,get settings(){return s()},get isOpen(){return e.isOpen}},()=>a,{children:(u,d)=>{var v=de(),h=X(v);{var m=p=>{var w=Kv(),b=X(w);ie(b,{label:"Left",children:(S,y)=>{{let A=g(()=>e.right-r(f));un(S,{get min(){return e.left},get max(){return r(A)},step:1,decNum:0,get value(){return t()[0]},set value(L){t(t()[0]=L,!0)}})}},$$slots:{default:!0}});var _=z(b,2);ie(_,{label:"Right",children:(S,y)=>{{let A=g(()=>e.left+r(f));un(S,{get min(){return r(A)},get max(){return e.right},step:1,decNum:0,get value(){return t()[1]},set value(L){t(t()[1]=L,!0)}})}},$$slots:{default:!0}}),E(p,w)};q(h,p=>{r(c)&&p(m)})}E(u,v)},$$slots:{default:!0}})),ge()}var Qv=U("<!> <!>",1);function Zv(n,e){me(e,!0);let t=B(e,"params",31,()=>Te([3,5]));B(e,"varind",27,()=>-1);let l=B(e,"settings",15);B(e,"nvars",3,0);let s=nn(e,["$$slots","$$events","$$legacy","params","varind","settings","nvars"]);const a="Spike removal";_e(()=>{l(t()[0]+"/"+t()[1])}),zn(n,Or({id:"scale",title:a,get settings(){return l()}},()=>s,{children:(o,c)=>{var f=Qv(),u=X(f);ie(u,{label:"Window",children:(v,h)=>{Bt(v,{min:3,max:15,step:2,get value(){return t()[0]},set value(m){t(t()[0]=m,!0)}})},$$slots:{default:!0}});var d=z(u,2);ie(d,{label:"Threshold",children:(v,h)=>{Bt(v,{min:3,max:50,get value(){return t()[1]},set value(m){t(t()[1]=m,!0)}})},$$slots:{default:!0}}),E(o,f)},$$slots:{default:!0}})),ge()}var $v=U("<h2>Selected methods</h2> <!>",1),eh=U("<p>No methods selected</p>"),th=U("<p> </p>"),rh=U("<h2>Available methods</h2>"),nh=U("<p>Maximum number of methods is selected.</p>"),lh=U("<p> </p> <!>",1),sh=U('<div><!> <!> <!></div> <div class="downloads-block"><!></div> <div class="methods-list svelte-15cx0gr"><!> <!></div>',1);function ah(n,e){me(e,!0);let t=B(e,"prepobj",31,()=>Te([])),l=B(e,"meta",15),s=B(e,"varind",31,()=>-1),a=B(e,"rawdataShort",15),o=B(e,"prepdataShort",15),c=B(e,"prepmodel",3,null),f=B(e,"reset",3,null),u=B(e,"finalize",3,null);const d=30,v=8,h={savgol:Dv,norm:qv,scale:Uv,baseline:Gv,trim:Jv,spikes:Zv};let m=re("neutral"),p=re(""),w=re(void 0),b=re(""),_=re(Te([])),S=re(Te([])),y=re(Te([]));l(new Array(v).fill(""));const A=g(()=>e.rawdata.values.ncols-e.rawdata.nresp);let L=Te(e.rawdata.values.nrows<3?Object.keys(h).filter(K=>K!=="scale"):Object.keys(h));C(),t().length!==0&&k();async function k(){t().length!==0&&j(w,e.WASM().then(K=>{j(m,"applying");const se=Fo(K,a().values,0,t(),!0,[]),le=Ss(K,a().values,0,se,!0);o(Xs(a(),le)),j(m,"success")}).catch(K=>{o(Xs(a())),console.error(K),j(m,"error"),j(p,K,!0)}),!0)}function C(){if(!e.rawdata)return;if(!t()||t().length<1){e.setLeft(0),e.setRight(e.rawdata.values.ncols),j(S,[],!0),j(y,[],!0);return}let K=[],se=[],le=0,ve=e.rawdata.values.ncols-e.rawdata.nresp;for(let oe of t())oe.id==="trim"?(K.push(le),se.push(ve),oe.params[0]<le&&(oe.params[0]=le),oe.params[1]>ve&&(oe.params[1]=ve),le=oe.params[0]>le?oe.params[0]:le,ve=oe.params[1]>0&&oe.params[1]<ve?oe.params[1]:ve):(K.push(le),se.push(ve));j(S,K,!0),j(y,se,!0),e.setLeft(le),e.setRight(ve)}function N(K){const se=Br.find(le=>le.id===K);se&&(r(S).push(e.left),r(y).push(e.right),t().push({id:se.id,params:se.mp}),j(b,t().length-1))}function F(K){if(K<=0)return;const se=t()[K],le=t()[K-1];t(t()[K-1]=se,!0),t(t()[K]=le,!0),V()}function M(K){if(K<0||K===t().length-1)return;const se=t()[K],le=t()[K+1];t(t()[K+1]=se,!0),t(t()[K]=le,!0),V()}function T(K){K<0||K>=t().length||(t(t().filter((se,le)=>le!==K)),V())}function R(K){j(b,K,!0)}function D(){j(b,null)}function V(){j(m,"neutral"),j(p,""),j(b,null),C(),k(),s(s()[1]=-1,!0),s(s()[2]=-1,!0)}_e(()=>{e.rawdata&&!a()&&a(Sv(e.rawdata,d))}),_e(()=>{a()&&!o()&&o(Xs(a()))}),_e(()=>{(!t()||t().length===0)&&(j(_,[],!0),o(null),j(S,[],!0),j(y,[],!0),j(b,""),l(new Array(v).fill("")))});var P=sh(),Y=X(P);let Z;var I=W(Y);ie(I,{label:"",children:(K,se)=>{var le=$v(),ve=z(X(le),2);{var oe=fe=>{qo(fe,{text:"edit",get onclick(){return f()}})};q(ve,fe=>{c()&&f()&&fe(oe)})}E(K,le)},$$slots:{default:!0}});var H=z(I,2);{var J=K=>{ie(K,{label:"",children:(se,le)=>{var ve=eh();E(se,ve)},$$slots:{default:!0}})},$=K=>{var se=de(),le=X(se);Ne(le,17,t,Ie,(ve,oe,fe)=>{var Se=de();const ct=g(()=>h[r(oe).id]);var Pe=X(Se);{var Be=Ze=>{var jt=de(),rr=X(jt);{let St=g(()=>fe===r(b));Hn(rr,()=>r(ct),(Gt,Pr)=>{Pr(Gt,{get isOpen(){return r(St)},get left(){return r(S)[fe]},get right(){return r(y)[fe]},pos:fe,get nvars(){return r(A)},moveUp:F,moveDown:M,apply:V,open:R,close:D,remove:T,get params(){return r(oe).params},set params(Kt){r(oe).params=Kt},get varind(){return s()},set varind(Kt){s(Kt)},get settings(){return l()[fe]},set settings(Kt){l(l()[fe]=Kt,!0)}})})}E(Ze,jt)},Re=Ze=>{var jt=de(),rr=X(jt);{let St=g(()=>fe===r(b));Hn(rr,()=>r(ct),(Gt,Pr)=>{Pr(Gt,{pos:fe,get isOpen(){return r(St)},get left(){return r(S)[fe]},get right(){return r(y)[fe]},get nvars(){return r(A)},moveUp:F,moveDown:M,apply:V,open:R,close:D,remove:T,get params(){return r(oe).params},set params(Kt){r(oe).params=Kt},get settings(){return l()[fe]},set settings(Kt){l(l()[fe]=Kt,!0)}})})}E(Ze,jt)};q(Pe,Ze=>{r(oe).id==="norm"||r(oe).id==="trim"?Ze(Be):Ze(Re,!1)})}E(ve,Se)}),E(K,se)};q(H,K=>{t().length===0?K(J):K($,!1)})}var ae=z(H,2);{var Q=K=>{ie(K,{status:"error",children:(se,le)=>{var ve=th(),oe=W(ve);ne(()=>xe(oe,r(p))),E(se,ve)},$$slots:{default:!0}})};q(ae,K=>{(r(m)==="error"||r(p))&&K(Q)})}var ee=z(Y,2),ue=W(ee);{var Ee=K=>{ie(K,{label:" ",children:(se,le)=>{et(se,{get onclick(){return u()},text:"Finalize"})},$$slots:{default:!0}})};q(ue,K=>{!c()&&!r(b)&&t().length>0&&K(Ee)})}var he=z(ee,2),we=W(he);ie(we,{label:"",children:(K,se)=>{var le=rh();E(K,le)},$$slots:{default:!0}});var ye=z(we,2);{var pe=K=>{ie(K,{label:"",children:(se,le)=>{var ve=nh();E(se,ve)},$$slots:{default:!0}})},ce=K=>{var se=de(),le=X(se);Ne(le,17,()=>L,Ie,(ve,oe)=>{const fe=g(()=>Br.find(Se=>Se.id===r(oe)));ie(ve,{children:(Se,ct)=>{var Pe=lh(),Be=X(Pe),Re=W(Be),Ze=z(Be,2);sf(Ze,{onclick:()=>N(r(fe).id)}),ne(()=>xe(Re,r(fe).title)),E(Se,Pe)},$$slots:{default:!0}})}),E(K,se)};q(ye,K=>{t().length>=v?K(pe):K(ce,!1)})}ne(K=>Z=ft(Y,1,"selected-methods-list svelte-15cx0gr",null,Z,K),[()=>({final:c()!==null&&c()!==void 0})]),E(n,P),ge()}var oh=U("<!> <!>",1),ih=U("<!> <!>",1),ch=U("<!> <!>",1),uh=U("<!> <!> <!> <!> <!> <!> <!> <!>",1),fh=U("<h2>Plot settings</h2>"),dh=U("<!> <!>",1),vh=U('<div class="plot-area svelte-x8qn01"><div class="plot svelte-x8qn01"><!></div></div> <div class="plot-controls-area svelte-x8qn01"><!> <!> <!></div>',1),hh=U('<div class="plot-panel svelte-x8qn01"><!></div>');function mh(n,e){me(e,!0);let t=re(!0),l=re("none"),s=re(!1);const a=g(()=>(r(t)?"Preprocessed":"Raw")+" data (selected rows)"),o=g(()=>r(t)&&e.prepdata?e.prepdata:e.rawdata),c=g(()=>r(o)?r(o).varaxisLabel:"Variables"),f=g(()=>e.rawdata.varaxisUnits),u=g(()=>r(t)&&r(o)&&e.left>=0&&e.right<r(o).values.nrows&&e.left<e.right?dt.seq(e.left+1,e.right):null),d=g(()=>r(u)?r(o).varvalues.filter((L,k)=>k>=e.left&&k<e.right):r(o).varvalues),v=g(()=>r(u)?r(o).values.subset(r(u),null):r(o).values),h=g(()=>r(v)?Ar(r(v).v):null),m=g(()=>r(h)?(r(h)[1]-r(h)[0])*.05:null),p=g(()=>r(h)?[r(h)[0],r(h)[1]+(r(l)!=="none")*r(m)]:[0,1]),w=g(()=>r(o)?Ar(r(o).varvalues):[0,1]),b=g(()=>r(s)?[r(o).varvalues[e.left],r(o).varvalues[e.right-1]]:r(w)),_=g(()=>{if(!e.rawdata)return null;const L={none:{colors:"#ff0000"}};if(e.rawdata.classes&&e.rawdata.classNames&&e.rawdata.classNames.length>1){const k=Vs(e.rawdata.classNames.length);L.groups={colors:e.rawdata.classes.map(C=>k[e.rawdata.classNames.findIndex(N=>N===C)]),breaks:an(0,e.rawdata.classNames.length),labels:e.rawdata.classNames,map:k}}if(e.rawdata.resp&&e.rawdata.resp.length===e.rawdata.values.ncols){const k=Al(e.rawdata.resp,8),C=Vs(k.length-1);L.response={colors:pv(e.rawdata.resp.v,k.v,C),labels:null,breaks:k,map:C}}return L});_e(()=>{(e.left<1||e.right<1||e.right>=e.left)&&j(s,!1)});var S=hh(),y=W(S);{var A=L=>{var k=vh(),C=X(k),N=W(C),F=W(N);Bs(F,{get title(){return r(a)},get limY(){return r(p)},get limX(){return r(b)},fileName:"plot-preprocessed",children:(P,Y)=>{var Z=uh(),I=X(Z);{var H=ce=>{gi(ce,{get xValues(){return r(d)},get yValues(){return r(v)}})},J=ce=>{var K=de(),se=X(K);Ne(se,17,()=>r(_)[r(l)].colors,Ie,(le,ve,oe)=>{{let fe=g(()=>r(v).getcolumn(oe+1));_r(le,{get xValues(){return r(d)},get yValues(){return r(fe)},get lineColor(){return r(ve)}})}}),E(ce,K)};q(I,ce=>{r(l)==="none"?ce(H):ce(J,!1)})}var $=z(I,2);{var ae=ce=>{var K=oh();const se=g(()=>r(o).varvalues[e.varind[0]]);var le=X(K);{let oe=g(()=>[r(se),r(se)]);_r(le,{get xValues(){return r(oe)},get yValues(){return r(p)},lineColor:"#00000060"})}var ve=z(le,2);{let oe=g(()=>[r(se)]),fe=g(()=>[r(p)[1]-r(m)*(r(l)==="none"?1:2)]),Se=g(()=>qr(r(se).toFixed(2)+" "+r(f)));hn(ve,{get xValues(){return r(oe)},get yValues(){return r(fe)},get labels(){return r(Se)},textColor:"#a0a0a0",textSize:.8,pos:2})}E(ce,K)};q($,ce=>{e.varind&&e.varind[0]>0&&ce(ae)})}var Q=z($,2);{var ee=ce=>{var K=ih();const se=g(()=>r(o).varvalues[e.varind[1]]);var le=X(K);{let oe=g(()=>[r(b)[0]]),fe=g(()=>[r(o).varvalues[e.varind[1]]-r(b)[0]]),Se=g(()=>[r(p)[1]]),ct=g(()=>[r(p)[1]-r(p)[0]]);Nn(le,{get left(){return r(oe)},get width(){return r(fe)},get top(){return r(Se)},get height(){return r(ct)},lineColor:"transparent",faceColor:"#00000040"})}var ve=z(le,2);{let oe=g(()=>[r(se)]),fe=g(()=>[r(p)[1]-r(m)*(r(l)==="none"?1:2)]),Se=g(()=>qr(r(se).toFixed(2)+" "+r(f)));hn(ve,{get xValues(){return r(oe)},get yValues(){return r(fe)},get labels(){return r(Se)},textColor:"#a0a0a0",textSize:.8,pos:2})}E(ce,K)};q(Q,ce=>{e.varind&&e.varind[1]>0&&ce(ee)})}var ue=z(Q,2);{var Ee=ce=>{var K=ch();const se=g(()=>r(o).varvalues[e.varind[2]-1]);var le=X(K);{let oe=g(()=>[r(o).varvalues[e.varind[2]-1]]),fe=g(()=>[r(b)[1]-r(o).varvalues[e.varind[2]-1]]),Se=g(()=>[r(p)[1]]),ct=g(()=>[r(p)[1]-r(p)[0]]);Nn(le,{get left(){return r(oe)},get width(){return r(fe)},get top(){return r(Se)},get height(){return r(ct)},lineColor:"transparent",faceColor:"#00000040"})}var ve=z(le,2);{let oe=g(()=>[r(se)]),fe=g(()=>[r(p)[1]-r(m)*(r(l)==="none"?1:2)]),Se=g(()=>qr(r(se).toFixed(2)+" "+r(f)));hn(ve,{get xValues(){return r(oe)},get yValues(){return r(fe)},get labels(){return r(Se)},textColor:"#a0a0a0",textSize:.8,pos:2})}E(ce,K)};q(ue,ce=>{e.varind&&e.varind[2]<r(o).varvalues.length&&e.varind[2]>0&&ce(Ee)})}var he=z(ue,2);{let ce=g(()=>r(l)!=="none");pi(he,{get show(){return r(ce)},get labels(){return r(_)[r(l)].labels},get breaks(){return r(_)[r(l)].breaks},get colmap(){return r(_)[r(l)].map}})}var we=z(he,2);qs(we,{get label(){return r(c)},showGrid:!0});var ye=z(we,2);Ys(ye,{showGrid:!0});var pe=z(ye,2);Ds(pe,{}),E(P,Z)},$$slots:{default:!0}});var M=z(C,2),T=W(M);ie(T,{label:"",children:(P,Y)=>{var Z=fh();E(P,Z)},$$slots:{default:!0}});var R=z(T,2);ie(R,{label:"Show",children:(P,Y)=>{Xt(P,{options:["raw","preprocessed"],get value(){return r(t)},set value(Z){j(t,Z,!0)}})},$$slots:{default:!0}});var D=z(R,2);{var V=P=>{var Y=dh(),Z=X(Y);ie(Z,{label:"Color by",children:(J,$)=>{{let ae=g(()=>Object.keys(r(_)));Oe(J,{get options(){return r(ae)},get value(){return r(l)},set value(Q){j(l,Q,!0)}})}},$$slots:{default:!0}});var I=z(Z,2);{var H=J=>{ie(J,{label:"Zoom (x-axis)",children:($,ae)=>{Xt($,{options:["off","on"],get value(){return r(s)},set value(Q){j(s,Q,!0)}})},$$slots:{default:!0}})};q(I,J=>{e.left>0&&e.right>e.left&&J(H)})}E(P,Y)};q(D,P=>{Object.keys(r(_)).length>1&&P(V)})}E(L,k)};q(y,L=>{r(d)&&r(v)&&L(A)})}E(n,S),ge()}var gh=U('<div class="widget-container svelte-1soqt9v"><div class="app-controls svelte-1soqt9v"><div class="prep-creator svelte-1soqt9v"><!></div></div> <div class="app-content svelte-1soqt9v"><!></div></div>');function ph(n,e){me(e,!0);let t=B(e,"left",15),l=B(e,"right",15),s=B(e,"prepobj",15),a=B(e,"meta",15),o=B(e,"finalize",3,null),c=re(Te([-1,0,0])),f=re(null),u=re(null);function d(y){const A=e.rawdata.values.ncols-e.rawdata.nresp;e.rawdata&&y>=0&&y<A&&y<l()&&t(y)}function v(y){const A=e.rawdata.values.ncols-e.rawdata.nresp;e.rawdata&&y<=A&&y>t()&&l(y)}var h=gh(),m=W(h),p=W(m),w=W(p);ah(w,{get WASM(){return e.WASM},get rawdata(){return e.rawdata},get outliers(){return e.outliers},get left(){return t()},get right(){return l()},setLeft:d,",":!0,setRight:v,get finalize(){return o()},get varind(){return r(c)},set varind(y){j(c,y,!0)},get prepobj(){return s()},set prepobj(y){s(y)},get rawdataShort(){return r(f)},set rawdataShort(y){j(f,y,!0)},get prepdataShort(){return r(u)},set prepdataShort(y){j(u,y,!0)},get meta(){return a()},set meta(y){a(y)}});var b=z(m,2),_=W(b);{var S=y=>{mh(y,{get rawdata(){return r(f)},get prepdata(){return r(u)},get left(){return t()},get right(){return l()},get varind(){return r(c)}})};q(_,y=>{r(f)&&y(S)})}E(n,h),ge()}var bh=U('<p class="info-text"><span style="color:#a0a0a0;">Preprocessing:</span> <!></p>'),_h=U("<!> <!> <!>",1),wh=U('<p class="info-text"><span style="color:#a0a0a0;">Preprocessing:</span> skipped</p> <div><!></div>',1),yh=U("<!> <!> <!>",1),xh=U("<p><strong>Preprocessing model</strong></p>"),kh=U("<!> <!>",1),Eh=U("<p> </p>"),Sh=U('<div class="prep-widget"><!></div> <!> <!>',1);function Ah(n,e){me(e,!0);let t=B(e,"prepType",15),l=B(e,"prepobj",15),s=B(e,"prepdata",15),a=B(e,"prepmodel",15),o=B(e,"prepmeta",15),c=re(!1),f=re(0),u=re(Te(e.rawdata?e.rawdata.values.ncols-e.rawdata.nresp:0)),d=re("neutral"),v=re(""),h=re(void 0);async function m(R,D,V){!D||!R||D.length===0||j(h,e.WASM().then(P=>{j(d,"applying");const Y=Fo(P,R.values,R.nresp,D,!1,V);Y.info=o(),a(Y)}).catch(P=>{a(null),console.error(P),j(d,"error"),j(v,P,!0)}),!0)}async function p(R,D){if(!D||typeof D!="object"){s(null);return}if(Object.keys(D).length===0){s(R);return}j(h,e.WASM().then(V=>{j(d,"applying");const P=Ss(V,R.values,R.nresp,D,!1,!1),Y=Av(xc(R),P);s(Du(Y,D))}).catch(V=>{s(null),console.error(V),j(d,"error"),j(v,V,!0)}),!0)}function w(){t(null),s(null),a(null),l([]),setLeft(0),setRight(e.rawdata.values.ncols-e.rawdata.nresp)}function b(){m(e.rawdata,l(),e.outliers),j(c,!1)}function _(){t("create"),s(null),a(null),j(c,!0)}function S(){t("skip"),a({})}_e(()=>{a(),e.rawdata&&p(e.rawdata,a())}),_e(()=>{t()==="create"&&l()&&!a()&&m(e.rawdata,l(),e.outliers)}),_e(()=>{t()==="skip"&&s()===null&&(a({}),l([]),s(e.rawdata))});var y=Sh(),A=X(y),L=W(A);{var k=R=>{ie(R,{name:"info",children:(D,V)=>{var P=_h(),Y=X(P);{var Z=$=>{var ae=bh(),Q=z(W(ae),2);Gs(Q,{get prepmodel(){return a()}}),E($,ae)};q(Y,$=>{r(c)||$(Z)})}var I=z(Y,2);{var H=$=>{qo($,{onclick:_})};q(I,$=>{t()==="create"&&$(H)})}var J=z(I,2);or(J,{onclick:w}),E(D,P)},$$slots:{default:!0}})},C=R=>{var D=de(),V=X(D);{var P=Z=>{ie(Z,{name:"prep-info",children:(I,H)=>{var J=wh(),$=z(X(J),2),ae=W($);or(ae,{onclick:w}),E(I,J)},$$slots:{default:!0}})},Y=Z=>{var I=de(),H=X(I);{var J=ae=>{ie(ae,{label:"Preprocessing",name:"prep-container",children:(Q,ee)=>{var ue=yh(),Ee=X(ue);et(Ee,{text:"Skip",onclick:S});var he=z(Ee,2);et(he,{text:"Load",onclick:()=>t("file")});var we=z(he,2);et(we,{text:"Create",onclick:_}),E(Q,ue)},$$slots:{default:!0}})},$=ae=>{var Q=de(),ee=X(Q);{var ue=Ee=>{var he=kh(),we=X(he);ie(we,{children:(pe,ce)=>{var K=xh();E(pe,K)},$$slots:{default:!0}});var ye=z(we,2);Iv(ye,{get model(){return a()},set model(pe){a(pe)},get prepobj(){return l()},set prepobj(pe){l(pe)},get left(){return r(f)},set left(pe){j(f,pe,!0)},get right(){return r(u)},set right(pe){j(u,pe,!0)}}),E(Ee,he)};q(ee,Ee=>{t()==="file"&&Ee(ue)},!0)}E(ae,Q)};q(H,ae=>{t()?ae($,!1):ae(J)},!0)}E(Z,I)};q(V,Z=>{t()==="skip"?Z(P):Z(Y,!1)},!0)}E(R,D)};q(L,R=>{a()&&s()&&a().ml?R(k):R(C,!1)})}var N=z(A,2);{var F=R=>{Us(R,{closeModal:b,isDark:!0,children:(D,V)=>{ph(D,{get WASM(){return e.WASM},get rawdata(){return e.rawdata},get outliers(){return e.outliers},finalize:b,get prepobj(){return l()},set prepobj(P){l(P)},get left(){return r(f)},set left(P){j(f,P,!0)},get right(){return r(u)},set right(P){j(u,P,!0)},get meta(){return o()},set meta(P){o(P)}})},$$slots:{default:!0}})};q(N,R=>{r(c)&&R(F)})}var M=z(N,2);{var T=R=>{ie(R,{status:"error",children:(D,V)=>{var P=Eh(),Y=W(P);ne(()=>xe(Y,r(v))),E(D,P)},$$slots:{default:!0}})};q(M,R=>{(r(d)==="error"||r(v))&&R(T)})}E(n,y),ge()}var Ch=U('<th class="svelte-8wnifa"> </th>'),Th=U('<td class="svelte-8wnifa"> </td>'),Ph=U('<tr class="svelte-8wnifa"></tr>'),Lh=U('<table class="svelte-8wnifa"><thead><tr class="svelte-8wnifa"></tr></thead><tbody></tbody></table>');function Ei(n,e){me(e,!0);const t=1,l=["xcumexpvar","ycumexpvar"],s=["rmse","r2","slope","bias"];let a=g(()=>{if(!e.res||e.ncomp<0)return null;const u=Object.keys(e.res),d=u.length,v=["",...u];let m=[["#LVs",...Array(d).fill(e.ncomp)]];for(let p of l){let w=[p];for(let b=0;b<d;b++)w.push(e.res[u[b]].stat[p][e.ncomp-1].toFixed(3));m.push(w)}for(let p of s){let w=[p];for(let b=0;b<d;b++){let _=3;const S=e.res[u[b]].stat[p].getcolref(t)[e.ncomp-1];p==="rmse"&&(_=S<1?3:S>100?1:2),w.push(S.toFixed(_))}m.push(w)}return{header:v,rows:m}});var o=de(),c=X(o);{var f=u=>{var d=Lh(),v=W(d),h=W(v);Ne(h,21,()=>r(a).header,Ie,(p,w)=>{var b=Ch(),_=W(b);ne(()=>xe(_,r(w))),E(p,b)});var m=z(v);Ne(m,21,()=>r(a).rows,Ie,(p,w)=>{var b=Ph();Ne(b,21,()=>r(w),Ie,(_,S)=>{var y=Th(),A=W(y);ne(()=>xe(A,r(S))),E(_,y)}),E(p,b)}),E(u,d)};q(c,u=>{r(a)&&u(f)})}E(n,o),ge()}var Nh=U("<!> <!> <!> <!>",1),zh=U("<p> </p>"),Mh=U("<!> <p>Computing global model...</p>",1),Rh=U('<p><span style="color:#a0a0a0;">PLS model:</span> </p> <!>',1),Ih=U('<div class="buttons"><!> <!></div>'),Fh=U("<!> <!>",1),jh=U("<p> </p>"),Vh=U("<!> <!> <!> <!>",1);function Oh(n,e){me(e,!0);let t=B(e,"outliers",19,()=>[]),l=B(e,"exclvars",19,()=>[]),s=B(e,"resobj",15),a=B(e,"model",15),o=B(e,"downloadModel",3,null),c=B(e,"downloadResults",3,null),f=re("neutral"),u=re(""),d=re(1),v=re(!0),h=re(!1),m=re(void 0);async function p(T,R,D,V){const P=T.nresp,Y=T.varindices;j(m,e.WASM().then(Z=>{j(f,"computing");const I=Vu(Z,T.values,P,R,D,V,t(),l());I.hash=jo(),I.varlabels=T.varlabels.filter((J,$)=>$<P||!l().includes(Y[$])),I.varindices=T.varindices.filter((J,$)=>$<P||!l().includes(Y[$])),I.varvalues=T.varvalues.filter((J,$)=>$<P||!l().includes(Y[$])),I.xvarlabels=I.varlabels.filter((J,$)=>$+1>P),I.xvarvalues=I.varvalues.filter((J,$)=>$+1>P),I.xvarindices=I.varindices.filter((J,$)=>$+1>P).map(J=>J+1),I.varvaluesName=T.varvaluesName,I.varvaluesUnits=T.varvaluesUnits,I.varrev=T.varrev,I.prep=null;const H=As(Z,I,T,t());I.stat={xexpvar:H.stat.xexpvar,yexpvar:H.stat.yexpvar},a(I),s(H),j(f,"success")}).catch(Z=>{console.error(Z),a(null),j(f,"error"),j(u,Z,!0)}),!0)}function w(T){j(f,"neutral"),j(u,null),p(e.dataset,r(d),r(v),r(h))}function b(){j(f,"neutral"),j(m,null),s(null),a(null),j(u,null)}let _=g(()=>e.dataset?Math.min(e.dataset.values.nrows-2-t().length,e.dataset.values.ncols-e.dataset.nresp-l().length-1,50):null);_e(()=>{e.dataset===null&&b()}),_e(()=>{j(d,r(_)?Math.min(r(_),20):null,!0)});var S=Vh(),y=X(S);{var A=T=>{var R=Nh(),D=X(R);{var V=I=>{ie(I,{name:"ncomp",label:"# of LVs",children:(H,J)=>{un(H,{id:"ncomp",min:1,get max(){return r(_)},step:1,decNum:0,get value(){return r(d)},set value($){j(d,$,!0)}})},$$slots:{default:!0}})};q(D,I=>{r(d)&&r(_)&&I(V)})}var P=z(D,2);ie(P,{name:"center",label:"Center",children:(I,H)=>{Xt(I,{id:"center",options:["no","yes"],get value(){return r(v)},set value(J){j(v,J,!0)}})},$$slots:{default:!0}});var Y=z(P,2);ie(Y,{name:"scale",label:"Scale",children:(I,H)=>{Xt(I,{id:"scale",options:["no","yes"],get value(){return r(h)},set value(J){j(h,J,!0)}})},$$slots:{default:!0}});var Z=z(Y,2);ie(Z,{name:"create-model",label:" ",children:(I,H)=>{et(I,{onclick:w,text:"Create model"})},$$slots:{default:!0}}),E(T,R)};q(y,T=>{e.dataset&&!a()&&r(f)!=="computing"&&T(A)})}var L=z(y,2);{var k=T=>{var R=de(),D=X(R);us(D,()=>r(m),V=>{ie(V,{name:"spinner",children:(P,Y)=>{var Z=Mh(),I=X(Z);Ps(I),E(P,Z)},$$slots:{default:!0}})},void 0,(V,P)=>{ie(V,{name:"error",status:"error",children:(Y,Z)=>{var I=zh(),H=W(I);ne(()=>xe(H,r(P))),E(Y,I)},$$slots:{default:!0}})}),E(T,R)};q(L,T=>{r(m)&&T(k)})}var C=z(L,2);{var N=T=>{var R=Fh(),D=X(R);ie(D,{name:"info",children:(Y,Z)=>{var I=Rh(),H=X(I),J=z(W(H)),$=z(H,2);or($,{onclick:b}),ne(()=>xe(J,` ${a().ncomp??""} LVs${a().center?", centered":""}${a().scale?", scaled":""}`)),E(Y,I)},$$slots:{default:!0}});var V=z(D,2);{var P=Y=>{ie(Y,{name:"download-buttons",label:"Download",children:(Z,I)=>{var H=Ih(),J=W(H);et(J,{onclick:()=>c()(s(),e.dataset,"train",t()),text:"Results"});var $=z(J,2);et($,{onclick:()=>o()(a()),text:"Model"}),E(Z,H)},$$slots:{default:!0}})};q(V,Y=>{o()&&c()&&Y(P)})}E(T,R)};q(C,T=>{a()&&a().ncomp&&T(N)})}var F=z(C,2);{var M=T=>{ie(T,{name:"error",status:"error",children:(R,D)=>{var V=jh(),P=W(V);ne(()=>xe(P,r(u))),E(R,V)},$$slots:{default:!0}})};q(F,T=>{(r(f)==="error"||r(u))&&T(M)})}E(n,S),ge()}var Bh=U("<!> <!> <!>",1),qh=U('<p class="svelte-16w7odi"> </p>'),Yh=U('<!> <p class="svelte-16w7odi">Computing PV-set...</p>',1),Dh=U('<p class="svelte-16w7odi"><span class="svelte-16w7odi">PV-set:</span> <br/> <span class="svelte-16w7odi">Size:</span> <span class="svelte-16w7odi">(X)</span> <span class="svelte-16w7odi">(Y)</span>,</p> <!> <!>',1),Wh=U('<p class="svelte-16w7odi"> </p>'),Uh=U("<!> <!> <!> <!>",1);function Hh(n,e){me(e,!0);let t=B(e,"outliers",19,()=>[]),l=B(e,"pvset",15),s=B(e,"pvres",15),a=B(e,"pvscalars",15),o=re("neutral"),c=re(""),f=re(Te(["ven","rand","loo"])),u=re("ven"),d=re(void 0),v=e.calset.values.nrows-t().length,h=e.calset&&e.calset.values.nrows>0?[3,4,5,10,20].filter(M=>M>=v/(v-e.model.ncomp-1)&&M<=v/2):[],m=re(Te(h.length>0?h[0]:0));_e(()=>{h.length===0&&(j(f,["loo"],!0),j(u,"loo"))});async function p(M,T,R,D){j(d,e.WASM().then(V=>{const P=R.type=="loo"?0:R.type=="rand"?2:1,[Y,Z]=Bu(V,T,M.values,M.nresp,T.ncomp,R.nseg,P,0,D);l({classLabelsVarname:M.classLabelsVarname,classNames:M.classNames,classes:M.classes,dec:M.dec,fileName:M.fileName+"-pcv",hasClassNames:M.hasClassNames,hasLabels:M.hasLabels,header:M.header,labelsVarname:M.labelsVarname,objindices:e.calres.objindices,objlabels:e.calres.objlabels,sep:M.sep,values:Y,varAxisTitle:M.varAxisTitle,varindices:T.varindices,varlabels:T.varlabels,varrev:T.varrev,varvalues:T.varvalues,varvaluesName:T.varvaluesName,varvaluesUnits:T.varvaluesUnits,nresp:T.nresp}),s(As(V,T,l(),[])),a(Z)}).catch(V=>{console.error(V),l(null),s(null),j(o,"error"),j(c,V,!0)}),!0)}function w(M){j(o,"neutral"),j(c,""),p(e.calset,e.model,{type:r(u),nseg:r(m)},t())}function b(){j(o,"neutral"),j(c,""),j(d,null),l(null),s(null)}_e(()=>{e.model===null&&b()});var _=Uh(),S=X(_);{var y=M=>{var T=Bh(),R=X(T);ie(R,{name:"split",label:"Split type:",children:(Y,Z)=>{Oe(Y,{id:"cvType",get options(){return r(f)},get value(){return r(u)},set value(I){j(u,I,!0)}})},$$slots:{default:!0}});var D=z(R,2);{var V=Y=>{ie(Y,{name:"nseg",label:"Segments:",children:(Z,I)=>{Oe(Z,{id:"nseg",get options(){return h},get value(){return r(m)},set value(H){j(m,H,!0)}})},$$slots:{default:!0}})};q(D,Y=>{r(u)!=="loo"&&Y(V)})}var P=z(D,2);ie(P,{name:"run-button",label:" ",children:(Y,Z)=>{et(Y,{onclick:w,text:"Compute PV-set"})},$$slots:{default:!0}}),E(M,T)};q(S,M=>{e.model&&!l()&&r(o)!=="busy"&&M(y)})}var A=z(S,2);{var L=M=>{var T=de(),R=X(T);us(R,()=>r(d),D=>{ie(D,{name:"spinner",children:(V,P)=>{var Y=Yh(),Z=X(Y);Ps(Z),E(V,Y)},$$slots:{default:!0}})},void 0,(D,V)=>{ie(D,{name:"error",status:"error",children:(P,Y)=>{var Z=qh(),I=W(Z);ne(()=>xe(I,r(V))),E(P,Z)},$$slots:{default:!0}})}),E(M,T)};q(A,M=>{r(d)&&M(L)})}var k=z(A,2);{var C=M=>{ie(M,{name:"info",children:(T,R)=>{var D=Dh(),V=X(D),P=z(W(V)),Y=z(P,4),Z=z(Y,2),I=z(V,2);lf(I,{onclick:()=>Qu(l(),e.calset.fileName+"-pv")});var H=z(I,2);or(H,{onclick:b}),ne(()=>{xe(P,` ${r(u)??""}
      ${r(u)!=="loo"?r(m)+" seg":""}`),xe(Y,` ${l().values.nrows??""}×${l().values.ncols-l().nresp} `),xe(Z,`,
      ${l().values.nrows??""}×${l().nresp??""} `)}),E(T,D)},$$slots:{default:!0}})};q(k,M=>{l()&&M(C)})}var N=z(k,2);{var F=M=>{ie(M,{name:"error",status:"error",children:(T,R)=>{var D=Wh(),V=W(D);ne(()=>xe(V,r(c))),E(T,D)},$$slots:{default:!0}})};q(N,M=>{r(o)==="error"&&r(c)&&M(F)})}E(n,_),ge()}var Xh=U('<span style="font-weight:bold"> </span><br/>',1),Gh=U('<span class="file-size svelte-gdjwex"> </span> <span>(X)</span>, <span class="file-size svelte-gdjwex"> </span> <span>(Y)</span>',1),Kh=U('<span class="file-size svelte-gdjwex"> </span>'),Jh=U('<p class="dataset-info svelte-gdjwex"><!> <span>Data file:</span> <span class="file-name svelte-gdjwex"> </span><br/> <span>Size:</span> <!></p> <!>',1);function Qh(n,e){me(e,!0);let t=B(e,"title",3,"");var l=de(),s=X(l);{var a=o=>{ie(o,{children:(c,f)=>{var u=Jh(),d=X(u),v=W(d);{var h=y=>{var A=Xh(),L=X(A),k=W(L);ne(()=>xe(k,t())),E(y,A)};q(v,y=>{t()&&t()!==""&&y(h)})}var m=z(v,4),p=W(m),w=z(m,5);{var b=y=>{var A=Gh(),L=X(A),k=W(L),C=z(L,4),N=W(C);ne(()=>{xe(k,`${e.dataset.values.nrows??""}×${e.dataset.values.ncols-e.dataset.nresp}`),xe(N,`${e.dataset.values.nrows??""}×${e.dataset.nresp??""}`)}),E(y,A)},_=y=>{var A=Kh(),L=W(A);ne(()=>xe(L,`${e.dataset.values.nrows??""}×${e.dataset.values.ncols??""}`)),E(y,A)};q(w,y=>{e.dataset.nresp&&e.dataset.nresp>0?y(b):y(_,!1)})}var S=z(d,2);or(S,{get onclick(){return e.reset}}),ne(()=>{O(m,"title",e.dataset.fileName),xe(p,e.dataset.fileName)}),E(c,u)},$$slots:{default:!0}})};q(s,o=>{e.dataset&&o(a)})}E(n,l),ge()}var Zh=U("<!> <!>",1),$h=U("<!> <!> <!> <!> <!>",1),em=U("<!> <!>",1),tm=U("<p> </p>"),rm=U("<!> <p> </p>",1),nm=U("<p> </p>"),lm=U("<!> <!> <!>",1);function Ks(n,e){me(e,!0);let t=B(e,"model",3,null),l=B(e,"outliers",19,()=>[]),s=B(e,"respMandatory",3,!1),a=B(e,"title",3,""),o=B(e,"dataset",15),c=B(e,"resobj",15);const f=[",",";"],u=g(()=>t()?["no","yes"]:["no","labels","values"]);let d=re(void 0),v=re(""),h=re(""),m=!1,p=re(","),w=re("no"),b=re(!1),_=re(0),S=g(()=>s()?1:0),y=re(null),A=re("neutral"),L=re("");function k(Q){j(A,"error"),j(L,Q,!0),console.error(Q)}function C(){j(A,"neural"),j(L,"")}function N(){j(A,"success"),j(L,"")}function F(Q,ee,ue){c()||j(y,e.WASM().then(Ee=>{c(As(Ee,Q,ee,ue,!0)),N()}).catch(Ee=>{c(null),k(Ee)}),!0)}function M(Q,ee){if(!Q||Q.size<10)return;const Ee=Q.slice(0,1e5),he=new FileReader;he.onload=()=>{const we=he.result;!we||we.length<0||((ye=>{var pe=ql(ye,5);j(p,pe[0],!0),j(b,pe[1],!0),m=pe[2],j(w,pe[3],!0),j(_,pe[4],!0)})(Ku(we,r(S))),ee&&r(w)!=="no"&&j(w,"yes"),N())},he.onerror=function(we){csvString=null,k("Error reading CSV file. "+we)},he.readAsText(Ee)}function T(Q){try{const ee=Hu(Q,r(p),r(w)==="yes"?"labels":r(w),r(b),m,r(v),r(h),r(S));if(ee.values.nrows<1)throw new Error("Dataset must have at least 1 row.");if(ee.values.ncols-ee.nresp<2)throw new Error("Dataset should habe at least two predictors.");if(t()){const ue=t().prep&&t().prep.npred?t().prep.npred:t().npred+t().exclvars.length,Ee=s()?ue+t().nresp:ue;if(ee.values.ncols!==Ee)throw new Error("Dataset has different number of columns than the training set.");ee.varrev=t().varrev,ee.header=t().header,ee.varlabels=t().varlabels,ee.varvalues=t().varvalues,ee.varindices=t().varindices,ee.varvaluesName=t().varvaluesName,ee.varvaluesUnits=t().varvaluesUnits}ee.fileName=r(d).name.replace(/\.[^/.]+$/,""),o(ee),N()}catch(ee){o(null),k(ee)}}function R(Q){const ee=new FileReader;ee.onload=()=>{T(ee.result)},ee.readAsText(r(d))}async function D(Q){try{const ee=r(d)instanceof FileList?r(d):[r(d)];o(await ef(ee)),N()}catch(ee){k("Failed to read SPC file: "+ee)}}function V(){j(d,""),o(null),c(null),j(v,""),j(h,""),C()}_e(()=>{if(!(r(d)===0||r(d)===void 0||o())){if(r(d)===null||r(d)===""){V();return}if(Array.isArray(r(d))){if(r(d).filter(Q=>Q.slice(-4)===".spc").length!==r(d).length){k("Multiple file selection is allowed only for SPC files.");return}D(r(d));return}r(d)&&r(d).type==="text/csv"?(M(r(d),t()),C()):D([r(d)])}}),_e(()=>{r(p)&&C()}),_e(()=>{if(o()&&t()&&!c()&&!r(L))try{F(t(),o(),l()),N()}catch(Q){o(null),c(null),k(Q)}});var P=lm(),Y=X(P);{var Z=Q=>{var ee=em(),ue=X(ee);Ln(ue,()=>r(d)===void 0,we=>{ie(we,{children:(ye,pe)=>{var ce=de(),K=X(ce);{var se=ve=>{Ll(ve,{id:"dataFile",message:"Select CSV file with dataset",get file(){return r(d)},set file(oe){j(d,oe,!0)}})},le=ve=>{Ll(ve,{id:"dataFile",message:"Select CSV or SPC file with dataset",acceptType:".csv, .spc",multiple:!0,get file(){return r(d)},set file(oe){j(d,oe,!0)}})};q(K,ve=>{s()?ve(se):ve(le,!1)})}E(ye,ce)},$$slots:{default:!0}})});var Ee=z(ue,2);{var he=we=>{var ye=$h(),pe=X(ye);ie(pe,{label:"Delimiter",children:(oe,fe)=>{Oe(oe,{id:"sep",get options(){return f},get value(){return r(p)},set value(Se){j(p,Se,!0)}})},$$slots:{default:!0}});var ce=z(pe,2);ie(ce,{label:"Row labels",children:(oe,fe)=>{Xt(oe,{id:"hasLabels",options:["no","yes"],get value(){return r(b)},set value(Se){j(b,Se,!0)}})},$$slots:{default:!0}});var K=z(ce,2);ie(K,{label:"Header",children:(oe,fe)=>{Oe(oe,{id:"header",get options(){return r(u)},get value(){return r(w)},set value(Se){j(w,Se,!0)}})},$$slots:{default:!0}});var se=z(K,2);{var le=oe=>{var fe=Zh(),Se=X(fe);ie(Se,{label:"Header name (predictors)",children:(Pe,Be)=>{Jo(Pe,{id:"varvaluesName",placeholder:"e.g. Wavelength",get value(){return r(v)},set value(Re){j(v,Re,!0)}})},$$slots:{default:!0}});var ct=z(Se,2);ie(ct,{label:"Header units (predictors)",children:(Pe,Be)=>{Jo(Pe,{id:"varvaluesUnits",maxLength:10,placeholder:"e.g. nm",get value(){return r(h)},set value(Re){j(h,Re,!0)}})},$$slots:{default:!0}}),E(oe,fe)};q(se,oe=>{r(w)==="values"&&oe(le)})}var ve=z(se,2);ie(ve,{label:" ",children:(oe,fe)=>{et(oe,{text:"Load",onclick:R})},$$slots:{default:!0}}),E(we,ye)};q(Ee,we=>{r(d)&&!Array.isArray(r(d))&&r(d).type==="text/csv"&&we(he)})}E(Q,ee)},I=Q=>{var ee=de(),ue=X(ee);{var Ee=he=>{var we=de(),ye=X(we);us(ye,()=>r(y),pe=>{ie(pe,{children:(ce,K)=>{var se=rm(),le=X(se);Ps(le);var ve=z(le,2),oe=W(ve);ne(()=>xe(oe,t()?"Loading data and apply model...":"Loading data...")),E(ce,se)},$$slots:{default:!0}})},void 0,(pe,ce)=>{ie(pe,{status:"error",children:(K,se)=>{var le=tm(),ve=W(le);ne(()=>xe(ve,r(ce))),E(K,le)},$$slots:{default:!0}})}),E(he,we)};q(ue,he=>{r(y)&&he(Ee)})}E(Q,ee)};q(Y,Q=>{o()?Q(I,!1):Q(Z)})}var H=z(Y,2);{var J=Q=>{Qh(Q,{get dataset(){return o()},reset:V,get title(){return a()}})};q(H,Q=>{o()&&Q(J)})}var $=z(H,2);{var ae=Q=>{ie(Q,{status:"error",children:(ee,ue)=>{var Ee=nm(),he=W(Ee);ne(()=>xe(he,r(L))),E(ee,Ee)},$$slots:{default:!0}})};q($,Q=>{(r(A)==="error"||r(L))&&Q(ae)})}E(n,P),ge()}var sm=U('<div class="msg-select"> </div>'),am=U('<div class="msg-select"> </div>'),om=U('<div class="msg-select"> </div>'),im=U('<div class="msg-select"> </div>'),cm=U('<div class="selected-buttons svelte-8mh2yv"><!></div>'),um=U('<div class="selected-buttons svelte-8mh2yv"><!></div>'),fm=U("<!> <!> <!>",1),dm=()=>switchPlot(i),vm=(n,e,t)=>j(e,r(t),!0),hm=U("<button> </button>"),mm=U('<div class="plot-panel svelte-8mh2yv"><div class="plot-area svelte-8mh2yv"><div class="plot svelte-8mh2yv"><!></div> <div class="plot-select-msg svelte-8mh2yv"><!> <!></div></div> <div class="plot-controls-area svelte-8mh2yv"></div></div>');function Js(n,e){me(e,!0);let t=B(e,"selobjText",3,"Click to select an object..."),l=B(e,"selvarText",3,"Make rectangular selection of variable to exclude ..."),s=B(e,"clearText",3,"Click anywhere to remove selection..."),a=B(e,"params",15),o=Te({objects:-1,variables:[]}),c=re(Te(Object.keys(e.plots)[0]));function f(F){o.objects=F}function u(F){o.objects=-1}function d(F){o.variables=F}function v(F){o.variables=[]}let h={objects:{select:f,unselect:u},variables:{select:d,unselect:v},stats:{}},m=g(()=>r(c)?e.plots[r(c)]:null),p=g(()=>r(m)?r(m).component:null);var w=mm(),b=W(w),_=W(b),S=W(_);Hn(S,()=>r(p),(F,M)=>{M(F,{get params(){return a()[r(c)]},get callbacks(){return h[r(m).scope]},get selected(){return o[r(m).scope]},get props(){return e.props}})});var y=z(_,2),A=W(y);{var L=F=>{var M=de(),T=X(M);{var R=V=>{var P=sm(),Y=W(P);ne(()=>xe(Y,t())),E(V,P)},D=V=>{var P=am(),Y=W(P);ne(()=>xe(Y,s())),E(V,P)};q(T,V=>{o[r(m).scope]<0?V(R):V(D,!1)})}E(F,M)};q(A,F=>{r(m).scope==="objects"&&a()[r(c)].plotType!=="l"&&t().length>0&&F(L)})}var k=z(A,2);{var C=F=>{var M=de(),T=X(M);{var R=V=>{var P=om(),Y=W(P);ne(()=>xe(Y,l())),E(V,P)},D=V=>{var P=im(),Y=W(P);ne(()=>xe(Y,s())),E(V,P)};q(T,V=>{o[r(m).scope].length===0?V(R):V(D,!1)})}E(F,M)};q(k,F=>{r(m).scope==="variables"&&a()[r(c)].plotType!=="l"&&l().length>0&&F(C)})}var N=z(b,2);Ne(N,21,()=>Object.keys(e.plots),Ie,(F,M)=>{var T=de(),R=X(T);{var D=P=>{var Y=fm(),Z=X(Y);Mf(Z,{get title(){return r(m).label},labelWidth:12,get options(){return e.controls[r(c)]},get value(){return a()[r(c)]},set value(ae){a(a()[r(c)]=ae,!0)}});var I=z(Z,2);{var H=ae=>{var Q=cm(),ee=W(Q);Er(ee,()=>r(m).buttons,()=>o.objects),E(ae,Q)};q(I,ae=>{r(m).scope==="objects"&&r(m).buttons&&o.objects>=0&&ae(H)})}var J=z(I,2);{var $=ae=>{var Q=um(),ee=W(Q);Er(ee,()=>r(m).buttons,()=>o.variables),E(ae,Q)};q(J,ae=>{r(m).scope==="variables"&&r(m).buttons&&o.variables.length>0&&ae($)})}E(P,Y)},V=P=>{var Y=hm();Y.__keydown=[dm],Y.__click=[vm,c,M];var Z=W(Y);ne(()=>{ft(Y,1,`plot-selector plot-selector-${r(M)??""}`,"svelte-8mh2yv"),xe(Z,e.plots[r(M)].label)}),E(P,Y)};q(R,P=>{r(m)&&r(c)===r(M)?P(D):P(V,!1)})}E(F,T)}),E(n,w),ge()}st(["keydown","click"]);function Si(n,e){!e.callbacks||!e.callbacks.select||dn(n,n.target.tagName,e.callbacks.select)}function gm(n,e){!e.callbacks||!e.callbacks.unselect||e.callbacks.unselect()}var pm=ke("<text> </text>"),bm=ke('<g class="series series-textlabels"></g>'),_m=ke('<g class="series series-line"><polyline class="line"></polyline></g>'),wm=ke("<rect></rect>"),ym=ke('<g class="series series-bar"></g>'),xm=ke("<text> </text>"),km=ke('<g class="series series-points series-points1"></g>'),Em=ke('<g class="series series-points series-points1"><text> </text></g>'),Sm=ke('<g class="series series-bar"><rect></rect></g>'),Am=ke('<g class="series series-text"><text> </text></g>'),Cm=ke('<rect width="100%" height="100%" fill="#ffffffa0"></rect><!><!>',1),Tm=ke("<!><!><!><!><!>",1);function cr(n,e){me(e,!0);let t=B(e,"shortenLabels",3,!0),l=B(e,"lineWidth",3,1),s=B(e,"markerSize",3,null),a=B(e,"markerWidth",3,2),o=B(e,"pch",3,"●"),c=B(e,"colors",3,void 0),f=B(e,"mainColor",19,()=>ir.cal),u=B(e,"faceColor",3,null),d=B(e,"selected",19,()=>-1),v=B(e,"xRange",15),h=B(e,"yRange",15);const m=Rt("axes"),p=g(()=>Tt(e.xValues,"PlotSeries")),w=g(()=>r(p)?Tt(e.yValues,"PlotSeries",r(p).length):null);_e(()=>{v(r(p)?ln(r(p)):null),h(r(w)?ln(r(w)):null)});const b=g(()=>u()===null?e.plotType==="p"?"transparent":"white":u()),_=g(()=>s()?s():e.plotType==="p"?1:.85),S=g(()=>Ms[m.scales().plot]),y=g(()=>at([0],m.tY())[0]),A=g(()=>Zn([.8],m.tX())[0]),L=g(()=>r(A)/2),k=g(()=>r(S));let C=g(()=>e.plotType==="l"||e.plotType==="b"?Fs(r(p),r(w),m.tX(),m.tY()):null),N=g(()=>r(p)?at(r(p),m.tX()):null),F=g(()=>r(w)?at(r(w),m.tY()):null),M=g(()=>e.labels&&Array.isArray(e.labels)?t()?e.labels.map(J=>J.slice(0,wi)):e.labels:null),T=g(()=>c()&&c().length===r(p).length?c():Array(r(p).length).fill(f()));const R=g(()=>`font-size:${r(_)}em;fill:${r(b)};cursor:default;text-anchor:middle;stroke-width:${a()}px;user-select:none;`),D=`font-size:0.85em;fill:${Rl};cursor:default;text-anchor:middle;stroke:${Rl};stroke-width:0.1px;user-select:none;`,V="font-size:1.2em;fill:none;text-anchor:middle;text-anchor:middle;cursor:default;stroke-width:3px;user-select:none;",P=`fill:transparent;stroke-width: ${l()}px;`,Y=`stroke-width:${l()}px;`;var Z=de(),I=X(Z);{var H=J=>{var $=Tm(),ae=X($);{var Q=K=>{var se=bm();Ne(se,21,()=>r(N),Ie,(le,ve,oe)=>{var fe=pm(),Se=W(fe);ne(()=>{O(fe,"x",r(N)[oe]),O(fe,"y",r(F)[oe]),O(fe,"dy",r(w).v[oe]<0?r(k):-r(k)),xe(Se,r(M)[oe])}),E(le,fe)}),ne(()=>ot(se,D)),E(K,se)};q(ae,K=>{e.showLabels&&r(M)&&K(Q)})}var ee=z(ae);{var ue=K=>{var se=_m(),le=W(se);ne(()=>{ot(se,P),O(le,"points",r(C)),O(le,"stroke",f())}),E(K,se)};q(ee,K=>{(e.plotType==="l"||e.plotType==="b")&&K(ue)})}var Ee=z(ee);{var he=K=>{var se=ym();se.__click=[Si,e],Ne(se,21,()=>r(N),Ie,(le,ve,oe)=>{var fe=wm();ne(()=>{O(fe,"x",r(N)[oe]-r(L)),O(fe,"y",r(w).v[oe]<0?r(y):r(F)[oe]),O(fe,"fill",r(T)[oe]),O(fe,"width",r(A)),O(fe,"height",r(w).v[oe]<0?r(F)[oe]-r(y):r(y)-r(F)[oe])}),E(le,fe)}),ne(()=>ot(se,Y)),E(K,se)};q(Ee,K=>{e.plotType==="h"&&K(he)})}var we=z(Ee);{var ye=K=>{var se=km();se.__click=[Si,e],Ne(se,21,()=>r(N),Ie,(le,ve,oe)=>{var fe=xm(),Se=W(fe);ne(()=>{O(fe,"x",r(N)[oe]),O(fe,"y",r(F)[oe]),O(fe,"fill",u()),O(fe,"stroke",r(T)[oe]),xe(Se,o())}),E(le,fe)}),ne(()=>ot(se,r(R))),E(K,se)};q(we,K=>{(e.plotType==="p"||e.plotType==="b")&&K(ye)})}var pe=z(we);{var ce=K=>{var se=Cm(),le=X(se);O(le,"x",0),O(le,"y",0),le.__click=[gm,e];var ve=z(le);{var oe=Pe=>{var Be=Em();ot(Be,V);var Re=W(Be),Ze=W(Re);ne(()=>{O(Re,"x",r(N)[d()]),O(Re,"y",r(F)[d()]),O(Re,"stroke",r(T)[d()]),xe(Ze,o())}),E(Pe,Be)},fe=Pe=>{var Be=Sm(),Re=W(Be);ne(()=>{ot(Be,Y),O(Re,"stroke",r(T)[d()]),O(Re,"fill",r(T)[d()]),O(Re,"x",r(N)[d()]-r(L)),O(Re,"y",r(w).v[d()]<0?r(y):r(F)[d()]),O(Re,"width",r(A)),O(Re,"height",r(w).v[d()]<0?r(F)[d()]-r(y):r(y)-r(F)[d()])}),E(Pe,Be)};q(ve,Pe=>{e.plotType!=="h"?Pe(oe):Pe(fe,!1)})}var Se=z(ve);{var ct=Pe=>{var Be=Am(),Re=W(Be),Ze=W(Re);ne(()=>{ot(Be,D),O(Re,"stroke",_i),O(Re,"fill",_i),O(Re,"x",r(N)[d()]),O(Re,"y",r(F)[d()]),O(Re,"dy",r(w).v[d()]<0?r(k):-r(k)),xe(Ze,r(M)[d()])}),E(Pe,Be)};q(Se,Pe=>{e.showLabels&&r(M)&&r(M).length>0&&Pe(ct)})}E(K,se)};q(pe,K=>{d()>=0&&K(ce)})}E(J,$)};q(I,J=>{r(N)&&r(F)&&J(H)})}E(n,Z),ge()}st(["click"]);var Pm=U("<!> <!> <!> <!>",1);function Ai(n,e){me(e,!0);let t=g(()=>e.props?e.props.res:null),l=g(()=>r(t)?Object.keys(r(t)):null),s=g(()=>e.params&&e.params.resID&&r(l)?e.params.resID==="both"?r(l):[e.params.resID]:null),a=g(()=>r(s)?r(t)[r(s)[0]]:null);const o={expvar:"Explained variance",resvar:"Residual variance",cumexpvar:"Cumulative explained variance",cumresvar:"Cumulative residual variance"},c=g(()=>e.params.varSet==="X"?"x":"y"),f=g(()=>e.params.varForm==="cumulative"?"cum":""),u=g(()=>e.params.varType==="explained"?"exp":"res"),d=g(()=>r(f)+r(u)+"var"),v=g(()=>r(c)+r(f)+r(u)+"var"),h=g(()=>r(d)?o[r(d)]+" ("+e.params.varSet+")":""),m=g(()=>r(a).ncomp>1?1-r(a).ncomp*.065:-.1),p=g(()=>r(a).ncomp>1?r(a).ncomp*1.065:2.1),w=g(()=>[r(m),r(p)]),b=g(()=>r(a)?r(a).stat.components:null),_=g(()=>r(s)?r(s).map(N=>{const F=r(t)[N].stat[r(v)];return{yValues:Ye(F),labels:Array.from(F).map(M=>M.toFixed(M<.1?3:2)),faceColor:Yr[N],mainColor:ir[N]}}):null),S=g(()=>r(_)?Ht(r(_).map(N=>Math.min(-.05,Ht(N.yValues)))):0),y=g(()=>[r(S)*1.1,1.1]),A=g(()=>r(_)?r(s).map(N=>({id:N,label:N,point:{marker:1,faceColor:Yr[N],lineColor:ir[N],markerSize:.85,lineWidth:1.5}})):null);var L=de(),k=X(L);{var C=N=>{{let F=g(()=>"plot-"+r(v));wr(N,{get title(){return r(h)},get limX(){return r(w)},get limY(){return r(y)},xLabel:"Number of LVs",yLabel:"Variance",get fileName(){return r(F)},whole:!0,children:(M,T)=>{var R=Pm(),D=X(R);{var V=H=>{{let J=g(()=>[e.props.ncomp]),$=g(()=>[e.props.ncomp]),ae=g(()=>[r(y)[0]]),Q=g(()=>[r(y)[1]]);vn(H,{get xStart(){return r(J)},get xEnd(){return r($)},get yStart(){return r(ae)},get yEnd(){return r(Q)},lineColor:"#a0a0a0"})}};q(D,H=>{e.props.ncomp&&H(V)})}var P=z(D,2);Ne(P,17,()=>r(_),Ie,(H,J)=>{cr(H,{get xValues(){return r(b)},get yValues(){return r(J).yValues},get labels(){return r(J).labels},get faceColor(){return r(J).faceColor},get mainColor(){return r(J).mainColor},plotType:"b",get showLabels(){return e.params.showLabels},lineWidth:1.5})});var Y=z(P,2);{var Z=H=>{var J=de(),$=X(J);Ne($,17,()=>r(_),Ie,(ae,Q)=>{{let ee=g(()=>[r(b)[e.props.ncomp-1]]),ue=g(()=>[r(Q).yValues.v[e.props.ncomp-1]]);cr(ae,{get xValues(){return r(ee)},get yValues(){return r(ue)},get faceColor(){return r(Q).faceColor},get mainColor(){return r(Q).mainColor},plotType:"b",get showLabels(){return e.params.showLabels},markerSize:1,lineWidth:1.5,markerWidth:3})}}),E(H,J)};q(Y,H=>{e.props.ncomp&&H(Z)})}var I=z(Y,2);Ml(I,{get items(){return r(A)}}),E(M,R)},$$slots:{default:!0}})}};q(k,N=>{r(b)&&r(_)&&N(C)})}E(n,L),ge()}var Lm=U("<!> <!> <!> <!>",1);function Ci(n,e){me(e,!0);const t={rmse:"RMSE",r2:"R^2",slope:"Slope"};let l=g(()=>e.props?e.props.res:null),s=g(()=>r(l)?Object.keys(r(l)):null),a=g(()=>e.params&&e.params.resID&&r(s)?e.params.resID==="both"?r(s):[e.params.resID]:null),o=g(()=>r(a)?r(l)[r(a)[0]]:null),c=g(()=>e.params?t[e.params.fom]:""),f=g(()=>e.params?t[e.params.fom]+" ("+r(o).varlabels[e.params.resp-1]+")":""),u=g(()=>r(o).ncomp>1?1-r(o).ncomp*.065:-.1),d=g(()=>r(o).ncomp>1?r(o).ncomp*1.065:2.1),v=g(()=>[r(u),r(d)]),h=g(()=>r(o)?r(o).stat.components:null),m=g(()=>{if(!r(a))return null;let A=0,L=Number.NEGATIVE_INFINITY,k=[];for(let C of r(a)){const N=r(l)[C].stat[e.params.fom].getcolref(e.params.resp);A=Math.min(A,Ht(N)),L=Math.max(L,er(N)),k.push({yValues:Ye(N),labels:Array.from(N).map(F=>F.toFixed(F<.1?3:2)),faceColor:Yr[C],mainColor:ir[C]})}return{yMin:A,yMax:L,values:k}}),p=g(()=>r(m)?r(a).map(A=>({id:A,label:A,point:{marker:1,faceColor:Yr[A],lineColor:ir[A],markerSize:.85,lineWidth:1.5}})):null);const w=g(()=>r(m)?(r(m).yMax-r(m).yMin)*.05:0),b=g(()=>r(m)?[r(m).yMin-r(w),r(m).yMax+4*r(w)]:[0,1]);var _=de(),S=X(_);{var y=A=>{{let L=g(()=>"plot-"+e.params.fom);wr(A,{get title(){return r(f)},get limX(){return r(v)},get limY(){return r(b)},get yLabel(){return r(c)},xLabel:"Number of LVs",get fileName(){return r(L)},whole:!0,children:(k,C)=>{var N=Lm(),F=X(N);{var M=P=>{{let Y=g(()=>[e.props.ncomp]),Z=g(()=>[e.props.ncomp]),I=g(()=>[r(b)[0]]),H=g(()=>[r(b)[1]]);vn(P,{get xStart(){return r(Y)},get xEnd(){return r(Z)},get yStart(){return r(I)},get yEnd(){return r(H)},lineColor:"#a0a0a0"})}};q(F,P=>{e.props.ncomp&&P(M)})}var T=z(F,2);Ne(T,17,()=>r(m).values,Ie,(P,Y)=>{cr(P,{get xValues(){return r(h)},get yValues(){return r(Y).yValues},get labels(){return r(Y).labels},get faceColor(){return r(Y).faceColor},get mainColor(){return r(Y).mainColor},plotType:"b",get showLabels(){return e.params.showLabels},lineWidth:1.5})});var R=z(T,2);{var D=P=>{var Y=de(),Z=X(Y);Ne(Z,17,()=>r(m).values,Ie,(I,H)=>{{let J=g(()=>[r(h)[e.props.ncomp-1]]),$=g(()=>[r(H).yValues.v[e.props.ncomp-1]]);cr(I,{get xValues(){return r(J)},get yValues(){return r($)},get faceColor(){return r(H).faceColor},get mainColor(){return r(H).mainColor},plotType:"b",get showLabels(){return e.params.showLabels},markerSize:1,lineWidth:1.5,markerWidth:3})}}),E(P,Y)};q(R,P=>{e.props.ncomp&&P(D)})}var V=z(R,2);Ml(V,{get items(){return r(p)}}),E(k,N)},$$slots:{default:!0}})}};q(S,A=>{r(h)&&r(m)&&A(y)})}E(n,_),ge()}var Nm=U("<!> <!>",1),zm=U("<!> <!> <!> <!>",1);function Qs(n,e){me(e,!0);const t=g(()=>e.props?e.props.res:null),l=g(()=>r(t)?Object.keys(r(t)):null),s=g(()=>e.params&&e.params.resID&&r(l)?e.params.resID==="both"?r(l):[e.params.resID]:null),a=g(()=>r(s)&&r(t)[r(s)[0]]?r(t)[r(s)[0]]:null),o=g(()=>!!(r(a)&&r(a).Yref)),c=g(()=>r(a)?"Predictions for "+r(a).varlabels[e.params.resp-1]+" (A = "+e.props.ncomp+")":""),f=g(()=>r(o)?"Reference y-values":"Objects"),u=g(()=>{if(!r(a)||!r(a).stat||!e.params.showStat||e.params.resID==="both")return null;const _=e.params.resID,S=r(t)[_].stat.rmse.getcolref(e.params.resp)[e.props.ncomp-1],y=r(t)[_].stat.r2.getcolref(e.params.resp)[e.props.ncomp-1],A=r(t)[_].stat.slope.getcolref(e.params.resp)[e.props.ncomp-1];return'<tspan x="5em" dy="1.5em">RMSE: '+S.toFixed(2)+'</tspan><tspan x="5em" dy="1.5em">R2: '+y.toFixed(3)+'</tspan><tspan x="5em" dy="1.5em">Slope: '+A.toFixed(3)+"</tspan></tspan>"}),d=g(()=>{if(!r(s)||!r(a))return null;let _=e.params.resp?Number.POSITIVE_INFINITY:null,S=e.params.resp?Number.NEGATIVE_INFINITY:null,y=0,A=[],L="";for(let k of r(s)){const C=r(t)[k],N=C.Yref?C.Yref.getcolref(e.params.resp):C.objindices.map(R=>R+1),F=Et(C,"Yp",e.props.ncomp,e.params.resp),M=mo(N,F)/ps(N),T=sn(F)-M*sn(N);_=Math.min(_,Ht(N),Ht(F)),S=Math.max(S,er(N),er(F)),y+=N.length,A.push({xValues:Ye(N),yValues:Ye(F),lineX:[_,S],lineY:[T+M*_,T+M*S],labels:e.params.showLabels==="labels"?C.objlabels:bv(F,_,S),faceColor:Yr[k]+"40",mainColor:ir[k],stats:L})}return{vMin:_,vMax:S,vNum:y,values:A}});let v=g(()=>r(d)?r(s).map(_=>({id:_,label:_,point:{marker:1,faceColor:Yr[_],lineColor:ir[_],markerSize:.85,lineWidth:1.5}})):null);const h=g(()=>r(d)?(r(d).vMax-r(d).vMin)*.075:null),m=g(()=>r(h)?[r(d).vMin-r(h),r(d).vMax+r(h)]:[0,1]);var p=de(),w=X(p);{var b=_=>{{let S=g(()=>r(o)?r(m):[0,r(d).vNum+1]);wr(_,{get title(){return r(c)},get xLabel(){return r(f)},get limX(){return r(S)},get limY(){return r(m)},yLabel:"Predicted y-values",fileName:"plot-predictions",get onclick(){return e.callbacks.unselectObject},children:(y,A)=>{var L=zm(),k=X(L);{var C=R=>{_r(R,{get xValues(){return r(m)},get yValues(){return r(m)},lineColor:"#d0d0d0"})};q(k,R=>{r(o)&&R(C)})}var N=z(k,2);Ne(N,17,()=>r(d).values,Ie,(R,D)=>{var V=Nm(),P=X(V);{var Y=I=>{_r(I,{get xValues(){return r(D).lineX},get yValues(){return r(D).lineY},get lineColor(){return r(D).mainColor}})};q(P,I=>{r(o)&&I(Y)})}var Z=z(P,2);{let I=g(()=>e.params.showLabels!=="hide"),H=g(()=>r(o)?"p":"h");cr(Z,{get selected(){return e.selected},get callbacks(){return e.callbacks},get xValues(){return r(D).xValues},get yValues(){return r(D).yValues},get faceColor(){return r(D).faceColor},get mainColor(){return r(D).mainColor},get labels(){return r(D).labels},get showLabels(){return r(I)},get plotType(){return r(H)}})}E(R,V)});var F=z(N,2);{var M=R=>{{let D=g(()=>[r(m)[0]]),V=g(()=>[r(m)[1]-r(h)]);hn(R,{textSize:.85,pos:0,get xValues(){return r(D)},get yValues(){return r(V)},get labels(){return r(u)}})}};q(F,R=>{r(u)&&R(M)})}var T=z(F,2);Ml(T,{get items(){return r(v)},position:"bottomright"}),E(y,L)},$$slots:{default:!0}})}};q(w,_=>{r(d)&&_(b)})}E(n,p),ge()}var Mm=U("<!> <!>",1),Rm=U("<!> <!> <!>",1);function Zs(n,e){me(e,!0);let t=g(()=>e.props?e.props.model:null),l=g(()=>e.props?e.props.res:null),s=g(()=>r(l)?Object.keys(r(l)):null),a=g(()=>e.params&&e.params.resID&&r(s)?e.params.resID==="both"?r(s):[e.params.resID]:null),o=g(()=>r(a)?r(l)[r(a)[0]]:null);const c="Scores";function f(S,y){return S==="X"?"X":S==="Y"?"Y":y==="x"?"X":"Y"}function u(S,y,A,L){return(S==="X"||S==="Y")&&L==="x"?y:A}function d(S,y){const A=f(S.varSet,y),L=u(S.varSet,S.comp1,S.comp2,y),k=r(t).stat[A.toLocaleLowerCase()+"expvar"][L-1]*100;return A+"-scores (LV"+L+", "+k.toFixed(k>1?1:2)+"%)"}let v=g(()=>{if(!r(a)||!r(o))return null;let S=Number.POSITIVE_INFINITY,y=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,L=Number.NEGATIVE_INFINITY,k=[];for(let T of r(a)){const R=r(l)[T],D=e.params.varSet==="X"|e.params.varSet==="XY"?Et(R,"xscores",e.params.varSet==="XY"?e.params.comp2:e.params.comp1):Et(R,"yscores",e.params.comp1),V=e.params.varSet==="X"?Et(R,"xscores",e.params.comp2):Et(R,"yscores",e.params.comp2);S=Math.min(S,Ht(D)),y=Math.min(y,Ht(V)),A=Math.max(A,er(D)),L=Math.max(L,er(V)),k.push({xValues:Ye(D),yValues:Ye(V),labels:R.objlabels,faceColor:Yr[T]+"40",mainColor:ir[T]})}const C=(A-S)*.05,N=(L-y)*.05,F=[S-C,A+C],M=[y-N,L+N];return{limX:F,limY:M,values:k}});const h=g(()=>d(e.params,"x")),m=g(()=>d(e.params,"y"));let p=g(()=>r(v)?r(a).map(S=>({id:S,label:S,point:{marker:1,faceColor:Yr[S],lineColor:ir[S],markerSize:.85,lineWidth:1.5}})):null);var w=de(),b=X(w);{var _=S=>{{let y=g(()=>"plot-"+e.params.varSet.toLowerCase()+"scores");wr(S,{title:c,get xLabel(){return r(h)},get yLabel(){return r(m)},get limX(){return r(v).limX},get limY(){return r(v).limY},get fileName(){return r(y)},get onclick(){return e.callbacks.unselectObject},children:(A,L)=>{var k=Rm(),C=X(k);{var N=T=>{var R=Mm(),D=X(R);{let P=g(()=>[r(v).limY[0]]),Y=g(()=>[r(v).limY[1]]);vn(D,{xStart:[0],xEnd:[0],get yStart(){return r(P)},get yEnd(){return r(Y)},get lineColor(){return $n}})}var V=z(D,2);{let P=g(()=>[r(v).limX[0]]),Y=g(()=>[r(v).limX[1]]);vn(V,{yStart:[0],yEnd:[0],get xStart(){return r(P)},get xEnd(){return r(Y)},get lineColor(){return $n}})}E(T,R)};q(C,T=>{e.props.ncomp&&T(N)})}var F=z(C,2);Ne(F,17,()=>r(v).values,Ie,(T,R)=>{cr(T,{get selected(){return e.selected},get callbacks(){return e.callbacks},get xValues(){return r(R).xValues},get yValues(){return r(R).yValues},get faceColor(){return r(R).faceColor},get mainColor(){return r(R).mainColor},get labels(){return r(R).labels},get showLabels(){return e.params.showLabels},plotType:"p",lineWidth:1.5})});var M=z(F,2);Ml(M,{get items(){return r(p)}}),E(A,k)},$$slots:{default:!0}})}};q(b,S=>{r(v)&&S(_)})}E(n,w),ge()}var Im=U("<!> <!> <!>",1),Fm=U("<!> <!> <!>",1);function Ti(n,e){me(e,!0);function t(ae,Q,ee){if(ee<10)return Math.round(Math.log2(ee)+1);const ue=2*ae/Math.pow(ee,.3333333);return Math.round(Q/ue)}const l={p:"Reference y-values",qq:"Standard normal quantiles, z",h:"Residuals, e"},s={p:"Residuals, e",qq:"Sample quantiles, e",h:"Counts"},a=g(()=>e.props.res[e.params.resID]),o=g(()=>r(a)?"Residuals for "+r(a).varlabels[e.params.resp-1]+" (A = "+e.props.ncomp+")":""),c=g(()=>l[e.params.plotType]),f=g(()=>s[e.params.plotType]),u=g(()=>r(a)?r(a).Yref.getcolref(e.params.resp):null),d=g(()=>r(a)?Et(r(a),"Yp",e.props.ncomp,e.params.resp):null),v=g(()=>r(u)&&r(d)?new ze(r(u).map((ae,Q)=>ae-r(d)[Q])):null),h=g(()=>r(v)?r(v).sort():null),m=g(()=>r(a)?Au(r(a).nrows):null),p=g(()=>r(m)?Cl(r(m)):null),w=g(()=>r(h)?r(h).v[Math.round(r(h).length*.25)]:null),b=g(()=>r(h)?r(h).v[Math.round(r(h).length*.75)]:null),_=g(()=>r(w)&&r(b)?r(b)-r(w):null),S=g(()=>r(_)?r(_)/1.348:1),y=g(()=>r(w)&&r(S)?r(w)+r(S)*.674:0),A=g(()=>[-4*r(S)+r(y),4*r(S)+r(y)]),L=[-4,4],k=g(()=>r(a)?r(a).nrows:1),C=g(()=>r(v)?ln(r(v)):null),N=g(()=>r(_)&&r(k)&&r(C)?t(r(_),r(C)[1]-r(C)[0],r(k)):10),F=g(()=>r(v)?Al(r(v),r(N)):null),M=g(()=>r(F)?fo(r(v),r(F)):null),T=g(()=>r(F)?vo(r(F)):null),R=g(()=>r(v)?Array.from(r(v).sortind().v):null),D=g(()=>e.params.plotType==="p"?r(a).objlabels:r(R).map(ae=>r(a).objlabels[ae-1])),V=g(()=>r(v)?e.params.plotType==="p"?new ze(r(u)):e.params.plotType==="qq"?r(p):r(T):null),P=g(()=>r(v)?e.params.plotType==="p"?r(v):e.params.plotType==="qq"?r(h):r(M):null),Y=g(()=>ir[e.params.resID]),Z=g(()=>r(V)?Ar(r(V)):[0,1]),I=g(()=>r(P)?Ar(r(P)):[0,1]);var H=de(),J=X(H);{var $=ae=>{wr(ae,{get title(){return r(o)},get xLabel(){return r(c)},get limX(){return r(Z)},get limY(){return r(I)},get yLabel(){return r(f)},fileName:"plot-yresiduals",get onclick(){return e.callbacks.unselectObject},children:(Q,ee)=>{var ue=de(),Ee=X(ue);{var he=ye=>{var pe=Im(),ce=X(pe);Ws(ce,{get xValues(){return r(V)},get yValues(){return r(P)},get lineColor(){return r(Y)},lineWidth:2});var K=z(ce,2);_r(K,{get xValues(){return L},get yValues(){return r(A)},lineColor:"#606060"});var se=z(K,2);{var le=ve=>{hn(ve,{get xValues(){return r(V)},get yValues(){return r(P)},get labels(){return r(D)},pos:3,textSize:.85,get faceColor(){return Rl}})};q(se,ve=>{e.params.showLabels!=="hide"&&ve(le)})}E(ye,pe)},we=ye=>{var pe=de(),ce=X(pe);{var K=le=>{Qd(le,{get xValues(){return r(V)},get yValues(){return r(P)},get faceColor(){return r(Y)},get lineColor(){return r(Y)},barWidth:.95})},se=le=>{var ve=Fm(),oe=X(ve);Ws(oe,{get xValues(){return r(V)},get yValues(){return r(P)},get lineColor(){return r(Y)},lineWidth:2});var fe=z(oe,2);_r(fe,{get xValues(){return r(Z)},yValues:[0,0],lineColor:"#606060"});var Se=z(fe,2);{var ct=Pe=>{hn(Pe,{get xValues(){return r(V)},get yValues(){return r(P)},get labels(){return r(D)},pos:3,textSize:.85,get faceColor(){return Rl}})};q(Se,Pe=>{e.params.showLabels!=="hide"&&Pe(ct)})}E(le,ve)};q(ce,le=>{e.params.plotType==="h"?le(K):le(se,!1)},!0)}E(ye,pe)};q(Ee,ye=>{e.params.plotType==="qq"?ye(he):ye(we,!1)})}E(Q,ue)},$$slots:{default:!0}})};q(J,ae=>{r(V)&&r(P)&&ae($)})}E(n,H),ge()}var jm=U("<!> <!> <!>",1);function Vm(n,e){me(e,!0);let t=g(()=>e.props?e.props.model:null);function l(C,N,F){return!C||!N||N<1||N>C.ncomp?null:new ze(zt(C,F,N))}let s=re(void 0),a=re(void 0);const o=g(()=>r(t)?Ye(r(t).xvarvalues):null),c=g(()=>r(t)?Ye(r(t).xvarindices):null),f=g(()=>r(t)?r(t).xvarlabels:null),u=g(()=>r(t)?l(r(t),e.params.comp2,e.params.statType):null),d=g(()=>r(t)?l(r(t),e.params.comp1,e.params.statType):null),v=g(()=>!r(t)||!e.params.comp1?null:e.params.plotType==="p"?{values:r(d),label:`LV${e.params.comp1}`}:e.params.plotType==="l"&&r(o)?{values:r(o),label:r(t).varvaluesName+(r(t).varvaluesUnits?", "+r(t).varvaluesUnits:"")}:{values:r(c),label:"Predictors"}),h=g(()=>r(v)?r(v).values:null),m=g(()=>r(v)?r(v).label:null),p=g(()=>r(u)),w=g(()=>`LV${e.params.comp2}`),b=g(()=>{if(r(a)&&r(a)[0]<Number.POSITIVE_INFINITY&&r(a)[1]>Number.NEGATIVE_INFINITY){const C=(r(a)[1]-r(a)[0])*.1;return[r(a)[0]-2*C,r(a)[1]+C]}else return[0,1]}),_=g(()=>{if(r(s)&&r(s)[0]<Number.POSITIVE_INFINITY&&r(s)[1]>Number.NEGATIVE_INFINITY){const C=Math.abs((r(s)[1]-r(s)[0])*.1);return e.params.plotType==="l"&&r(t).varrev?[r(s)[1]+C,r(s)[0]-C]:[r(s)[0]-C,r(s)[1]+C]}else return[0,1]}),S=g(()=>e.params.statType==="xloadings"?"X-loadings":"Weights"),y=g(()=>"plot-"+e.params.statType);var A=de(),L=X(A);{var k=C=>{wr(C,{get xLabel(){return r(m)},get yLabel(){return r(w)},get title(){return r(S)},get fileName(){return r(y)},get limX(){return r(_)},get limY(){return r(b)},children:(N,F)=>{var M=jm(),T=X(M);{let P=g(()=>[r(_)[0]]),Y=g(()=>[r(_)[1]]);vn(T,{get xStart(){return r(P)},get xEnd(){return r(Y)},yStart:[0],yEnd:[0],get lineColor(){return $n}})}var R=z(T,2);{var D=P=>{{let Y=g(()=>[r(b)[0]]),Z=g(()=>[r(b)[1]]);vn(P,{xStart:[0],xEnd:[0],get yStart(){return r(Y)},get yEnd(){return r(Z)},get lineColor(){return $n}})}};q(R,P=>{e.params.plotType==="p"&&P(D)})}var V=z(R,2);cr(V,{get xValues(){return r(h)},get yValues(){return r(p)},get selected(){return e.selected},get plotType(){return e.params.plotType},get showLabels(){return e.params.showLabels},get labels(){return r(f)},shortenLabels:!1,get xRange(){return r(s)},set xRange(P){j(s,P,!0)},get yRange(){return r(a)},set yRange(P){j(a,P,!0)}}),E(N,M)},$$slots:{default:!0}})};q(L,C=>{r(h)&&r(p)&&C(k)})}E(n,A),ge()}var Om=U("<!> <!> <!>",1);function $s(n,e){me(e,!0);let t=g(()=>e.props&&e.props.model?e.props.model:null),l=g(()=>e.props&&e.props.res?e.props.res:null),s=g(()=>r(l)?Object.keys(r(l)):null),a=g(()=>e.params&&e.params.resID&&r(s)?e.params.resID==="both"?r(s):[e.params.resID]:null);const o="#909090",c=g(()=>r(t)?e.params.limType==="classic"?{h:zt(r(t),"cNh"),q:zt(r(t),"cNq"),z:zt(r(t),"cNz")}:{h:zt(r(t),"rNh"),q:zt(r(t),"rNq"),z:zt(r(t),"rNz")}:null),f=g(()=>r(t)?e.params.limType==="classic"?{h:zt(r(t),"ch0"),q:zt(r(t),"cq0"),z:zt(r(t),"cz0")}:{h:zt(r(t),"rh0"),q:zt(r(t),"rq0"),z:zt(r(t),"rz0")}:null),u=g(()=>r(c)?{h:r(c).h[e.props.ncomp-1],q:r(c).q[e.props.ncomp-1],z:r(c).z[e.props.ncomp-1]}:null),d=g(()=>r(f)?{h:r(f).h[e.props.ncomp-1],q:r(f).q[e.props.ncomp-1],z:r(f).z[e.props.ncomp-1]}:null),v=g(()=>r(u)?e.params.distType==="h/q"?r(u).h:r(u).h+r(u).q:null),h=g(()=>r(u)?e.params.distType==="h/q"?r(u).q:r(u).z:null),m=g(()=>r(d)?e.params.distType==="h/q"?r(d).h:r(u).h+r(u).q:null),p=g(()=>r(d)?e.params.distType==="h/q"?r(d).q:r(d).z:null),w=g(()=>e.params.alpha?1-e.params.alpha/100:.95),b=g(()=>e.params.gamma?1-e.params.gamma/100:.99);let _=g(()=>r(u)?ki(r(w),r(v),r(h),e.params.transType):null),S=g(()=>r(u)?ki(Math.pow(r(b),1/r(t).nrows),r(v),r(h),e.params.transType):null);const y=g(()=>{if(!r(l)||!r(u)||!r(d))return null;let V=Number.POSITIVE_INFINITY,P=Number.POSITIVE_INFINITY,Y=Number.NEGATIVE_INFINITY,Z=Number.NEGATIVE_INFINITY;const I=[];for(let H of r(a)){const J=r(l)[H];if(!J)return null;const $=Et(J,"hdist",e.props.ncomp),ae=Et(J,"qdist",e.props.ncomp),Q=Et(J,"zdist",e.props.ncomp),ee=e.params.distType==="h/q"?$:$.map((we,ye)=>we/r(d).h*r(u).h+ae[ye]/r(d).q*r(u).q),ue=e.params.distType==="h/q"?ae:Q,Ee=yi(ee,r(v),r(m),e.params.transType),he=yi(ue,r(h),r(p),e.params.transType);V=Math.min(V,Ee.min),P=Math.min(P,he.min),Y=Math.max(Y,Ee.max),Z=Math.max(Z,he.max),I.push({xValues:Ee.values,yValues:he.values,mainColor:ir[H],labels:J.objlabels.map(we=>we.slice(0,wi))})}return{values:I,xMin:V,xMax:Y,yMin:P,yMax:Z}});let A=g(()=>"Distances (A = "+e.props.ncomp+")"),L=g(()=>xi(e.params.distType==="h/q"?"h":"f",e.params.transType)),k=g(()=>xi(e.params.distType==="h/q"?"q":"z",e.params.transType)),C=re(void 0),N=re(void 0),F=g(()=>{if(!r(y))return[0,1];const V=Math.max(r(y).xMax,r(S).x.v[r(S).x.v.length-1]);return[-.02*(V-r(y).xMin),1.05*V]}),M=g(()=>{if(!r(y))return[0,1];const V=Math.max(r(y).yMax,r(S).y.v[0]);return[-.02*(V-r(y).yMin),(1.05+.1*(e.params.colorBy!=="none"))*V]});var T=de(),R=X(T);{var D=V=>{wr(V,{get title(){return r(A)},get limX(){return r(F)},get limY(){return r(M)},get xLabel(){return r(L)},get yLabel(){return r(k)},fileName:"plot-distance",get onclick(){return e.callbacks.unselectObject},children:(P,Y)=>{var Z=Om(),I=X(Z);{var H=Q=>{_r(Q,{get xValues(){return r(_).x},get yValues(){return r(_).y},lineColor:o,lineType:2})};q(I,Q=>{r(_)&&Q(H)})}var J=z(I,2);{var $=Q=>{_r(Q,{get xValues(){return r(S).x},get yValues(){return r(S).y},lineColor:o,lineType:3})};q(J,Q=>{r(S)&&Q($)})}var ae=z(J,2);Ne(ae,17,()=>r(y).values,Ie,(Q,ee)=>{cr(Q,{get selected(){return e.selected},get callbacks(){return e.callbacks},get labels(){return r(ee).labels},get mainColor(){return r(ee).mainColor},get xValues(){return r(ee).xValues},get yValues(){return r(ee).yValues},plotType:"p",get showLabels(){return e.params.showLabels},get xRange(){return r(C)},set xRange(ue){j(C,ue,!0)},get yRange(){return r(N)},set yRange(ue){j(N,ue,!0)}})}),E(P,Z)},$$slots:{default:!0}})};q(R,V=>{r(y)&&V(D)})}E(n,T),ge()}var Bm=U("<!> <!>",1);function qm(n,e){me(e,!0);let t=g(()=>e.props?e.props.model:null),l=g(()=>r(t)&&e.props.ncomp>0?r(t).coeffs.subarray((e.props.ncomp-1)*r(t).npred*r(t).nresp,(e.props.ncomp-1)*r(t).npred*r(t).nresp+r(t).npred*r(t).nresp):null),s=g(()=>r(l)?new $e(r(l),r(t).npred,r(t).nresp):null);const a=g(()=>r(t)?Ye(r(t).xvarvalues):null),o=g(()=>r(t)?Ye(r(t).xvarindices):null),c=g(()=>r(t)?r(t).xvarlabels:null),f=g(()=>r(t)?r(t).varvaluesName+(r(t).varvaluesUnits?", "+r(t).varvaluesUnits:""):""),u=g(()=>e.params.plotType==="h"?r(o):r(a)),d=g(()=>r(s)?r(s).getcolumn(e.params.resp):null),v=g(()=>e.params.plotType==="h"?"Predictors":r(f)),h=g(()=>e.params.plotType==="h"&&r(u).length<20?[.5,r(u).length+.5]:r(u)?Ar(r(u),.05):[0,1]),m=g(()=>r(d)?Ar(r(d),.075):[0,1]),p=g(()=>"Regression coefficients (A = "+e.props.ncomp+")"),w="Coefficients";var b=de(),_=X(b);{var S=y=>{{let A=g(()=>e.params.plotType==="h");wr(y,{get xLabel(){return r(v)},yLabel:w,get limX(){return r(h)},get limY(){return r(m)},get title(){return r(p)},get whole(){return r(A)},fileName:"plot-regcoeffs",children:(L,k)=>{var C=Bm(),N=X(C);{let M=g(()=>[r(h)[0]]),T=g(()=>[r(h)[1]]);vn(N,{get xStart(){return r(M)},get xEnd(){return r(T)},yStart:[0],yEnd:[0],get lineColor(){return $n}})}var F=z(N,2);cr(F,{get xValues(){return r(u)},get yValues(){return r(d)},get selected(){return e.selected},get plotType(){return e.params.plotType},get showLabels(){return e.params.showLabels},get labels(){return r(c)},shortenLabels:!1}),E(L,C)},$$slots:{default:!0}})}};q(_,y=>{r(u)&&r(d)&&y(S)})}E(n,b),ge()}var Ym=U("<!> <!> <!>",1),Dm=U('<div class="svelte-17oamay"><!></div>');function Wm(n,e){me(e,!0);let t=g(()=>!0),l=re(!1),s=re(null),a=re(null),o=re(null),c=re(null);const f=g(()=>r(s)!==null&&r(o)!==null?Math.min(r(s),r(o)):null),u=g(()=>r(a)!==null&&r(c)!==null?Math.max(r(a),r(c)):null),d=g(()=>r(s)!==null&&r(o)!==null?Math.abs(r(s)-r(o)):null),v=g(()=>r(a)!==null&&r(c)!==null?Math.abs(r(a)-r(c)):null),h=g(()=>e.props?e.props.model:null),m=g(()=>e.props&&e.props.ncomp>0?e.props.ncomp:1),p=g(()=>r(h)&&r(m)>0?(r(m)-1)*r(h).npred*r(h).nresp:null),w=g(()=>r(p)!==null?r(p)+r(h).npred*r(h).nresp:null),b=g(()=>r(w)!==null?new $e(r(h).sr.subarray(r(p),r(w)),r(h).npred,r(h).nresp):null),_=g(()=>r(w)!==null?new $e(r(h).vip.subarray(r(p),r(w)),r(h).npred,r(h).nresp):null),S=g(()=>r(h)?Ye(r(h).xvarvalues):null),y=g(()=>r(h)?Ye(r(h).xvarindices):null),A=g(()=>r(h)?r(h).xvarlabels:null),L=g(()=>r(S)&&r(y)&&r(_)?{values:r(S),indices:r(y),vip:r(_).getcolumn(e.params.resp)}:null),k=g(()=>r(_)&&r(b)?{vip:r(_).getcolumn(e.params.resp),selratio:r(b).getcolumn(e.params.resp)}:null),C=g(()=>r(h)?{values:r(h).varvaluesName+(r(h).varvaluesUnits?", "+r(h).varvaluesUnits:""),indices:"Predictors",vip:"VIP scores"}:null),N=g(()=>r(h)?{vip:"VIP scores",selratio:"Selectivity ratio"}:null),F=g(()=>r(L)?r(L)[e.params.xset]:null),M=g(()=>r(k)?r(k)[e.params.yset]:null),T=g(()=>r(C)?r(C)[e.params.xset]:null),R=g(()=>r(N)?r(N)[e.params.yset]:null),D=g(()=>"Variable importance (A = "+r(m)+")"),V=g(()=>r(F)?Ar(r(F),.05):[0,1]),P=g(()=>r(M)?Ar(r(M),.075):[0,1]),Y=g(()=>r(h)?r(h).npred<30?1:r(h).npred>200?.4:.6:1),Z=g(()=>e.selected&&e.selected.length>0?Ye(e.selected.map(he=>r(F).v[he])):null),I=g(()=>e.selected&&e.selected.length>0?Ye(e.selected.map(he=>r(M).v[he])):null);function H(){const he=r(u)-r(v),we=r(f)+r(d),ye=[];for(let pe=0;pe<=r(F).length;pe++){const ce=r(F).v[pe],K=r(M).v[pe];ce>=r(f)&&ce<=we&&K>=he&&K<=r(u)&&ye.push(pe)}ye.length>0&&e.callbacks.select(ye),j(s,null),j(a,null),j(o,null),j(c,null)}function J(he,we){e.callbacks.unselect(),j(l,!0),j(s,he,!0),j(a,we,!0),j(o,he,!0),j(c,we,!0)}function $(he,we){j(l,!1),j(t,!0),H()}function ae(he,we){r(l)&&(j(o,he,!0),j(c,we,!0))}function Q(){if(r(t)){j(t,!1);return}j(l,!1),j(s,null),j(a,null),j(o,null),j(c,null),e.callbacks.unselect()}var ee=de(),ue=X(ee);{var Ee=he=>{var we=Dm(),ye=W(we);wr(ye,{get xLabel(){return r(T)},get yLabel(){return r(R)},get limX(){return r(V)},get limY(){return r(P)},get title(){return r(D)},onmousedown:J,onmouseup:$,onmousemove:ae,onclick:Q,fileName:"plot-varimp",children:(pe,ce)=>{var K=Ym(),se=X(K);cr(se,{get xValues(){return r(F)},get yValues(){return r(M)},get markerSize(){return r(Y)},plotType:"p",get showLabels(){return e.params.showLabels},get labels(){return r(A)},shortenLabels:!1});var le=z(se,2);{var ve=Se=>{{let ct=g(()=>[r(f)]),Pe=g(()=>[r(u)]),Be=g(()=>[r(d)]),Re=g(()=>[r(v)]);Nn(Se,{get left(){return r(ct)},get top(){return r(Pe)},get width(){return r(Be)},get height(){return r(Re)},faceColor:"#ff000040"})}};q(le,Se=>{r(f)&&r(u)&&r(l)&&Se(ve)})}var oe=z(le,2);{var fe=Se=>{cr(Se,{get xValues(){return r(Z)},get yValues(){return r(I)},get markerSize(){return r(Y)},mainColor:"red",plotType:"p",shortenLabels:!1})};q(oe,Se=>{r(Z)&&r(I)&&Se(fe)})}E(pe,K)},$$slots:{default:!0}}),E(he,we)};q(ue,he=>{r(F)&&r(M)&&he(Ee)})}E(n,ee),ge()}var Um=U("<!> <!> <!> <!> <!>",1);function Hm(n,e){me(e,!0);let t=g(()=>e.props?e.props.scalars:null);const l=[-99999,-2,-1,0,.2,.5,.8,1.2,1.5,1.8,2,2.5,3,99999],s=["#6200DF","#6923FF","#648FFF","#8CCDFD","#D2ECFF","#E8F5FF","#fefeff","#FFF5E5","#FFE5BE","#FFCE85","#FFA34E","#FF8024","#CF5903"],a=l.map(w=>w.toFixed(1));a[0]="&minus;&infin;",a[a.length-1]="&infin;";const o=g(()=>r(t)?r(t).nrows/8:1),c=g(()=>r(t)?[.45,r(t).ncols+.6]:[0,1]),f=g(()=>r(t)?[.45,r(t).nrows+Math.max(.9,r(o))]:[0,1]),u="PV-scalars",d="Segments, k",v="Components, A";var h=de(),m=X(h);{var p=w=>{Bs(w,{get limX(){return r(c)},get limY(){return r(f)},title:u,fileName:"plot-pvscalars",children:(b,_)=>{var S=Um(),y=X(S);uv(y,{get values(){return r(t)},get breaks(){return l},get colmap(){return s}});var A=z(y,2);pi(A,{get breaks(){return l},get colmap(){return s},get labels(){return a}});var L=z(A,2);qs(L,{label:v,whole:!0});var k=z(L,2);Ys(k,{label:d,whole:!0});var C=z(k,2);Ds(C,{}),E(b,S)},$$slots:{default:!0}})};q(m,w=>{r(t)&&w(p)})}E(n,h),ge()}function Pi(n){const e=Object.keys(n),t=e.length>1?[...e,"both"]:e,l=e.length>1?"both":e[0];return{resID:{el:Oe,hidden:e.length==1,default:l,label:"Show",props:{options:t}},varSet:{el:Oe,hidden:!1,default:"X",label:"Variance for",props:{options:["X","Y"]}},varType:{el:Oe,hidden:!1,default:"explained",label:"Type",props:{options:["explained","residual"]}},varForm:{el:Oe,hidden:!1,default:"cumulative",label:"Form",props:{options:["individual","cumulative"]}},showLabels:{el:Xt,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function Li(n,e){const t=Object.keys(n),l=t.length>1?[...t,"both"]:t,s=["rmse","r2","slope"],a=t.length>1?"both":t[0];return{resID:{el:Oe,hidden:t.length==1,default:a,label:"Show",props:{options:l}},fom:{el:Oe,hidden:!1,default:"rmse",label:"FoM",props:{options:s}},resp:{el:Bt,hidden:e<2,default:1,label:"Response",props:{min:1,max:e}},showLabels:{el:Xt,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function ea(n,e){const t=Object.keys(n),l=t.length>1?[...t,"both"]:t,s=n[t[0]],a=t.length>1?"both":t[0];return{resID:{el:Oe,hidden:t.length==1,default:a,label:"Show",props:{options:l}},resp:{el:Bt,hidden:e<2,default:1,label:"Response",props:{min:1,max:e}},showStat:{el:Xt,hidden:s.Yref===null,default:!1,label:"FoM",props:{options:["hide","show"]}},showLabels:{el:Oe,hidden:!1,default:"hide",label:"Labels",props:{options:["hide","labels","values"]}}}}function Ni(n,e){const t=Object.keys(n);return{resID:{el:Oe,hidden:t.length==1,default:t[0],label:"Show",props:{options:t}},resp:{el:Bt,hidden:e<2,default:1,label:"Response",props:{min:1,max:e}},plotType:{el:Ls,hidden:!1,default:"p",label:"Plot type",props:{options:["p","qq","h"]}},showLabels:{el:Oe,hidden:!1,default:"hide",label:"Labels",props:{options:["hide","show"]}}}}function ta(n){const e=Object.keys(n),t=e.length>1?[...e,"both"]:e,l=n[e[0]],s=l.Yref?["X","Y","XY"]:["X"],a=e.length>1?"both":e[0];return{resID:{el:Oe,hidden:e.length===1,default:a,label:"Show",props:{options:t}},varSet:{el:Oe,hidden:l.Yref===null,default:"X",label:"Scores for",props:{options:s}},comp2:{el:Bt,hidden:!1,default:l.ncomp>1?2:1,label:"LV (y-axis)",props:{min:1,max:l.ncomp}},comp1:{el:Bt,hidden:!1,default:1,label:"LV (x-axis)",props:{min:1,max:l.ncomp}},showLabels:{el:Xt,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function Xm(n,e){return{statType:{el:Oe,hidden:!1,default:"xloadings",label:"Show",props:{options:["xloadings","weights"]}},plotType:{el:Ls,hidden:!1,default:"p",label:"Plot type",props:{options:["p","l","h"]}},comp2:{el:Bt,hidden:!1,default:n.ncomp>1?2:1,label:"LV (y-axis)",props:{min:1,max:n.ncomp}},comp1:{el:Bt,hidden:!1,default:1,label:"LV (x-axis)",props:{min:1,max:n.ncomp}},showLabels:{el:Xt,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function ra(n){const e=Object.keys(n),t=e.length>1?[...e,"both"]:e,l=n[e[0]],s=e.length>1?"both":e[0],a=l.Yref?["h/q","f/z"]:["h/q"];return{resID:{el:Oe,hidden:e.length==1,default:s,label:"Show",props:{options:t}},distType:{el:Oe,hidden:l.Yref===null,default:"h/q",label:"Show",props:{options:a}},transType:{el:Oe,hidden:!1,default:"no",label:"Transform",props:{options:["no","log"]}},limType:{el:Oe,hidden:!1,default:"classic",label:"Limits",props:{options:["classic","robust"]}},showLabels:{el:Xt,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function Gm(n){return{plotType:{el:Ls,hidden:!1,default:"l",label:"Plot type",props:{options:["l","h"]}},resp:{el:Bt,hidden:n<2,default:1,label:"Response",props:{min:1,max:n}},showLabels:{el:Xt,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function Km(n){return{yset:{el:Oe,hidden:!1,default:"vip",label:"Y-axis",props:{options:["vip","selratio"]}},xset:{el:Oe,hidden:!1,default:"values",label:"X-axis",props:{options:["values","indices","vip"]}},resp:{el:Bt,hidden:n<2,default:1,label:"Response",props:{min:1,max:n}},showLabels:{el:Xt,hidden:!1,default:!1,label:"Labels",props:{options:["hide","show"]}}}}function Jm(){return{}}var Qm=U("<!> <!>",1),Zm=U("<p>can not exclude</p>");function $m(n,e){me(e,!0);const t=(v,h=xt)=>{ie(v,{label:"Selected",children:(m,p)=>{var w=Qm(),b=X(w);et(b,{onclick:()=>e.showContributions(h()),text:"plot"});var _=z(b,2);{var S=y=>{et(y,{onclick:()=>e.markOutlier(h()),text:"remove"})};q(_,y=>{h()>=0&&y(S)})}E(m,w)},$$slots:{default:!0}})},l=(v,h=xt)=>{ie(v,{label:"Selected",children:(m,p)=>{var w=de(),b=X(w);{var _=y=>{et(y,{onclick:()=>e.excludeVars(h()),get text(){return`exclude ${h().length??""} variables`}})},S=y=>{var A=Zm();E(y,A)};q(b,y=>{e.res.cal.npred-h().length>=2?y(_):y(S,!1)})}E(m,w)},$$slots:{default:!0}})},s=Object.keys(e.res),a=e.res[s[0]].nresp,o=g(()=>({pred:{label:"Predictions",scope:"objects",component:Qs,buttons:t},scores:{label:"Scores",scope:"objects",component:Zs,buttons:t},distance:{label:"Distances",scope:"objects",component:$s,buttons:t},yresiduals:{label:"Residuals",scope:"stats",component:Ti},loadings:{label:"X-loadings and weights",scope:"stats",component:Vm},regcoeffs:{label:"Regression coefficients",scope:"stats",component:qm},varsel:{label:"Variable importance",scope:"variables",component:Wm,buttons:l},fom:{label:"Figures of merit",scope:"stats",component:Ci},variance:{label:"Variance",scope:"stats",component:Ai},scalars:{label:"PV scalars",scope:"stats",component:Hm}})),c=Te({pred:ea(e.res,a),scores:ta(e.res),distance:ra(e.res),yresiduals:Ni(e.res,a),loadings:Xm(e.model,e.ncomp),regcoeffs:Gm(a),varsel:Km(a),fom:Li(e.res,a),variance:Pi(e.res),scalars:Jm(e.res)});let f=re(Te({pred:bt(c.pred),scores:bt(c.scores),distance:bt(c.distance),yresiduals:bt(c.yresiduals),loadings:bt(c.loadings),regcoeffs:bt(c.regcoeffs),varsel:bt(c.varsel),fom:bt(c.fom),variance:bt(c.variance),scalars:bt(c.scalars)}));_e(()=>{r(f).scores.varSet==="XY"?(c.scores.comp1.hidden=!0,c.scores.comp2.label="LV"):(c.scores.comp2.label="LV (y-axis)",c.scores.comp1.hidden=!1)}),_e(()=>{r(f).loadings.plotType!=="p"?c.loadings.comp1.hidden=!0:c.loadings.comp1.hidden=!1}),_e(()=>{r(f).pred.resID==="both"?c.pred.showStat.hidden=!0:c.pred.showStat.hidden=!1}),_e(()=>{r(f).yresiduals.plotType==="h"?c.yresiduals.showLabels.hidden=!0:c.yresiduals.showLabels.hidden=!1});const u=g(()=>({res:e.res,model:e.model,data:e.data,ncomp:e.ncomp,scalars:e.scalars})),d={markOutlier:e.markOutlier};Js(n,{get plots(){return r(o)},get props(){return r(u)},get controls(){return c},get callbacks(){return d},get params(){return r(f)},set params(v){j(f,v,!0)}}),ge()}var eg=U('<div class="outliers-pane svelte-b7gdku"><!></div>'),tg=U('<div class="exclvars-pane svelte-b7gdku"><!></div>'),rg=U('<div class="model-calculator svelte-b7gdku"><!></div>'),ng=U('<div class="pcv-calculator svelte-b7gdku"><!></div>'),lg=U('<div class="buttons"><!> <!> <!></div>'),sg=U('<div class="ncomp-selector svelte-b7gdku"><!> <!></div> <div class="result-stats svelte-b7gdku"><!></div>',1),ag=U(`<p class="svelte-b7gdku">This tab lets you train a PLS regression model and optimize it using Procrustes cross-validation.
               After that you can save the model to a file, apply it to a test set (tab <strong>Test</strong>)
               or to a new set of samples whose response us unknown (tab <strong>Predict</strong>).</p> <p class="svelte-b7gdku"><strong>Step 1.</strong></p> <p class="svelte-b7gdku">Load your training/calibration set from a CSV file. The file should contain data as numeric values delimited
               by comma (with dot as decimal separator) or by semicolon (with comma as decimal separator). Rows
               correspond to observations or objects, columns — to variables (both response and predictors).</p> <p class="svelte-b7gdku">First row in the CSV file can contain variable labels or values (<strong>header</strong>). It is assumed
               that variable lables are text (or have text parts), e.g. <em>"Na"</em>, <em>"OD260"</em>, etc. If x-variables
               are signals, e.g. spectra, this part of header can content numeric values, e.g. wavelength or wavenumbers.
               If this is the case, select <em>values</em> option for the header. This will let you to specify
               name of the values (e.g. <em>Wavelength</em>) and the units (e.g. <em>nm</em>) if necessary.</p> <p class="svelte-b7gdku">First column in the file can contain labels for the objects/observations (<strong>row labels</strong>) — if so, just set
               the corresponding options after selecting the file.</p> <p class="svelte-b7gdku">The response variable (<em>Y</em>) should be located right after the column with object/row labels. If there are no
               object labels, the response variable is expected to be in the first column. <strong>Response variable is mandatory
               in the training set and in this version of app only single response is supported (PLS1).</strong></p> <p class="svelte-b7gdku">Here is an example how data structure may look like (note, that row labels and header are optional):</p> <div class="svelte-b7gdku"><table class="svelte-b7gdku"><thead class="svelte-b7gdku"><tr class="svelte-b7gdku"><td class="svelte-b7gdku">Name</td><td class="svelte-b7gdku">y</td><td class="svelte-b7gdku">x1</td><td class="svelte-b7gdku">x2</td><td class="svelte-b7gdku">x3</td></tr></thead><tbody class="svelte-b7gdku"><tr><td class="svelte-b7gdku">O1</td><td class="svelte-b7gdku">96.1</td><td class="svelte-b7gdku">3.8</td><td class="svelte-b7gdku">1.3</td><td class="svelte-b7gdku">13.6</td></tr><tr><td class="svelte-b7gdku">O2</td><td class="svelte-b7gdku">88.9</td><td class="svelte-b7gdku">11.1</td><td class="svelte-b7gdku">12.3</td><td class="svelte-b7gdku">3.3</td></tr><tr><td class="svelte-b7gdku">O3</td><td class="svelte-b7gdku">56.1</td><td class="svelte-b7gdku">1.2</td><td class="svelte-b7gdku">2.3</td><td class="svelte-b7gdku">4.2</td></tr></tbody></table></div> <p class="svelte-b7gdku"></p>`,1),og=U(`<p class="svelte-b7gdku"><strong>Step 2</strong></p> <p class="svelte-b7gdku">Next step is to decide how to preprocess the data. You can either skip preprocessing (in the model settings you
               will be able to apply centering and scaling), create the chain of preprocessing methods in special constructor
               (use <em>Create</em> to load the constructor) or load already built preprocessing model from a file. Make your choice.</p>`,1),ig=U(`<p class="svelte-b7gdku"><strong>Step 3</strong></p> <p class="svelte-b7gdku">Now you can create a global PLS model for the training set. Use more components/latent variables (LVs) than
               you expect to be optimal. You will have possibility to select the optimal number of components later.</p>`,1),cg=U(`<p class="svelte-b7gdku"><strong>Step 4</strong></p> <p class="svelte-b7gdku">Now set necessary parameters for Procrustes cross-validation and click button to compute the PV-set,
               which will help you to optimize PLS model parameters. The parameters are the same as for conventional
               cross-validation: type of splits and number of segments. It is recommended to use fewer number of
               segments (e.g. 3, 4 or 5).</p> <p class="svelte-b7gdku">After this step PLS model will be created automatically and you will be able to explore it and tune
               its parameters.</p>`,1),ug=U("<!> <!> <!>",1),fg=U('<div class="help-text svelte-b7gdku"><!></div>'),dg=U('<div class="app-container svelte-b7gdku"><!> <div class="app-controls svelte-b7gdku"><div class="data-loader svelte-b7gdku"><!></div> <!> <!> <!> <!> <!> <!></div> <div class="app-content svelte-b7gdku"><!></div></div>');function vg(n,e){me(e,!0);const t=g(()=>e.session.train);let l=re(-1),s=re(!1);function a(I){if(I.length<1)return;const H=I.map(J=>r(t).model.varindices[J+r(t).model.nresp]);if(H.length>0){const J=new Set(r(t).exclvars),$=[...new Set(H)].filter(ae=>!J.has(ae));r(t).exclvars=r(t).exclvars.concat($),r(t).model=null,r(t).pvres=null,r(t).calres=null,r(t).pvset=null,r(t).ncomp_selected=1}}function o(){r(t).exclvars=[],r(t).model=null,r(t).pvres=null,r(t).calres=null,r(t).pvset=null,r(t).ncomp_selected=1}function c(I){if(I<0||I>r(t).calres.nrows-1)return;const H=r(t).calres.objindices[I];H>=0&&!r(t).outliers.includes(H)&&(r(t).outliers.push(H),r(t).model=null,r(t).pvres=null,r(t).calres=null,r(t).calsetp=null,r(t).prepmodel=null,r(t).pvset=null,r(t).ncomp_selected=1)}function f(){r(t).outliers=[],r(t).model=null,r(t).pvres=null,r(t).calres=null,r(t).calsetp=null,r(t).prepmodel=null,r(t).pvset=null,r(t).ncomp_selected=1}function u(){r(t).outliers.pop(),r(t).model=null,r(t).pvres=null,r(t).calres=null,r(t).calsetp=null,r(t).prepmodel=null,r(t).pvset=null,r(t).ncomp_selected=1}function d(I,H){I<0||(j(l,I,!0),j(s,!0))}function v(){j(s,!1),j(l,-1)}_e(()=>{r(t).calset===null&&(r(t).pvres=null,r(t).calres=null,r(t).pvset=null,r(t).calsetp=null,r(t).prepmodel=null,r(t).prepobj=[],r(t).prepType=null,r(t).outliers=[],r(t).exclvars=[],r(t).ncomp_selected=1,r(t).model=null)}),_e(()=>{r(t).model===null&&(r(t).calres=null,r(t).pvres=null,r(t).pvset=null)}),_e(()=>{r(t).prepmodel||(r(t).calres=null,r(t).calsetp=null,r(t).exclvars=[])}),_e(()=>{r(t).calsetp||(r(t).model=null,r(t).calres=null,r(t).pvres=null)}),_e(()=>{if(r(t).model&&r(t).model.ncomp&&r(t).pvres&&r(t).pvres.stat){const I=r(t).pvres.stat.rmse.getcolref(1),J=I.map(($,ae)=>ae>0?1-$*$/I[ae-1]**2:1).findIndex($=>$<=.0975);r(t).ncomp_selected=J<0?r(t).model.ncomp:J}}),_e(()=>{const I=pr(()=>JSON.stringify(e.session,Kn));e.backupSession(I,r(t).model,r(t).calset,r(t).calsetp,r(t).pvres)});var h=dg(),m=W(h);{var p=I=>{{let H=g(()=>({cal:r(t).calres,pv:r(t).pvres}));Hs(I,{get model_getter(){return zt},get res_getter(){return Et},get model(){return r(t).model},get res(){return r(H)},get ncomp(){return r(t).ncomp_selected},get selected(){return r(l)},closeModal:v})}};q(m,I=>{r(s)&&I(p)})}var w=z(m,2),b=W(w),_=W(b);Ks(_,{respMandatory:!0,get dataset(){return r(t).calset},set dataset(I){r(t).calset=I}});var S=z(b,2);{var y=I=>{var H=eg(),J=W(H);Ns(J,{get outliers(){return r(t).outliers},get dataset(){return r(t).calset},resetOutliers:f,undoOutliers:u}),E(I,H)};q(S,I=>{r(t).outliers&&r(t).outliers.length>0&&I(y)})}var A=z(S,2);{var L=I=>{Ah(I,{get WASM(){return e.WASM},get rawdata(){return r(t).calset},get outliers(){return r(t).outliers},get prepType(){return r(t).prepType},set prepType(H){r(t).prepType=H},get prepobj(){return r(t).prepobj},set prepobj(H){r(t).prepobj=H},get prepdata(){return r(t).calsetp},set prepdata(H){r(t).calsetp=H},get prepmeta(){return r(t).prepmeta},set prepmeta(H){r(t).prepmeta=H},get prepmodel(){return r(t).prepmodel},set prepmodel(H){r(t).prepmodel=H}})};q(A,I=>{r(t).calset&&I(L)})}var k=z(A,2);{var C=I=>{var H=tg(),J=W(H);jf(J,{get exclvars(){return r(t).exclvars},get dataset(){return r(t).calset},resetExclvars:o}),E(I,H)};q(k,I=>{r(t).exclvars&&r(t).exclvars.length>0&&I(C)})}var N=z(k,2);{var F=I=>{var H=rg(),J=W(H);Oh(J,{get WASM(){return e.WASM},get dataset(){return r(t).calsetp},get outliers(){return r(t).outliers},get exclvars(){return r(t).exclvars},get model(){return r(t).model},set model($){r(t).model=$},get resobj(){return r(t).calres},set resobj($){r(t).calres=$}}),E(I,H)};q(N,I=>{r(t).calsetp&&I(F)})}var M=z(N,2);{var T=I=>{var H=ng(),J=W(H);Hh(J,{get WASM(){return e.WASM},get calset(){return r(t).calsetp},get outliers(){return r(t).outliers},get model(){return r(t).model},get calres(){return r(t).calres},get pvset(){return r(t).pvset},set pvset($){r(t).pvset=$},get pvres(){return r(t).pvres},set pvres($){r(t).pvres=$},get pvscalars(){return r(t).pvscalars},set pvscalars($){r(t).pvscalars=$}}),E(I,H)};q(M,I=>{r(t).calsetp&&r(t).model&&I(T)})}var R=z(M,2);{var D=I=>{var H=sg(),J=X(H),$=W(J);ie($,{name:"ncomp",label:"# of LVs",children:(ue,Ee)=>{un(ue,{min:1,get max(){return r(t).model.ncomp},step:1,decNum:0,get value(){return r(t).ncomp_selected},set value(he){r(t).ncomp_selected=he}})},$$slots:{default:!0}});var ae=z($,2);ie(ae,{label:"Download",children:(ue,Ee)=>{var he=lg(),we=W(he);et(we,{onclick:()=>Nl(r(t).calres,r(t).calset,"train",r(t).ncomp_selected),text:"Res (cal)"});var ye=z(we,2);et(ye,{onclick:()=>Nl(r(t).pvres,r(t).pvset,"PV",r(t).ncomp_selected),text:"Res (pv)"});var pe=z(ye,2);et(pe,{onclick:()=>Qo(r(t).model,r(t).ncomp_selected,r(t).prepmodel),text:"Model"}),E(ue,he)},$$slots:{default:!0}});var Q=z(J,2),ee=W(Q);{let ue=g(()=>({cal:r(t).calres,pv:r(t).pvres}));Ei(ee,{get res(){return r(ue)},get ncomp(){return r(t).ncomp_selected}})}E(I,H)};q(R,I=>{r(t).model&&r(t).model.ncomp&&r(t).calres&&r(t).pvres&&I(D)})}var V=z(w,2),P=W(V);{var Y=I=>{var H=fg(),J=W(H);{var $=Q=>{var ee=ag();E(Q,ee)},ae=Q=>{var ee=ug(),ue=X(ee);{var Ee=ce=>{var K=og();E(ce,K)};q(ue,ce=>{r(t).calset&&!r(t).prepmodel&&ce(Ee)})}var he=z(ue,2);{var we=ce=>{var K=ig();E(ce,K)};q(he,ce=>{r(t).prepmodel&&!r(t).model&&ce(we)})}var ye=z(he,2);{var pe=ce=>{var K=cg();E(ce,K)};q(ye,ce=>{r(t).model&&!r(t).pvset&&ce(pe)})}E(Q,ee)};q(J,Q=>{r(t).calset?Q(ae,!1):Q($)})}E(I,H)},Z=I=>{var H=de(),J=X(H);Ln(J,()=>r(t).pvres&&r(t).model,$=>{var ae=de(),Q=X(ae);{var ee=ue=>{{let Ee=g(()=>({cal:r(t).calset,pv:r(t).pvset})),he=g(()=>({cal:r(t).calres,pv:r(t).pvres}));$m(ue,{markOutlier:c,showContributions:d,excludeVars:a,get data(){return r(Ee)},get res(){return r(he)},get scalars(){return r(t).pvscalars},get model(){return r(t).model},get ncomp(){return r(t).ncomp_selected}})}};q(Q,ue=>{r(t).calres&&r(t).pvres&&r(t).model&&r(t).calset&&r(t).pvset&&ue(ee)})}E($,ae)}),E(I,H)};q(P,I=>{!r(t).calres||!r(t).pvres||!r(t).model?I(Y):I(Z,!1)})}E(n,h),ge()}var hg=U("<!> <!>",1),mg=U('<br/><span style="color:#a0a0a0;">Optimal LVs:</span> <span style="color:#a0a0a0;"> </span>',1),gg=U('<br/><span style="color:#a0a0a0;">Preprocessing:</span> <!>',1),pg=U('<br/><span style="color:#a0a0a0;">Excluded</span> <span style="color:#a0a0a0;">variables.</span>',1),bg=U('<p class="info-text svelte-3v2vv7"><span>Model file:</span> <span class="file-name svelte-3v2vv7"> </span><br/> <span style="color:#a0a0a0;">Model info:</span> <!> <!> <!></p> <!>',1),_g=U("<p><!></p>"),wg=U("<!> <!>",1);function zi(n,e){me(e,!0);let t=B(e,"model",15),l=re(""),s=re("neutral"),a=re("");function o(b){try{const _=JSON.parse(b,Cs);if(Array.isArray(_.v)&&(_.v=Float64Array.from(_.v)),_.class[0]!=="plsmodel")throw Error("The JSON file you selected does not contain PLS model.");_.fileName=r(u),t(_),j(s,"success"),j(a,"")}catch(_){console.error(_),t(null),j(s,"error"),j(a,_,!0)}}function c(b){const _=new FileReader;_.onload=()=>{o(_.result)},_.readAsText(r(l))}function f(){j(l,""),t(null),j(s,"neutral"),j(a,"")}_e(()=>{r(l)===null?(t(null),j(s,"neutral"),j(a,"")):(j(s,"neutral"),j(a,""))});let u=g(()=>r(l)?r(l).name.replace(/\.[^/.]+$/,""):"");var d=wg(),v=X(d);{var h=b=>{var _=hg(),S=X(_);Ln(S,()=>r(l),L=>{ie(L,{name:"file-selector",children:(k,C)=>{Ll(k,{id:"modelFile",acceptType:".json",message:"Select file with model",get file(){return r(l)},set file(N){j(l,N,!0)}})},$$slots:{default:!0}})});var y=z(S,2);{var A=L=>{ie(L,{name:"load-button",label:" ",children:(k,C)=>{et(k,{onclick:c,text:"Load"})},$$slots:{default:!0}})};q(y,L=>{r(l)&&L(A)})}E(b,_)},m=b=>{ie(b,{name:"info",class:"info",children:(_,S)=>{var y=bg(),A=X(y),L=z(W(A),2),k=W(L),C=z(L,4),N=z(C);{var F=P=>{var Y=mg(),Z=z(X(Y),3),I=W(Z);ne(()=>xe(I,t().ncomp_selected)),E(P,Y)};q(N,P=>{t().ncomp_selected&&P(F)})}var M=z(N,2);{var T=P=>{var Y=gg(),Z=z(X(Y),3);Gs(Z,{get prepmodel(){return t().prep}}),E(P,Y)};q(M,P=>{t().prep&&P(T)})}var R=z(M,2);{var D=P=>{var Y=pg(),Z=z(X(Y),2);ne(()=>xe(Z,` ${t().exclvars.length??""} `)),E(P,Y)};q(R,P=>{t().exclvars.length>0&&P(D)})}var V=z(A,2);or(V,{onclick:f}),ne(()=>{O(L,"title",t().fileName),xe(k,t().fileName),xe(C,` ${t().ncomp??""} LVs${t().center?", centered":""}${t().scale?", scaled":""} `)}),E(_,y)},$$slots:{default:!0}})};q(v,b=>{t()?b(m,!1):b(h)})}var p=z(v,2);{var w=b=>{ie(b,{name:"error",status:"error",children:(_,S)=>{var y=_g(),A=W(y);kt(A,()=>r(a)),E(_,y)},$$slots:{default:!0}})};q(p,b=>{(r(s)==="error"||r(a))&&b(w)})}E(n,d),ge()}var yg=U("<!> <!>",1);function xg(n,e){me(e,!0);const t=(d,v=xt)=>{ie(d,{label:"Selected",children:(h,m)=>{var p=yg(),w=X(p);et(w,{onclick:()=>e.showContributions(v()),text:"plot"});var b=z(w,2);et(b,{onclick:()=>e.markOutlier(v()),text:"remove"}),E(h,p)},$$slots:{default:!0}})},l=Object.keys(e.res),s=e.res[l[0]].nresp,a=g(()=>({pred:{label:"Predictions",scope:"objects",component:Qs,buttons:t},scores:{label:"Scores",scope:"objects",component:Zs,buttons:t},distance:{label:"Distances",scope:"objects",component:$s,buttons:t},yresiduals:{label:"Residuals",scope:"stats",component:Ti},fom:{label:"Figures of merit",scope:"stats",component:Ci},variance:{label:"Variance",scope:"stats",component:Ai}})),o=Te({pred:ea(e.res,s),scores:ta(e.res),distance:ra(e.res),yresiduals:Ni(e.res,s),fom:Li(e.res,s),variance:Pi(e.res)});let c=re(Te({pred:bt(o.pred),scores:bt(o.scores),distance:bt(o.distance),yresiduals:bt(o.yresiduals),fom:bt(o.fom),variance:bt(o.variance)}));_e(()=>{r(c).scores.varSet==="XY"?(o.scores.comp1.hidden=!0,o.scores.comp2.label="LV"):(o.scores.comp2.label="LV (y-axis)",o.scores.comp1.hidden=!1)}),_e(()=>{r(c).pred.resID==="both"?o.pred.showStat.hidden=!0:o.pred.showStat.hidden=!1}),_e(()=>{r(c).yresiduals.plotType==="h"?o.yresiduals.showLabels.hidden=!0:o.yresiduals.showLabels.hidden=!1});const f=g(()=>({res:e.res,model:e.model,data:e.data,ncomp:e.ncomp,scalars:e.scalars})),u={markOutlier:e.markOutlier};Js(n,{get plots(){return r(a)},get controls(){return o},get props(){return r(f)},get callbacks(){return u},get params(){return r(c)},set params(d){j(c,d,!0)}}),ge()}var kg=U('<div class="outliers-pane svelte-b7gdku"><!></div>'),Eg=U('<div class="buttons"><!> <!></div>'),Sg=U('<div class="ncomp-selector svelte-b7gdku"><!> <!></div> <div class="result-stats svelte-b7gdku"><!></div>',1),Ag=U('<div class="data-loader svelte-b7gdku"><!></div> <!> <!>',1),Cg=U(`<p class="svelte-b7gdku">In this tab you can test a PLS regression model developed in <strong>Train</strong> tab by
               applying it to a test set, which contains both predictors and responses.</p> <p class="svelte-b7gdku"><strong>Step 1.</strong></p> <p class="svelte-b7gdku">Load the previously developed PLS model from a JSON file.</p>`,1),Tg=U(`<p class="svelte-b7gdku"><strong>Step 2.</strong></p> <p class="svelte-b7gdku">Load your test set from a CSV file. The file structure should be the same as the training/calibration set.
               The response variable is mandatory. Here is an example how data structure may look like (note, that row labels
               and header are optional):</p> <div class="svelte-b7gdku"><table class="svelte-b7gdku"><thead class="svelte-b7gdku"><tr class="svelte-b7gdku"><td class="svelte-b7gdku">Name</td><td class="svelte-b7gdku">y</td><td class="svelte-b7gdku">x1</td><td class="svelte-b7gdku">x2</td><td class="svelte-b7gdku">x3</td></tr></thead><tbody class="svelte-b7gdku"><tr><td class="svelte-b7gdku">O1</td><td class="svelte-b7gdku">96.1</td><td class="svelte-b7gdku">3.8</td><td class="svelte-b7gdku">1.3</td><td class="svelte-b7gdku">13.6</td></tr><tr><td class="svelte-b7gdku">O2</td><td class="svelte-b7gdku">88.9</td><td class="svelte-b7gdku">11.1</td><td class="svelte-b7gdku">12.3</td><td class="svelte-b7gdku">3.3</td></tr><tr><td class="svelte-b7gdku">O3</td><td class="svelte-b7gdku">56.1</td><td class="svelte-b7gdku">1.2</td><td class="svelte-b7gdku">2.3</td><td class="svelte-b7gdku">4.2</td></tr></tbody></table></div> <p class="svelte-b7gdku"></p>`,1),Pg=U('<div class="help-text svelte-b7gdku"><!></div>'),Lg=U('<div class="app-container svelte-b7gdku"><!> <div class="app-controls svelte-b7gdku"><div class="model-loader svelte-b7gdku"><!></div> <!></div> <div class="app-content svelte-b7gdku"><!></div></div>');function Ng(n,e){me(e,!0);const t=g(()=>e.session.test);let l=re(-1),s=re(!1);function a(k){if(k<0||k>r(t).testres.nrows-1)return;const C=r(t).testres.objindices[k];C>=0&&!r(t).outliers.includes(C)&&(r(t).outliers.push(C),r(t).testres=null)}function o(){r(t).outliers=[],r(t).testres=null}function c(){r(t).outliers.pop(),r(t).testres=null}function f(k){k<0||(j(l,k,!0),j(s,!0))}function u(){j(s,!1),j(l,-1)}_e(()=>{r(t).testset===null&&(r(t).outliers=[],r(t).testres=null),r(t).model===null&&(r(t).testres=null,r(t).testset=null)}),_e(()=>{r(t).model&&(r(t).ncomp_selected=r(t).model.ncomp_selected)}),_e(()=>{const k=pr(()=>JSON.stringify(e.session,Kn));e.backupSession(k,r(t).model,r(t).testres)});var d=Lg(),v=W(d);{var h=k=>{{let C=g(()=>({test:r(t).testres}));Hs(k,{get model_getter(){return zt},get res_getter(){return Et},get model(){return r(t).model},get res(){return r(C)},get ncomp(){return r(t).ncomp_selected},get selected(){return r(l)},closeModal:u})}};q(v,k=>{r(s)&&k(h)})}var m=z(v,2),p=W(m),w=W(p);zi(w,{get model(){return r(t).model},set model(k){r(t).model=k}});var b=z(p,2);{var _=k=>{var C=Ag(),N=X(C),F=W(N);Ks(F,{get WASM(){return e.WASM},get outliers(){return r(t).outliers},get model(){return r(t).model},respMandatory:!0,get dataset(){return r(t).testset},set dataset(V){r(t).testset=V},get resobj(){return r(t).testres},set resobj(V){r(t).testres=V}});var M=z(N,2);{var T=V=>{var P=kg(),Y=W(P);Ns(Y,{get outliers(){return r(t).outliers},get dataset(){return r(t).testset},resetOutliers:o,undoOutliers:c}),E(V,P)};q(M,V=>{r(t).outliers&&r(t).outliers.length>0&&V(T)})}var R=z(M,2);{var D=V=>{var P=Sg(),Y=X(P),Z=W(Y);ie(Z,{name:"ncomp",label:"# of LVs",children:($,ae)=>{un($,{min:1,get max(){return r(t).model.ncomp},step:1,decNum:0,get value(){return r(t).ncomp_selected},set value(Q){r(t).ncomp_selected=Q}})},$$slots:{default:!0}});var I=z(Z,2);ie(I,{label:"Download",children:($,ae)=>{var Q=Eg(),ee=W(Q);et(ee,{onclick:()=>Nl(r(t).testres,r(t).testset,"test",r(t).ncomp_selected),text:"Res (test)"});var ue=z(ee,2);et(ue,{onclick:()=>Qo(r(t).model,r(t).ncomp_selected),text:"Model"}),E($,Q)},$$slots:{default:!0}});var H=z(Y,2),J=W(H);{let $=g(()=>({test:r(t).testres}));Ei(J,{get res(){return r($)},get ncomp(){return r(t).ncomp_selected}})}E(V,P)};q(R,V=>{r(t).model&&r(t).testres&&V(D)})}E(k,C)};q(b,k=>{r(t).model&&k(_)})}var S=z(m,2),y=W(S);{var A=k=>{var C=Pg(),N=W(C);{var F=T=>{var R=Cg();E(T,R)},M=T=>{var R=de(),D=X(R);{var V=P=>{var Y=Tg();E(P,Y)};q(D,P=>{r(t).testset||P(V)},!0)}E(T,R)};q(N,T=>{r(t).model?T(M,!1):T(F)})}E(k,C)},L=k=>{var C=de(),N=X(C);Ln(N,()=>r(t).testres&&r(t).model,F=>{var M=de(),T=X(M);{var R=D=>{{let V=g(()=>({test:r(t).testset})),P=g(()=>({test:r(t).testres}));xg(D,{markOutlier:a,showContributions:f,get data(){return r(V)},get res(){return r(P)},get model(){return r(t).model},get ncomp(){return r(t).ncomp_selected}})}};q(T,D=>{r(t).testres&&r(t).model&&D(R)})}E(F,M)}),E(k,C)};q(y,k=>{r(t).testres?k(L,!1):k(A)})}E(n,d),ge()}var zg=U("<!> <!>",1);function Mg(n,e){me(e,!0);const t=(d,v=xt)=>{ie(d,{label:"Selected",children:(h,m)=>{var p=zg(),w=X(p);et(w,{onclick:()=>e.showContributions(v()),text:"plot"});var b=z(w,2);et(b,{onclick:()=>e.markOutlier(v()),text:"remove"}),E(h,p)},$$slots:{default:!0}})},l=Object.keys(e.res),s=e.res[l[0]].nresp,a=g(()=>({pred:{label:"Predictions",scope:"objects",component:Qs,buttons:t},scores:{label:"Scores",scope:"objects",component:Zs,buttons:t},distance:{label:"Distances",scope:"objects",component:$s,buttons:t}})),o=Te({pred:ea(e.res,s),scores:ta(e.res),distance:ra(e.res)});let c=re(Te({pred:bt(o.pred),scores:bt(o.scores),distance:bt(o.distance)}));const f=g(()=>({res:e.res,model:e.model,data:e.data,ncomp:e.ncomp,scalars:e.scalars})),u={markOutlier:e.markOutlier};Js(n,{get plots(){return r(a)},get controls(){return o},get props(){return r(f)},get callbacks(){return u},get params(){return r(c)},set params(d){j(c,d,!0)}}),ge()}var Rg=U('<div class="data-loader svelte-1ssp7bh"><!></div>'),Ig=U('<div class="outliers-pane svelte-1ssp7bh"><!></div>'),Fg=U('<div class="buttons"><!></div>'),jg=U('<div class="ncomp-selector svelte-1ssp7bh"><!></div>'),Vg=U(`<p class="svelte-1ssp7bh">In this tab you can apply a PLS regression model developed in <strong>Train</strong> tab to
               new set of measurements without known response variable.</p> <p class="svelte-1ssp7bh"><strong>Step 1.</strong></p> <p class="svelte-1ssp7bh">Load the previously developed PLS model from a JSON file.</p>`,1),Og=U(`<p class="svelte-1ssp7bh"><strong>Step 2.</strong></p> <p class="svelte-1ssp7bh">Load your test set. In this case, because dataset should not contain the response variable you
            can load it either from a CSV file or from SPC files.</p> <p class="svelte-1ssp7bh">If you load data from a <strong>CSV file</strong>, the file structure should be the same as the training/calibration set but <strong>without the response values</strong> (only predictors). Here is an example how data structure may look like
               (note, that row labels and header are optional):</p> <div class="svelte-1ssp7bh"><table class="svelte-1ssp7bh"><thead class="svelte-1ssp7bh"><tr class="svelte-1ssp7bh"><td class="svelte-1ssp7bh">Name</td><td class="svelte-1ssp7bh">x1</td><td class="svelte-1ssp7bh">x2</td><td class="svelte-1ssp7bh">x3</td></tr></thead><tbody><tr><td class="svelte-1ssp7bh">O1</td><td class="svelte-1ssp7bh">3.8</td><td class="svelte-1ssp7bh">1.3</td><td class="svelte-1ssp7bh">13.6</td></tr><tr><td class="svelte-1ssp7bh">O2</td><td class="svelte-1ssp7bh">11.1</td><td class="svelte-1ssp7bh">12.3</td><td class="svelte-1ssp7bh">3.3</td></tr><tr><td class="svelte-1ssp7bh">O3</td><td class="svelte-1ssp7bh">1.2</td><td class="svelte-1ssp7bh">2.3</td><td class="svelte-1ssp7bh">4.2</td></tr></tbody></table> <p>If your model uses spectra as predictors, you can also load spectral data directly
                  from Galactic Industries <strong>SPC files</strong>. The app supports both single spectrum in a file and
                  files with multiple spectra, however only 2-way datasets can be loaded. You can select several
                  SPC files to load (hold Ctrl or Shift when selecting), in this case they will be combined together
                  into the same dataset.</p></div> <p class="svelte-1ssp7bh"></p>`,1),Bg=U('<div class="help-text svelte-1ssp7bh"><!></div>'),qg=U('<div class="app-container svelte-1ssp7bh"><!> <div class="app-controls svelte-1ssp7bh"><div class="model-loader svelte-1ssp7bh"><!></div> <!> <!> <!></div> <div class="app-content svelte-1ssp7bh"><!></div></div>');function Yg(n,e){me(e,!0);const t=g(()=>e.session.new);let l=re(-1),s=re(!1);function a(M){if(M<0||M>r(t).newres.nrows-1)return;const T=r(t).newres.objindices[M];T>=0&&!r(t).outliers.includes(T)&&(r(t).outliers.push(T),r(t).newres=null)}function o(){r(t).outliers=[],r(t).newres=null}function c(){r(t).outliers.pop(),r(t).newres=null}function f(M){M<0||(j(l,M,!0),j(s,!0))}function u(){j(s,!1),j(l,-1)}_e(()=>{r(t).newset===null&&(r(t).outliers=[],r(t).newres=null),r(t).model===null&&(r(t).newres=null,r(t).newset=null)}),_e(()=>{r(t).model&&(r(t).ncomp_selected=r(t).model.ncomp_selected)}),_e(()=>{const M=pr(()=>JSON.stringify(e.session,Kn));e.backupSession(M,r(t).model,r(t).newres)});var d=qg(),v=W(d);{var h=M=>{{let T=g(()=>({new:r(t).newres}));Hs(M,{get model_getter(){return zt},get res_getter(){return Et},get model(){return r(t).model},get res(){return r(T)},get ncomp(){return r(t).ncomp_selected},get selected(){return r(l)},closeModal:u})}};q(v,M=>{r(s)&&M(h)})}var m=z(v,2),p=W(m),w=W(p);zi(w,{get model(){return r(t).model},set model(M){r(t).model=M}});var b=z(p,2);{var _=M=>{var T=Rg(),R=W(T);Ks(R,{get WASM(){return e.WASM},get outliers(){return r(t).outliers},get model(){return r(t).model},respMandatory:!1,get dataset(){return r(t).newset},set dataset(D){r(t).newset=D},get resobj(){return r(t).newres},set resobj(D){r(t).newres=D}}),E(M,T)};q(b,M=>{r(t).model&&M(_)})}var S=z(b,2);{var y=M=>{var T=Ig(),R=W(T);Ns(R,{get outliers(){return r(t).outliers},get dataset(){return r(t).newset},resetOutliers:o,undoOutliers:c}),E(M,T)};q(S,M=>{r(t).outliers&&r(t).outliers.length>0&&M(y)})}var A=z(S,2);{var L=M=>{var T=jg(),R=W(T);ie(R,{label:"Download",children:(D,V)=>{var P=Fg(),Y=W(P);et(Y,{onclick:()=>Nl(r(t).newres,r(t).newset,"new",r(t).ncomp_selected),text:"Res (new)"}),E(D,P)},$$slots:{default:!0}}),E(M,T)};q(A,M=>{r(t).newres&&M(L)})}var k=z(m,2),C=W(k);{var N=M=>{var T=Bg(),R=W(T);{var D=P=>{var Y=Vg();E(P,Y)},V=P=>{var Y=de(),Z=X(Y);{var I=H=>{var J=Og();E(H,J)};q(Z,H=>{r(t).newset||H(I)},!0)}E(P,Y)};q(R,P=>{r(t).model?P(V,!1):P(D)})}E(M,T)},F=M=>{var T=de(),R=X(T);Ln(R,()=>r(t).newres&&r(t).model,D=>{var V=de(),P=X(V);{var Y=Z=>{{let I=g(()=>({new:r(t).newset})),H=g(()=>({new:r(t).newres}));Mg(Z,{markOutlier:a,showContributions:f,get data(){return r(I)},get res(){return r(H)},get model(){return r(t).model},get ncomp(){return r(t).ncomp_selected}})}};q(P,Z=>{r(t).newres&&r(t).model&&Z(Y)})}E(D,V)}),E(M,T)};q(C,M=>{r(t).newres?M(F,!1):M(N)})}E(n,d),ge()}function Mi(n,e){j(e,!0)}function Dg(n,e,t){const l=Ts(new Date),s=e.appID+"-session-"+l+".json";r(t).date=l;const a=JSON.stringify(r(t),Kn),o=new Blob([a],{type:"text/json"}),c=window.URL.createObjectURL(o),f=document.createElement("a");f.setAttribute("href",c),f.setAttribute("download",s),f.click()}function Wg(n,e){confirm("Are you sure? All current results and models will be lost in all tabs.")&&e()}var Ug=U('<sup style="color:red">β</sup>'),Hg=U('<li><button class="svelte-1cyr8za"> </button></li>'),Xg=U("<div><!></div>"),Gg=U('<div class="info-container svelte-1cyr8za"><!></div>'),Kg=U('<div class="page svelte-1cyr8za"><header class="page-header svelte-1cyr8za"><div class="header-group svelte-1cyr8za"><img class="logo svelte-1cyr8za" src="logo.svg"/> <h1 class="svelte-1cyr8za"> <!></h1> <p class="svelte-1cyr8za"> </p></div> <ul class="nav svelte-1cyr8za"></ul></header> <main class="svelte-1cyr8za"></main> <footer class="svelte-1cyr8za"><div><span class="session-message svelte-1cyr8za"> </span> <label title="load session from file" class="upload-button svelte-1cyr8za"><input type="file" class="svelte-1cyr8za"/> <svg xmlns="http://www.w3.org/2000/svg" version="2.0" width="20px" height="20px" viewBox="0 0 100 100" class="svelte-1cyr8za"><line x1="50" y1="25" x2="50" y2="75"></line><line x1="30" y1="40" x2="50" y2="25"></line><line x1="70" y1="40" x2="50" y2="25"></line></svg></label> <button title="download session as a file" class="download-button svelte-1cyr8za"><svg xmlns="http://www.w3.org/2000/svg" version="2.0" width="20px" height="20px" viewBox="0 0 100 100" class="svelte-1cyr8za"><line x1="50" y1="25" x2="50" y2="75"></line><line x1="30" y1="60" x2="50" y2="75"></line><line x1="70" y1="60" x2="50" y2="75"></line></svg></button> <button title="reset all sessions" class="clear-button svelte-1cyr8za"><svg xmlns="http://www.w3.org/2000/svg" version="2.0" width="20px" height="20px" viewBox="0 0 100 100" class="svelte-1cyr8za"><line x1="25" y1="25" x2="75" y2="75"></line><line x1="25" y1="75" x2="75" y2="25"></line></svg></button></div> <div class="info svelte-1cyr8za"><button title="Show information about the app" class="button-info svelte-1cyr8za">info</button> <!></div></footer> <!></div>');function Jg(n,e){me(e,!0);let t=B(e,"tabs",19,()=>[]),l=B(e,"isBeta",3,!1);const s="mdatools-"+e.appID;let a=re(!1),o=re(void 0),c=re("Current session "),f=re(!1);function u(A){j(c,A,!0),j(f,!0),setTimeout(()=>{j(c,"Current session "),j(f,!1)},1e3)}function d(){j(a,!1)}function v(A){r(o).tab=A}function h(){const A=indexedDB.open(s,1);A.onsuccess=L=>{const C=L.target.result.transaction(e.appID,"readwrite");C.objectStore(e.appID).delete("session"),C.oncomplete=()=>{j(o,e.initSession(),!0),u("Session was reinitialzed.")},C.onerror=()=>console.error("Failed to session from DB.")}}function m(A,L){window.localStorage.removeItem(e.appID+"-blocked");const k=indexedDB.open(s,1);k.onsuccess=C=>{const M=C.target.result.transaction(e.appID,"readwrite").objectStore(e.appID);M.put(A,"session"),M.put(Ts(new Date),"session-update")}}function p(){new Promise((A,L)=>{const k=indexedDB.open(s,1);k.onsuccess=C=>{const T=C.target.result.transaction(e.appID,"readonly").objectStore(e.appID).get("session");T.onsuccess=()=>A(T.result),T.onerror=()=>L(T.error)}}).then(A=>{w(A),j(c,"Last session is restored "),j(f,!0),setTimeout(()=>{j(c,"Current session "),j(f,!1)},1500)}).catch(A=>{console.error(A),j(o,e.initSession(),!0)})}function w(A){if(!A||A==="undefined"){j(o,e.initSession(),!0);return}const L=JSON.parse(A,Cs);j(o,e.checkSession(L)?L:e.initSession(e.appID),!0)}function b(A){e.resetSession(r(o));const L=new FileReader;L.onload=()=>{w(L.result),A.target.value=""},L.readAsText(A.target.files[0])}ku(()=>{const A=e.appID,L=indexedDB.open(s,1);L.onupgradeneeded=k=>{const C=k.target.result;C.objectStoreNames.contains(A)||C.createObjectStore(A)},L.onsuccess=k=>{p()}});var _=de(),S=X(_);{var y=A=>{var L=Kg(),k=W(L),C=W(k),N=W(C),F=z(N,2),M=W(F),T=z(M);{var R=ce=>{var K=Ug();E(ce,K)};q(T,ce=>{l()&&ce(R)})}var D=z(F,2),V=W(D),P=z(C,2);Ne(P,21,t,Ie,(ce,K,se)=>{var le=Hg();let ve;var oe=W(le);oe.__click=()=>v(se),oe.__keydown=()=>v(se);var fe=W(oe);ne(Se=>{ve=ft(le,1,"nav-item svelte-1cyr8za",null,ve,Se),xe(fe,r(K).name)},[()=>({selected:r(o).tab===se})]),E(ce,le)});var Y=z(k,2);Ne(Y,21,t,Ie,(ce,K,se)=>{var le=Xg();let ve;var oe=W(le);Hn(oe,()=>r(K).component,(fe,Se)=>{Se(fe,{get WASM(){return e.WASM},get session(){return r(o)},backupSession:m})}),ne(fe=>ve=ft(le,1,"tab-content svelte-1cyr8za",null,ve,fe),[()=>({hidden:r(o).tab!==se})]),E(ce,le)});var Z=z(Y,2),I=W(Z);let H;var J=W(I),$=W(J),ae=z(J,2),Q=W(ae);Q.__change=b;var ee=z(ae,2);ee.__click=[Dg,e,o];var ue=z(ee,2);ue.__click=[Wg,h];var Ee=z(I,2),he=W(Ee);he.__click=[Mi,a],he.__keydown=[Mi,a];var we=z(he,2);Er(we,()=>e.footer);var ye=z(Z,2);{var pe=ce=>{Us(ce,{closeModal:d,children:(K,se)=>{var le=Gg(),ve=W(le);Er(ve,()=>e.info),E(K,le)},$$slots:{default:!0}})};q(ye,ce=>{r(a)&&ce(pe)})}ne(ce=>{O(N,"alt",e.appShortTitle),xe(M,e.appTitle),xe(V,e.appSlogan),H=ft(I,1,"session svelte-1cyr8za",null,H,ce),xe($,r(c))},[()=>({"no-buttons":r(f)})]),E(A,L)};q(S,A=>{r(o)&&A(y)})}E(n,_),ge()}st(["click","keydown","change"]);const c1="modulepreload",u1=function(n){return"/"+n},f1={},Qg=function(e,t,l){let s=Promise.resolve();function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};async function Zg(n={}){var Fi;var e,t=n,l=typeof window=="object",s=typeof WorkerGlobalScope<"u",a=typeof process=="object"&&((Fi=process.versions)==null?void 0:Fi.node)&&process.type!="renderer";if(a){const{createRequire:G}=await Qg(()=>Promise.resolve().then(()=>r1),void 0);var o=G(Ue&&Ue.tagName.toUpperCase()==="SCRIPT"&&Ue.src||new URL("pls.js",document.baseURI).href)}var c=(G,te)=>{throw te},f=Ue&&Ue.tagName.toUpperCase()==="SCRIPT"&&Ue.src||new URL("pls.js",document.baseURI).href,u="";function d(G){return t.locateFile?t.locateFile(G,u):u+G}var v,h;if(a){var m=o("fs");f.startsWith("file:")&&(u=o("path").dirname(o("url").fileURLToPath(f))+"/"),h=G=>{G=y(G)?new URL(G):G;var te=m.readFileSync(G);return te},v=async(G,te=!0)=>{G=y(G)?new URL(G):G;var be=m.readFileSync(G,te?void 0:"utf8");return be},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),c=(G,te)=>{throw process.exitCode=G,te}}else if(l||s){try{u=new URL(".",f).href}catch{}s&&(h=G=>{var te=new XMLHttpRequest;return te.open("GET",G,!1),te.responseType="arraybuffer",te.send(null),new Uint8Array(te.response)}),v=async G=>{if(y(G))return new Promise((be,Xe)=>{var We=new XMLHttpRequest;We.open("GET",G,!0),We.responseType="arraybuffer",We.onload=()=>{if(We.status==200||We.status==0&&We.response){be(We.response);return}Xe(We.status)},We.onerror=Xe,We.send(null)});var te=await fetch(G,{credentials:"same-origin"});if(te.ok)return te.arrayBuffer();throw new Error(te.status+" : "+te.url)}}var p=console.log.bind(console),w=console.error.bind(console),b,_=!1,S,y=G=>G.startsWith("file://"),A,L,k,C,N,F,M=!1;function T(){var G=k.buffer;C=new Int8Array(G),N=new Uint8Array(G),t.HEAP32=new Int32Array(G),F=new Uint32Array(G),t.HEAPF64=new Float64Array(G),new BigInt64Array(G),new BigUint64Array(G)}function R(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)se(t.preRun.shift());ye(K)}function D(){M=!0,ll.k()}function V(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)ce(t.postRun.shift());ye(pe)}var P=0,Y=null;function Z(G){var te;P++,(te=t.monitorRunDependencies)==null||te.call(t,P)}function I(G){var be;if(P--,(be=t.monitorRunDependencies)==null||be.call(t,P),P==0&&Y){var te=Y;Y=null,te()}}function H(G){var be;(be=t.onAbort)==null||be.call(t,G),G="Aborted("+G+")",w(G),_=!0,G+=". Build with -sASSERTIONS for more info.";var te=new WebAssembly.RuntimeError(G);throw L==null||L(te),te}var J;function $(){return t.locateFile?d("pls_wasm.wasm"):new URL("/pls/pls.wasm",Ue&&Ue.tagName.toUpperCase()==="SCRIPT"&&Ue.src||new URL("pls.js",document.baseURI).href).href}function ae(G){if(G==J&&b)return new Uint8Array(b);if(h)return h(G);throw"both async and sync fetching of the wasm failed"}async function Q(G){if(!b)try{var te=await v(G);return new Uint8Array(te)}catch{}return ae(G)}async function ee(G,te){try{var be=await Q(G),Xe=await WebAssembly.instantiate(be,te);return Xe}catch(We){w(`failed to asynchronously prepare wasm: ${We}`),H(We)}}async function ue(G,te,be){if(!G&&typeof WebAssembly.instantiateStreaming=="function"&&!y(te)&&!a)try{var Xe=fetch(te,{credentials:"same-origin"}),We=await WebAssembly.instantiateStreaming(Xe,be);return We}catch(tt){w(`wasm streaming compile failed: ${tt}`),w("falling back to ArrayBuffer instantiation")}return ee(te,be)}function Ee(){return{a:l1}}async function he(){function G(tt,rt){return ll=tt.exports,k=ll.j,T(),n1(ll),I(),ll}Z();function te(tt){return G(tt.instance)}var be=Ee();if(t.instantiateWasm)return new Promise((tt,rt)=>{t.instantiateWasm(be,(lt,fr)=>{tt(G(lt))})});J??(J=$());var Xe=await ue(b,J,be),We=te(Xe);return We}class we{constructor(te){xr(this,"name","ExitStatus");this.message=`Program terminated with exit(${te})`,this.status=te}}var ye=G=>{for(;G.length>0;)G.shift()(t)},pe=[],ce=G=>pe.push(G),K=[],se=G=>K.push(G),le=!0,ve=G=>pt(G),oe=()=>Ii(),fe=()=>H(""),Se=0,ct=()=>{le=!1,Se=0},Pe={},Be=G=>{if(G instanceof we||G=="unwind")return S;c(1,G)},Re=()=>le||Se>0,Ze=G=>{var te;S=G,Re()||((te=t.onExit)==null||te.call(t,G),_=!0),c(G,new we(G))},jt=(G,te)=>{S=G,Ze(G)},rr=jt,St=()=>{if(!Re())try{rr(S)}catch(G){Be(G)}},Gt=G=>{if(!_)try{G(),St()}catch(te){Be(te)}},Pr=()=>performance.now(),Kt=(G,te)=>{if(Pe[G]&&(clearTimeout(Pe[G].id),delete Pe[G]),!te)return 0;var be=setTimeout(()=>{delete Pe[G],Gt(()=>yr(G,Pr()))},te);return Pe[G]={id:be,timeout_ms:te},0},na=()=>Date.now(),la=()=>2147483648,Ce=(G,te)=>Math.ceil(G/te)*te,De=G=>{var te=k.buffer.byteLength,be=(G-te+65535)/65536|0;try{return k.grow(be),T(),1}catch{}},qe=G=>{var te=N.length;G>>>=0;var be=la();if(G>be)return!1;for(var Xe=1;Xe<=4;Xe*=2){var We=te*(1+.2/Xe);We=Math.min(We,G+100663296);var tt=Math.min(be,Ce(Math.max(G,We),65536)),rt=De(tt);if(rt)return!0}return!1},vt=G=>52;function Mt(G,te,be,Xe){return 70}var ur=[null,[],[]],Vt=typeof TextDecoder<"u"?new TextDecoder:void 0,qt=(G,te,be,Xe)=>{for(var We=te+be;G[te]&&!(te>=We);)++te;return te},Ke=(G,te=0,be,Xe)=>{var We=qt(G,te,be);if(We-te>16&&G.buffer&&Vt)return Vt.decode(G.subarray(te,We));for(var tt="";te<We;){var rt=G[te++];if(!(rt&128)){tt+=String.fromCharCode(rt);continue}var lt=G[te++]&63;if((rt&224)==192){tt+=String.fromCharCode((rt&31)<<6|lt);continue}var fr=G[te++]&63;if((rt&240)==224?rt=(rt&15)<<12|lt<<6|fr:rt=(rt&7)<<18|lt<<12|fr<<6|G[te++]&63,rt<65536)tt+=String.fromCharCode(rt);else{var bn=rt-65536;tt+=String.fromCharCode(55296|bn>>10,56320|bn&1023)}}return tt},He=(G,te)=>{var be=ur[G];te===0||te===10?((G===1?p:w)(Ke(be)),be.length=0):be.push(te)},Pt=(G,te,be)=>G?Ke(N,G,te):"",yt=(G,te,be,Xe)=>{for(var We=0,tt=0;tt<be;tt++){var rt=F[te>>2],lt=F[te+4>>2];te+=8;for(var fr=0;fr<lt;fr++)He(G,N[rt+fr]);We+=lt}return F[Xe>>2]=We,0},ht=G=>{var te=t["_"+G];return te},nt=(G,te)=>{C.set(G,te)},nr=G=>{for(var te=0,be=0;be<G.length;++be){var Xe=G.charCodeAt(be);Xe<=127?te++:Xe<=2047?te+=2:Xe>=55296&&Xe<=57343?(te+=4,++be):te+=3}return te},pn=(G,te,be,Xe)=>{if(!(Xe>0))return 0;for(var We=be,tt=be+Xe-1,rt=0;rt<G.length;++rt){var lt=G.codePointAt(rt);if(lt<=127){if(be>=tt)break;te[be++]=lt}else if(lt<=2047){if(be+1>=tt)break;te[be++]=192|lt>>6,te[be++]=128|lt&63}else if(lt<=65535){if(be+2>=tt)break;te[be++]=224|lt>>12,te[be++]=128|lt>>6&63,te[be++]=128|lt&63}else{if(be+3>=tt)break;te[be++]=240|lt>>18,te[be++]=128|lt>>12&63,te[be++]=128|lt>>6&63,te[be++]=128|lt&63,rt++}}return te[be]=0,be-We},Ge=(G,te,be)=>pn(G,N,te,be),Ae=G=>Vl(G),Lt=G=>{var te=nr(G)+1,be=Ae(te);return Ge(G,be,te),be},sa=(G,te,be,Xe,We)=>{var tt={string:Jt=>{var sl=0;return Jt!=null&&Jt!==0&&(sl=Lt(Jt)),sl},array:Jt=>{var sl=Ae(Jt.length);return nt(Jt,sl),sl}};function rt(Jt){return te==="string"?Pt(Jt):te==="boolean"?!!Jt:Jt}var lt=ht(G),fr=[],bn=0;if(Xe)for(var _n=0;_n<Xe.length;_n++){var ji=tt[be[_n]];ji?(bn===0&&(bn=oe()),fr[_n]=ji(Xe[_n])):fr[_n]=Xe[_n]}var oa=lt(...fr);function a1(Jt){return bn!==0&&ve(bn),rt(Jt)}return oa=a1(oa),oa};t.noExitRuntime&&(le=t.noExitRuntime),t.print&&(p=t.print),t.printErr&&(w=t.printErr),t.wasmBinary&&(b=t.wasmBinary),t.arguments&&t.arguments,t.thisProgram&&t.thisProgram,t.ccall=sa;var yr,pt,Vl,Ii;function n1(G){t._plsfit_wasm=G.l,t._free=G.m,t._malloc=G.n,t._plspredict_wasm=G.o,t._pcvpls_wasm=G.p,t._prepfit_wasm=G.q,t._prepapply_wasm=G.r,yr=G.s,pt=G.t,Vl=G.u,Ii=G.v}var l1={c:fe,b:ct,d:Kt,i:na,e:qe,h:vt,f:Mt,g:yt,a:Ze},ll=await he();function aa(){if(P>0){Y=aa;return}if(R(),P>0){Y=aa;return}function G(){var te;t.calledRun=!0,!_&&(D(),A==null||A(t),(te=t.onRuntimeInitialized)==null||te.call(t),V())}t.setStatus?(t.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>t.setStatus(""),1),G()},1)):G()}function s1(){if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.shift()()}return s1(),aa(),M?e=t:e=new Promise((G,te)=>{A=G,L=te}),e}var $g=U('<p>Current release: <span>1.2.2</span> Feedback: <a class="paper-link" href="mailto:help@mda.tools?subject=PCA app">help@mda.tools</a></p>'),e1=U(`<h2>Partial Least Squares regression</h2> <p>Interactive web-application for creating, testing and applying PLS models for multivariate regression
      directly in your browser. The app does not send any information to the server,
      all calculations are done locally on your device.</p> <p>The application uses <a href="https://doi.org/10.1016/j.aca.2023.341096">Procrustes cross-validation</a> for optimization and quality check on the training stage.</p> <h3>v. 1.2.2</h3> <p class="release-info">released 25/07/2025</p> <ul><li>Small improvements and bug fixes.</li></ul> <h3>v. 1.2.1</h3> <p class="release-info">released 22/07/2025</p> <ul><li>Built in preprocessing functionality.</li> <li>Added ability to read SPC files in <em>Predict</em> tab.</li> <li>Numerous small improvements and bug fixes</li></ul>`,1);function t1(n,e){me(e,!1);function t(o){o.train.calset=null,o.test.model=null,o.new.model=null,o.tab=0}function l(o){const c=Object.keys(o);if(!["date","tab","train","test","new"].every(p=>c.includes(p)))return!1;const f=["model","calset","calsetp","calres","pvset","pvres","outliers","exclvars","ncomp_selected","pvscalars","prepType","prepmodel","prepmeta","prepobj"],u=Object.keys(o.train);if(!f.every(p=>u.includes(p)))return!1;const d=["model","testset","testres","outliers","ncomp_selected"],v=Object.keys(o.test);if(!d.every(p=>v.includes(p)))return!1;const h=["model","newset","newres","outliers","ncomp_selected"],m=Object.keys(o.new);return!!h.every(p=>m.includes(p))}function s(){return{date:Ts(new Date),tab:0,train:{model:0,calset:0,calsetp:0,calres:0,pvset:0,pvres:0,outliers:[],exclvars:[],ncomp_selected:1,pvscalars:0,prepType:null,prepmodel:0,prepmeta:0,prepobj:[]},test:{model:0,testset:0,testres:0,outliers:[],ncomp_selected:1},new:{model:0,newset:0,newres:0,outliers:[],ncomp_selected:1}}}const a=[{name:"Train",label:"train",component:vg},{name:"Test",label:"test",component:Ng},{name:"Predict",label:"new",component:Yg}];_u(),Jg(n,{appID:"pls",appTitle:"PLS",appShortTitle:"PLS",appSlogan:"Partial least squares regression",get WASM(){return Zg},get tabs(){return a},initSession:s,checkSession:l,resetSession:t,footer:f=>{var u=$g();E(f,u)},info:f=>{var u=e1();E(f,u)},$$slots:{footer:!0,info:!0}}),ge()}tu(t1,{target:document.body});const r1=Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"}))})();
//# sourceMappingURL=pls.js.map
